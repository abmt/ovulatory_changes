<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Robustness checks</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="site_libs/datatables-binding-0.2/datatables.js"></script>
<link href="site_libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="site_libs/jszip-1.10.12/jszip.min.js"></script>
<script src="site_libs/pdfmake-1.10.12/pdfmake.min.js"></script>
<script src="site_libs/pdfmake-1.10.12/vfs_fonts.js"></script>
<link href="site_libs/dt-ext-buttons-1.10.12/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-buttons-1.10.12/js/dataTables.buttons.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.12/js/buttons.flash.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.12/js/buttons.html5.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.12/js/buttons.colVis.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.10.12/js/buttons.print.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<script src="library/auto_tab_first_section.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="library/custom_styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Fertility diary</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="1_power_analysis.html">Power analysis</a>
</li>
<li>
  <a href="1_researcher_df_analysis.html">Researcher degree of freedom simulation</a>
</li>
<li>
  <a href="1_wrangle_data.html">Data wrangling</a>
</li>
<li>
  <a href="2_descriptives.html">Descriptives</a>
</li>
<li>
  <a href="3_fertility_as_prereg.html">Preregistered analyses</a>
</li>
<li>
  <a href="3_fertility_robustness.html">Robustness tests</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="robustness-checks-of-ovulatory-changes" class="section level1 tab-content">
<h1>Robustness checks <small>of ovulatory changes</small></h1>
<p><span style="background:red;width:20px;height:20px;display:inline-block;"></span> Cycling women (not on hormonal birth control)</p>
<p><span style="background:black;width:20px;height:20px;display:inline-block;"></span> Women on hormonal birth control</p>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<pre class="r"><code># cd /usr/users/rarslan/relationship_dynamics/ &amp;&amp; bsub -q mpi -W 48:00 -n 20 -R span[hosts=1] R -e &quot;filebase = &#39;3_fertility_robustness&#39;; x = rmarkdown::render(paste0(&#39;3_fertility_robustness&#39;,&#39;.Rmd&#39;), run_pandoc = FALSE, clean = FALSE); save(x, file = &#39;rob.rda&#39;); cat(readLines(paste0(filebase,&#39;.utf8.md&#39;)), sep = &#39;\n&#39;)&quot;
library(knitr)
opts_chunk$set(fig.width = 8, fig.height = 8, cache = T, warning = T, message = F, cache = F)</code></pre>
<pre class="r"><code>source(&quot;0_helpers.R&quot;)
load(&quot;full_data.rdata&quot;)
diary = diary %&gt;% 
  mutate(
  included = included_all,
  fertile = if_else(is.na(prc_stirn_b_squished), prc_stirn_b_backward_inferred, prc_stirn_b_squished),
  contraceptive_methods = factor(contraceptive_method, levels = 
  c(&quot;barrier_or_abstinence&quot;, &quot;fertility_awareness&quot;, &quot;none&quot;,  &quot;hormonal&quot;)),
  relationship_status_clean = factor(relationship_status_clean),
  cohabitation = factor(cohabitation),
  certainty_menstruation = as.numeric(as.character(certainty_menstruation)),
  partner_st_vs_lt = partner_attractiveness_shortterm - partner_attractiveness_longterm
)  %&gt;% group_by(person) %&gt;% 
  mutate(
      fertile_mean = mean(fertile, na.rm = T)
  )
opts_chunk$set(warning = F)
library(Cairo)
opts_chunk$set(dev = &quot;CairoPNG&quot;)

diary$age_group = cut(diary$age,c(18,20,25,30,35,70), include.lowest = T)</code></pre>
<pre class="r"><code>models = list()

do_model = function(model, diary) {
  outcome = names(model@frame)[1]
  outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)
  model = calculate_effects(model)
  options = list(fig.path = paste0(knitr::opts_chunk$get(&quot;fig.path&quot;), outcome, &quot;-&quot;), 
                                 cache.path = paste0(knitr::opts_chunk$get(&quot;cache.path&quot;), outcome, &quot;-&quot;))
    asis_knit_child(&quot;_robustness_model.Rmd&quot;, options = options)
}
do_moderators = function(model, diary) {
  asis_knit_child(&quot;_moderators.Rmd&quot;)
}</code></pre>
<pre class="r"><code>models$extra_pair = lmer(extra_pair ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$desirability_1 = lmer(desirability_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$extra_pair_intimacy = glmer(extra_pair_intimacy ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$extra_pair_sex = glmer(extra_pair_sex ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$in_pair_desire = lmer(in_pair_desire ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$had_petting = glmer(had_petting ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$had_sexual_intercourse = glmer(had_sexual_intercourse ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$partner_initiated_sexual_intercourse = glmer(partner_initiated_sexual_intercourse ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$sexual_intercourse_satisfaction = lmer(sexual_intercourse_satisfaction ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$spent_night_with_partner = glmer(spent_night_with_partner ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$partner_mate_retention = lmer(partner_mate_retention ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$female_mate_retention = lmer(female_mate_retention ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$sexy_clothes = lmer(sexy_clothes ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$showy_clothes = lmer(showy_clothes ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$male_attention_1 = lmer(male_attention_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$in_pair_public_intimacy = glmer(in_pair_public_intimacy ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;))
models$NARQ_admiration = lmer(NARQ_admiration ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$NARQ_rivalry = lmer(NARQ_rivalry ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$self_esteem_1 = lmer(self_esteem_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$female_jealousy = lmer(female_jealousy ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$relationship_satisfaction_1 = lmer(relationship_satisfaction_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
models$communication_partner_1 = lmer(communication_partner_1 ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)</code></pre>
<pre class="r"><code>model_summaries = parallel::mclapply(models, FUN = do_model, diary = diary, mc.cores = 20)</code></pre>
</div>
<div id="extra-pair" class="section level2 tab-content active">
<h2>Extra-pair</h2>
<pre class="r"><code>model_summaries$extra_pair</code></pre>
<div id="model-summary" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-1" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: extra_pair ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 48344

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.557 -0.148  0.405  7.999 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.311    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value   Pr(&gt;|t|)    
(Intercept)                             1.8333     0.0473  1298.0000   38.73    &lt; 2e-16 ***
includedhorm_contra                    -0.1241     0.0388  1246.0000   -3.20     0.0014 ** 
menstruationpre                        -0.0907     0.0174 25762.0000   -5.22 0.00000018 ***
menstruationyes                        -0.0716     0.0163 25854.0000   -4.38 0.00001194 ***
fertile                                 0.1736     0.0352 25761.0000    4.93 0.00000082 ***
fertile_mean                           -0.0116     0.2172  1407.0000   -0.05     0.9574    
includedhorm_contra:menstruationpre     0.0692     0.0223 25761.0000    3.11     0.0019 ** 
includedhorm_contra:menstruationyes     0.0860     0.0214 25839.0000    4.02 0.00005897 ***
includedhorm_contra:fertile            -0.1751     0.0445 25862.0000   -3.94 0.00008301 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.470                                                               
menstrutnpr             -0.141  0.180                                                        
menstrutnys             -0.138  0.174  0.400                                                 
fertile                 -0.137  0.223  0.470    0.387                                        
fertile_men             -0.771 -0.032 -0.008   -0.006   -0.057                               
inclddhrm_cntr:mnstrtnp  0.117 -0.225 -0.780   -0.312   -0.366 -0.003                        
inclddhrm_cntr:mnstrtny  0.111 -0.213 -0.305   -0.763   -0.295 -0.002  0.385                 
inclddhrm_cntr:f         0.137 -0.280 -0.371   -0.306   -0.789  0.008  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.31 [0.18;0.43].</p>
</div>
<div id="marginal-effect-plots" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-1" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-1" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-1" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-1" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-2" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-2" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-2" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-1" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-3" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-3" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-3" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-extra_pair-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 48000

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.747 -0.550 -0.138  0.391  7.903 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.3337   0.578                     
          fertile         0.2927   0.541    -0.18            
          menstruationpre 0.0444   0.211    -0.29  0.43      
          menstruationyes 0.0673   0.259    -0.26  0.57  0.77
 Residual                 0.3034   0.551                     
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           1.8458     0.0483    38.2
includedhorm_contra                  -0.1299     0.0402    -3.2
menstruationpre                      -0.0998     0.0209    -4.8
menstruationyes                      -0.0777     0.0217    -3.6
fertile                               0.1620     0.0463     3.5
fertile_mean                         -0.0547     0.2206    -0.2
includedhorm_contra:menstruationpre   0.0791     0.0268     3.0
includedhorm_contra:menstruationyes   0.0943     0.0282     3.3
includedhorm_contra:fertile          -0.1627     0.0588    -2.8

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.478                                                               
menstrutnpr             -0.216  0.261                                                        
menstrutnys             -0.206  0.254  0.532                                                 
fertile                 -0.167  0.260  0.446    0.462                                        
fertile_men             -0.763 -0.033 -0.002   -0.008   -0.062                               
inclddhrm_cntr:mnstrtnp  0.174 -0.330 -0.780   -0.415   -0.347 -0.006                        
inclddhrm_cntr:mnstrtny  0.165 -0.316 -0.410   -0.770   -0.355 -0.003  0.522                 
inclddhrm_cntr:f         0.161 -0.327 -0.351   -0.364   -0.786  0.010  0.445                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.457                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">48316</td>
<td align="center">48407</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">47993</td>
<td align="center">48157</td>
<td align="center">-23977</td>
<td align="center">47953</td>
<td align="center">341.2</td>
<td align="center">9</td>
<td align="center">4.512e-68</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 43802

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.436 -0.556 -0.143  0.403  8.131 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.31468  0.5610  
 Xr.2     s(days_filled_out):includedhorm_contra 0.08703  0.2950  
 Xr.1     s(days_filled_out):includedcycling     0.01562  0.1250  
 Xr.0     s(day_number):includedhorm_contra      0.00184  0.0429  
 Xr       s(day_number):includedcycling          0.00000  0.0000  
 Residual                                        0.31295  0.5594  
Number of obs: 24250, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 1.8256     0.0477    38.3
Xincludedhorm_contra                        -0.1138     0.0394    -2.9
Xmenstruationpre                            -0.0929     0.0179    -5.2
Xmenstruationyes                            -0.0682     0.0172    -4.0
Xfertile                                     0.1770     0.0371     4.8
Xfertile_mean                               -0.0479     0.2179    -0.2
Xincludedhorm_contra:menstruationpre         0.0750     0.0230     3.3
Xincludedhorm_contra:menstruationyes         0.0868     0.0225     3.9
Xincludedhorm_contra:fertile                -0.1783     0.0468    -3.8
Xs(day_number):includedcyclingFx1            0.0721     0.0300     2.4
Xs(day_number):includedhorm_contraFx1        0.0704     0.0316     2.2
Xs(days_filled_out):includedcyclingFx1      -0.1246     0.0459    -2.7
Xs(days_filled_out):includedhorm_contraFx1  -0.2040     0.0618    -3.3
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
extra_pair ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)                           1.8256     0.0477   38.25    &lt; 2e-16 ***
includedhorm_contra                  -0.1138     0.0394   -2.89    0.00386 ** 
menstruationpre                      -0.0929     0.0179   -5.18 0.00000022 ***
menstruationyes                      -0.0682     0.0172   -3.97 0.00007268 ***
fertile                               0.1770     0.0371    4.78 0.00000180 ***
fertile_mean                         -0.0479     0.2179   -0.22    0.82612    
includedhorm_contra:menstruationpre   0.0750     0.0230    3.27    0.00109 ** 
includedhorm_contra:menstruationyes   0.0868     0.0225    3.86    0.00012 ***
includedhorm_contra:fertile          -0.1783     0.0468   -3.81    0.00014 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value   
s(day_number):includedcycling          1.00   1.00 5.77   0.016 * 
s(day_number):includedhorm_contra      1.45   1.45 5.73   0.017 * 
s(days_filled_out):includedcycling     3.31   3.31 3.06   0.015 * 
s(days_filled_out):includedhorm_contra 5.44   5.44 3.75   0.004 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00596   
lmer.REML =  43802  Scale est. = 0.31295   n = 24250
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  46732 46831 -23354

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.5539   0.5765

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.3072 
Fixed effects: extra_pair ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.8428   0.04840 25495   38.07  0.0000
includedhorm_contra                 -0.1243   0.03983  1040   -3.12  0.0018
menstruationpre                     -0.0887   0.02024 25495   -4.38  0.0000
menstruationyes                     -0.0690   0.01887 25495   -3.65  0.0003
fertile                              0.1778   0.04337 25495    4.10  0.0000
fertile_mean                        -0.0308   0.22223  1040   -0.14  0.8898
includedhorm_contra:menstruationpre  0.0728   0.02598 25495    2.80  0.0050
includedhorm_contra:menstruationyes  0.0847   0.02458 25495    3.44  0.0006
includedhorm_contra:fertile         -0.1741   0.05477 25495   -3.18  0.0015
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.160  0.201                                                        
menstruationyes                     -0.157  0.197  0.405                                                 
fertile                             -0.155  0.256  0.427    0.362                                        
fertile_mean                        -0.768 -0.032 -0.008   -0.006   -0.070                               
includedhorm_contra:menstruationpre  0.131 -0.250 -0.779   -0.316   -0.332 -0.003                        
includedhorm_contra:menstruationyes  0.126 -0.240 -0.311   -0.768   -0.277 -0.002  0.390                 
includedhorm_contra:fertile          0.157 -0.322 -0.338   -0.286   -0.789  0.011  0.425                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.355                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.2821 -0.5605 -0.1654  0.3836  7.8144 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  46431 46538 -23203

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:        0.54   0.5875

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.7472 -0.4954 
Fixed effects: extra_pair ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.8379   0.04846 25495   37.93  0.0000
includedhorm_contra                 -0.1184   0.03982  1040   -2.97  0.0030
menstruationpre                     -0.0772   0.02030 25495   -3.80  0.0001
menstruationyes                     -0.0627   0.01931 25495   -3.25  0.0012
fertile                              0.1799   0.04589 25495    3.92  0.0001
fertile_mean                        -0.0192   0.22319  1040   -0.09  0.9314
includedhorm_contra:menstruationpre  0.0608   0.02609 25495    2.33  0.0199
includedhorm_contra:menstruationyes  0.0705   0.02505 25495    2.82  0.0049
includedhorm_contra:fertile         -0.1868   0.05786 25495   -3.23  0.0012
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.471                                                               
menstruationpre                     -0.157  0.194                                                        
menstruationyes                     -0.161  0.201  0.436                                                 
fertile                             -0.152  0.259  0.355    0.339                                        
fertile_mean                        -0.769 -0.034 -0.003   -0.005   -0.076                               
includedhorm_contra:menstruationpre  0.127 -0.241 -0.778   -0.340   -0.276 -0.003                        
includedhorm_contra:menstruationyes  0.128 -0.244 -0.336   -0.771   -0.261 -0.001  0.424                 
includedhorm_contra:fertile          0.157 -0.325 -0.281   -0.269   -0.790  0.013  0.352                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.332                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.0403 -0.5612 -0.1856  0.3756  7.6990 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 30418

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.348 -0.557 -0.148  0.408  8.097 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.320    0.566   
 Residual             0.313    0.560   
Number of obs: 17026, groups:  person, 513

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                               1.909422   0.106971   17.85
fertile_mean                                             -0.111294   0.522029   -0.21
contraceptive_methodsfertility_awareness                 -0.100940   0.137287   -0.74
contraceptive_methodsnone                                -0.224004   0.145421   -1.54
contraceptive_methodshormonal                            -0.168364   0.069287   -2.43
fertile                                                   0.053678   0.062481    0.86
menstruationpre                                          -0.085755   0.030170   -2.84
menstruationyes                                          -0.038498   0.028824   -1.34
contraceptive_methodsfertility_awareness:fertile          0.246743   0.141881    1.74
contraceptive_methodsnone:fertile                         0.102445   0.153584    0.67
contraceptive_methodshormonal:fertile                    -0.063479   0.069805   -0.91
contraceptive_methodsfertility_awareness:menstruationpre  0.034951   0.066824    0.52
contraceptive_methodsnone:menstruationpre                 0.136851   0.069882    1.96
contraceptive_methodshormonal:menstruationpre             0.065769   0.033986    1.94
contraceptive_methodsfertility_awareness:menstruationyes  0.052088   0.067166    0.78
contraceptive_methodsnone:menstruationyes                -0.000944   0.073064   -0.01
contraceptive_methodshormonal:menstruationyes             0.058055   0.032875    1.77
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">30386</td>
<td align="center">30486</td>
<td align="center">-15180</td>
<td align="center">30360</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">30390</td>
<td align="center">30537</td>
<td align="center">-15176</td>
<td align="center">30352</td>
<td align="center">7.983</td>
<td align="center">6</td>
<td align="center">0.2393</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">48325</td>
<td align="center">48481</td>
<td align="center">-24144</td>
<td align="center">48287</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">48334</td>
<td align="center">48556</td>
<td align="center">-24140</td>
<td align="center">48280</td>
<td align="center">6.944</td>
<td align="center">8</td>
<td align="center">0.5427</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + age_group +  
    included + fertile + menstruation:included + age_group:included +  
    age_group:fertile + included:fertile + age_group:included:fertile
   Data: diary

REML criterion at convergence: 48378

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.287 -0.558 -0.151  0.404  8.007 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.559   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   1.93261    0.09969   19.39
menstruationpre                              -0.09098    0.01737   -5.24
menstruationyes                              -0.07124    0.01635   -4.36
fertile_mean                                 -0.02505    0.21849   -0.11
age_group(20,25]                             -0.06581    0.10693   -0.62
age_group(25,30]                             -0.11362    0.11004   -1.03
age_group(30,35]                             -0.16287    0.12630   -1.29
age_group(35,70]                             -0.14042    0.11604   -1.21
includedhorm_contra                          -0.16517    0.10703   -1.54
fertile                                       0.11359    0.09991    1.14
menstruationpre:includedhorm_contra           0.06925    0.02227    3.11
menstruationyes:includedhorm_contra           0.08565    0.02142    4.00
age_group(20,25]:includedhorm_contra         -0.00756    0.12205   -0.06
age_group(25,30]:includedhorm_contra          0.00903    0.13433    0.07
age_group(30,35]:includedhorm_contra          0.27848    0.17511    1.59
age_group(35,70]:includedhorm_contra         -0.05947    0.19742   -0.30
age_group(20,25]:fertile                      0.08217    0.11068    0.74
age_group(25,30]:fertile                      0.08934    0.11408    0.78
age_group(30,35]:fertile                      0.09511    0.13215    0.72
age_group(35,70]:fertile                     -0.01459    0.12040   -0.12
includedhorm_contra:fertile                  -0.13009    0.11081   -1.17
age_group(20,25]:includedhorm_contra:fertile -0.04277    0.12398   -0.34
age_group(25,30]:includedhorm_contra:fertile -0.06905    0.13740   -0.50
age_group(30,35]:includedhorm_contra:fertile -0.30212    0.17736   -1.70
age_group(35,70]:includedhorm_contra:fertile  0.04234    0.20229    0.21
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48315</td>
<td align="center">48422</td>
<td align="center">-24145</td>
<td align="center">48289</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48317</td>
<td align="center">48440</td>
<td align="center">-24144</td>
<td align="center">48287</td>
<td align="center">2.226</td>
<td align="center">2</td>
<td align="center">0.3286</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + weekend +  
    included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 48359

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.277 -0.557 -0.147  0.404  8.007 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              1.82987    0.04776    38.3
menstruationpre                         -0.09065    0.01736    -5.2
menstruationyes                         -0.07163    0.01634    -4.4
fertile_mean                            -0.00921    0.21720     0.0
weekendTRUE                              0.00729    0.01515     0.5
includedhorm_contra                     -0.12472    0.03961    -3.1
fertile                                  0.18947    0.04280     4.4
menstruationpre:includedhorm_contra      0.06895    0.02226     3.1
menstruationyes:includedhorm_contra      0.08618    0.02141     4.0
weekendTRUE:includedhorm_contra          0.00261    0.01946     0.1
weekendTRUE:fertile                     -0.03862    0.05902    -0.7
includedhorm_contra:fertile             -0.21713    0.05426    -4.0
weekendTRUE:includedhorm_contra:fertile  0.10023    0.07480     1.3
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">48245</td>
<td align="center">48433</td>
<td align="center">-24100</td>
<td align="center">48199</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">48259</td>
<td align="center">48546</td>
<td align="center">-24095</td>
<td align="center">48189</td>
<td align="center">9.896</td>
<td align="center">12</td>
<td align="center">0.6251</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + weekday +  
    included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 48355

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.272 -0.555 -0.147  0.401  8.101 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.320    0.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   1.78816    0.05050    35.4
menstruationpre                              -0.09022    0.01734    -5.2
menstruationyes                              -0.07117    0.01632    -4.4
fertile_mean                                 -0.00164    0.21712     0.0
weekdayTuesday                                0.05586    0.02702     2.1
weekdayWednesday                              0.04844    0.02699     1.8
weekdayThursday                               0.05581    0.02730     2.0
weekdayFriday                                 0.09722    0.02776     3.5
weekdaySaturday                               0.03272    0.02806     1.2
weekdaySunday                                 0.01365    0.02710     0.5
includedhorm_contra                          -0.12721    0.04483    -2.8
fertile                                       0.16614    0.07646     2.2
menstruationpre:includedhorm_contra           0.06754    0.02223     3.0
menstruationyes:includedhorm_contra           0.08440    0.02138     3.9
weekdayTuesday:includedhorm_contra           -0.03650    0.03467    -1.1
weekdayWednesday:includedhorm_contra          0.01092    0.03480     0.3
weekdayThursday:includedhorm_contra           0.04302    0.03514     1.2
weekdayFriday:includedhorm_contra            -0.00915    0.03561    -0.3
weekdaySaturday:includedhorm_contra           0.02111    0.03604     0.6
weekdaySunday:includedhorm_contra             0.00477    0.03493     0.1
weekdayTuesday:fertile                       -0.05361    0.10519    -0.5
weekdayWednesday:fertile                      0.06544    0.10587     0.6
weekdayThursday:fertile                       0.08891    0.10744     0.8
weekdayFriday:fertile                        -0.05748    0.10755    -0.5
weekdaySaturday:fertile                       0.08715    0.10898     0.8
weekdaySunday:fertile                        -0.07550    0.10595    -0.7
includedhorm_contra:fertile                  -0.25667    0.09752    -2.6
weekdayTuesday:includedhorm_contra:fertile    0.16446    0.13389     1.2
weekdayWednesday:includedhorm_contra:fertile -0.01278    0.13509    -0.1
weekdayThursday:includedhorm_contra:fertile  -0.01477    0.13626    -0.1
weekdayFriday:includedhorm_contra:fertile     0.14997    0.13659     1.1
weekdaySaturday:includedhorm_contra:fertile   0.02063    0.13855     0.1
weekdaySunday:includedhorm_contra:fertile     0.24222    0.13486     1.8
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">48316</td>
<td align="center">48455</td>
<td align="center">-24141</td>
<td align="center">48282</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">48315</td>
<td align="center">48503</td>
<td align="center">-24134</td>
<td align="center">48269</td>
<td align="center">13.49</td>
<td align="center">6</td>
<td align="center">0.03586</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + included_levels +  
    included + fertile + menstruation:included + included_levels:included +  
    included_levels:fertile + included:fertile + included_levels:included:fertile
   Data: diary

REML criterion at convergence: 48359

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.291 -0.557 -0.149  0.406  7.989 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.309    0.556   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              1.82309    0.05247    34.7
menstruationpre                                         -0.09282    0.01737    -5.3
menstruationyes                                         -0.07270    0.01635    -4.4
fertile_mean                                            -0.06134    0.21816    -0.3
included_levelslax                                       0.25569    0.10930     2.3
included_levelsconservative                             -0.00658    0.08532    -0.1
included_levelsstrict                                   -0.02278    0.08399    -0.3
includedhorm_contra                                     -0.13608    0.05418    -2.5
fertile                                                  0.26213    0.04470     5.9
menstruationpre:includedhorm_contra                      0.07059    0.02229     3.2
menstruationyes:includedhorm_contra                      0.08628    0.02143     4.0
included_levelslax:includedhorm_contra                  -0.08277    0.13280    -0.6
included_levelsconservative:includedhorm_contra          0.02475    0.10631     0.2
included_levelsstrict:includedhorm_contra                0.03185    0.10296     0.3
included_levelslax:fertile                              -0.07539    0.10795    -0.7
included_levelsconservative:fertile                     -0.19765    0.08073    -2.4
included_levelsstrict:fertile                           -0.24616    0.08078    -3.0
includedhorm_contra:fertile                             -0.21967    0.06794    -3.2
included_levelslax:includedhorm_contra:fertile           0.01669    0.13173     0.1
included_levelsconservative:includedhorm_contra:fertile  0.15696    0.10494     1.5
included_levelsstrict:includedhorm_contra:fertile        0.17553    0.10332     1.7
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">48314</td>
<td align="center">48453</td>
<td align="center">-24140</td>
<td align="center">48280</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">48320</td>
<td align="center">48508</td>
<td align="center">-24137</td>
<td align="center">48274</td>
<td align="center">6.495</td>
<td align="center">6</td>
<td align="center">0.3701</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + cycle_length_groups +  
    included + fertile + menstruation:included + cycle_length_groups:included +  
    cycle_length_groups:fertile + included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 48356

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.311 -0.557 -0.148  0.405  8.005 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.309    0.556   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              2.0859     0.0928   22.49
menstruationpre                                         -0.0901     0.0174   -5.18
menstruationyes                                         -0.0713     0.0165   -4.33
fertile_mean                                            -0.0371     0.2190   -0.17
cycle_length_groups(25,30]                              -0.2633     0.0919   -2.87
cycle_length_groups(30,35]                              -0.3707     0.1098   -3.37
cycle_length_groups(35,41]                              -0.2232     0.1549   -1.44
includedhorm_contra                                     -0.4318     0.1037   -4.16
fertile                                                  0.1471     0.0948    1.55
menstruationpre:includedhorm_contra                      0.0694     0.0223    3.12
menstruationyes:includedhorm_contra                      0.0867     0.0215    4.02
cycle_length_groups(25,30]:includedhorm_contra           0.3353     0.1124    2.98
cycle_length_groups(30,35]:includedhorm_contra           0.3751     0.1711    2.19
cycle_length_groups(35,41]:includedhorm_contra           0.3298     0.2216    1.49
cycle_length_groups(25,30]:fertile                       0.0511     0.1013    0.50
cycle_length_groups(30,35]:fertile                      -0.0296     0.1192   -0.25
cycle_length_groups(35,41]:fertile                      -0.0531     0.1669   -0.32
includedhorm_contra:fertile                             -0.1397     0.1110   -1.26
cycle_length_groups(25,30]:includedhorm_contra:fertile  -0.0439     0.1192   -0.37
cycle_length_groups(30,35]:includedhorm_contra:fertile  -0.2046     0.1857   -1.10
cycle_length_groups(35,41]:includedhorm_contra:fertile  -0.1241     0.2190   -0.57
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48320</td>
<td align="center">48426</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48321</td>
<td align="center">48444</td>
<td align="center">-24145</td>
<td align="center">48291</td>
<td align="center">2.925</td>
<td align="center">2</td>
<td align="center">0.2317</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + certainty_menstruation +  
    included + fertile + menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 48361

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.279 -0.557 -0.149  0.406  7.997 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         1.96557    0.13840   14.20
menstruationpre                                    -0.09004    0.01737   -5.18
menstruationyes                                    -0.07053    0.01636   -4.31
fertile_mean                                       -0.00109    0.21766    0.00
certainty_menstruation                             -0.03252    0.03158   -1.03
includedhorm_contra                                -0.19917    0.17375   -1.15
fertile                                            -0.00632    0.14209   -0.04
menstruationpre:includedhorm_contra                 0.06856    0.02227    3.08
menstruationyes:includedhorm_contra                 0.08544    0.02143    3.99
certainty_menstruation:includedhorm_contra          0.01864    0.04050    0.46
certainty_menstruation:fertile                      0.04339    0.03322    1.31
includedhorm_contra:fertile                        -0.11772    0.18232   -0.65
certainty_menstruation:includedhorm_contra:fertile -0.01485    0.04210   -0.35
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">48324</td>
<td align="center">48447</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">48330</td>
<td align="center">48486</td>
<td align="center">-24146</td>
<td align="center">48292</td>
<td align="center">2.253</td>
<td align="center">4</td>
<td align="center">0.6893</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + cycle_regularity +  
    included + fertile + menstruation:included + cycle_regularity:included +  
    cycle_regularity:fertile + included:fertile + cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 48368

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.557 -0.148  0.405  8.002 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.313    0.559   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        1.81491    0.05602    32.4
menstruationpre                                                                   -0.08993    0.01737    -5.2
menstruationyes                                                                   -0.07106    0.01635    -4.3
fertile_mean                                                                      -0.00918    0.21882     0.0
cycle_regularityslightly irregular,\nup to 5 days off                              0.03709    0.06573     0.6
cycle_regularityirregular,\nmore than 5 days off                                   0.02631    0.07843     0.3
includedhorm_contra                                                               -0.10979    0.05127    -2.1
fertile                                                                            0.22043    0.04856     4.5
menstruationpre:includedhorm_contra                                                0.06836    0.02228     3.1
menstruationyes:includedhorm_contra                                                0.08541    0.02142     4.0
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra         -0.01973    0.09948    -0.2
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.00549    0.11836     0.0
cycle_regularityslightly irregular,\nup to 5 days off:fertile                     -0.07056    0.06686    -1.1
cycle_regularityirregular,\nmore than 5 days off:fertile                          -0.11230    0.08348    -1.3
includedhorm_contra:fertile                                                       -0.22146    0.05686    -3.9
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.05669    0.09917     0.6
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.12668    0.12350     1.0
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">48314</td>
<td align="center">48437</td>
<td align="center">-24142</td>
<td align="center">48284</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">48309</td>
<td align="center">48464</td>
<td align="center">-24135</td>
<td align="center">48271</td>
<td align="center">13.7</td>
<td align="center">4</td>
<td align="center">0.008316</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + cohabitation +  
    included + fertile + menstruation:included + cohabitation:included +  
    cohabitation:fertile + included:fertile + cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 48350

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.279 -0.559 -0.148  0.402  7.995 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.309    0.556   
 Residual             0.321    0.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 1.7683     0.0543    32.6
menstruationpre                                            -0.0912     0.0174    -5.3
menstruationyes                                            -0.0728     0.0163    -4.5
fertile_mean                                               -0.0183     0.2171    -0.1
cohabitationLive in same city                               0.1642     0.0742     2.2
cohabitationLong-distance                                   0.1288     0.0700     1.8
includedhorm_contra                                        -0.1244     0.0587    -2.1
fertile                                                     0.1813     0.0442     4.1
menstruationpre:includedhorm_contra                         0.0694     0.0223     3.1
menstruationyes:includedhorm_contra                         0.0869     0.0214     4.1
cohabitationLive in same city:includedhorm_contra          -0.0658     0.0948    -0.7
cohabitationLong-distance:includedhorm_contra              -0.0342     0.0908    -0.4
cohabitationLive in same city:fertile                      -0.2074     0.0801    -2.6
cohabitationLong-distance:fertile                           0.1198     0.0721     1.7
includedhorm_contra:fertile                                -0.1997     0.0642    -3.1
cohabitationLive in same city:includedhorm_contra:fertile   0.2533     0.1000     2.5
cohabitationLong-distance:includedhorm_contra:fertile      -0.1177     0.0928    -1.3
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">48321</td>
<td align="center">48444</td>
<td align="center">-24146</td>
<td align="center">48291</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">48327</td>
<td align="center">48483</td>
<td align="center">-24145</td>
<td align="center">48289</td>
<td align="center">2.155</td>
<td align="center">4</td>
<td align="center">0.7072</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + relationship_status_clean +  
    included + fertile + menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 48359

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.557 -0.148  0.405  7.999 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       1.85318    0.05061    36.6
menstruationpre                                                  -0.09062    0.01736    -5.2
menstruationyes                                                  -0.07155    0.01634    -4.4
fertile_mean                                                     -0.02090    0.21747    -0.1
relationship_status_cleanVerheiratet                             -0.05182    0.06898    -0.8
relationship_status_cleanVerlobt                                 -0.11746    0.13146    -0.9
includedhorm_contra                                              -0.13497    0.04349    -3.1
fertile                                                           0.18506    0.04015     4.6
menstruationpre:includedhorm_contra                               0.06920    0.02227     3.1
menstruationyes:includedhorm_contra                               0.08616    0.02141     4.0
relationship_status_cleanVerheiratet:includedhorm_contra          0.00547    0.13305     0.0
relationship_status_cleanVerlobt:includedhorm_contra             -0.07171    0.19338    -0.4
relationship_status_cleanVerheiratet:fertile                     -0.04726    0.07136    -0.7
relationship_status_cleanVerlobt:fertile                         -0.00212    0.13217     0.0
includedhorm_contra:fertile                                      -0.18381    0.04891    -3.8
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.07139    0.13320    -0.5
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.11774    0.20520     0.6
</code></pre>
<pre class="r"><code>do_moderators(models$extra_pair, diary)</code></pre>
</div>
</div>
<div id="moderators" class="section level3 tab-content">
<h3>Moderators</h3>
<div id="partners-physical-attractiveness" class="section level4">
<h4>Partner’s physical attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s physical attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_physical&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48284</td>
<td align="center">48390</td>
<td align="center">-24129</td>
<td align="center">48258</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48283</td>
<td align="center">48406</td>
<td align="center">-24127</td>
<td align="center">48253</td>
<td align="center">4.419</td>
<td align="center">2</td>
<td align="center">0.1098</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/phys_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_physical +  
    included + fertile + menstruation:included + partner_attractiveness_physical:included +  
    partner_attractiveness_physical:fertile + included:fertile +  
    partner_attractiveness_physical:included:fertile
   Data: diary

REML criterion at convergence: 48328

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.279 -0.556 -0.149  0.406  7.995 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.301    0.549   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                   2.5476     0.1476   17.26
menstruationpre                                              -0.0905     0.0174   -5.21
menstruationyes                                              -0.0718     0.0163   -4.39
fertile_mean                                                  0.0131     0.2144    0.06
partner_attractiveness_physical                              -0.0904     0.0177   -5.11
includedhorm_contra                                          -0.5611     0.1919   -2.92
fertile                                                       0.4498     0.1554    2.89
menstruationpre:includedhorm_contra                           0.0692     0.0223    3.11
menstruationyes:includedhorm_contra                           0.0864     0.0214    4.03
partner_attractiveness_physical:includedhorm_contra           0.0559     0.0234    2.39
partner_attractiveness_physical:fertile                      -0.0346     0.0190   -1.82
includedhorm_contra:fertile                                  -0.3156     0.2040   -1.55
partner_attractiveness_physical:includedhorm_contra:fertile   0.0181     0.0246    0.74
</code></pre>
</div>
<div id="partners-short-term-attractiveness" class="section level4">
<h4>Partner’s short-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s short-term attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48291</td>
<td align="center">48397</td>
<td align="center">-24132</td>
<td align="center">48265</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48290</td>
<td align="center">48413</td>
<td align="center">-24130</td>
<td align="center">48260</td>
<td align="center">4.444</td>
<td align="center">2</td>
<td align="center">0.1084</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_shortterm +  
    included + fertile + menstruation:included + partner_attractiveness_shortterm:included +  
    partner_attractiveness_shortterm:fertile + included:fertile +  
    partner_attractiveness_shortterm:included:fertile
   Data: diary

REML criterion at convergence: 48331

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.556 -0.148  0.405  7.998 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.304    0.551   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                             Estimate Std. Error t value
(Intercept)                                                   1.81826    0.04697    38.7
menstruationpre                                              -0.09064    0.01736    -5.2
menstruationyes                                              -0.07183    0.01634    -4.4
fertile_mean                                                  0.00332    0.21504     0.0
partner_attractiveness_shortterm                             -0.12555    0.02785    -4.5
includedhorm_contra                                          -0.10592    0.03859    -2.7
fertile                                                       0.16872    0.03528     4.8
menstruationpre:includedhorm_contra                           0.06930    0.02226     3.1
menstruationyes:includedhorm_contra                           0.08644    0.02141     4.0
partner_attractiveness_shortterm:includedhorm_contra          0.07047    0.03728     1.9
partner_attractiveness_shortterm:fertile                     -0.05970    0.02983    -2.0
includedhorm_contra:fertile                                  -0.16776    0.04470    -3.8
partner_attractiveness_shortterm:includedhorm_contra:fertile  0.04326    0.03882     1.1
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) top-right (high LT, low ST), then top-left (low LT, low ST), then bottom-left (low LT, high ST), then bottom-right (high LT/ST).</p>
<pre class="r"><code>add_main = update.formula(formula(model), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * included + partner_attractiveness_shortterm * included + partner_attractiveness_longterm * partner_attractiveness_shortterm&quot;))) # reorder so that the triptych looks nice
add_mod_formula = update.formula(update.formula(formula(model), new = . ~ . - included * fertile), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * fertile * partner_attractiveness_shortterm * included&quot;))) # reorder so that the triptych looks nice

update(model, formula = add_main) -&gt; with_main
update(model, formula = add_mod_formula) -&gt; with_mod
cat(pander(anova(with_main, with_mod)))</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">48240</td>
<td align="center">48371</td>
<td align="center">-24104</td>
<td align="center">48208</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">48237</td>
<td align="center">48426</td>
<td align="center">-24096</td>
<td align="center">48191</td>
<td align="center">16.73</td>
<td align="center">7</td>
<td align="center">0.01921</td>
</tr>
</tbody>
</table>
<pre class="r"><code>effs = allEffects(with_mod)
effs = data.frame(effs$`partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included`) %&gt;% 
  filter(partner_attractiveness_longterm %in% c(-2,0),partner_attractiveness_shortterm %in% c(-2,0))
ggplot(effs, aes(fertile, fit, ymin = lower, ymax = upper, color = included)) + 
  facet_grid(partner_attractiveness_shortterm ~ partner_attractiveness_longterm) +
  geom_smooth(stat=&#39;identity&#39;) +
  scale_color_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  scale_fill_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  ggtitle(&quot;Moderation&quot;, &quot;top-to-bottom: short-term,\nleft-to-right: long-term attractiveness of the partner&quot;)+
  ylab(names(model@frame)[1])</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/st_vs_lt-1.png" width="768" /></p>
<pre class="r"><code>print_summary(with_mod)</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_longterm +  
    fertile + partner_attractiveness_shortterm + included + menstruation:included +  
    partner_attractiveness_longterm:fertile + partner_attractiveness_longterm:partner_attractiveness_shortterm +  
    fertile:partner_attractiveness_shortterm + partner_attractiveness_longterm:included +  
    fertile:included + partner_attractiveness_shortterm:included +  
    partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm +  
    partner_attractiveness_longterm:fertile:included + partner_attractiveness_longterm:partner_attractiveness_shortterm:included +  
    fertile:partner_attractiveness_shortterm:included + partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included
   Data: diary

REML criterion at convergence: 48305

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.557 -0.148  0.404  7.979 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.288    0.537   
 Residual             0.321    0.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                             Estimate
(Intercept)                                                                                   1.81842
menstruationpre                                                                              -0.08951
menstruationyes                                                                              -0.06970
fertile_mean                                                                                 -0.02856
partner_attractiveness_longterm                                                              -0.13592
fertile                                                                                       0.17260
partner_attractiveness_shortterm                                                             -0.05735
includedhorm_contra                                                                          -0.10616
menstruationpre:includedhorm_contra                                                           0.06855
menstruationyes:includedhorm_contra                                                           0.08489
partner_attractiveness_longterm:fertile                                                       0.06863
partner_attractiveness_longterm:partner_attractiveness_shortterm                              0.02761
fertile:partner_attractiveness_shortterm                                                     -0.09355
partner_attractiveness_longterm:includedhorm_contra                                          -0.02074
fertile:includedhorm_contra                                                                  -0.17603
partner_attractiveness_shortterm:includedhorm_contra                                          0.03824
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                     -0.02371
partner_attractiveness_longterm:fertile:includedhorm_contra                                  -0.00256
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra          0.01451
fertile:partner_attractiveness_shortterm:includedhorm_contra                                  0.06205
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra  0.03130
                                                                                             Std. Error
(Intercept)                                                                                     0.04718
menstruationpre                                                                                 0.01736
menstruationyes                                                                                 0.01635
fertile_mean                                                                                    0.21090
partner_attractiveness_longterm                                                                 0.03258
fertile                                                                                         0.03686
partner_attractiveness_shortterm                                                                0.03058
includedhorm_contra                                                                             0.03962
menstruationpre:includedhorm_contra                                                             0.02226
menstruationyes:includedhorm_contra                                                             0.02142
partner_attractiveness_longterm:fertile                                                         0.03548
partner_attractiveness_longterm:partner_attractiveness_shortterm                                0.02405
fertile:partner_attractiveness_shortterm                                                        0.03279
partner_attractiveness_longterm:includedhorm_contra                                             0.04142
fertile:includedhorm_contra                                                                     0.04635
partner_attractiveness_shortterm:includedhorm_contra                                            0.03947
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        0.02643
partner_attractiveness_longterm:fertile:includedhorm_contra                                     0.04494
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            0.03733
fertile:partner_attractiveness_shortterm:includedhorm_contra                                    0.04167
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra    0.04070
                                                                                             t value
(Intercept)                                                                                     38.5
menstruationpre                                                                                 -5.2
menstruationyes                                                                                 -4.3
fertile_mean                                                                                    -0.1
partner_attractiveness_longterm                                                                 -4.2
fertile                                                                                          4.7
partner_attractiveness_shortterm                                                                -1.9
includedhorm_contra                                                                             -2.7
menstruationpre:includedhorm_contra                                                              3.1
menstruationyes:includedhorm_contra                                                              4.0
partner_attractiveness_longterm:fertile                                                          1.9
partner_attractiveness_longterm:partner_attractiveness_shortterm                                 1.1
fertile:partner_attractiveness_shortterm                                                        -2.9
partner_attractiveness_longterm:includedhorm_contra                                             -0.5
fertile:includedhorm_contra                                                                     -3.8
partner_attractiveness_shortterm:includedhorm_contra                                             1.0
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        -0.9
partner_attractiveness_longterm:fertile:includedhorm_contra                                     -0.1
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra             0.4
fertile:partner_attractiveness_shortterm:includedhorm_contra                                     1.5
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra     0.8
</code></pre>
</div>
<div id="relative-attractiveness-to-self" class="section level4">
<h4>Relative attractiveness to self</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s relative attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_rel_to_self&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48320</td>
<td align="center">48426</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48322</td>
<td align="center">48445</td>
<td align="center">-24146</td>
<td align="center">48292</td>
<td align="center">1.46</td>
<td align="center">2</td>
<td align="center">0.482</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/rel_self-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_rel_to_self +  
    included + fertile + menstruation:included + partner_attractiveness_rel_to_self:included +  
    partner_attractiveness_rel_to_self:fertile + included:fertile +  
    partner_attractiveness_rel_to_self:included:fertile
   Data: diary

REML criterion at convergence: 48361

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.287 -0.556 -0.150  0.405  8.006 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                               Estimate Std. Error t value
(Intercept)                                                      1.8456     0.0534    34.6
menstruationpre                                                 -0.0906     0.0174    -5.2
menstruationyes                                                 -0.0711     0.0163    -4.4
fertile_mean                                                    -0.0133     0.2173    -0.1
partner_attractiveness_rel_to_self                               0.0346     0.0685     0.5
includedhorm_contra                                             -0.1324     0.0458    -2.9
fertile                                                          0.1975     0.0419     4.7
menstruationpre:includedhorm_contra                              0.0690     0.0223     3.1
menstruationyes:includedhorm_contra                              0.0854     0.0214     4.0
partner_attractiveness_rel_to_self:includedhorm_contra          -0.0475     0.0712    -0.7
partner_attractiveness_rel_to_self:fertile                       0.0717     0.0681     1.1
includedhorm_contra:fertile                                     -0.2025     0.0503    -4.0
partner_attractiveness_rel_to_self:includedhorm_contra:fertile  -0.0605     0.0707    -0.9
</code></pre>
</div>
<div id="partners-shortterm-attractiveness-alternative-specification" class="section level4">
<h4>Partner’s shortterm attractiveness, alternative specification</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm_v2&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48293</td>
<td align="center">48399</td>
<td align="center">-24133</td>
<td align="center">48267</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48294</td>
<td align="center">48417</td>
<td align="center">-24132</td>
<td align="center">48264</td>
<td align="center">2.879</td>
<td align="center">2</td>
<td align="center">0.237</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr2-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_shortterm_v2 +  
    included + fertile + menstruation:included + partner_attractiveness_shortterm_v2:included +  
    partner_attractiveness_shortterm_v2:fertile + included:fertile +  
    partner_attractiveness_shortterm_v2:included:fertile
   Data: diary

REML criterion at convergence: 48335

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.279 -0.556 -0.149  0.405  7.996 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.304    0.551   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                Estimate Std. Error t value
(Intercept)                                                       1.8225     0.0469    38.8
menstruationpre                                                  -0.0903     0.0174    -5.2
menstruationyes                                                  -0.0714     0.0163    -4.4
fertile_mean                                                      0.0187     0.2152     0.1
partner_attractiveness_shortterm_v2                              -0.1312     0.0280    -4.7
includedhorm_contra                                              -0.1173     0.0384    -3.1
fertile                                                           0.1731     0.0352     4.9
menstruationpre:includedhorm_contra                               0.0689     0.0223     3.1
menstruationyes:includedhorm_contra                               0.0860     0.0214     4.0
partner_attractiveness_shortterm_v2:includedhorm_contra           0.0977     0.0369     2.6
partner_attractiveness_shortterm_v2:fertile                      -0.0457     0.0297    -1.5
includedhorm_contra:fertile                                      -0.1733     0.0445    -3.9
partner_attractiveness_shortterm_v2:includedhorm_contra:fertile   0.0285     0.0384     0.7
</code></pre>
</div>
<div id="partners-global-attractiveness" class="section level4">
<h4>Partner’s global attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_global&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48315</td>
<td align="center">48421</td>
<td align="center">-24144</td>
<td align="center">48289</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48317</td>
<td align="center">48440</td>
<td align="center">-24144</td>
<td align="center">48287</td>
<td align="center">1.366</td>
<td align="center">2</td>
<td align="center">0.5052</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/global_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_global +  
    included + fertile + menstruation:included + partner_attractiveness_global:included +  
    partner_attractiveness_global:fertile + included:fertile +  
    partner_attractiveness_global:included:fertile
   Data: diary

REML criterion at convergence: 48359

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.280 -0.555 -0.150  0.406  7.998 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.310    0.557   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                           Estimate Std. Error t value
(Intercept)                                                1.832394   0.047264    38.8
menstruationpre                                           -0.090602   0.017363    -5.2
menstruationyes                                           -0.071485   0.016344    -4.4
fertile_mean                                               0.000873   0.216917     0.0
partner_attractiveness_global                             -0.061919   0.027930    -2.2
includedhorm_contra                                       -0.125206   0.038735    -3.2
fertile                                                    0.174011   0.035195     4.9
menstruationpre:includedhorm_contra                        0.069191   0.022267     3.1
menstruationyes:includedhorm_contra                        0.085968   0.021413     4.0
partner_attractiveness_global:includedhorm_contra          0.076352   0.036877     2.1
partner_attractiveness_global:fertile                     -0.020697   0.028995    -0.7
includedhorm_contra:fertile                               -0.175861   0.044491    -4.0
partner_attractiveness_global:includedhorm_contra:fertile -0.001229   0.037453     0.0
</code></pre>
</div>
<div id="partners-longterm-attractiveness" class="section level4">
<h4>Partner’s longterm attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_longterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48245</td>
<td align="center">48352</td>
<td align="center">-24110</td>
<td align="center">48219</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48243</td>
<td align="center">48365</td>
<td align="center">-24106</td>
<td align="center">48213</td>
<td align="center">6.656</td>
<td align="center">2</td>
<td align="center">0.03586</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_longterm +  
    included + fertile + menstruation:included + partner_attractiveness_longterm:included +  
    partner_attractiveness_longterm:fertile + included:fertile +  
    partner_attractiveness_longterm:included:fertile
   Data: diary

REML criterion at convergence: 48284

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.295 -0.557 -0.148  0.403  7.990 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.290    0.538   
 Residual             0.321    0.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                   1.8409     0.0460    40.0
menstruationpre                                              -0.0900     0.0174    -5.2
menstruationyes                                              -0.0702     0.0164    -4.3
fertile_mean                                                 -0.0557     0.2112    -0.3
partner_attractiveness_longterm                              -0.1765     0.0279    -6.3
includedhorm_contra                                          -0.1165     0.0377    -3.1
fertile                                                       0.1719     0.0352     4.9
menstruationpre:includedhorm_contra                           0.0689     0.0223     3.1
menstruationyes:includedhorm_contra                           0.0854     0.0214     4.0
partner_attractiveness_longterm:includedhorm_contra           0.0136     0.0373     0.4
partner_attractiveness_longterm:fertile                       0.0429     0.0311     1.4
includedhorm_contra:fertile                                  -0.1777     0.0445    -4.0
partner_attractiveness_longterm:includedhorm_contra:fertile   0.0155     0.0410     0.4
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-1" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>We also test this specification of the short-term vs. long-term moderator prediction, but we think this is a suboptimal way to test it.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_st_vs_lt&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48311</td>
<td align="center">48417</td>
<td align="center">-24142</td>
<td align="center">48285</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48301</td>
<td align="center">48424</td>
<td align="center">-24135</td>
<td align="center">48271</td>
<td align="center">14.22</td>
<td align="center">2</td>
<td align="center">0.0008158</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-7-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_st_vs_lt +  
    included + fertile + menstruation:included + partner_st_vs_lt:included +  
    partner_st_vs_lt:fertile + included:fertile + partner_st_vs_lt:included:fertile
   Data: diary

REML criterion at convergence: 48343

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.264 -0.557 -0.149  0.405  7.971 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.309    0.556   
 Residual             0.321    0.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    1.8390     0.0474    38.8
menstruationpre                               -0.0901     0.0174    -5.2
menstruationyes                               -0.0704     0.0163    -4.3
fertile_mean                                  -0.0199     0.2167    -0.1
partner_st_vs_lt                               0.0388     0.0265     1.5
includedhorm_contra                           -0.1328     0.0388    -3.4
fertile                                        0.1634     0.0353     4.6
menstruationpre:includedhorm_contra            0.0688     0.0223     3.1
menstruationyes:includedhorm_contra            0.0851     0.0214     4.0
partner_st_vs_lt:includedhorm_contra           0.0288     0.0335     0.9
partner_st_vs_lt:fertile                      -0.0831     0.0275    -3.0
includedhorm_contra:fertile                   -0.1620     0.0446    -3.6
partner_st_vs_lt:includedhorm_contra:fertile   0.0362     0.0345     1.0
</code></pre>
</div>
<div id="partners-mate-value" class="section level4">
<h4>Partner’s mate value</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;MV_P_short&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48319</td>
<td align="center">48425</td>
<td align="center">-24146</td>
<td align="center">48293</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48321</td>
<td align="center">48444</td>
<td align="center">-24145</td>
<td align="center">48291</td>
<td align="center">2.008</td>
<td align="center">2</td>
<td align="center">0.3664</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/mvp_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + MV_P_short +  
    included + fertile + menstruation:included + MV_P_short:included +  
    MV_P_short:fertile + included:fertile + MV_P_short:included:fertile
   Data: diary

REML criterion at convergence: 48360

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.279 -0.556 -0.149  0.405  7.999 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.311    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                              1.9064     0.1260   15.13
menstruationpre                         -0.0909     0.0174   -5.23
menstruationyes                         -0.0718     0.0163   -4.39
fertile_mean                            -0.0113     0.2171   -0.05
MV_P_short                              -0.0216     0.0347   -0.62
includedhorm_contra                     -0.2987     0.1594   -1.87
fertile                                  0.3430     0.1279    2.68
menstruationpre:includedhorm_contra      0.0694     0.0223    3.12
menstruationyes:includedhorm_contra      0.0862     0.0214    4.02
MV_P_short:includedhorm_contra           0.0520     0.0460    1.13
MV_P_short:fertile                      -0.0503     0.0366   -1.38
includedhorm_contra:fertile             -0.3116     0.1645   -1.89
MV_P_short:includedhorm_contra:fertile   0.0405     0.0472    0.86
</code></pre>
</div>
<div id="partners-job-and-income" class="section level4">
<h4>Partner’s job and income</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_money&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">48320</td>
<td align="center">48426</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">48324</td>
<td align="center">48446</td>
<td align="center">-24147</td>
<td align="center">48294</td>
<td align="center">0.2692</td>
<td align="center">2</td>
<td align="center">0.8741</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/income_attr-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: extra_pair ~ menstruation + fertile_mean + (1 | person) + partner_attractiveness_money +  
    included + fertile + menstruation:included + partner_attractiveness_money:included +  
    partner_attractiveness_money:fertile + included:fertile +  
    partner_attractiveness_money:included:fertile
   Data: diary

REML criterion at convergence: 48363

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.282 -0.557 -0.150  0.405  7.997 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.312    0.558   
 Residual             0.321    0.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               1.76604    0.11306   15.62
menstruationpre                                          -0.09065    0.01736   -5.22
menstruationyes                                          -0.07157    0.01634   -4.38
fertile_mean                                             -0.00274    0.21755   -0.01
partner_attractiveness_money                              0.02092    0.03227    0.65
includedhorm_contra                                      -0.03498    0.14141   -0.25
fertile                                                   0.15212    0.11143    1.37
menstruationpre:includedhorm_contra                       0.06911    0.02227    3.10
menstruationyes:includedhorm_contra                       0.08597    0.02141    4.01
partner_attractiveness_money:includedhorm_contra         -0.02873    0.04424   -0.65
partner_attractiveness_money:fertile                      0.00678    0.03339    0.20
includedhorm_contra:fertile                              -0.11051    0.14611   -0.76
partner_attractiveness_money:includedhorm_contra:fertile -0.02130    0.04517   -0.47
</code></pre>
</div>
</div>
<div id="specific-robustness-analyses-for-extra-pair-effects" class="section level3 tab-content">
<h3>Specific robustness analyses for extra-pair effects</h3>
<div id="just-libido" class="section level4 tab-content">
<h4>Just libido?</h4>
<p>Does the effect on extra-pair desire remain after adjusting for the effect on in-pair desire and vice versa?</p>
<p>Yes, it remains, they appear to be more or less independent effects, if anything they suppress one another’s effects, because they are negatively associated, but both positively associated with fertility. Even though we unfortunately did not measure non-directed “libido” (e.g. irrespective of potential partner/solo), the independence of these effects makes it seem unlikely that this is the common core of both of these effects.</p>
<div id="models" class="section level5">
<h5>Models</h5>
<pre class="r"><code>lmer(extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean + menstruation + (1 | person), data = diary) %-&gt;%
  m_extra_not_adjusted_for_in  %&gt;% 
  print_summary()  %&gt;% 
  plot_all_effects()</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     menstruation + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 52215
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.857 -0.495 -0.129  0.334  7.395 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.422    0.649   
##  Residual             0.369    0.608   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                       Estimate Std. Error         df t value       Pr(&gt;|t|)    
## (Intercept)                             1.8244     0.0543  1250.0000   33.59        &lt; 2e-16 ***
## includedhorm_contra                    -0.2279     0.0446  1198.0000   -5.11 0.000000373260 ***
## fertile                                 0.2493     0.0378 25721.0000    6.60 0.000000000041 ***
## menstruationpre                        -0.1132     0.0186 25719.0000   -6.07 0.000000001264 ***
## menstruationyes                        -0.0784     0.0175 25806.0000   -4.47 0.000007811568 ***
## fertile_mean                           -0.2105     0.2485  1351.0000   -0.85         0.3971    
## includedhorm_contra:fertile            -0.2386     0.0477 25814.0000   -5.00 0.000000583638 ***
## includedhorm_contra:menstruationpre     0.0756     0.0239 25717.0000    3.17         0.0016 ** 
## includedhorm_contra:menstruationyes     0.0899     0.0230 25791.0000    3.91 0.000092273665 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ fertil mnstrtnp mnstrtny frtl_m inclddhrm_cntr:f
## inclddhrm_c             -0.471                                                        
## fertile                 -0.128  0.208                                                 
## menstrutnpr             -0.132  0.168  0.470                                          
## menstrutnys             -0.129  0.163  0.388  0.400                                   
## fertile_men             -0.771 -0.031 -0.054 -0.008   -0.006                          
## inclddhrm_cntr:f         0.128 -0.262 -0.789 -0.371   -0.306    0.008                 
## inclddhrm_cntr:mnstrtnp  0.109 -0.210 -0.366 -0.780   -0.312   -0.002  0.468          
## inclddhrm_cntr:mnstrtny  0.103 -0.199 -0.295 -0.305   -0.763   -0.002  0.383          
##                         inclddhrm_cntr:mnstrtnp
## inclddhrm_c                                    
## fertile                                        
## menstrutnpr                                    
## menstrutnys                                    
## fertile_men                                    
## inclddhrm_cntr:f                               
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny  0.385                 
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-1.png" width="768" /></p>
<pre class="r"><code>lmer(extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean + in_pair_desire + (1 | person), data = diary) %-&gt;%
  m_extra_adjusted_for_in %&gt;% 
  print_summary()  %&gt;% 
  plot_all_effects()</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     in_pair_desire + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 52116
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.805 -0.498 -0.133  0.340  7.377 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.412    0.642   
##  Residual             0.368    0.607   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                             1.94888     0.05508  1375.00000   35.38  &lt; 2e-16 ***
## includedhorm_contra                    -0.21745     0.04413  1201.00000   -4.93  9.5e-07 ***
## fertile                                 0.25899     0.03771 25722.00000    6.87  6.7e-12 ***
## menstruationpre                        -0.11561     0.01860 25721.00000   -6.22  5.2e-10 ***
## menstruationyes                        -0.08515     0.01752 25810.00000   -4.86  1.2e-06 ***
## fertile_mean                           -0.20869     0.24605  1354.00000   -0.85   0.3965    
## in_pair_desire                         -0.03590     0.00344 26353.00000  -10.43  &lt; 2e-16 ***
## includedhorm_contra:fertile            -0.25595     0.04769 25818.00000   -5.37  8.1e-08 ***
## includedhorm_contra:menstruationpre     0.07553     0.02385 25719.00000    3.17   0.0015 ** 
## includedhorm_contra:menstruationyes     0.09120     0.02294 25794.00000    3.98  7.0e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ fertil mnstrtnp mnstrtny frtl_m in_pr_ inclddhrm_cntr:f
## inclddhrm_c             -0.454                                                               
## fertile                 -0.120  0.210                                                        
## menstrutnpr             -0.132  0.169  0.469                                                 
## menstrutnys             -0.135  0.163  0.386  0.400                                          
## fertile_men             -0.752 -0.031 -0.054 -0.008   -0.006                                 
## in_pair_dsr             -0.217 -0.022 -0.025  0.012    0.037   -0.001                        
## inclddhrm_cntr:f         0.118 -0.265 -0.789 -0.371   -0.305    0.008  0.035                 
## inclddhrm_cntr:mnstrtnp  0.107 -0.211 -0.366 -0.780   -0.312   -0.002  0.001  0.468          
## inclddhrm_cntr:mnstrtny  0.103 -0.201 -0.295 -0.305   -0.763   -0.002 -0.006  0.383          
##                         inclddhrm_cntr:mnstrtnp
## inclddhrm_c                                    
## fertile                                        
## menstrutnpr                                    
## menstrutnys                                    
## fertile_men                                    
## in_pair_dsr                                    
## inclddhrm_cntr:f                               
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny  0.385                 
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-2.png" width="768" /></p>
<pre class="r"><code>lmer(extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean + scale(in_pair_desire) * included * fertile + fertile_mean + menstruation + (1 | person), data = diary) %-&gt;%
  m_extra_mod_by_in %&gt;% 
  print_summary()  %&gt;% 
  plot_triptych(x.var = &quot;fertile&quot;, xlevels = 2)</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     scale(in_pair_desire) * included * fertile + fertile_mean +      menstruation + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 52134
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.804 -0.498 -0.133  0.340  7.379 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.412    0.642   
##  Residual             0.368    0.607   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                                      Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                           1.81934     0.05376  1252.00000   33.84  &lt; 2e-16 ***
## includedhorm_contra                                  -0.21742     0.04413  1201.00000   -4.93  9.5e-07 ***
## fertile                                               0.25928     0.03773 25720.00000    6.87  6.5e-12 ***
## menstruationpre                                      -0.11572     0.01860 25719.00000   -6.22  5.0e-10 ***
## menstruationyes                                      -0.08536     0.01754 25810.00000   -4.87  1.1e-06 ***
## fertile_mean                                         -0.20845     0.24605  1353.00000   -0.85   0.3970    
## scale(in_pair_desire)                                -0.05248     0.00937 26295.00000   -5.60  2.1e-08 ***
## includedhorm_contra:fertile                          -0.25583     0.04772 25815.00000   -5.36  8.3e-08 ***
## includedhorm_contra:menstruationpre                   0.07564     0.02386 25717.00000    3.17   0.0015 ** 
## includedhorm_contra:menstruationyes                   0.09147     0.02297 25794.00000    3.98  6.9e-05 ***
## includedhorm_contra:scale(in_pair_desire)             0.00413     0.01205 26229.00000    0.34   0.7315    
## fertile:scale(in_pair_desire)                         0.01353     0.03158 25769.00000    0.43   0.6683    
## includedhorm_contra:fertile:scale(in_pair_desire)    -0.02017     0.04061 25726.00000   -0.50   0.6194    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-3.png" width="768" /></p>
<pre class="r"><code>anova(m_extra_adjusted_for_in, m_extra_mod_by_in)</code></pre>
<pre><code>## Data: diary
## Models:
## object: extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean + 
## object:     in_pair_desire + (1 | person)
## ..1: extra_pair_desire ~ included * (fertile + menstruation) + fertile_mean + 
## ..1:     scale(in_pair_desire) * included * fertile + fertile_mean + 
## ..1:     menstruation + (1 | person)
##        Df   AIC   BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)
## object 12 52083 52181 -26030    52059                        
## ..1    15 52089 52212 -26029    52059  0.26      3       0.97</code></pre>
<pre class="r"><code>lmer(in_pair_desire ~ included * (fertile + menstruation) + fertile_mean + scale(extra_pair_desire) * included * fertile + fertile_mean + menstruation + (1 | person), data = diary) %-&gt;%
  m_in_mod_by_extra %&gt;% 
  print_summary()  %&gt;% 
  plot_triptych(x.var = &quot;fertile&quot;, xlevels = 2)</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: in_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     scale(extra_pair_desire) * included * fertile + fertile_mean +      menstruation + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 82592
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.525 -0.679 -0.028  0.667  3.740 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.704    0.839   
##  Residual             1.187    1.089   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                                         Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                              3.50526     0.07498  1401.00000   46.75  &lt; 2e-16 ***
## includedhorm_contra                                      0.25514     0.06126  1369.00000    4.16  3.3e-05 ***
## fertile                                                  0.26169     0.06853 25846.00000    3.82  0.00013 ***
## menstruationpre                                         -0.08183     0.03341 25864.00000   -2.45  0.01434 *  
## menstruationyes                                         -0.19833     0.03140 25974.00000   -6.32  2.7e-10 ***
## fertile_mean                                             0.00491     0.34625  1512.00000    0.01  0.98868    
## scale(extra_pair_desire)                                -0.11940     0.01670 26177.00000   -7.15  8.9e-13 ***
## includedhorm_contra:fertile                             -0.46913     0.08622 25976.00000   -5.44  5.3e-08 ***
## includedhorm_contra:menstruationpre                      0.00623     0.04281 25866.00000    0.15  0.88427    
## includedhorm_contra:menstruationyes                      0.05018     0.04112 25956.00000    1.22  0.22233    
## includedhorm_contra:scale(extra_pair_desire)            -0.00643     0.02293 26368.00000   -0.28  0.77913    
## fertile:scale(extra_pair_desire)                         0.16224     0.05076 26008.00000    3.20  0.00139 ** 
## includedhorm_contra:fertile:scale(extra_pair_desire)    -0.12564     0.07116 25927.00000   -1.77  0.07745 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-4.png" width="768" /></p>
<pre class="r"><code>lmer(in_pair_desire ~ included * (fertile + menstruation) + fertile_mean + menstruation + (1 | person), data = diary) %-&gt;%
  m_in_not_adjusted_for_extra  %&gt;% 
  print_summary()  %&gt;% 
  plot_all_effects()</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: in_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     menstruation + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 82706
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.477 -0.680 -0.031  0.669  3.795 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.733    0.856   
##  Residual             1.191    1.091   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value     Pr(&gt;|t|)    
## (Intercept)                             3.47716     0.07609  1389.00000   45.70      &lt; 2e-16 ***
## includedhorm_contra                     0.28629     0.06217  1354.00000    4.61 0.0000045076 ***
## fertile                                 0.27106     0.06770 25847.00000    4.00 0.0000624942 ***
## menstruationpre                        -0.06548     0.03340 25860.00000   -1.96         0.05 *  
## menstruationyes                        -0.18657     0.03142 25969.00000   -5.94 0.0000000029 ***
## fertile_mean                            0.03688     0.35160  1506.00000    0.10         0.92    
## includedhorm_contra:fertile            -0.48328     0.08553 25975.00000   -5.65 0.0000000162 ***
## includedhorm_contra:menstruationpre    -0.00498     0.04283 25861.00000   -0.12         0.91    
## includedhorm_contra:menstruationyes     0.03667     0.04117 25952.00000    0.89         0.37    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ fertil mnstrtnp mnstrtny frtl_m inclddhrm_cntr:f
## inclddhrm_c             -0.469                                                        
## fertile                 -0.165  0.267                                                 
## menstrutnpr             -0.171  0.217  0.469                                          
## menstrutnys             -0.167  0.209  0.387  0.399                                   
## fertile_men             -0.772 -0.034 -0.067 -0.008   -0.006                          
## inclddhrm_cntr:f         0.165 -0.336 -0.789 -0.371   -0.306    0.009                 
## inclddhrm_cntr:mnstrtnp  0.141 -0.271 -0.365 -0.780   -0.311   -0.004  0.468          
## inclddhrm_cntr:mnstrtny  0.133 -0.256 -0.295 -0.304   -0.763   -0.004  0.383          
##                         inclddhrm_cntr:mnstrtnp
## inclddhrm_c                                    
## fertile                                        
## menstrutnpr                                    
## menstrutnys                                    
## fertile_men                                    
## inclddhrm_cntr:f                               
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny  0.384                 
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-5.png" width="768" /></p>
<pre class="r"><code>lmer(in_pair_desire ~ included * (fertile + menstruation) + fertile_mean + extra_pair_desire + (1 | person), data = diary) %-&gt;%
  m_in_adjusted_for_extra  %&gt;% 
  print_summary()  %&gt;% 
  plot_all_effects()</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: in_pair_desire ~ included * (fertile + menstruation) + fertile_mean +  
##     extra_pair_desire + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 82590
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.516 -0.679 -0.029  0.667  3.736 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.704    0.839   
##  Residual             1.187    1.090   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value      Pr(&gt;|t|)    
## (Intercept)                             3.69591     0.07743  1571.00000   47.73       &lt; 2e-16 ***
## includedhorm_contra                     0.25926     0.06122  1366.00000    4.23 0.00002441874 ***
## fertile                                 0.30072     0.06763 25860.00000    4.45 0.00000877060 ***
## menstruationpre                        -0.07916     0.03336 25867.00000   -2.37         0.018 *  
## menstruationyes                        -0.19600     0.03137 25979.00000   -6.25 0.00000000042 ***
## fertile_mean                            0.01344     0.34626  1512.00000    0.04         0.969    
## extra_pair_desire                      -0.12046     0.01084 25948.00000  -11.12       &lt; 2e-16 ***
## includedhorm_contra:fertile            -0.51133     0.08541 25988.00000   -5.99 0.00000000217 ***
## includedhorm_contra:menstruationpre     0.00434     0.04276 25867.00000    0.10         0.919    
## includedhorm_contra:menstruationyes     0.04762     0.04111 25960.00000    1.16         0.247    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ fertil mnstrtnp mnstrtny frtl_m extr__ inclddhrm_cntr:f
## inclddhrm_c             -0.463                                                               
## fertile                 -0.152  0.269                                                        
## menstrutnpr             -0.177  0.221  0.467                                                 
## menstrutnys             -0.170  0.213  0.385  0.399                                          
## fertile_men             -0.748 -0.034 -0.068 -0.008   -0.005                                 
## extr_pr_dsr             -0.254  0.040 -0.039  0.037    0.027    0.006                        
## inclddhrm_cntr:f         0.154 -0.340 -0.789 -0.369   -0.305    0.009  0.030                 
## inclddhrm_cntr:mnstrtnp  0.144 -0.275 -0.364 -0.780   -0.311   -0.004 -0.020  0.467          
## inclddhrm_cntr:mnstrtny  0.137 -0.260 -0.293 -0.305   -0.763   -0.004 -0.024  0.381          
##                         inclddhrm_cntr:mnstrtnp
## inclddhrm_c                                    
## fertile                                        
## menstrutnpr                                    
## menstrutnys                                    
## fertile_men                                    
## extr_pr_dsr                                    
## inclddhrm_cntr:f                               
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny  0.384                 
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_additional-6.png" width="768" /></p>
<pre class="r"><code>anova(m_in_adjusted_for_extra, m_in_mod_by_extra)</code></pre>
<pre><code>## Data: diary
## Models:
## object: in_pair_desire ~ included * (fertile + menstruation) + fertile_mean + 
## object:     extra_pair_desire + (1 | person)
## ..1: in_pair_desire ~ included * (fertile + menstruation) + fertile_mean + 
## ..1:     scale(extra_pair_desire) * included * fertile + fertile_mean + 
## ..1:     menstruation + (1 | person)
##        Df   AIC   BIC logLik deviance Chisq Chi Df Pr(&gt;Chisq)   
## object 12 82568 82666 -41272    82544                           
## ..1    15 82561 82684 -41265    82531  13.4      3     0.0038 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>coefficients = bind_cols(bind_rows(
  extra_not_adjusted_for_in = broom::tidy(m_extra_not_adjusted_for_in, conf.int = T),
  extra_adjusted_for_in = broom::tidy(m_extra_adjusted_for_in, conf.int = T),
  in_not_adjusted_for_extra = broom::tidy(m_in_not_adjusted_for_extra, conf.int = T),
  in_adjusted_for_extra = broom::tidy(m_in_adjusted_for_extra, conf.int = T),
  .id = c(&quot;model&quot;)
),  bind_rows( broom::tidy(m_extra_not_adjusted_for_in, conf.int = T, level = 0.8),
  broom::tidy(m_extra_adjusted_for_in, conf.int = T, level = 0.8),
  broom::tidy(m_in_not_adjusted_for_extra, conf.int = T, level = 0.8),
  broom::tidy(m_in_adjusted_for_extra, conf.int = T, level = 0.8)
)  %&gt;% select(conf.low, conf.high)  %&gt;% rename(conf.low80 = conf.low, conf.high80 = conf.high)
)</code></pre>
</div>
<div id="summary" class="section level5">
<h5>Summary</h5>
<pre class="r"><code>coefficients  %&gt;% 
  filter(term %ends_with% &quot;fertile&quot;) %&gt;% 
  ggplot(aes(x = model, y = estimate, ymin = conf.low, ymax = conf.high, color = term)) +
  geom_linerange(size = 0.5) +
  geom_pointrange(aes(ymin = conf.low80, ymax = conf.high80), size = 1) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;includedhorm_contra:fertile&quot;=&quot;black&quot;,&quot;fertile&quot; = &quot;red&quot;), labels = c(&quot;includedhorm_contra:fertile&quot;=&quot;hormonally\ncontracepting&quot;,&quot;fertile&quot; = &quot;fertile&quot;), guide = F) + 
  geom_hline(yintercept = 0, linetype = &quot;dashed&quot;) +
  coord_flip()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_add_summ-1.png" width="768" /></p>
</div>
</div>
<div id="awareness-vs.regularity" class="section level4 tab-content">
<h4>Awareness vs. regularity?</h4>
<p>Are there stronger effects on extra pair desire in women using fertility-awareness-based contraception only because they have more regular cycles and so our fertility predictor is more useful?</p>
<p>No, it actually seems to be the other way around, cycle length no longer moderates the fertility effect when awareness is also included as a moderator.</p>
<pre class="r"><code>lmer(extra_pair ~ contraceptive_methods * fertile + fertile_mean + menstruation + (1 | person), data = diary, subset = !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;) %-&gt;%
  m_extra_not_adjusted_for_length  %&gt;% 
  print_summary()  %&gt;% 
  plot_triptych(xlevels = 4, panel_rows = 1) </code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair ~ contraceptive_methods * fertile + fertile_mean +      menstruation + (1 | person)
##    Data: diary
##  Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;
## 
## REML criterion at convergence: 30402
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.333 -0.557 -0.147  0.406  8.083 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.320    0.566   
##  Residual             0.313    0.560   
## Number of obs: 17026, groups:  person, 513
## 
## Fixed effects:
##                                                     Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                          1.87936     0.10617   518.00000   17.70   &lt;2e-16 ***
## contraceptive_methodsfertility_awareness            -0.07506     0.13288   524.00000   -0.56    0.572    
## contraceptive_methodsnone                           -0.17512     0.14088   530.00000   -1.24    0.214    
## contraceptive_methodshormonal                       -0.13113     0.06727   525.00000   -1.95    0.052 .  
## fertile                                              0.11889     0.05531 16564.00000    2.15    0.032 *  
## fertile_mean                                        -0.11221     0.52225   519.00000   -0.21    0.830    
## menstruationpre                                     -0.03094     0.01323 16563.00000   -2.34    0.019 *  
## menstruationyes                                      0.00506     0.01325 16569.00000    0.38    0.702    
## contraceptive_methodsfertility_awareness:fertile     0.19271     0.11667 16569.00000    1.65    0.099 .  
## contraceptive_methodsnone:fertile                   -0.01023     0.12973 16551.00000   -0.08    0.937    
## contraceptive_methodshormonal:fertile               -0.14470     0.05944 16575.00000   -2.43    0.015 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                  (Intr) cntr__ cntrcptv_mthdsn cntrcptv_mthdsh fertil frtl_m mnstrtnp mnstrtny cnt__:
## cntrcptv_m_      -0.245                                                                              
## cntrcptv_mthdsn  -0.279  0.191                                                                       
## cntrcptv_mthdsh  -0.439  0.403  0.375                                                                
## fertile          -0.077  0.065  0.060           0.133                                                
## fertile_men      -0.823 -0.012  0.047          -0.078          -0.025                                
## menstrutnpr      -0.053 -0.001 -0.002           0.006           0.238 -0.002                         
## menstrutnys      -0.046  0.000  0.002           0.008           0.189 -0.005  0.386                  
## cntrcptv__:       0.036 -0.150 -0.029          -0.061          -0.438  0.002  0.009    0.018         
## cntrcptv_mthdsn:  0.030 -0.028 -0.143          -0.055          -0.395  0.005  0.007    0.007    0.188
## cntrcptv_mthdsh:  0.069 -0.061 -0.057          -0.151          -0.867  0.008 -0.006    0.007    0.411
##                  cntrcptv_mthdsn:
## cntrcptv_m_                      
## cntrcptv_mthdsn                  
## cntrcptv_mthdsh                  
## fertile                          
## fertile_men                      
## menstrutnpr                      
## menstrutnys                      
## cntrcptv__:                      
## cntrcptv_mthdsn:                 
## cntrcptv_mthdsh:  0.370          
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/awareness_vs_regularity-1.png" width="768" /></p>
<pre class="r"><code>lmer(extra_pair ~ contraceptive_methods * fertile + cycle_length_groups * fertile + fertile_mean + menstruation + (1 | person), data = diary, subset = !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;) %&gt;%
  calculate_effects() %-&gt;%
  m_extra_adjusted_for_length  %&gt;% 
  print_summary()  %&gt;% 
  plot_triptych(xlevels = 3, term = &quot;fertile:cycle_length_groups&quot;, panel_rows = 1) %&gt;% 
  plot_triptych(xlevels = 4, term = &quot;contraceptive_methods:fertile&quot;, panel_rows = 1)</code></pre>
<pre><code>## 
## 
## ```
## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: extra_pair ~ contraceptive_methods * fertile + cycle_length_groups *  
##     fertile + fertile_mean + menstruation + (1 | person)
##    Data: diary
##  Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;
## 
## REML criterion at convergence: 30409
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.355 -0.556 -0.147  0.406  8.088 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.321    0.566   
##  Residual             0.313    0.560   
## Number of obs: 17026, groups:  person, 513
## 
## Fixed effects:
##                                                     Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                                          1.88591     0.13059   520.00000   14.44   &lt;2e-16 ***
## contraceptive_methodsfertility_awareness            -0.07171     0.13312   522.00000   -0.54   0.5904    
## contraceptive_methodsnone                           -0.17149     0.14124   528.00000   -1.21   0.2252    
## contraceptive_methodshormonal                       -0.14096     0.06885   523.00000   -2.05   0.0411 *  
## fertile                                              0.16004     0.08257 16549.00000    1.94   0.0526 .  
## cycle_length_groups(25,30]                           0.01582     0.07813   527.00000    0.20   0.8396    
## cycle_length_groups(30,35]                          -0.05283     0.11587   525.00000   -0.46   0.6486    
## fertile_mean                                        -0.15500     0.52483   517.00000   -0.30   0.7679    
## menstruationpre                                     -0.03048     0.01323 16560.00000   -2.30   0.0212 *  
## menstruationyes                                      0.00524     0.01326 16567.00000    0.40   0.6928    
## contraceptive_methodsfertility_awareness:fertile     0.19965     0.11677 16566.00000    1.71   0.0873 .  
## contraceptive_methodsnone:fertile                    0.00858     0.13014 16550.00000    0.07   0.9474    
## contraceptive_methodshormonal:fertile               -0.17435     0.06104 16580.00000   -2.86   0.0043 ** 
## fertile:cycle_length_groups(25,30]                  -0.00525     0.06800 16539.00000   -0.08   0.9384    
## fertile:cycle_length_groups(30,35]                  -0.18513     0.10377 16553.00000   -1.78   0.0744 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/awareness_vs_regularity-2.png" width="768" /><img src="3_fertility_robustness_files/figure-html/awareness_vs_regularity-3.png" width="768" /></p>
</div>
</div>
</div>
<div id="extra-pair-intimacy" class="section level2 tab-content">
<h2>Extra-pair intimacy</h2>
<pre class="r"><code>model_summaries$extra_pair_intimacy</code></pre>
<div id="model-summary-2" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-3" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2401     2483    -1191     2381    26557 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.128 -0.008 -0.002 -0.002  7.936 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 4.37     2.09    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -3.998      0.231  -17.28  &lt; 2e-16 ***
includedhorm_contra                   -0.814      0.197   -4.13 0.000037 ***
menstruationpre                       -0.251      0.115   -2.18    0.030 *  
menstruationyes                       -0.239      0.110   -2.18    0.030 *  
fertile                               -0.367      0.237   -1.55    0.121    
fertile_mean                           1.859      1.012    1.84    0.066 .  
includedhorm_contra:menstruationpre    0.118      0.213    0.55    0.579    
includedhorm_contra:menstruationyes    0.264      0.195    1.35    0.176    
includedhorm_contra:fertile            0.371      0.404    0.92    0.358    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.075                                                               
menstrutnpr             -0.140  0.193                                                        
menstrutnys             -0.128  0.177  0.332                                                 
fertile                 -0.106  0.276  0.418    0.318                                        
fertile_men             -0.831 -0.119 -0.017   -0.012   -0.140                               
inclddhrm_cntr:mnstrtnp  0.090 -0.350 -0.541   -0.179   -0.224 -0.005                        
inclddhrm_cntr:mnstrtny  0.077 -0.342 -0.187   -0.564   -0.178  0.000  0.335                 
inclddhrm_cntr:f         0.104 -0.511 -0.245   -0.186   -0.578  0.021  0.433                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.338                 
convergence code: 0
Model failed to converge with max|grad| = 3.73989 (tol = 0.001, component 1)
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.37 [-0.83;0.10].</p>
</div>
<div id="marginal-effect-plots-1" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-1" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-1" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-1" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-1" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-2" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-4" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-4" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-4" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-2" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-5" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-5" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-5" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-1" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-3" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-6" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-6" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-6" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-3" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-7" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-7" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-7" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-extra_pair_intimacy-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-1" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-1" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2375     2530    -1168     2337    26548 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.738 -0.004 -0.002 -0.001  6.451 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     5.954    2.440                     
        fertile         5.172    2.274     0.76            
        menstruationpre 0.034    0.184     0.94  0.56      
        menstruationyes 0.717    0.847     0.07 -0.08 -0.03
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -3.8698     0.2838  -13.64   &lt;2e-16 ***
includedhorm_contra                  -0.1920     0.1749   -1.10    0.273    
menstruationpre                      -0.2509     0.2790   -0.90    0.369    
menstruationyes                      -0.2220     0.2920   -0.76    0.447    
fertile                              -2.2432     1.2103   -1.85    0.064 .  
fertile_mean                         -0.4164     1.3921   -0.30    0.765    
includedhorm_contra:menstruationpre  -0.0939     0.2192   -0.43    0.668    
includedhorm_contra:menstruationyes  -0.1200     0.2749   -0.44    0.663    
includedhorm_contra:fertile           0.3639     0.6384    0.57    0.569    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.319                                                               
menstrutnpr             -0.327  0.221                                                        
menstrutnys             -0.243  0.245  0.299                                                 
fertile                 -0.236  0.055  0.325    0.206                                        
fertile_men             -0.729 -0.072 -0.018   -0.107   -0.079                               
inclddhrm_cntr:mnstrtnp  0.140 -0.335 -0.402   -0.132   -0.126 -0.004                        
inclddhrm_cntr:mnstrtny  0.093 -0.309 -0.116   -0.378   -0.018  0.006  0.226                 
inclddhrm_cntr:f         0.121 -0.217 -0.170   -0.095   -0.482  0.013  0.331                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.126                 
convergence code: 0
Model failed to converge with max|grad| = 1.565 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">2401</td>
<td align="center">2483</td>
<td align="center">-1191</td>
<td align="center">2381</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">2375</td>
<td align="center">2530</td>
<td align="center">-1168</td>
<td align="center">2337</td>
<td align="center">44.52</td>
<td align="center">9</td>
<td align="center">0.000001131</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate</p>
</div>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate</p>
</div>
</div>
<div id="m_e-exclusion-criteria-1" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-1" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-1" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
  1962.2   2108.0   -963.1   1926.2    24252 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.972 -0.003 -0.002 -0.001  7.516 

Random effects:
 Groups Name                                   Variance    Std.Dev.
 person (Intercept)                            8.312570904 2.883153
 Xr.2   s(days_filled_out):includedhorm_contra 0.002149182 0.046359
 Xr.1   s(days_filled_out):includedcycling     0.000377367 0.019426
 Xr.0   s(day_number):includedhorm_contra      0.004125241 0.064228
 Xr     s(day_number):includedcycling          0.000000191 0.000437
Number of obs: 24270, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value Pr(&gt;|z|)    
X(Intercept)                                -3.9519     0.2720  -14.53   &lt;2e-16 ***
Xincludedhorm_contra                        -0.4075     0.2272   -1.79    0.073 .  
Xmenstruationpre                            -0.0185     0.1315   -0.14    0.888    
Xmenstruationyes                            -0.0972     0.1324   -0.73    0.463    
Xfertile                                     0.3019     0.2746    1.10    0.272    
Xfertile_mean                               -2.4014     1.5544   -1.54    0.122    
Xincludedhorm_contra:menstruationpre         0.1044     0.2258    0.46    0.644    
Xincludedhorm_contra:menstruationyes         0.2705     0.2184    1.24    0.215    
Xincludedhorm_contra:fertile                 0.0597     0.4548    0.13    0.896    
Xs(day_number):includedcyclingFx1            0.3480     0.1725    2.02    0.044 *  
Xs(day_number):includedhorm_contraFx1        0.4269     0.2088    2.04    0.041 *  
Xs(days_filled_out):includedcyclingFx1      -0.3043     0.1781   -1.71    0.088 .  
Xs(days_filled_out):includedhorm_contraFx1  -0.3971     0.2172   -1.83    0.067 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
failure to converge in 10000 evaluations
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
extra_pair_intimacy ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value    Pr(&gt;|z|)    
(Intercept)                          -3.9519     0.6952   -5.68 0.000000013 ***
includedhorm_contra                  -0.4075     0.5731   -0.71        0.48    
menstruationpre                      -0.0185     0.1422   -0.13        0.90    
menstruationyes                      -0.0972     0.1438   -0.68        0.50    
fertile                               0.3019     0.3027    1.00        0.32    
fertile_mean                         -2.4014     3.6538   -0.66        0.51    
includedhorm_contra:menstruationpre   0.1044     0.2433    0.43        0.67    
includedhorm_contra:menstruationyes   0.2705     0.2365    1.14        0.25    
includedhorm_contra:fertile           0.0597     0.4923    0.12        0.90    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq p-value
s(day_number):includedcycling          1.00   1.00   1.98    0.16
s(day_number):includedhorm_contra      1.04   1.04   2.13    0.16
s(days_filled_out):includedcycling     1.01   1.01   1.45    0.23
s(days_filled_out):includedhorm_contra 1.02   1.02   1.67    0.20

R-sq.(adj) =  -0.000488   
glmer.ML = 1422.3  Scale est. = 1         n = 24270
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-1" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-1" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
  1541.8   1681.2   -752.9   1505.8    17026 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.033 -0.007 -0.003 -0.002  7.897 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 4.68     2.16    
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                              -3.80267    0.40416   -9.41   &lt;2e-16 ***
fertile_mean                                             -0.68589    2.03575   -0.34    0.736    
contraceptive_methodsfertility_awareness                 -0.38620    0.52854   -0.73    0.465    
contraceptive_methodsnone                                 0.15119    0.45224    0.33    0.738    
contraceptive_methodshormonal                            -0.55664    0.26427   -2.11    0.035 *  
fertile                                                   0.24714    0.39095    0.63    0.527    
menstruationpre                                           0.10251    0.18945    0.54    0.588    
menstruationyes                                           0.20637    0.17425    1.18    0.236    
contraceptive_methodsfertility_awareness:fertile         -0.26345    0.86515   -0.30    0.761    
contraceptive_methodsnone:fertile                         0.00997    0.87657    0.01    0.991    
contraceptive_methodshormonal:fertile                     0.23538    0.52643    0.45    0.655    
contraceptive_methodsfertility_awareness:menstruationpre -0.29703    0.38207   -0.78    0.437    
contraceptive_methodsnone:menstruationpre                -0.55983    0.44829   -1.25    0.212    
contraceptive_methodshormonal:menstruationpre            -0.13802    0.27311   -0.51    0.613    
contraceptive_methodsfertility_awareness:menstruationyes  0.24577    0.36207    0.68    0.497    
contraceptive_methodsnone:menstruationyes                -0.75827    0.48723   -1.56    0.120    
contraceptive_methodshormonal:menstruationyes            -0.17371    0.25556   -0.68    0.497    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.48136 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">1527</td>
<td align="center">1620</td>
<td align="center">-751.4</td>
<td align="center">1503</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">1542</td>
<td align="center">1681</td>
<td align="center">-752.9</td>
<td align="center">1506</td>
<td align="center">0</td>
<td align="center">6</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-1" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">2397</td>
<td align="center">2544</td>
<td align="center">-1180</td>
<td align="center">2361</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">2398</td>
<td align="center">2611</td>
<td align="center">-1173</td>
<td align="center">2346</td>
<td align="center">14.8</td>
<td align="center">8</td>
<td align="center">0.06317</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2398     2611    -1173     2346    26541 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.029 -0.004 -0.002 -0.002  8.412 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.64     2.58    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                  -4.09607    0.43700   -9.37   &lt;2e-16 ***
menstruationpre                              -0.13249    0.12266   -1.08    0.280    
menstruationyes                              -0.00417    0.11352   -0.04    0.971    
fertile_mean                                 -1.08343    1.37895   -0.79    0.432    
age_group(20,25]                              0.23571    0.40840    0.58    0.564    
age_group(25,30]                             -0.01943    0.43314   -0.04    0.964    
age_group(30,35]                             -0.06194    0.52367   -0.12    0.906    
age_group(35,70]                             -0.03721    0.48528   -0.08    0.939    
includedhorm_contra                           0.10578    0.42437    0.25    0.803    
fertile                                       0.70539    0.70740    1.00    0.319    
menstruationpre:includedhorm_contra          -0.05225    0.20997   -0.25    0.803    
menstruationyes:includedhorm_contra          -0.03955    0.19169   -0.21    0.837    
age_group(20,25]:includedhorm_contra         -0.62880    0.49505   -1.27    0.204    
age_group(25,30]:includedhorm_contra         -0.33064    0.62118   -0.53    0.595    
age_group(30,35]:includedhorm_contra         -0.21874    0.87483   -0.25    0.803    
age_group(35,70]:includedhorm_contra         -0.04922    0.83413   -0.06    0.953    
age_group(20,25]:fertile                     -1.17532    0.80353   -1.46    0.144    
age_group(25,30]:fertile                     -0.14490    0.79428   -0.18    0.855    
age_group(30,35]:fertile                     -0.41411    0.96172   -0.43    0.667    
age_group(35,70]:fertile                     -1.27067    0.97026   -1.31    0.190    
includedhorm_contra:fertile                  -1.07609    0.90696   -1.19    0.235    
age_group(20,25]:includedhorm_contra:fertile  1.75328    1.04457    1.68    0.093 .  
age_group(25,30]:includedhorm_contra:fertile  0.22160    1.35558    0.16    0.870    
age_group(30,35]:includedhorm_contra:fertile -0.01531    1.62605   -0.01    0.992    
age_group(35,70]:includedhorm_contra:fertile  1.84573    1.68529    1.10    0.273    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.25062 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-1" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">2370</td>
<td align="center">2468</td>
<td align="center">-1173</td>
<td align="center">2346</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">2376</td>
<td align="center">2490</td>
<td align="center">-1174</td>
<td align="center">2348</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2376     2490    -1174     2348    26553 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.094 -0.004 -0.003 -0.002  7.926 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.51     2.55    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                              -3.9858     0.2566  -15.54   &lt;2e-16 ***
menstruationpre                          -0.0528     0.1207   -0.44    0.662    
menstruationyes                           0.1226     0.1092    1.12    0.262    
fertile_mean                             -1.0328     1.3059   -0.79    0.429    
weekendTRUE                              -0.1005     0.1058   -0.95    0.342    
includedhorm_contra                      -0.4946     0.2134   -2.32    0.020 *  
fertile                                   0.0946     0.3045    0.31    0.756    
menstruationpre:includedhorm_contra      -0.0190     0.2075   -0.09    0.927    
menstruationyes:includedhorm_contra      -0.1049     0.1906   -0.55    0.582    
weekendTRUE:includedhorm_contra           0.4444     0.1795    2.48    0.013 *  
weekendTRUE:fertile                       0.1759     0.4257    0.41    0.679    
includedhorm_contra:fertile               0.2230     0.5077    0.44    0.660    
weekendTRUE:includedhorm_contra:fertile  -0.6122     0.6855   -0.89    0.372    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 1.52109 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-1" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">2388</td>
<td align="center">2568</td>
<td align="center">-1172</td>
<td align="center">2344</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">2398</td>
<td align="center">2677</td>
<td align="center">-1165</td>
<td align="center">2330</td>
<td align="center">13.52</td>
<td align="center">12</td>
<td align="center">0.3326</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2398     2676    -1165     2330    26533 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.874 -0.003 -0.003 -0.001  9.337 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.57     2.56    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                  -4.10144    0.29121  -14.08   &lt;2e-16 ***
menstruationpre                              -0.12441    0.12372   -1.01    0.315    
menstruationyes                               0.00548    0.11338    0.05    0.961    
fertile_mean                                 -0.25520    1.30234   -0.20    0.845    
weekdayTuesday                               -0.23737    0.18940   -1.25    0.210    
weekdayWednesday                             -0.34768    0.20274   -1.71    0.086 .  
weekdayThursday                              -0.06412    0.18754   -0.34    0.732    
weekdayFriday                                -0.03137    0.19050   -0.16    0.869    
weekdaySaturday                              -0.06215    0.19249   -0.32    0.747    
weekdaySunday                                 0.06316    0.18160    0.35    0.728    
includedhorm_contra                          -0.08974    0.25788   -0.35    0.728    
fertile                                       0.83803    0.46399    1.81    0.071 .  
menstruationpre:includedhorm_contra           0.00859    0.21051    0.04    0.967    
menstruationyes:includedhorm_contra           0.00774    0.19179    0.04    0.968    
weekdayTuesday:includedhorm_contra           -0.09383    0.31788   -0.30    0.768    
weekdayWednesday:includedhorm_contra         -0.07406    0.33520   -0.22    0.825    
weekdayThursday:includedhorm_contra          -0.51123    0.33927   -1.51    0.132    
weekdayFriday:includedhorm_contra            -0.27101    0.32126   -0.84    0.399    
weekdaySaturday:includedhorm_contra          -0.03602    0.30322   -0.12    0.905    
weekdaySunday:includedhorm_contra            -0.11277    0.29211   -0.39    0.699    
weekdayTuesday:fertile                       -0.51956    0.72383   -0.72    0.473    
weekdayWednesday:fertile                     -0.30906    0.76393   -0.40    0.686    
weekdayThursday:fertile                      -0.88216    0.71766   -1.23    0.219    
weekdayFriday:fertile                        -0.82014    0.70624   -1.16    0.246    
weekdaySaturday:fertile                      -1.13657    0.76629   -1.48    0.138    
weekdaySunday:fertile                        -2.12505    0.83313   -2.55    0.011 *  
includedhorm_contra:fertile                  -1.16873    0.81739   -1.43    0.153    
weekdayTuesday:includedhorm_contra:fertile    0.35164    1.32147    0.27    0.790    
weekdayWednesday:includedhorm_contra:fertile  0.66210    1.28281    0.52    0.606    
weekdayThursday:includedhorm_contra:fertile   1.92116    1.21348    1.58    0.113    
weekdayFriday:includedhorm_contra:fertile     1.24442    1.22397    1.02    0.309    
weekdaySaturday:includedhorm_contra:fertile   1.76314    1.18251    1.49    0.136    
weekdaySunday:includedhorm_contra:fertile     2.33976    1.24208    1.88    0.060 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 1.01692 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-1" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">2388</td>
<td align="center">2519</td>
<td align="center">-1178</td>
<td align="center">2356</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">2392</td>
<td align="center">2572</td>
<td align="center">-1174</td>
<td align="center">2348</td>
<td align="center">7.883</td>
<td align="center">6</td>
<td align="center">0.2468</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2392     2572    -1174     2348    26545 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.975 -0.004 -0.003 -0.002  9.165 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.44     2.54    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                             -4.243015   0.307797  -13.79   &lt;2e-16 ***
menstruationpre                                         -0.000488   0.120800    0.00     1.00    
menstruationyes                                          0.074901   0.113051    0.66     0.51    
fertile_mean                                            -0.530802   1.407136   -0.38     0.71    
included_levelslax                                       0.609606   0.377262    1.62     0.11    
included_levelsconservative                             -0.044807   0.332163   -0.13     0.89    
included_levelsstrict                                    0.202528   0.295635    0.69     0.49    
includedhorm_contra                                     -0.024891   0.307292   -0.08     0.94    
fertile                                                 -0.038888   0.385290   -0.10     0.92    
menstruationpre:includedhorm_contra                     -0.236823   0.212206   -1.12     0.26    
menstruationyes:includedhorm_contra                     -0.052542   0.187962   -0.28     0.78    
included_levelslax:includedhorm_contra                  -0.443736   0.507961   -0.87     0.38    
included_levelsconservative:includedhorm_contra          0.116334   0.464753    0.25     0.80    
included_levelsstrict:includedhorm_contra               -0.582546   0.565476   -1.03     0.30    
included_levelslax:fertile                               0.505837   0.569030    0.89     0.37    
included_levelsconservative:fertile                      0.874198   0.571722    1.53     0.13    
included_levelsstrict:fertile                            0.015282   0.658413    0.02     0.98    
includedhorm_contra:fertile                             -0.472919   0.775144   -0.61     0.54    
included_levelslax:includedhorm_contra:fertile           0.268064   0.971428    0.28     0.78    
included_levelsconservative:includedhorm_contra:fertile -0.397599   1.028993   -0.39     0.70    
included_levelsstrict:includedhorm_contra:fertile       -0.292877   1.214897   -0.24     0.81    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.39553 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-1" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate</p>
</div>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-1" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">2371</td>
<td align="center">2469</td>
<td align="center">-1173</td>
<td align="center">2347</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">2392</td>
<td align="center">2507</td>
<td align="center">-1182</td>
<td align="center">2364</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2392     2507    -1182     2364    26553 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.311 -0.005 -0.003 -0.002  9.259 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 4.9      2.21    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value      Pr(&gt;|z|)    
(Intercept)                                          -2.930      0.473   -6.19 0.00000000061 ***
menstruationpre                                      -0.305      0.121   -2.52        0.0119 *  
menstruationyes                                      -0.176      0.112   -1.56        0.1180    
fertile_mean                                         -3.183      1.285   -2.48        0.0132 *  
certainty_menstruation                               -0.116      0.106   -1.10        0.2718    
includedhorm_contra                                  -2.231      0.928   -2.40        0.0162 *  
fertile                                              -4.116      1.316   -3.13        0.0018 ** 
menstruationpre:includedhorm_contra                   0.332      0.201    1.65        0.0988 .  
menstruationyes:includedhorm_contra                   0.219      0.189    1.16        0.2465    
certainty_menstruation:includedhorm_contra            0.410      0.205    2.00        0.0457 *  
certainty_menstruation:fertile                        0.914      0.290    3.16        0.0016 ** 
includedhorm_contra:fertile                           6.801      2.194    3.10        0.0019 ** 
certainty_menstruation:includedhorm_contra:fertile   -1.464      0.486   -3.01        0.0026 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.72125 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-1" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">2401</td>
<td align="center">2516</td>
<td align="center">-1186</td>
<td align="center">2373</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">2387</td>
<td align="center">2534</td>
<td align="center">-1175</td>
<td align="center">2351</td>
<td align="center">21.94</td>
<td align="center">4</td>
<td align="center">0.0002064</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2387     2534    -1176     2351    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.080 -0.004 -0.002 -0.002  8.544 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.24     2.5     
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                       -3.88384    0.27441  -14.15
menstruationpre                                                                   -0.19725    0.12388   -1.59
menstruationyes                                                                    0.02461    0.11141    0.22
fertile_mean                                                                      -1.27711    1.32760   -0.96
cycle_regularityslightly irregular,\nup to 5 days off                             -0.10793    0.25047   -0.43
cycle_regularityirregular,\nmore than 5 days off                                  -0.17566    0.33990   -0.52
includedhorm_contra                                                               -0.26404    0.21773   -1.21
fertile                                                                            0.44182    0.32668    1.35
menstruationpre:includedhorm_contra                                               -0.03027    0.21055   -0.14
menstruationyes:includedhorm_contra                                               -0.11441    0.19202   -0.60
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.00408    0.53917    0.01
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.36386    0.52197    0.70
cycle_regularityslightly irregular,\nup to 5 days off:fertile                     -0.82737    0.49092   -1.69
cycle_regularityirregular,\nmore than 5 days off:fertile                          -0.83867    0.62934   -1.33
includedhorm_contra:fertile                                                       -0.49545    0.46418   -1.07
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.30193    1.47485    0.20
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.36048    1.45285   -0.25
                                                                                  Pr(&gt;|z|)    
(Intercept)                                                                         &lt;2e-16 ***
menstruationpre                                                                      0.111    
menstruationyes                                                                      0.825    
fertile_mean                                                                         0.336    
cycle_regularityslightly irregular,\nup to 5 days off                                0.667    
cycle_regularityirregular,\nmore than 5 days off                                     0.605    
includedhorm_contra                                                                  0.225    
fertile                                                                              0.176    
menstruationpre:includedhorm_contra                                                  0.886    
menstruationyes:includedhorm_contra                                                  0.551    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra            0.994    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                 0.486    
cycle_regularityslightly irregular,\nup to 5 days off:fertile                        0.092 .  
cycle_regularityirregular,\nmore than 5 days off:fertile                             0.183    
includedhorm_contra:fertile                                                          0.286    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile    0.838    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile         0.804    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 1.6193 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-1" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">2379</td>
<td align="center">2494</td>
<td align="center">-1175</td>
<td align="center">2351</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">2375</td>
<td align="center">2523</td>
<td align="center">-1170</td>
<td align="center">2339</td>
<td align="center">11.59</td>
<td align="center">4</td>
<td align="center">0.0207</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_intimacy-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_intimacy ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    2375     2523    -1170     2339    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.134 -0.003 -0.002 -0.002  7.752 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 7.11     2.67    
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                -4.1948     0.2956  -14.19   &lt;2e-16 ***
menstruationpre                                            -0.0256     0.1215   -0.21    0.833    
menstruationyes                                             0.0895     0.1124    0.80    0.426    
fertile_mean                                               -1.3917     1.3365   -1.04    0.298    
cohabitationLive in same city                               0.4646     0.2728    1.70    0.089 .  
cohabitationLong-distance                                   0.0561     0.2912    0.19    0.847    
includedhorm_contra                                         0.0545     0.2831    0.19    0.847    
fertile                                                     0.2740     0.3520    0.78    0.436    
menstruationpre:includedhorm_contra                        -0.0751     0.2049   -0.37    0.714    
menstruationyes:includedhorm_contra                        -0.1334     0.1909   -0.70    0.485    
cohabitationLive in same city:includedhorm_contra          -0.5398     0.4137   -1.30    0.192    
cohabitationLong-distance:includedhorm_contra              -0.1338     0.4037   -0.33    0.740    
cohabitationLive in same city:fertile                      -0.9779     0.5792   -1.69    0.091 .  
cohabitationLong-distance:fertile                           0.3397     0.5098    0.67    0.505    
includedhorm_contra:fertile                                -0.0603     0.6035   -0.10    0.920    
cohabitationLive in same city:includedhorm_contra:fertile   0.2411     0.9214    0.26    0.794    
cohabitationLong-distance:includedhorm_contra:fertile      -0.1586     0.8077   -0.20    0.844    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.88515 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-1" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
</div>
</div>
<div id="does-extra-pair-desire-predict-being-intimate-with-an-extra-pair-mate" class="section level3">
<h3>Does extra-pair desire predict being intimate with an extra-pair mate?</h3>
<pre class="r"><code>diary %&gt;%
  group_by(person) %&gt;% 
  mutate_at(vars(extra_pair_compliments, extra_pair_flirting, extra_pair_going_out),
    funs(mean, lag), na.rm = T) %&gt;% 
  glmer(extra_pair_intimacy ~ 
          extra_pair_compliments_mean + extra_pair_compliments + 
          extra_pair_flirting_mean + extra_pair_flirting + 
          # extra_pair_going_out_mean + extra_pair_going_out_lag + extra_pair_going_out + 
          (1 | person), data = ., family = binomial(link = &#39;probit&#39;)) %&gt;% summary()</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( probit )
## Formula: extra_pair_intimacy ~ extra_pair_compliments_mean + extra_pair_compliments +  
##     extra_pair_flirting_mean + extra_pair_flirting + (1 | person)
##    Data: .
## 
##      AIC      BIC   logLik deviance df.resid 
##     2249     2299    -1118     2237    29833 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.601 -0.002 -0.001  0.000 29.706 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  person (Intercept) 5.85     2.42    
## Number of obs: 29839, groups:  person, 1153
## 
## Fixed effects:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -5.91202    0.00202   -2928   &lt;2e-16 ***
## extra_pair_compliments_mean -0.25322    0.00202    -126   &lt;2e-16 ***
## extra_pair_compliments       0.35566    0.00201     177   &lt;2e-16 ***
## extra_pair_flirting_mean     0.39687    0.00202     197   &lt;2e-16 ***
## extra_pair_flirting          0.28078    0.00202     139   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) extr_pr_c_ extr_pr_c extr_pr_f_
## extr_pr_cm_ -0.001                                
## extr_pr_cmp -0.002 -0.006                         
## extr_pr_fl_ -0.001 -0.002     -0.003              
## extr_pr_flr -0.001 -0.003     -0.005    -0.002    
## convergence code: 0
## Model failed to converge with max|grad| = 0.0347609 (tol = 0.001, component 1)</code></pre>
</div>
</div>
<div id="extra-pair-sex" class="section level2 tab-content">
<h2>Extra-pair sex</h2>
<pre class="r"><code>model_summaries$extra_pair_sex</code></pre>
<div id="model-summary-4" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-5" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   999.2   1081.4   -489.6    979.2    27210 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.680 -0.001 -0.001 -0.001  6.813 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 8.58     2.93    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -4.2763     0.3752  -11.40   &lt;2e-16 ***
includedhorm_contra                  -0.2096     0.2914   -0.72     0.47    
menstruationpre                       0.0129     0.1751    0.07     0.94    
menstruationyes                      -0.1220     0.1802   -0.68     0.50    
fertile                               0.1587     0.3773    0.42     0.67    
fertile_mean                         -1.9277     2.1167   -0.91     0.36    
includedhorm_contra:menstruationpre  -0.2393     0.3463   -0.69     0.49    
includedhorm_contra:menstruationyes  -0.0501     0.3369   -0.15     0.88    
includedhorm_contra:fertile           0.1807     0.6095    0.30     0.77    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.258                                                               
menstrutnpr             -0.195  0.252                                                        
menstrutnys             -0.146  0.196  0.345                                                 
fertile                 -0.170  0.309  0.451    0.319                                        
fertile_men             -0.816 -0.061 -0.005   -0.006   -0.087                               
inclddhrm_cntr:mnstrtnp  0.115 -0.336 -0.506   -0.174   -0.227 -0.017                        
inclddhrm_cntr:mnstrtny  0.089 -0.291 -0.185   -0.535   -0.169 -0.010  0.273                 
inclddhrm_cntr:f         0.177 -0.536 -0.279   -0.197   -0.610 -0.042  0.400                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.312                 
convergence code: 0
Model failed to converge with max|grad| = 0.778636 (tol = 0.001, component 1)
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.16 [-0.58;0.90].</p>
</div>
<div id="marginal-effect-plots-2" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-2" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-2" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-2" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-2" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-4" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-8" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-8" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-8" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-4" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-9" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-9" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-9" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-2" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-5" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-10" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-10" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-10" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-5" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-11" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-11" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-11" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-extra_pair_sex-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-2" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-2" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1020.9   1176.9   -491.5    982.9    27201 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.164 -0.001  0.000  0.000  6.305 

Random effects:
 Groups Name            Variance Std.Dev. Corr          
 person (Intercept)     10.7     3.27                   
        fertile         21.3     4.61     0.99          
        menstruationpre  1.9     1.38     0.99 0.99     
        menstruationyes 12.1     3.48     0.75 0.68 0.69
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept)                           -4.185      1.028   -4.07 0.0000465 ***
includedhorm_contra                   -0.267      0.930   -0.29   0.77445    
menstruationpre                       -1.069      0.320   -3.34   0.00083 ***
menstruationyes                       -3.749      0.832   -4.51 0.0000066 ***
fertile                               -3.766      0.963   -3.91 0.0000920 ***
fertile_mean                          -0.297      5.597   -0.05   0.95761    
includedhorm_contra:menstruationpre   -0.242      0.539   -0.45   0.65347    
includedhorm_contra:menstruationyes   -0.336      1.551   -0.22   0.82874    
includedhorm_contra:fertile            0.289      1.484    0.20   0.84535    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.339                                                               
menstrutnpr              0.421 -0.462                                                        
menstrutnys              0.328 -0.361  0.468                                                 
fertile                  0.466 -0.527  0.839    0.486                                        
fertile_men             -0.803 -0.067 -0.004   -0.002    0.013                               
inclddhrm_cntr:mnstrtnp -0.267  0.607 -0.593   -0.278   -0.497  0.024                        
inclddhrm_cntr:mnstrtny -0.101  0.441 -0.251   -0.536   -0.262 -0.093  0.346                 
inclddhrm_cntr:f        -0.364  0.761 -0.544   -0.316   -0.648  0.068  0.767                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.381                 
convergence code: 0
unable to evaluate scaled gradient
Model failed to converge: degenerate  Hessian with 4 negative eigenvalues
failure to converge in 10000 evaluations
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">999.2</td>
<td align="center">1081</td>
<td align="center">-489.6</td>
<td align="center">979.2</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">1021</td>
<td align="center">1177</td>
<td align="center">-491.5</td>
<td align="center">982.9</td>
<td align="center">0</td>
<td align="center">9</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate</p>
</div>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
</div>
<div id="m_e-exclusion-criteria-2" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-2" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-2" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
   811.5    957.7   -387.8    775.5    24796 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.733 -0.001 -0.001 -0.001  9.221 

Random effects:
 Groups Name                                   Variance Std.Dev.
 person (Intercept)                            8.805035 2.9673  
 Xr.2   s(days_filled_out):includedhorm_contra 0.161609 0.4020  
 Xr.1   s(days_filled_out):includedcycling     0.062152 0.2493  
 Xr.0   s(day_number):includedhorm_contra      0.000714 0.0267  
 Xr     s(day_number):includedcycling          0.012331 0.1110  
Number of obs: 24814, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value Pr(&gt;|z|)    
X(Intercept)                                -4.5629     1.0482   -4.35 0.000013 ***
Xincludedhorm_contra                         0.0492     0.9251    0.05     0.96    
Xmenstruationpre                             0.2751     0.2106    1.31     0.19    
Xmenstruationyes                            -0.1831     0.2410   -0.76     0.45    
Xfertile                                     0.7180     0.4784    1.50     0.13    
Xfertile_mean                               -1.8460     5.6868   -0.32     0.75    
Xincludedhorm_contra:menstruationpre        -0.3667     0.4004   -0.92     0.36    
Xincludedhorm_contra:menstruationyes        -0.1782     0.4643   -0.38     0.70    
Xincludedhorm_contra:fertile                -0.2281     0.7681   -0.30     0.77    
Xs(day_number):includedcyclingFx1           -0.1157     0.3665   -0.32     0.75    
Xs(day_number):includedhorm_contraFx1        0.2887     0.3757    0.77     0.44    
Xs(days_filled_out):includedcyclingFx1       0.2267     0.3850    0.59     0.56    
Xs(days_filled_out):includedhorm_contraFx1  -0.2318     0.4153   -0.56     0.58    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
extra_pair_sex ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -4.5629     1.0482   -4.35 0.000013 ***
includedhorm_contra                   0.0492     0.9251    0.05     0.96    
menstruationpre                       0.2751     0.2106    1.31     0.19    
menstruationyes                      -0.1831     0.2410   -0.76     0.45    
fertile                               0.7180     0.4784    1.50     0.13    
fertile_mean                         -1.8460     5.6868   -0.32     0.75    
includedhorm_contra:menstruationpre  -0.3667     0.4004   -0.92     0.36    
includedhorm_contra:menstruationyes  -0.1782     0.4643   -0.38     0.70    
includedhorm_contra:fertile          -0.2281     0.7681   -0.30     0.77    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq p-value
s(day_number):includedcycling          1.06   1.06   0.10    0.78
s(day_number):includedhorm_contra      1.00   1.00   0.59    0.44
s(days_filled_out):includedcycling     1.29   1.29   0.85    0.59
s(days_filled_out):includedhorm_contra 1.41   1.41   0.35    0.74

R-sq.(adj) =  -0.000513   
glmer.ML = 560.14  Scale est. = 1         n = 24814
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-2" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-2" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
   655.1    794.8   -309.6    619.1    17309 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.796 -0.002 -0.001  0.000  8.338 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.62     2.57    
Number of obs: 17327, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error z value      Pr(&gt;|z|)    
(Intercept)                                              -3.67937    0.58035   -6.34 0.00000000023 ***
fertile_mean                                             -3.56096    3.54478   -1.00         0.315    
contraceptive_methodsfertility_awareness                 -0.00439    0.53158   -0.01         0.993    
contraceptive_methodsnone                                -0.95267    1.06118   -0.90         0.369    
contraceptive_methodshormonal                            -0.82668    0.46448   -1.78         0.075 .  
fertile                                                   0.18951    0.58178    0.33         0.745    
menstruationpre                                          -0.09068    0.29507   -0.31         0.759    
menstruationyes                                          -0.04614    0.28244   -0.16         0.870    
contraceptive_methodsfertility_awareness:fertile          0.04392    1.05864    0.04         0.967    
contraceptive_methodsnone:fertile                         1.18355    1.61469    0.73         0.464    
contraceptive_methodshormonal:fertile                     0.65884    0.82470    0.80         0.424    
contraceptive_methodsfertility_awareness:menstruationpre  0.27534    0.46933    0.59         0.557    
contraceptive_methodsnone:menstruationpre                 0.59791    0.72167    0.83         0.407    
contraceptive_methodshormonal:menstruationpre            -0.08170    0.46731   -0.17         0.861    
contraceptive_methodsfertility_awareness:menstruationyes -0.19639    0.52347   -0.38         0.708    
contraceptive_methodsnone:menstruationyes                 0.00423    0.78433    0.01         0.996    
contraceptive_methodshormonal:menstruationyes            -0.21762    0.48103   -0.45         0.651    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.0036 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">643.2</td>
<td align="center">736.3</td>
<td align="center">-309.6</td>
<td align="center">619.2</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">655.1</td>
<td align="center">794.8</td>
<td align="center">-309.6</td>
<td align="center">619.1</td>
<td align="center">0.038</td>
<td align="center">6</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-2" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">1031</td>
<td align="center">1179</td>
<td align="center">-497.4</td>
<td align="center">994.8</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">1035</td>
<td align="center">1248</td>
<td align="center">-491.3</td>
<td align="center">982.6</td>
<td align="center">12.2</td>
<td align="center">8</td>
<td align="center">0.1426</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1034.6   1248.1   -491.3    982.6    27194 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.772 -0.002 -0.001 -0.001  8.062 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 5.69     2.39    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                  -3.54966    0.44126   -8.04  8.7e-16 ***
menstruationpre                              -0.07301    0.17706   -0.41    0.680    
menstruationyes                              -0.17468    0.18395   -0.95    0.342    
fertile_mean                                 -3.64032    1.91391   -1.90    0.057 .  
age_group(20,25]                             -0.25664    0.44804   -0.57    0.567    
age_group(25,30]                             -0.39481    0.48165   -0.82    0.412    
age_group(30,35]                             -0.47039    0.60760   -0.77    0.439    
age_group(35,70]                             -0.58687    0.83828   -0.70    0.484    
includedhorm_contra                          -0.25884    0.49635   -0.52    0.602    
fertile                                      -0.39167    1.10040   -0.36    0.722    
menstruationpre:includedhorm_contra          -0.31157    0.35085   -0.89    0.375    
menstruationyes:includedhorm_contra          -0.22754    0.35428   -0.64    0.521    
age_group(20,25]:includedhorm_contra         -0.00540    0.61290   -0.01    0.993    
age_group(25,30]:includedhorm_contra          0.28970    0.72227    0.40    0.688    
age_group(30,35]:includedhorm_contra         -0.07480    1.68812   -0.04    0.965    
age_group(35,70]:includedhorm_contra          0.76486    1.11735    0.68    0.494    
age_group(20,25]:fertile                      0.00388    1.22994    0.00    0.997    
age_group(25,30]:fertile                      1.19708    1.23501    0.97    0.332    
age_group(30,35]:fertile                      1.27431    1.37152    0.93    0.353    
age_group(35,70]:fertile                     -3.42578    3.54683   -0.97    0.334    
includedhorm_contra:fertile                   0.65058    1.45263    0.45    0.654    
age_group(20,25]:includedhorm_contra:fertile  0.10073    1.65689    0.06    0.952    
age_group(25,30]:includedhorm_contra:fertile -1.41925    1.90427   -0.75    0.456    
age_group(30,35]:includedhorm_contra:fertile -3.78246    2.96729   -1.27    0.202    
age_group(35,70]:includedhorm_contra:fertile  3.67511    3.88163    0.95    0.344    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.37577 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-2" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">1003</td>
<td align="center">1102</td>
<td align="center">-489.6</td>
<td align="center">979.1</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">1010</td>
<td align="center">1125</td>
<td align="center">-491.2</td>
<td align="center">982.3</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1010.3   1125.3   -491.2    982.3    27206 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.754 -0.002 -0.001 -0.001  7.316 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.07     2.46    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                              -4.0934     0.3461  -11.83   &lt;2e-16 ***
menstruationpre                          -0.1358     0.1701   -0.80    0.425    
menstruationyes                          -0.3320     0.1847   -1.80    0.072 .  
fertile_mean                             -1.5164     1.8768   -0.81    0.419    
weekendTRUE                               0.1401     0.1559    0.90    0.369    
includedhorm_contra                      -0.3846     0.3070   -1.25    0.210    
fertile                                  -0.4311     0.4930   -0.87    0.382    
menstruationpre:includedhorm_contra      -0.2559     0.3816   -0.67    0.502    
menstruationyes:includedhorm_contra       0.4169     0.3176    1.31    0.189    
weekendTRUE:includedhorm_contra          -0.3704     0.2967   -1.25    0.212    
weekendTRUE:fertile                      -0.0993     0.6956   -0.14    0.886    
includedhorm_contra:fertile               0.4221     0.8100    0.52    0.602    
weekendTRUE:includedhorm_contra:fertile   1.6248     1.0742    1.51    0.130    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 1.95333 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-2" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">1026</td>
<td align="center">1206</td>
<td align="center">-490.9</td>
<td align="center">981.7</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">1041</td>
<td align="center">1320</td>
<td align="center">-486.5</td>
<td align="center">973</td>
<td align="center">8.767</td>
<td align="center">12</td>
<td align="center">0.7227</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1041.0   1320.2   -486.5    973.0    27186 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.927 -0.002 -0.001 -0.001 10.163 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 5.73     2.39    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                   -3.7316     0.3502  -10.65   &lt;2e-16 ***
menstruationpre                               -0.1134     0.1755   -0.65    0.518    
menstruationyes                               -0.2181     0.1804   -1.21    0.227    
fertile_mean                                  -2.8418     1.8447   -1.54    0.123    
weekdayTuesday                                -0.6183     0.3051   -2.03    0.043 *  
weekdayWednesday                              -0.4618     0.3087   -1.50    0.135    
weekdayThursday                               -0.2485     0.2830   -0.88    0.380    
weekdayFriday                                 -0.3024     0.3012   -1.00    0.315    
weekdaySaturday                               -0.1154     0.2758   -0.42    0.676    
weekdaySunday                                  0.2243     0.2430    0.92    0.356    
includedhorm_contra                           -0.1452     0.3543   -0.41    0.682    
fertile                                        0.3399     0.7110    0.48    0.633    
menstruationpre:includedhorm_contra           -0.0245     0.3395   -0.07    0.942    
menstruationyes:includedhorm_contra           -0.0413     0.3570   -0.12    0.908    
weekdayTuesday:includedhorm_contra             0.1564     0.4932    0.32    0.751    
weekdayWednesday:includedhorm_contra           0.1685     0.4886    0.34    0.730    
weekdayThursday:includedhorm_contra           -0.7977     0.5930   -1.35    0.179    
weekdayFriday:includedhorm_contra             -1.0569     0.7588   -1.39    0.164    
weekdaySaturday:includedhorm_contra           -0.0546     0.4417   -0.12    0.902    
weekdaySunday:includedhorm_contra             -0.7265     0.4696   -1.55    0.122    
weekdayTuesday:fertile                         0.9661     1.0553    0.92    0.360    
weekdayWednesday:fertile                       0.2284     1.1473    0.20    0.842    
weekdayThursday:fertile                       -1.6971     1.4079   -1.21    0.228    
weekdayFriday:fertile                         -0.2221     1.1275   -0.20    0.844    
weekdaySaturday:fertile                       -0.1480     1.0950   -0.14    0.893    
weekdaySunday:fertile                         -1.5263     1.1539   -1.32    0.186    
includedhorm_contra:fertile                   -0.7739     1.2790   -0.61    0.545    
weekdayTuesday:includedhorm_contra:fertile    -1.0602     2.0509   -0.52    0.605    
weekdayWednesday:includedhorm_contra:fertile  -0.8942     2.0760   -0.43    0.667    
weekdayThursday:includedhorm_contra:fertile    3.9601     2.1263    1.86    0.063 .  
weekdayFriday:includedhorm_contra:fertile      2.1650     2.4976    0.87    0.386    
weekdaySaturday:includedhorm_contra:fertile    0.7850     1.7588    0.45    0.655    
weekdaySunday:includedhorm_contra:fertile      3.4100     1.8140    1.88    0.060 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 2.0464 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-2" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">1014</td>
<td align="center">1145</td>
<td align="center">-490.9</td>
<td align="center">981.8</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">1049</td>
<td align="center">1230</td>
<td align="center">-502.6</td>
<td align="center">1005</td>
<td align="center">0</td>
<td align="center">6</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1049.3   1229.9   -502.6   1005.3    27198 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.420 -0.003 -0.003 -0.002 14.557 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 3.44     1.85    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                             -4.12370    0.35479  -11.62   &lt;2e-16 ***
menstruationpre                                          0.15794    0.16727    0.94   0.3451    
menstruationyes                                         -0.09823    0.17985   -0.55   0.5849    
fertile_mean                                            -0.62400    1.67067   -0.37   0.7088    
included_levelslax                                       0.66810    0.36766    1.82   0.0692 .  
included_levelsconservative                             -1.54703    0.74503   -2.08   0.0379 *  
included_levelsstrict                                    0.00599    0.40866    0.01   0.9883    
includedhorm_contra                                     -0.15194    0.37430   -0.41   0.6848    
fertile                                                 -0.50833    0.62566   -0.81   0.4165    
menstruationpre:includedhorm_contra                     -0.11117    0.30186   -0.37   0.7127    
menstruationyes:includedhorm_contra                      0.14888    0.30167    0.49   0.6216    
included_levelslax:includedhorm_contra                  -0.81904    0.57852   -1.42   0.1568    
included_levelsconservative:includedhorm_contra          1.62297    0.85384    1.90   0.0573 .  
included_levelsstrict:includedhorm_contra               -0.13537    0.59720   -0.23   0.8207    
included_levelslax:fertile                               0.80214    0.82781    0.97   0.3325    
included_levelsconservative:fertile                      3.40750    1.08389    3.14   0.0017 ** 
included_levelsstrict:fertile                           -1.13021    1.06506   -1.06   0.2886    
includedhorm_contra:fertile                              0.19486    1.22658    0.16   0.8738    
included_levelslax:includedhorm_contra:fertile           0.78967    1.46157    0.54   0.5890    
included_levelsconservative:includedhorm_contra:fertile -2.74217    1.65642   -1.66   0.0978 .  
included_levelsstrict:includedhorm_contra:fertile        1.84602    1.74462    1.06   0.2900    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 4.79174 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-2" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-2" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">1006</td>
<td align="center">1105</td>
<td align="center">-491.2</td>
<td align="center">982.5</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">1029</td>
<td align="center">1144</td>
<td align="center">-500.3</td>
<td align="center">1001</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1028.6   1143.5   -500.3   1000.6    27206 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.687 -0.003 -0.002 -0.001  8.019 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 4.62     2.15    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                          -5.825      1.491   -3.91 0.000094 ***
menstruationpre                                      -0.169      0.175   -0.96    0.336    
menstruationyes                                      -0.303      0.184   -1.64    0.101    
fertile_mean                                         -2.136      1.750   -1.22    0.222    
certainty_menstruation                                0.428      0.299    1.43    0.152    
includedhorm_contra                                   2.868      1.539    1.86    0.062 .  
fertile                                              -0.787      1.772   -0.44    0.657    
menstruationpre:includedhorm_contra                  -0.305      0.346   -0.88    0.378    
menstruationyes:includedhorm_contra                  -0.127      0.351   -0.36    0.718    
certainty_menstruation:includedhorm_contra           -0.697      0.333   -2.09    0.036 *  
certainty_menstruation:fertile                        0.134      0.400    0.33    0.738    
includedhorm_contra:fertile                          -2.946      3.585   -0.82    0.411    
certainty_menstruation:includedhorm_contra:fertile    0.732      0.786    0.93    0.351    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 4.55616 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-2" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
</div>
<div id="m_m9-moderation-by-cohabitation-status-2" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">1008</td>
<td align="center">1123</td>
<td align="center">-490.2</td>
<td align="center">980.4</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">1021</td>
<td align="center">1169</td>
<td align="center">-492.5</td>
<td align="center">985</td>
<td align="center">0</td>
<td align="center">4</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/extra_pair_sex-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: extra_pair_sex ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
  1021.0   1168.8   -492.5    985.0    27202 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-0.683 -0.002 -0.001  0.000  7.065 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 6.86     2.62    
Number of obs: 27220, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                -4.6016     0.4812   -9.56   &lt;2e-16 ***
menstruationpre                                            -0.0609     0.1744   -0.35     0.73    
menstruationyes                                            -0.2665     0.1864   -1.43     0.15    
fertile_mean                                               -0.8813     1.9306   -0.46     0.65    
cohabitationLive in same city                               0.4726     0.4274    1.11     0.27    
cohabitationLong-distance                                   0.5252     0.3999    1.31     0.19    
includedhorm_contra                                         0.2876     0.4144    0.69     0.49    
fertile                                                     0.5167     0.5866    0.88     0.38    
menstruationpre:includedhorm_contra                        -0.1614     0.3465   -0.47     0.64    
menstruationyes:includedhorm_contra                         0.0703     0.3464    0.20     0.84    
cohabitationLive in same city:includedhorm_contra          -1.1994     1.0468   -1.15     0.25    
cohabitationLong-distance:includedhorm_contra              -1.2732     0.9942   -1.28     0.20    
cohabitationLive in same city:fertile                      -0.8562     0.8626   -0.99     0.32    
cohabitationLong-distance:fertile                          -0.7917     0.7814   -1.01     0.31    
includedhorm_contra:fertile                                -0.0179     0.8416   -0.02     0.98    
cohabitationLive in same city:includedhorm_contra:fertile  -0.0288     1.5045   -0.02     0.98    
cohabitationLong-distance:includedhorm_contra:fertile       0.1365     1.2995    0.11     0.92    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 5.11326 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-2" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in pwrssUpdate(pp, resp, tol = tolPwrss, GQmat = GQmat, compDev = compDev, : Downdated VtV is not positive definite</p>
</div>
</div>
</div>
<div id="does-extra-pair-desire-predict-having-sex-with-an-extra-pair-mate" class="section level3">
<h3>Does extra-pair desire predict having sex with an extra-pair mate?</h3>
<pre class="r"><code>diary %&gt;%
  group_by(person) %&gt;% 
  mutate_at(vars(extra_pair_compliments, extra_pair_flirting, extra_pair_going_out),
    funs(mean, lag), na.rm = T) %&gt;% 
  glmer(extra_pair_sex ~ 
          extra_pair_compliments_mean + extra_pair_compliments + 
          extra_pair_flirting_mean + extra_pair_flirting + 
          # extra_pair_going_out_mean + extra_pair_going_out_lag + extra_pair_going_out + 
          (1 | person), data = ., family = binomial(link = &#39;probit&#39;)) %&gt;% summary()</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( probit )
## Formula: extra_pair_sex ~ extra_pair_compliments_mean + extra_pair_compliments +  
##     extra_pair_flirting_mean + extra_pair_flirting + (1 | person)
##    Data: .
## 
##      AIC      BIC   logLik deviance df.resid 
##    983.9   1033.7   -485.9    971.9    29867 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
##  -1.28   0.00   0.00   0.00  11.86 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  person (Intercept) 9.06     3.01    
## Number of obs: 29873, groups:  person, 1154
## 
## Fixed effects:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  -6.2267     0.4964  -12.54  &lt; 2e-16 ***
## extra_pair_compliments_mean  -0.3000     0.1988   -1.51    0.131    
## extra_pair_compliments        0.4234     0.0552    7.68  1.6e-14 ***
## extra_pair_flirting_mean      0.3047     0.2587    1.18    0.239    
## extra_pair_flirting           0.1300     0.0614    2.12    0.034 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) extr_pr_c_ extr_pr_c extr_pr_f_
## extr_pr_cm_ -0.507                                
## extr_pr_cmp -0.405 -0.144                         
## extr_pr_fl_ -0.028 -0.698      0.141              
## extr_pr_flr  0.041  0.111     -0.456    -0.299</code></pre>
</div>
</div>
<div id="in-pair-desire" class="section level2 tab-content">
<h2>In-pair desire</h2>
<pre class="r"><code>model_summaries$in_pair_desire</code></pre>
<div id="model-summary-6" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-7" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 82706

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.477 -0.680 -0.031  0.669  3.795 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.733    0.856   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value     Pr(&gt;|t|)    
(Intercept)                             3.47716     0.07609  1389.00000   45.70      &lt; 2e-16 ***
includedhorm_contra                     0.28629     0.06217  1354.00000    4.61 0.0000045076 ***
menstruationpre                        -0.06548     0.03340 25860.00000   -1.96         0.05 *  
menstruationyes                        -0.18657     0.03142 25969.00000   -5.94 0.0000000029 ***
fertile                                 0.27106     0.06770 25847.00000    4.00 0.0000624942 ***
fertile_mean                            0.03688     0.35160  1506.00000    0.10         0.92    
includedhorm_contra:menstruationpre    -0.00498     0.04283 25861.00000   -0.12         0.91    
includedhorm_contra:menstruationyes     0.03667     0.04117 25952.00000    0.89         0.37    
includedhorm_contra:fertile            -0.48328     0.08553 25975.00000   -5.65 0.0000000162 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.171  0.217                                                        
menstrutnys             -0.167  0.209  0.399                                                 
fertile                 -0.165  0.267  0.469    0.387                                        
fertile_men             -0.772 -0.034 -0.008   -0.006   -0.067                               
inclddhrm_cntr:mnstrtnp  0.141 -0.271 -0.780   -0.311   -0.365 -0.004                        
inclddhrm_cntr:mnstrtny  0.133 -0.256 -0.304   -0.763   -0.295 -0.004  0.384                 
inclddhrm_cntr:f         0.165 -0.336 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.25 [0.13;0.37].</p>
</div>
<div id="marginal-effect-plots-3" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-3" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-3" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-3" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-3" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-6" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-12" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-12" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-12" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-6" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-13" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-13" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-13" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-3" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-7" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-14" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-14" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-14" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-7" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-15" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-15" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-15" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-in_pair_desire-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-3" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-3" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 82256

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.669 -0.662 -0.033  0.646  3.656 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.825    0.908                     
          fertile         1.065    1.032    -0.30            
          menstruationpre 0.198    0.445    -0.23  0.35      
          menstruationyes 0.243    0.493    -0.21  0.25  0.27
 Residual                 1.109    1.053                     
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          3.48416    0.07807    44.6
includedhorm_contra                  0.27746    0.06542     4.2
menstruationpre                     -0.06175    0.04158    -1.5
menstruationyes                     -0.18972    0.04152    -4.6
fertile                              0.26864    0.08848     3.0
fertile_mean                         0.01320    0.35668     0.0
includedhorm_contra:menstruationpre  0.00674    0.05331     0.1
includedhorm_contra:menstruationyes  0.04736    0.05401     0.9
includedhorm_contra:fertile         -0.46053    0.11210    -4.1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.483                                                               
menstrutnpr             -0.210  0.256                                                        
menstrutnys             -0.206  0.248  0.338                                                 
fertile                 -0.216  0.332  0.413    0.328                                        
fertile_men             -0.758 -0.034 -0.006   -0.002   -0.079                               
inclddhrm_cntr:mnstrtnp  0.172 -0.322 -0.780   -0.264   -0.321 -0.006                        
inclddhrm_cntr:mnstrtny  0.163 -0.307 -0.260   -0.769   -0.252 -0.004  0.329                 
inclddhrm_cntr:f         0.210 -0.420 -0.326   -0.259   -0.785  0.010  0.413                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.324                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">82689</td>
<td align="center">82779</td>
<td align="center">-41334</td>
<td align="center">82667</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">82260</td>
<td align="center">82424</td>
<td align="center">-41110</td>
<td align="center">82220</td>
<td align="center">447</td>
<td align="center">9</td>
<td align="center">1.278e-90</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-3" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-3" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-3" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 75341

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.525 -0.683 -0.032  0.657  3.723 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.741    0.861   
 Xr.2     s(days_filled_out):includedhorm_contra 0.281    0.530   
 Xr.1     s(days_filled_out):includedcycling     0.138    0.371   
 Xr.0     s(day_number):includedhorm_contra      0.251    0.501   
 Xr       s(day_number):includedcycling          0.338    0.581   
 Residual                                        1.170    1.082   
Number of obs: 24250, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 3.4401     0.0769    44.7
Xincludedhorm_contra                         0.2815     0.0635     4.4
Xmenstruationpre                            -0.0682     0.0346    -2.0
Xmenstruationyes                            -0.2053     0.0332    -6.2
Xfertile                                     0.2609     0.0716     3.6
Xfertile_mean                                0.1168     0.3532     0.3
Xincludedhorm_contra:menstruationpre        -0.0019     0.0443     0.0
Xincludedhorm_contra:menstruationyes         0.0475     0.0434     1.1
Xincludedhorm_contra:fertile                -0.4873     0.0904    -5.4
Xs(day_number):includedcyclingFx1            0.1919     0.1523     1.3
Xs(day_number):includedhorm_contraFx1        0.5230     0.1441     3.6
Xs(days_filled_out):includedcyclingFx1      -0.1562     0.1312    -1.2
Xs(days_filled_out):includedhorm_contraFx1  -0.5016     0.1460    -3.4
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
in_pair_desire ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value      Pr(&gt;|t|)    
(Intercept)                           3.4401     0.0769   44.71       &lt; 2e-16 ***
includedhorm_contra                   0.2815     0.0635    4.44 0.00000920600 ***
menstruationpre                      -0.0682     0.0346   -1.97       0.04867 *  
menstruationyes                      -0.2053     0.0332   -6.19 0.00000000063 ***
fertile                               0.2609     0.0716    3.64       0.00027 ***
fertile_mean                          0.1168     0.3532    0.33       0.74097    
includedhorm_contra:menstruationpre  -0.0019     0.0443   -0.04       0.96586    
includedhorm_contra:menstruationyes   0.0475     0.0434    1.09       0.27436    
includedhorm_contra:fertile          -0.4873     0.0904   -5.39 0.00000007126 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F      p-value    
s(day_number):includedcycling          4.70   4.70 2.86        0.011 *  
s(day_number):includedhorm_contra      4.61   4.61 9.11 0.0000000521 ***
s(days_filled_out):includedcycling     3.39   3.39 3.59        0.013 *  
s(days_filled_out):includedhorm_contra 4.75   4.75 9.97 0.0000000053 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00715   
lmer.REML =  75341  Scale est. = 1.1697    n = 24250
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  79989 80088 -39983

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.8227    1.111

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
 Phi1 
0.369 
Fixed effects: in_pair_desire ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.477    0.0776 25495   44.83  0.0000
includedhorm_contra                  0.281    0.0638  1040    4.40  0.0000
menstruationpre                     -0.049    0.0395 25495   -1.25  0.2107
menstruationyes                     -0.181    0.0368 25495   -4.93  0.0000
fertile                              0.284    0.0864 25495    3.29  0.0010
fertile_mean                         0.077    0.3592  1040    0.22  0.8295
includedhorm_contra:menstruationpre -0.006    0.0507 25495   -0.13  0.9001
includedhorm_contra:menstruationyes  0.062    0.0478 25495    1.30  0.1950
includedhorm_contra:fertile         -0.465    0.1090 25495   -4.27  0.0000
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.196  0.245                                                        
menstruationyes                     -0.193  0.240  0.406                                                 
fertile                             -0.189  0.314  0.412    0.352                                        
fertile_mean                        -0.767 -0.035 -0.007   -0.006   -0.086                               
includedhorm_contra:menstruationpre  0.160 -0.304 -0.779   -0.316   -0.320 -0.004                        
includedhorm_contra:menstruationyes  0.154 -0.291 -0.312   -0.769   -0.270 -0.003  0.390                 
includedhorm_contra:fertile          0.193 -0.395 -0.326   -0.279   -0.788  0.013  0.410                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.344                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.37779 -0.68862 -0.03652  0.66097  3.73980 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  79970 80077 -39972

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.8191    1.113

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
    Phi1   Theta1 
 0.44542 -0.08838 
Fixed effects: in_pair_desire ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.476    0.0776 25495   44.78  0.0000
includedhorm_contra                  0.281    0.0639  1040    4.39  0.0000
menstruationpre                     -0.046    0.0397 25495   -1.17  0.2431
menstruationyes                     -0.182    0.0370 25495   -4.92  0.0000
fertile                              0.283    0.0875 25495    3.23  0.0012
fertile_mean                         0.081    0.3596  1040    0.22  0.8228
includedhorm_contra:menstruationpre -0.009    0.0510 25495   -0.17  0.8624
includedhorm_contra:menstruationyes  0.061    0.0481 25495    1.27  0.2058
includedhorm_contra:fertile         -0.464    0.1104 25495   -4.21  0.0000
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.197  0.245                                                        
menstruationyes                     -0.194  0.241  0.409                                                 
fertile                             -0.190  0.315  0.403    0.349                                        
fertile_mean                        -0.767 -0.035 -0.006   -0.006   -0.087                               
includedhorm_contra:menstruationpre  0.160 -0.304 -0.779   -0.319   -0.313 -0.004                        
includedhorm_contra:menstruationyes  0.155 -0.292 -0.315   -0.770   -0.268 -0.003  0.394                 
includedhorm_contra:fertile          0.194 -0.397 -0.319   -0.276   -0.788  0.013  0.401                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.341                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.36882 -0.68991 -0.03606  0.66274  3.71711 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-3" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-3" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 52683

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.489 -0.682 -0.039  0.670  3.439 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.674    0.821   
 Residual             1.179    1.086   
Number of obs: 17026, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               3.70449    0.15897   23.30
fertile_mean                                             -0.06860    0.77147   -0.09
contraceptive_methodsfertility_awareness                 -0.02951    0.20787   -0.14
contraceptive_methodsnone                                -0.40242    0.22038   -1.83
contraceptive_methodshormonal                             0.10620    0.10475    1.01
fertile                                                   0.16094    0.12113    1.33
menstruationpre                                          -0.08107    0.05851   -1.39
menstruationyes                                          -0.20042    0.05588   -3.59
contraceptive_methodsfertility_awareness:fertile         -0.30697    0.27510   -1.12
contraceptive_methodsnone:fertile                         0.40800    0.29783    1.37
contraceptive_methodshormonal:fertile                    -0.40963    0.13531   -3.03
contraceptive_methodsfertility_awareness:menstruationpre -0.18053    0.12961   -1.39
contraceptive_methodsnone:menstruationpre                -0.16633    0.13549   -1.23
contraceptive_methodshormonal:menstruationpre            -0.00178    0.06590   -0.03
contraceptive_methodsfertility_awareness:menstruationyes  0.09994    0.13025    0.77
contraceptive_methodsnone:menstruationyes                -0.10010    0.14168   -0.71
contraceptive_methodshormonal:menstruationyes             0.00895    0.06373    0.14
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">52675</td>
<td align="center">52775</td>
<td align="center">-26324</td>
<td align="center">52649</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">52674</td>
<td align="center">52821</td>
<td align="center">-26318</td>
<td align="center">52636</td>
<td align="center">13.13</td>
<td align="center">6</td>
<td align="center">0.04103</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-3" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">82685</td>
<td align="center">82841</td>
<td align="center">-41324</td>
<td align="center">82647</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">82677</td>
<td align="center">82899</td>
<td align="center">-41312</td>
<td align="center">82623</td>
<td align="center">23.86</td>
<td align="center">8</td>
<td align="center">0.002419</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 82693

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.474 -0.679 -0.028  0.670  3.795 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.726    0.852   
 Residual             1.190    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.69074    0.15707   23.50
menstruationpre                              -0.06604    0.03340   -1.98
menstruationyes                              -0.19027    0.03142   -6.06
fertile_mean                                  0.02114    0.35201    0.06
age_group(20,25]                             -0.17215    0.16764   -1.03
age_group(25,30]                             -0.08070    0.17256   -0.47
age_group(30,35]                             -0.32700    0.19799   -1.65
age_group(35,70]                             -0.49005    0.18177   -2.70
includedhorm_contra                           0.25365    0.16801    1.51
fertile                                       0.20300    0.19215    1.06
menstruationpre:includedhorm_contra          -0.00635    0.04283   -0.15
menstruationyes:includedhorm_contra           0.03846    0.04117    0.93
age_group(20,25]:includedhorm_contra         -0.00955    0.19113   -0.05
age_group(25,30]:includedhorm_contra         -0.21040    0.21056   -1.00
age_group(30,35]:includedhorm_contra         -0.03414    0.27405   -0.12
age_group(35,70]:includedhorm_contra         -0.24440    0.30918   -0.79
age_group(20,25]:fertile                      0.08071    0.21282    0.38
age_group(25,30]:fertile                     -0.28128    0.21936   -1.28
age_group(30,35]:fertile                      0.50147    0.25407    1.97
age_group(35,70]:fertile                      0.29452    0.23157    1.27
includedhorm_contra:fertile                  -0.54224    0.21311   -2.54
age_group(20,25]:includedhorm_contra:fertile  0.05912    0.23840    0.25
age_group(25,30]:includedhorm_contra:fertile  0.54692    0.26417    2.07
age_group(30,35]:includedhorm_contra:fertile -0.43608    0.34094   -1.28
age_group(35,70]:includedhorm_contra:fertile  0.15704    0.38909    0.40
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-3" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82351</td>
<td align="center">82458</td>
<td align="center">-41163</td>
<td align="center">82325</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82353</td>
<td align="center">82476</td>
<td align="center">-41162</td>
<td align="center">82323</td>
<td align="center">2.1</td>
<td align="center">2</td>
<td align="center">0.35</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 82380

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.592 -0.675 -0.025  0.663  3.885 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.734    0.857   
 Residual             1.175    1.084   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              3.38880    0.07693    44.1
menstruationpre                         -0.06563    0.03318    -2.0
menstruationyes                         -0.18820    0.03121    -6.0
fertile_mean                             0.05610    0.35113     0.2
weekendTRUE                              0.21106    0.02897     7.3
includedhorm_contra                      0.27322    0.06393     4.3
fertile                                  0.22382    0.08182     2.7
menstruationpre:includedhorm_contra     -0.00682    0.04255    -0.2
menstruationyes:includedhorm_contra      0.04146    0.04090     1.0
weekendTRUE:includedhorm_contra          0.03852    0.03722     1.0
weekendTRUE:fertile                      0.10605    0.11287     0.9
includedhorm_contra:fertile             -0.48013    0.10367    -4.6
weekendTRUE:includedhorm_contra:fertile -0.00911    0.14307    -0.1
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-3" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">82156</td>
<td align="center">82344</td>
<td align="center">-41055</td>
<td align="center">82110</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">82161</td>
<td align="center">82447</td>
<td align="center">-41045</td>
<td align="center">82091</td>
<td align="center">18.55</td>
<td align="center">12</td>
<td align="center">0.09988</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 82215

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.593 -0.669 -0.020  0.664  3.938 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.736    0.858   
 Residual             1.165    1.080   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.57413    0.08310    43.0
menstruationpre                              -0.06610    0.03305    -2.0
menstruationyes                              -0.18925    0.03109    -6.1
fertile_mean                                  0.03676    0.35113     0.1
weekdayTuesday                               -0.20371    0.05156    -4.0
weekdayWednesday                             -0.25523    0.05150    -5.0
weekdayThursday                              -0.27230    0.05209    -5.2
weekdayFriday                                -0.13611    0.05295    -2.6
weekdaySaturday                               0.10825    0.05353     2.0
weekdaySunday                                 0.11586    0.05171     2.2
includedhorm_contra                           0.24722    0.07545     3.3
fertile                                       0.04581    0.14585     0.3
menstruationpre:includedhorm_contra          -0.00454    0.04238    -0.1
menstruationyes:includedhorm_contra           0.04443    0.04074     1.1
weekdayTuesday:includedhorm_contra           -0.06519    0.06615    -1.0
weekdayWednesday:includedhorm_contra          0.02600    0.06638     0.4
weekdayThursday:includedhorm_contra           0.14355    0.06703     2.1
weekdayFriday:includedhorm_contra             0.08914    0.06793     1.3
weekdaySaturday:includedhorm_contra           0.02193    0.06876     0.3
weekdaySunday:includedhorm_contra             0.07787    0.06664     1.2
weekdayTuesday:fertile                        0.09581    0.20065     0.5
weekdayWednesday:fertile                      0.15116    0.20196     0.7
weekdayThursday:fertile                       0.49890    0.20495     2.4
weekdayFriday:fertile                         0.40362    0.20518     2.0
weekdaySaturday:fertile                      -0.00164    0.20790     0.0
weekdaySunday:fertile                         0.45585    0.20212     2.3
includedhorm_contra:fertile                  -0.35918    0.18600    -1.9
weekdayTuesday:includedhorm_contra:fertile    0.15132    0.25541     0.6
weekdayWednesday:includedhorm_contra:fertile -0.16681    0.25770    -0.6
weekdayThursday:includedhorm_contra:fertile  -0.48357    0.25992    -1.9
weekdayFriday:includedhorm_contra:fertile    -0.22129    0.26059    -0.8
weekdaySaturday:includedhorm_contra:fertile   0.09201    0.26433     0.3
weekdaySunday:includedhorm_contra:fertile    -0.26069    0.25728    -1.0
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-3" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">82696</td>
<td align="center">82835</td>
<td align="center">-41331</td>
<td align="center">82662</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">82704</td>
<td align="center">82892</td>
<td align="center">-41329</td>
<td align="center">82658</td>
<td align="center">3.919</td>
<td align="center">6</td>
<td align="center">0.6876</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 82724

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.484 -0.680 -0.030  0.668  3.759 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.734    0.857   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              3.42516    0.08456    40.5
menstruationpre                                         -0.06736    0.03343    -2.0
menstruationyes                                         -0.18620    0.03143    -5.9
fertile_mean                                             0.00226    0.35491     0.0
included_levelslax                                       0.05575    0.17137     0.3
included_levelsconservative                              0.23958    0.13390     1.8
included_levelsstrict                                    0.12014    0.13174     0.9
includedhorm_contra                                      0.31738    0.08724     3.6
fertile                                                  0.32303    0.08595     3.8
menstruationpre:includedhorm_contra                     -0.00381    0.04288    -0.1
menstruationyes:includedhorm_contra                      0.03557    0.04122     0.9
included_levelslax:includedhorm_contra                  -0.09606    0.20862    -0.5
included_levelsconservative:includedhorm_contra         -0.11902    0.16724    -0.7
included_levelsstrict:includedhorm_contra               -0.10165    0.16193    -0.6
included_levelslax:fertile                              -0.31948    0.20781    -1.5
included_levelsconservative:fertile                      0.00334    0.15536     0.0
included_levelsstrict:fertile                           -0.13169    0.15547    -0.8
includedhorm_contra:fertile                             -0.51611    0.13039    -4.0
included_levelslax:includedhorm_contra:fertile           0.33806    0.25345     1.3
included_levelsconservative:includedhorm_contra:fertile -0.09626    0.20180    -0.5
included_levelsstrict:includedhorm_contra:fertile        0.13975    0.19869     0.7
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-3" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">82691</td>
<td align="center">82830</td>
<td align="center">-41329</td>
<td align="center">82657</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">82698</td>
<td align="center">82886</td>
<td align="center">-41326</td>
<td align="center">82652</td>
<td align="center">5.482</td>
<td align="center">6</td>
<td align="center">0.4837</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 82710

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.480 -0.681 -0.029  0.668  3.792 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.73     0.854   
 Residual             1.19     1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             3.25158    0.14730   22.07
menstruationpre                                        -0.06437    0.03344   -1.92
menstruationyes                                        -0.18313    0.03165   -5.79
fertile_mean                                            0.01254    0.35504    0.04
cycle_length_groups(25,30]                              0.28550    0.14533    1.96
cycle_length_groups(30,35]                              0.15140    0.17346    0.87
cycle_length_groups(35,41]                              0.27739    0.24446    1.13
includedhorm_contra                                     0.38127    0.16419    2.32
fertile                                                 0.14347    0.18220    0.79
menstruationpre:includedhorm_contra                    -0.00511    0.04287   -0.12
menstruationyes:includedhorm_contra                     0.03364    0.04141    0.81
cycle_length_groups(25,30]:includedhorm_contra         -0.12181    0.17762   -0.69
cycle_length_groups(30,35]:includedhorm_contra         -0.18136    0.26968   -0.67
cycle_length_groups(35,41]:includedhorm_contra          0.06354    0.34789    0.18
cycle_length_groups(25,30]:fertile                      0.12804    0.19485    0.66
cycle_length_groups(30,35]:fertile                      0.23236    0.22915    1.01
cycle_length_groups(35,41]:fertile                      0.06451    0.32102    0.20
includedhorm_contra:fertile                            -0.30170    0.21351   -1.41
cycle_length_groups(25,30]:includedhorm_contra:fertile -0.17148    0.22932   -0.75
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.79387    0.35725   -2.22
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.11520    0.42133   -0.27
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-3" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82690</td>
<td align="center">82797</td>
<td align="center">-41332</td>
<td align="center">82664</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82684</td>
<td align="center">82807</td>
<td align="center">-41327</td>
<td align="center">82654</td>
<td align="center">10.53</td>
<td align="center">2</td>
<td align="center">0.005161</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 82709

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.480 -0.680 -0.032  0.669  3.818 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.733    0.856   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         3.34144    0.21796   15.33
menstruationpre                                    -0.06222    0.03341   -1.86
menstruationyes                                    -0.18133    0.03146   -5.76
fertile_mean                                        0.01944    0.35218    0.06
certainty_menstruation                              0.03316    0.04970    0.67
includedhorm_contra                                 0.25530    0.27349    0.93
fertile                                            -0.57223    0.27318   -2.09
menstruationpre:includedhorm_contra                -0.00821    0.04283   -0.19
menstruationyes:includedhorm_contra                 0.03097    0.04120    0.75
certainty_menstruation:includedhorm_contra          0.00668    0.06368    0.10
certainty_menstruation:fertile                      0.20360    0.06387    3.19
includedhorm_contra:fertile                         0.49027    0.35050    1.40
certainty_menstruation:includedhorm_contra:fertile -0.23397    0.08095   -2.89
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-3" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">82690</td>
<td align="center">82813</td>
<td align="center">-41330</td>
<td align="center">82660</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">82696</td>
<td align="center">82852</td>
<td align="center">-41329</td>
<td align="center">82658</td>
<td align="center">1.972</td>
<td align="center">4</td>
<td align="center">0.7409</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 82715

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.476 -0.680 -0.031  0.666  3.782 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.732    0.855   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        3.57262    0.08952    39.9
menstruationpre                                                                   -0.06700    0.03341    -2.0
menstruationyes                                                                   -0.18756    0.03143    -6.0
fertile_mean                                                                       0.06504    0.35322     0.2
cycle_regularityslightly irregular,\nup to 5 days off                             -0.20300    0.10319    -2.0
cycle_regularityirregular,\nmore than 5 days off                                  -0.15652    0.12363    -1.3
includedhorm_contra                                                                0.18731    0.08136     2.3
fertile                                                                            0.20581    0.09342     2.2
menstruationpre:includedhorm_contra                                               -0.00376    0.04285    -0.1
menstruationyes:includedhorm_contra                                                0.03721    0.04119     0.9
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.31482    0.15591     2.0
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.02324    0.18586    -0.1
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.06660    0.12856     0.5
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.22000    0.16048     1.4
includedhorm_contra:fertile                                                       -0.42302    0.10934    -3.9
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.06369    0.19076    -0.3
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.16608    0.23742    -0.7
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-3" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">82677</td>
<td align="center">82800</td>
<td align="center">-41324</td>
<td align="center">82647</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">82675</td>
<td align="center">82831</td>
<td align="center">-41319</td>
<td align="center">82637</td>
<td align="center">10.16</td>
<td align="center">4</td>
<td align="center">0.03777</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 82697

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.470 -0.681 -0.029  0.666  3.763 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.72     0.849   
 Residual             1.19     1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                           Estimate Std. Error t value
(Intercept)                                                3.383469   0.086513    39.1
menstruationpre                                           -0.065219   0.033393    -2.0
menstruationyes                                           -0.186180   0.031420    -5.9
fertile_mean                                               0.000291   0.350117     0.0
cohabitationLive in same city                              0.220328   0.116543     1.9
cohabitationLong-distance                                  0.218239   0.109905     2.0
includedhorm_contra                                        0.213616   0.092827     2.3
fertile                                                    0.429088   0.084990     5.0
menstruationpre:includedhorm_contra                       -0.006596   0.042828    -0.2
menstruationyes:includedhorm_contra                        0.035009   0.041168     0.9
cohabitationLive in same city:includedhorm_contra          0.155221   0.148757     1.0
cohabitationLong-distance:includedhorm_contra             -0.082970   0.142428    -0.6
cohabitationLive in same city:fertile                     -0.372598   0.153859    -2.4
cohabitationLong-distance:fertile                         -0.346116   0.138670    -2.5
includedhorm_contra:fertile                               -0.609069   0.123417    -4.9
cohabitationLive in same city:includedhorm_contra:fertile  0.286361   0.192217     1.5
cohabitationLong-distance:includedhorm_contra:fertile      0.332860   0.178415     1.9
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-3" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">82679</td>
<td align="center">82802</td>
<td align="center">-41325</td>
<td align="center">82649</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">82683</td>
<td align="center">82839</td>
<td align="center">-41323</td>
<td align="center">82645</td>
<td align="center">3.991</td>
<td align="center">4</td>
<td align="center">0.4072</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_desire-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 82696

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.474 -0.679 -0.029  0.668  3.781 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.721    0.849   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       3.55480    0.08054    44.1
menstruationpre                                                  -0.06514    0.03340    -2.0
menstruationyes                                                  -0.18616    0.03142    -5.9
fertile_mean                                                      0.06164    0.34991     0.2
relationship_status_cleanVerheiratet                             -0.30737    0.10802    -2.8
relationship_status_cleanVerlobt                                 -0.18223    0.20451    -0.9
includedhorm_contra                                               0.22892    0.06901     3.3
fertile                                                           0.20863    0.07720     2.7
menstruationpre:includedhorm_contra                              -0.00596    0.04283    -0.1
menstruationyes:includedhorm_contra                               0.03588    0.04117     0.9
relationship_status_cleanVerheiratet:includedhorm_contra         -0.28395    0.20765    -1.4
relationship_status_cleanVerlobt:includedhorm_contra              0.27015    0.30197     0.9
relationship_status_cleanVerheiratet:fertile                      0.22718    0.13723     1.7
relationship_status_cleanVerlobt:fertile                          0.16313    0.25409     0.6
includedhorm_contra:fertile                                      -0.43315    0.09401    -4.6
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.10793    0.25615    -0.4
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.10629    0.39462     0.3
</code></pre>
<pre class="r"><code>do_moderators(models$in_pair_desire, diary)</code></pre>
</div>
</div>
<div id="moderators-1" class="section level3 tab-content">
<h3>Moderators</h3>
<div id="partners-physical-attractiveness-1" class="section level4">
<h4>Partner’s physical attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s physical attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_physical&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82485</td>
<td align="center">82591</td>
<td align="center">-41229</td>
<td align="center">82459</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82488</td>
<td align="center">82610</td>
<td align="center">-41229</td>
<td align="center">82458</td>
<td align="center">1.122</td>
<td align="center">2</td>
<td align="center">0.5708</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/phys_attr-8-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_physical + included + fertile + menstruation:included +  
    partner_attractiveness_physical:included + partner_attractiveness_physical:fertile +  
    included:fertile + partner_attractiveness_physical:included:fertile
   Data: diary

REML criterion at convergence: 82518

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.473 -0.681 -0.029  0.669  3.760 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.592    0.769   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                  1.31756    0.21693    6.07
menstruationpre                                             -0.06625    0.03337   -1.99
menstruationyes                                             -0.18756    0.03139   -5.98
fertile_mean                                                -0.07229    0.32544   -0.22
partner_attractiveness_physical                              0.27381    0.02591   10.57
includedhorm_contra                                          0.64334    0.28098    2.29
fertile                                                     -0.00836    0.29846   -0.03
menstruationpre:includedhorm_contra                         -0.00444    0.04279   -0.10
menstruationyes:includedhorm_contra                          0.03644    0.04112    0.89
partner_attractiveness_physical:includedhorm_contra         -0.05124    0.03415   -1.50
partner_attractiveness_physical:fertile                      0.03474    0.03644    0.95
includedhorm_contra:fertile                                 -0.08890    0.39182   -0.23
partner_attractiveness_physical:includedhorm_contra:fertile -0.04868    0.04728   -1.03
</code></pre>
</div>
<div id="partners-short-term-attractiveness-1" class="section level4">
<h4>Partner’s short-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s short-term attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82483</td>
<td align="center">82589</td>
<td align="center">-41228</td>
<td align="center">82457</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82486</td>
<td align="center">82609</td>
<td align="center">-41228</td>
<td align="center">82456</td>
<td align="center">0.4128</td>
<td align="center">2</td>
<td align="center">0.8135</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr-9-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm + included + fertile + menstruation:included +  
    partner_attractiveness_shortterm:included + partner_attractiveness_shortterm:fertile +  
    included:fertile + partner_attractiveness_shortterm:included:fertile
   Data: diary

REML criterion at convergence: 82514

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.486 -0.681 -0.030  0.667  3.733 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.589    0.767   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                             Estimate Std. Error t value
(Intercept)                                                   3.53187    0.07022    50.3
menstruationpre                                              -0.06530    0.03337    -2.0
menstruationyes                                              -0.18785    0.03139    -6.0
fertile_mean                                                 -0.03174    0.32482    -0.1
partner_attractiveness_shortterm                              0.44267    0.04056    10.9
includedhorm_contra                                           0.20389    0.05747     3.5
fertile                                                       0.26729    0.06782     3.9
menstruationpre:includedhorm_contra                          -0.00561    0.04279    -0.1
menstruationyes:includedhorm_contra                           0.03661    0.04112     0.9
partner_attractiveness_shortterm:includedhorm_contra         -0.08690    0.05415    -1.6
partner_attractiveness_shortterm:fertile                     -0.02330    0.05727    -0.4
includedhorm_contra:fertile                                  -0.48268    0.08586    -5.6
partner_attractiveness_shortterm:includedhorm_contra:fertile  0.04703    0.07458     0.6
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-2" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) top-right (high LT, low ST), then top-left (low LT, low ST), then bottom-left (low LT, high ST), then bottom-right (high LT/ST).</p>
<pre class="r"><code>add_main = update.formula(formula(model), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * included + partner_attractiveness_shortterm * included + partner_attractiveness_longterm * partner_attractiveness_shortterm&quot;))) # reorder so that the triptych looks nice
add_mod_formula = update.formula(update.formula(formula(model), new = . ~ . - included * fertile), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * fertile * partner_attractiveness_shortterm * included&quot;))) # reorder so that the triptych looks nice

update(model, formula = add_main) -&gt; with_main
update(model, formula = add_mod_formula) -&gt; with_mod
cat(pander(anova(with_main, with_mod)))</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">82455</td>
<td align="center">82586</td>
<td align="center">-41211</td>
<td align="center">82423</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">82461</td>
<td align="center">82649</td>
<td align="center">-41207</td>
<td align="center">82415</td>
<td align="center">7.882</td>
<td align="center">7</td>
<td align="center">0.3431</td>
</tr>
</tbody>
</table>
<pre class="r"><code>effs = allEffects(with_mod)
effs = data.frame(effs$`partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included`) %&gt;% 
  filter(partner_attractiveness_longterm %in% c(-2,0),partner_attractiveness_shortterm %in% c(-2,0))
ggplot(effs, aes(fertile, fit, ymin = lower, ymax = upper, color = included)) + 
  facet_grid(partner_attractiveness_shortterm ~ partner_attractiveness_longterm) +
  geom_smooth(stat=&#39;identity&#39;) +
  scale_color_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  scale_fill_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  ggtitle(&quot;Moderation&quot;, &quot;top-to-bottom: short-term,\nleft-to-right: long-term attractiveness of the partner&quot;)+
  ylab(names(model@frame)[1])</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/st_vs_lt-10-1.png" width="768" /></p>
<pre class="r"><code>print_summary(with_mod)</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + fertile + partner_attractiveness_shortterm +  
    included + menstruation:included + partner_attractiveness_longterm:fertile +  
    partner_attractiveness_longterm:partner_attractiveness_shortterm +  
    fertile:partner_attractiveness_shortterm + partner_attractiveness_longterm:included +  
    fertile:included + partner_attractiveness_shortterm:included +  
    partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm +  
    partner_attractiveness_longterm:fertile:included + partner_attractiveness_longterm:partner_attractiveness_shortterm:included +  
    fertile:partner_attractiveness_shortterm:included + partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included
   Data: diary

REML criterion at convergence: 82506

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.465 -0.680 -0.030  0.668  3.715 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.57     0.755   
 Residual             1.19     1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                             Estimate
(Intercept)                                                                                   3.50262
menstruationpre                                                                              -0.06488
menstruationyes                                                                              -0.18630
fertile_mean                                                                                  0.03236
partner_attractiveness_longterm                                                               0.21377
fertile                                                                                       0.28730
partner_attractiveness_shortterm                                                              0.36122
includedhorm_contra                                                                           0.23213
menstruationpre:includedhorm_contra                                                          -0.00556
menstruationyes:includedhorm_contra                                                           0.03507
partner_attractiveness_longterm:fertile                                                       0.02998
partner_attractiveness_longterm:partner_attractiveness_shortterm                              0.02145
fertile:partner_attractiveness_shortterm                                                     -0.05670
partner_attractiveness_longterm:includedhorm_contra                                          -0.09558
fertile:includedhorm_contra                                                                  -0.52448
partner_attractiveness_shortterm:includedhorm_contra                                         -0.02957
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                     -0.05929
partner_attractiveness_longterm:fertile:includedhorm_contra                                  -0.04833
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra         -0.08591
fertile:partner_attractiveness_shortterm:includedhorm_contra                                  0.07394
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra  0.17850
                                                                                             Std. Error
(Intercept)                                                                                     0.07110
menstruationpre                                                                                 0.03337
menstruationyes                                                                                 0.03142
fertile_mean                                                                                    0.32142
partner_attractiveness_longterm                                                                 0.04781
fertile                                                                                         0.07087
partner_attractiveness_shortterm                                                                0.04488
includedhorm_contra                                                                             0.05942
menstruationpre:includedhorm_contra                                                             0.04279
menstruationyes:includedhorm_contra                                                             0.04115
partner_attractiveness_longterm:fertile                                                         0.06812
partner_attractiveness_longterm:partner_attractiveness_shortterm                                0.03530
fertile:partner_attractiveness_shortterm                                                        0.06298
partner_attractiveness_longterm:includedhorm_contra                                             0.06079
fertile:includedhorm_contra                                                                     0.08903
partner_attractiveness_shortterm:includedhorm_contra                                            0.05783
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        0.05077
partner_attractiveness_longterm:fertile:includedhorm_contra                                     0.08630
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            0.05478
fertile:partner_attractiveness_shortterm:includedhorm_contra                                    0.08006
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra    0.07820
                                                                                             t value
(Intercept)                                                                                     49.3
menstruationpre                                                                                 -1.9
menstruationyes                                                                                 -5.9
fertile_mean                                                                                     0.1
partner_attractiveness_longterm                                                                  4.5
fertile                                                                                          4.1
partner_attractiveness_shortterm                                                                 8.0
includedhorm_contra                                                                              3.9
menstruationpre:includedhorm_contra                                                             -0.1
menstruationyes:includedhorm_contra                                                              0.9
partner_attractiveness_longterm:fertile                                                          0.4
partner_attractiveness_longterm:partner_attractiveness_shortterm                                 0.6
fertile:partner_attractiveness_shortterm                                                        -0.9
partner_attractiveness_longterm:includedhorm_contra                                             -1.6
fertile:includedhorm_contra                                                                     -5.9
partner_attractiveness_shortterm:includedhorm_contra                                            -0.5
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        -1.2
partner_attractiveness_longterm:fertile:includedhorm_contra                                     -0.6
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            -1.6
fertile:partner_attractiveness_shortterm:includedhorm_contra                                     0.9
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra     2.3
</code></pre>
</div>
<div id="relative-attractiveness-to-self-1" class="section level4">
<h4>Relative attractiveness to self</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s relative attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_rel_to_self&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82692</td>
<td align="center">82799</td>
<td align="center">-41333</td>
<td align="center">82666</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82693</td>
<td align="center">82816</td>
<td align="center">-41332</td>
<td align="center">82663</td>
<td align="center">2.939</td>
<td align="center">2</td>
<td align="center">0.23</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/rel_self-11-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_rel_to_self + included + fertile +  
    menstruation:included + partner_attractiveness_rel_to_self:included +  
    partner_attractiveness_rel_to_self:fertile + included:fertile +  
    partner_attractiveness_rel_to_self:included:fertile
   Data: diary

REML criterion at convergence: 82717

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.474 -0.680 -0.031  0.667  3.788 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.734    0.857   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                               Estimate Std. Error t value
(Intercept)                                                     3.49172    0.08541    40.9
menstruationpre                                                -0.06530    0.03340    -2.0
menstruationyes                                                -0.18539    0.03143    -5.9
fertile_mean                                                    0.03204    0.35189     0.1
partner_attractiveness_rel_to_self                              0.03992    0.10774     0.4
includedhorm_contra                                             0.26731    0.07303     3.7
fertile                                                         0.33816    0.08056     4.2
menstruationpre:includedhorm_contra                            -0.00497    0.04283    -0.1
menstruationyes:includedhorm_contra                             0.03597    0.04118     0.9
partner_attractiveness_rel_to_self:includedhorm_contra         -0.02202    0.11194    -0.2
partner_attractiveness_rel_to_self:fertile                      0.20116    0.13092     1.5
includedhorm_contra:fertile                                    -0.54174    0.09670    -5.6
partner_attractiveness_rel_to_self:includedhorm_contra:fertile -0.22882    0.13588    -1.7
</code></pre>
</div>
<div id="partners-shortterm-attractiveness-alternative-specification-1" class="section level4">
<h4>Partner’s shortterm attractiveness, alternative specification</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm_v2&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82551</td>
<td align="center">82658</td>
<td align="center">-41263</td>
<td align="center">82525</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82555</td>
<td align="center">82678</td>
<td align="center">-41262</td>
<td align="center">82525</td>
<td align="center">0.2024</td>
<td align="center">2</td>
<td align="center">0.9038</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr2-12-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm_v2 + included + fertile +  
    menstruation:included + partner_attractiveness_shortterm_v2:included +  
    partner_attractiveness_shortterm_v2:fertile + included:fertile +  
    partner_attractiveness_shortterm_v2:included:fertile
   Data: diary

REML criterion at convergence: 82582

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.485 -0.679 -0.030  0.667  3.747 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.634    0.796   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                Estimate Std. Error t value
(Intercept)                                                      3.50899    0.07209    48.7
menstruationpre                                                 -0.06648    0.03338    -2.0
menstruationyes                                                 -0.18863    0.03140    -6.0
fertile_mean                                                    -0.05685    0.33364    -0.2
partner_attractiveness_shortterm_v2                              0.37961    0.04199     9.0
includedhorm_contra                                              0.25705    0.05886     4.4
fertile                                                          0.26765    0.06768     4.0
menstruationpre:includedhorm_contra                             -0.00449    0.04280    -0.1
menstruationyes:includedhorm_contra                              0.03716    0.04114     0.9
partner_attractiveness_shortterm_v2:includedhorm_contra         -0.09656    0.05534    -1.7
partner_attractiveness_shortterm_v2:fertile                     -0.02220    0.05701    -0.4
includedhorm_contra:fertile                                     -0.48057    0.08556    -5.6
partner_attractiveness_shortterm_v2:includedhorm_contra:fertile  0.03271    0.07374     0.4
</code></pre>
</div>
<div id="partners-global-attractiveness-1" class="section level4">
<h4>Partner’s global attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_global&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82641</td>
<td align="center">82747</td>
<td align="center">-41307</td>
<td align="center">82615</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82641</td>
<td align="center">82763</td>
<td align="center">-41305</td>
<td align="center">82611</td>
<td align="center">4.338</td>
<td align="center">2</td>
<td align="center">0.1143</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/global_attr-13-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_global + included + fertile + menstruation:included +  
    partner_attractiveness_global:included + partner_attractiveness_global:fertile +  
    included:fertile + partner_attractiveness_global:included:fertile
   Data: diary

REML criterion at convergence: 82667

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.463 -0.680 -0.029  0.664  3.756 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.695    0.834   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                3.48778    0.07458    46.8
menstruationpre                                           -0.06649    0.03339    -2.0
menstruationyes                                           -0.18820    0.03141    -6.0
fertile_mean                                              -0.04457    0.34503    -0.1
partner_attractiveness_global                              0.23056    0.04311     5.3
includedhorm_contra                                        0.29267    0.06091     4.8
fertile                                                    0.27014    0.06769     4.0
menstruationpre:includedhorm_contra                       -0.00366    0.04282    -0.1
menstruationyes:includedhorm_contra                        0.03785    0.04116     0.9
partner_attractiveness_global:includedhorm_contra         -0.03167    0.05683    -0.6
partner_attractiveness_global:fertile                     -0.08678    0.05575    -1.6
includedhorm_contra:fertile                               -0.48296    0.08551    -5.6
partner_attractiveness_global:includedhorm_contra:fertile  0.02369    0.07201     0.3
</code></pre>
</div>
<div id="partners-longterm-attractiveness-1" class="section level4">
<h4>Partner’s longterm attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_longterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82594</td>
<td align="center">82700</td>
<td align="center">-41284</td>
<td align="center">82568</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82597</td>
<td align="center">82720</td>
<td align="center">-41284</td>
<td align="center">82567</td>
<td align="center">0.4448</td>
<td align="center">2</td>
<td align="center">0.8006</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-14-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + included + fertile + menstruation:included +  
    partner_attractiveness_longterm:included + partner_attractiveness_longterm:fertile +  
    included:fertile + partner_attractiveness_longterm:included:fertile
   Data: diary

REML criterion at convergence: 82624

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.471 -0.680 -0.030  0.667  3.779 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.664    0.815   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                   3.4603     0.0733    47.2
menstruationpre                                              -0.0663     0.0334    -2.0
menstruationyes                                              -0.1868     0.0314    -5.9
fertile_mean                                                  0.1279     0.3393     0.4
partner_attractiveness_longterm                               0.3612     0.0436     8.3
includedhorm_contra                                           0.2775     0.0599     4.6
fertile                                                       0.2694     0.0677     4.0
menstruationpre:includedhorm_contra                          -0.0042     0.0428    -0.1
menstruationyes:includedhorm_contra                           0.0369     0.0412     0.9
partner_attractiveness_longterm:includedhorm_contra          -0.1592     0.0584    -2.7
partner_attractiveness_longterm:fertile                       0.0353     0.0597     0.6
includedhorm_contra:fertile                                  -0.4808     0.0856    -5.6
partner_attractiveness_longterm:includedhorm_contra:fertile  -0.0511     0.0789    -0.6
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-3" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>We also test this specification of the short-term vs. long-term moderator prediction, but we think this is a suboptimal way to test it.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_st_vs_lt&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82676</td>
<td align="center">82782</td>
<td align="center">-41325</td>
<td align="center">82650</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82679</td>
<td align="center">82801</td>
<td align="center">-41324</td>
<td align="center">82649</td>
<td align="center">1.379</td>
<td align="center">2</td>
<td align="center">0.5017</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-15-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_st_vs_lt + included + fertile + menstruation:included +  
    partner_st_vs_lt:included + partner_st_vs_lt:fertile + included:fertile +  
    partner_st_vs_lt:included:fertile
   Data: diary

REML criterion at convergence: 82706

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.491 -0.680 -0.031  0.668  3.783 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.72     0.849   
 Residual             1.19     1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.49192    0.07587    46.0
menstruationpre                              -0.06489    0.03340    -1.9
menstruationyes                              -0.18580    0.03143    -5.9
fertile_mean                                  0.00255    0.34964     0.0
partner_st_vs_lt                              0.08548    0.04166     2.1
includedhorm_contra                           0.27070    0.06192     4.4
fertile                                       0.26479    0.06800     3.9
menstruationpre:includedhorm_contra          -0.00598    0.04283    -0.1
menstruationyes:includedhorm_contra           0.03523    0.04117     0.9
partner_st_vs_lt:includedhorm_contra          0.02550    0.05261     0.5
partner_st_vs_lt:fertile                     -0.05099    0.05291    -1.0
includedhorm_contra:fertile                  -0.47888    0.08581    -5.6
partner_st_vs_lt:includedhorm_contra:fertile  0.07773    0.06630     1.2
</code></pre>
</div>
<div id="partners-mate-value-1" class="section level4">
<h4>Partner’s mate value</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;MV_P_short&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82634</td>
<td align="center">82741</td>
<td align="center">-41304</td>
<td align="center">82608</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82631</td>
<td align="center">82754</td>
<td align="center">-41301</td>
<td align="center">82601</td>
<td align="center">7.216</td>
<td align="center">2</td>
<td align="center">0.0271</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/mvp_attr-16-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    MV_P_short + included + fertile + menstruation:included +  
    MV_P_short:included + MV_P_short:fertile + included:fertile +      MV_P_short:included:fertile
   Data: diary

REML criterion at convergence: 82656

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.475 -0.680 -0.028  0.666  3.767 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.689    0.83    
 Residual             1.191    1.09    
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                             2.47398    0.19420   12.74
menstruationpre                        -0.06661    0.03339   -1.99
menstruationyes                        -0.18756    0.03141   -5.97
fertile_mean                           -0.01863    0.34375   -0.05
MV_P_short                              0.30018    0.05339    5.62
includedhorm_contra                     0.39490    0.24474    1.61
fertile                                 0.55461    0.24582    2.26
menstruationpre:includedhorm_contra    -0.00315    0.04282   -0.07
menstruationyes:includedhorm_contra     0.03747    0.04116    0.91
MV_P_short:includedhorm_contra         -0.02924    0.07061   -0.41
MV_P_short:fertile                     -0.08459    0.07027   -1.20
includedhorm_contra:fertile            -0.30600    0.31624   -0.97
MV_P_short:includedhorm_contra:fertile -0.05348    0.09079   -0.59
</code></pre>
</div>
<div id="partners-job-and-income-1" class="section level4">
<h4>Partner’s job and income</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_money&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">82693</td>
<td align="center">82799</td>
<td align="center">-41333</td>
<td align="center">82667</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">82696</td>
<td align="center">82819</td>
<td align="center">-41333</td>
<td align="center">82666</td>
<td align="center">0.7316</td>
<td align="center">2</td>
<td align="center">0.6937</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/income_attr-17-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: in_pair_desire ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_money + included + fertile + menstruation:included +  
    partner_attractiveness_money:included + partner_attractiveness_money:fertile +  
    included:fertile + partner_attractiveness_money:included:fertile
   Data: diary

REML criterion at convergence: 82721

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.488 -0.679 -0.031  0.668  3.789 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.734    0.857   
 Residual             1.191    1.091   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               3.53697    0.17856   19.81
menstruationpre                                          -0.06542    0.03340   -1.96
menstruationyes                                          -0.18667    0.03142   -5.94
fertile_mean                                              0.03220    0.35215    0.09
partner_attractiveness_money                             -0.01870    0.05081   -0.37
includedhorm_contra                                       0.13794    0.22289    0.62
fertile                                                   0.19747    0.21428    0.92
menstruationpre:includedhorm_contra                      -0.00505    0.04283   -0.12
menstruationyes:includedhorm_contra                       0.03657    0.04117    0.89
partner_attractiveness_money:includedhorm_contra          0.04869    0.06964    0.70
partner_attractiveness_money:fertile                      0.02324    0.06422    0.36
includedhorm_contra:fertile                              -0.27503    0.28096   -0.98
partner_attractiveness_money:includedhorm_contra:fertile -0.06852    0.08687   -0.79
</code></pre>
</div>
</div>
</div>
<div id="self-reported-perceived-desirability" class="section level2 tab-content">
<h2>Self-reported perceived desirability</h2>
<pre class="r"><code>model_summaries$desirability_1</code></pre>
<div id="model-summary-8" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-9" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: desirability_1 ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 84266

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.049 -0.633  0.031  0.660  3.656 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.716    0.846   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                        Estimate   Std. Error           df t value Pr(&gt;|t|)    
(Intercept)                             3.728628     0.075946  1440.000000   49.10  &lt; 2e-16 ***
includedhorm_contra                    -0.008606     0.062024  1411.000000   -0.14   0.8897    
menstruationpre                        -0.111339     0.034424 25901.000000   -3.23   0.0012 ** 
menstruationyes                        -0.253377     0.032382 26011.000000   -7.82  5.3e-15 ***
fertile                                 0.148779     0.069782 25885.000000    2.13   0.0330 *  
fertile_mean                           -0.000747     0.351362  1559.000000    0.00   0.9983    
includedhorm_contra:menstruationpre     0.028313     0.044143 25902.000000    0.64   0.5213    
includedhorm_contra:menstruationyes     0.072306     0.042427 25993.000000    1.70   0.0883 .  
includedhorm_contra:fertile            -0.287175     0.088143 26015.000000   -3.26   0.0011 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.177  0.224                                                        
menstrutnys             -0.172  0.216  0.399                                                 
fertile                 -0.170  0.276  0.469    0.387                                        
fertile_men             -0.772 -0.034 -0.008   -0.006   -0.069                               
inclddhrm_cntr:mnstrtnp  0.146 -0.280 -0.780   -0.311   -0.365 -0.004                        
inclddhrm_cntr:mnstrtny  0.138 -0.264 -0.304   -0.763   -0.295 -0.004  0.383                 
inclddhrm_cntr:f         0.170 -0.347 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.382                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.13 [0.01;0.25].</p>
</div>
<div id="marginal-effect-plots-4" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-4" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-4" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-4" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-4" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-8" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-16" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-16" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-16" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-8" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-17" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-17" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-17" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-4" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-9" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-18" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-18" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-18" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-9" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-19" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-19" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-19" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-desirability_1-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-4" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-4" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 84027

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.136 -0.613  0.028  0.647  3.623 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.787    0.887                     
          fertile         0.803    0.896    -0.28            
          menstruationpre 0.149    0.386    -0.16  0.34      
          menstruationyes 0.141    0.376    -0.20  0.15  0.34
 Residual                 1.208    1.099                     
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          3.73363    0.07738    48.3
includedhorm_contra                 -0.00889    0.06460    -0.1
menstruationpre                     -0.11379    0.04068    -2.8
menstruationyes                     -0.25493    0.03853    -6.6
fertile                              0.14905    0.08581     1.7
fertile_mean                        -0.02658    0.35433    -0.1
includedhorm_contra:menstruationpre  0.03821    0.05215     0.7
includedhorm_contra:menstruationyes  0.07753    0.05023     1.5
includedhorm_contra:fertile         -0.28698    0.10860    -2.6

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.481                                                               
menstrutnpr             -0.194  0.241                                                        
menstrutnys             -0.208  0.249  0.376                                                 
fertile                 -0.213  0.332  0.419    0.310                                        
fertile_men             -0.760 -0.034 -0.009    0.000   -0.081                               
inclddhrm_cntr:mnstrtnp  0.161 -0.302 -0.780   -0.293   -0.326 -0.005                        
inclddhrm_cntr:mnstrtny  0.164 -0.308 -0.288   -0.767   -0.237 -0.005  0.365                 
inclddhrm_cntr:f         0.209 -0.420 -0.331   -0.245   -0.786  0.010  0.418                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.305                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">84249</td>
<td align="center">84339</td>
<td align="center">-42114</td>
<td align="center">84227</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">84031</td>
<td align="center">84195</td>
<td align="center">-41996</td>
<td align="center">83991</td>
<td align="center">236</td>
<td align="center">9</td>
<td align="center">9.164e-46</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-4" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-4" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-4" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 76928

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.996 -0.628  0.028  0.664  3.806 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.7127   0.844   
 Xr.2     s(days_filled_out):includedhorm_contra 0.0000   0.000   
 Xr.1     s(days_filled_out):includedcycling     0.0914   0.302   
 Xr.0     s(day_number):includedhorm_contra      0.0000   0.000   
 Xr       s(day_number):includedcycling          0.0970   0.311   
 Residual                                        1.2543   1.120   
Number of obs: 24255, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                            Estimate Std. Error t value
X(Intercept)                                3.702674   0.076463    48.4
Xincludedhorm_contra                       -0.000699   0.063036     0.0
Xmenstruationpre                           -0.105837   0.035791    -3.0
Xmenstruationyes                           -0.241225   0.034344    -7.0
Xfertile                                    0.188416   0.074082     2.5
Xfertile_mean                               0.002461   0.351496     0.0
Xincludedhorm_contra:menstruationpre        0.017517   0.045835     0.4
Xincludedhorm_contra:menstruationyes        0.067834   0.044899     1.5
Xincludedhorm_contra:fertile               -0.313698   0.093478    -3.4
Xs(day_number):includedcyclingFx1          -0.034187   0.113372    -0.3
Xs(day_number):includedhorm_contraFx1       0.137127   0.048460     2.8
Xs(days_filled_out):includedcyclingFx1     -0.099984   0.113608    -0.9
Xs(days_filled_out):includedhorm_contraFx1 -0.153328   0.049670    -3.1
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
desirability_1 ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          3.702674   0.076463   48.42  &lt; 2e-16 ***
includedhorm_contra                 -0.000699   0.063036   -0.01  0.99115    
menstruationpre                     -0.105837   0.035791   -2.96  0.00311 ** 
menstruationyes                     -0.241225   0.034344   -7.02  2.2e-12 ***
fertile                              0.188416   0.074082    2.54  0.01099 *  
fertile_mean                         0.002461   0.351496    0.01  0.99441    
includedhorm_contra:menstruationpre  0.017517   0.045835    0.38  0.70233    
includedhorm_contra:menstruationyes  0.067834   0.044899    1.51  0.13085    
includedhorm_contra:fertile         -0.313698   0.093478   -3.36  0.00079 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value   
s(day_number):includedcycling          3.27   3.27 1.47  0.1675   
s(day_number):includedhorm_contra      1.00   1.00 8.01  0.0047 **
s(days_filled_out):includedcycling     3.14   3.14 0.75  0.4561   
s(days_filled_out):includedhorm_contra 1.00   1.00 9.53  0.0020 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00103   
lmer.REML =  76927  Scale est. = 1.2543    n = 24255
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  82975 83073 -41476

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.8249    1.138

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2631 
Fixed effects: desirability_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.737    0.0772 25500   48.42  0.0000
includedhorm_contra                 -0.011    0.0634  1040   -0.18  0.8562
menstruationpre                     -0.105    0.0393 25500   -2.68  0.0074
menstruationyes                     -0.241    0.0367 25500   -6.57  0.0000
fertile                              0.149    0.0833 25500    1.79  0.0736
fertile_mean                        -0.033    0.3573  1040   -0.09  0.9261
includedhorm_contra:menstruationpre  0.043    0.0505 25500    0.84  0.3982
includedhorm_contra:menstruationyes  0.076    0.0479 25500    1.58  0.1138
includedhorm_contra:fertile         -0.262    0.1051 25500   -2.49  0.0127
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.198  0.248                                                        
menstruationyes                     -0.193  0.241  0.402                                                 
fertile                             -0.190  0.311  0.435    0.366                                        
fertile_mean                        -0.768 -0.035 -0.007   -0.006   -0.082                               
includedhorm_contra:menstruationpre  0.162 -0.308 -0.779   -0.314   -0.338 -0.005                        
includedhorm_contra:menstruationyes  0.154 -0.293 -0.309   -0.767   -0.280 -0.004  0.387                 
includedhorm_contra:fertile          0.192 -0.392 -0.345   -0.290   -0.788  0.012  0.434                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.360                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.93997 -0.63223  0.03292  0.65800  3.52418 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  82886 82992 -41430

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.8159    1.143

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.5159 -0.2708 
Fixed effects: desirability_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.731    0.0774 25500   48.23  0.0000
includedhorm_contra                 -0.008    0.0636  1040   -0.13  0.8960
menstruationpre                     -0.095    0.0400 25500   -2.37  0.0179
menstruationyes                     -0.238    0.0375 25500   -6.35  0.0000
fertile                              0.154    0.0864 25500    1.79  0.0740
fertile_mean                        -0.020    0.3585  1040   -0.06  0.9560
includedhorm_contra:menstruationpre  0.035    0.0513 25500    0.68  0.4944
includedhorm_contra:menstruationyes  0.070    0.0487 25500    1.44  0.1509
includedhorm_contra:fertile         -0.273    0.1089 25500   -2.50  0.0123
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.199  0.248                                                        
menstruationyes                     -0.197  0.245  0.411                                                 
fertile                             -0.192  0.316  0.412    0.358                                        
fertile_mean                        -0.767 -0.036 -0.006   -0.006   -0.085                               
includedhorm_contra:menstruationpre  0.162 -0.309 -0.779   -0.320   -0.320 -0.005                        
includedhorm_contra:menstruationyes  0.157 -0.298 -0.316   -0.768   -0.274 -0.003  0.397                 
includedhorm_contra:fertile          0.195 -0.398 -0.326   -0.284   -0.788  0.012  0.410                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.351                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.89996 -0.63104  0.03585  0.65741  3.45825 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-4" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-4" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/desirability_1-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 54029

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.690 -0.636  0.026  0.664  3.608 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.663    0.814   
 Residual             1.280    1.131   
Number of obs: 17029, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               3.91300    0.15846   24.69
fertile_mean                                             -0.15601    0.76802   -0.20
contraceptive_methodsfertility_awareness                 -0.00436    0.20806   -0.02
contraceptive_methodsnone                                -0.18353    0.22060   -0.83
contraceptive_methodshormonal                            -0.13147    0.10481   -1.25
fertile                                                   0.14184    0.12614    1.12
menstruationpre                                          -0.08777    0.06093   -1.44
menstruationyes                                          -0.24694    0.05819   -4.24
contraceptive_methodsfertility_awareness:fertile         -0.07389    0.28648   -0.26
contraceptive_methodsnone:fertile                         0.13475    0.31017    0.43
contraceptive_methodshormonal:fertile                    -0.37400    0.14090   -2.65
contraceptive_methodsfertility_awareness:menstruationpre -0.04693    0.13498   -0.35
contraceptive_methodsnone:menstruationpre                -0.28538    0.14109   -2.02
contraceptive_methodshormonal:menstruationpre            -0.04023    0.06863   -0.59
contraceptive_methodsfertility_awareness:menstruationyes  0.19676    0.13564    1.45
contraceptive_methodsnone:menstruationyes                -0.14919    0.14755   -1.01
contraceptive_methodshormonal:menstruationyes             0.03187    0.06636    0.48
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">54021</td>
<td align="center">54121</td>
<td align="center">-26997</td>
<td align="center">53995</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">54021</td>
<td align="center">54168</td>
<td align="center">-26992</td>
<td align="center">53983</td>
<td align="center">11.46</td>
<td align="center">6</td>
<td align="center">0.07529</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-4" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">84248</td>
<td align="center">84404</td>
<td align="center">-42105</td>
<td align="center">84210</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">84251</td>
<td align="center">84472</td>
<td align="center">-42099</td>
<td align="center">84197</td>
<td align="center">13.39</td>
<td align="center">8</td>
<td align="center">0.09903</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 84266

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.056 -0.628  0.030  0.664  3.640 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.711    0.843   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    3.7582     0.1566   24.01
menstruationpre                               -0.1087     0.0344   -3.16
menstruationyes                               -0.2537     0.0324   -7.83
fertile_mean                                   0.0185     0.3523    0.05
age_group(20,25]                               0.0945     0.1669    0.57
age_group(25,30]                              -0.0476     0.1718   -0.28
age_group(30,35]                              -0.2393     0.1971   -1.21
age_group(35,70]                              -0.1213     0.1810   -0.67
includedhorm_contra                            0.1611     0.1673    0.96
fertile                                        0.3076     0.1981    1.55
menstruationpre:includedhorm_contra            0.0248     0.0442    0.56
menstruationyes:includedhorm_contra            0.0722     0.0424    1.70
age_group(20,25]:includedhorm_contra          -0.3045     0.1903   -1.60
age_group(25,30]:includedhorm_contra          -0.3315     0.2096   -1.58
age_group(30,35]:includedhorm_contra          -0.1294     0.2728   -0.47
age_group(35,70]:includedhorm_contra          -0.4164     0.3078   -1.35
age_group(20,25]:fertile                      -0.3708     0.2194   -1.69
age_group(25,30]:fertile                      -0.2248     0.2262   -0.99
age_group(30,35]:fertile                      -0.0112     0.2619   -0.04
age_group(35,70]:fertile                       0.1624     0.2387    0.68
includedhorm_contra:fertile                   -0.5286     0.2197   -2.41
age_group(20,25]:includedhorm_contra:fertile   0.4721     0.2458    1.92
age_group(25,30]:includedhorm_contra:fertile   0.4133     0.2723    1.52
age_group(30,35]:includedhorm_contra:fertile   0.0879     0.3515    0.25
age_group(35,70]:includedhorm_contra:fertile  -0.2614     0.4012   -0.65
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-4" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">84046</td>
<td align="center">84152</td>
<td align="center">-42010</td>
<td align="center">84020</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">84049</td>
<td align="center">84172</td>
<td align="center">-42009</td>
<td align="center">84019</td>
<td align="center">0.7321</td>
<td align="center">2</td>
<td align="center">0.6935</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 84075

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.006 -0.627  0.031  0.664  3.560 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.716    0.846   
 Residual             1.256    1.121   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                               3.6489     0.0769    47.5
menstruationpre                          -0.1114     0.0343    -3.2
menstruationyes                          -0.2549     0.0323    -7.9
fertile_mean                              0.0127     0.3510     0.0
weekendTRUE                               0.1914     0.0299     6.4
includedhorm_contra                      -0.0122     0.0639    -0.2
fertile                                   0.1722     0.0846     2.0
menstruationpre:includedhorm_contra       0.0267     0.0440     0.6
menstruationyes:includedhorm_contra       0.0764     0.0423     1.8
weekendTRUE:includedhorm_contra           0.0142     0.0385     0.4
weekendTRUE:fertile                      -0.0633     0.1167    -0.5
includedhorm_contra:fertile              -0.3385     0.1071    -3.2
weekendTRUE:includedhorm_contra:fertile   0.1234     0.1479     0.8
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-4" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">83991</td>
<td align="center">84179</td>
<td align="center">-41972</td>
<td align="center">83945</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">84007</td>
<td align="center">84294</td>
<td align="center">-41969</td>
<td align="center">83937</td>
<td align="center">7.625</td>
<td align="center">12</td>
<td align="center">0.8137</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 84059

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.105 -0.625  0.036  0.663  3.563 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.716    0.846   
 Residual             1.253    1.119   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   3.758586   0.083471    45.0
menstruationpre                              -0.111276   0.034253    -3.2
menstruationyes                              -0.255355   0.032219    -7.9
fertile_mean                                  0.004251   0.350992     0.0
weekdayTuesday                               -0.174915   0.053456    -3.3
weekdayWednesday                             -0.134143   0.053390    -2.5
weekdayThursday                              -0.126085   0.054008    -2.3
weekdayFriday                                -0.000321   0.054899     0.0
weekdaySaturday                               0.112996   0.055497     2.0
weekdaySunday                                 0.135962   0.053613     2.5
includedhorm_contra                          -0.032256   0.076237    -0.4
fertile                                       0.046319   0.151205     0.3
menstruationpre:includedhorm_contra           0.027094   0.043922     0.6
menstruationyes:includedhorm_contra           0.078230   0.042217     1.9
weekdayTuesday:includedhorm_contra            0.012869   0.068587     0.2
weekdayWednesday:includedhorm_contra          0.035984   0.068827     0.5
weekdayThursday:includedhorm_contra           0.033289   0.069493     0.5
weekdayFriday:includedhorm_contra            -0.009080   0.070427    -0.1
weekdaySaturday:includedhorm_contra           0.105102   0.071290     1.5
weekdaySunday:includedhorm_contra             0.012405   0.069088     0.2
weekdayTuesday:fertile                        0.158828   0.208024     0.8
weekdayWednesday:fertile                      0.087616   0.209390     0.4
weekdayThursday:fertile                       0.278984   0.212487     1.3
weekdayFriday:fertile                         0.103528   0.212730     0.5
weekdaySaturday:fertile                      -0.045529   0.215546    -0.2
weekdaySunday:fertile                         0.137151   0.209546     0.7
includedhorm_contra:fertile                  -0.320250   0.192829    -1.7
weekdayTuesday:includedhorm_contra:fertile    0.009639   0.264796     0.0
weekdayWednesday:includedhorm_contra:fertile -0.025023   0.267176    -0.1
weekdayThursday:includedhorm_contra:fertile  -0.069233   0.269429    -0.3
weekdayFriday:includedhorm_contra:fertile     0.207254   0.270164     0.8
weekdaySaturday:includedhorm_contra:fertile   0.107750   0.274050     0.4
weekdaySunday:includedhorm_contra:fertile    -0.005697   0.266736     0.0
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-4" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">84255</td>
<td align="center">84394</td>
<td align="center">-42111</td>
<td align="center">84221</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">84262</td>
<td align="center">84450</td>
<td align="center">-42108</td>
<td align="center">84216</td>
<td align="center">5.463</td>
<td align="center">6</td>
<td align="center">0.486</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 84282

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.044 -0.631  0.029  0.660  3.659 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.715    0.846   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                               3.6553     0.0843    43.3
menstruationpre                                          -0.1130     0.0345    -3.3
menstruationyes                                          -0.2544     0.0324    -7.9
fertile_mean                                             -0.0334     0.3546    -0.1
included_levelslax                                        0.1654     0.1699     1.0
included_levelsconservative                               0.2610     0.1328     2.0
included_levelsstrict                                     0.1919     0.1307     1.5
includedhorm_contra                                       0.0390     0.0870     0.4
fertile                                                   0.1610     0.0886     1.8
menstruationpre:includedhorm_contra                       0.0273     0.0442     0.6
menstruationyes:includedhorm_contra                       0.0698     0.0425     1.6
included_levelslax:includedhorm_contra                   -0.1782     0.2070    -0.9
included_levelsconservative:includedhorm_contra          -0.2310     0.1660    -1.4
included_levelsstrict:includedhorm_contra                -0.1071     0.1607    -0.7
included_levelslax:fertile                                0.1816     0.2142     0.8
included_levelsconservative:fertile                      -0.1356     0.1601    -0.8
included_levelsstrict:fertile                            -0.0223     0.1603    -0.1
includedhorm_contra:fertile                              -0.1527     0.1343    -1.1
included_levelslax:includedhorm_contra:fertile           -0.3140     0.2612    -1.2
included_levelsconservative:includedhorm_contra:fertile  -0.1148     0.2080    -0.6
included_levelsstrict:includedhorm_contra:fertile        -0.1519     0.2048    -0.7
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-4" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">84250</td>
<td align="center">84389</td>
<td align="center">-42108</td>
<td align="center">84216</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">84239</td>
<td align="center">84427</td>
<td align="center">-42096</td>
<td align="center">84193</td>
<td align="center">23</td>
<td align="center">6</td>
<td align="center">0.0007969</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 84250

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.069 -0.626  0.030  0.662  3.626 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.712    0.844   
 Residual             1.265    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              3.6055     0.1465   24.61
menstruationpre                                         -0.1126     0.0345   -3.27
menstruationyes                                         -0.2620     0.0326   -8.04
fertile_mean                                            -0.1014     0.3546   -0.29
cycle_length_groups(25,30]                               0.1763     0.1444    1.22
cycle_length_groups(30,35]                               0.0921     0.1723    0.53
cycle_length_groups(35,41]                               0.1733     0.2428    0.71
includedhorm_contra                                      0.0595     0.1632    0.36
fertile                                                  0.5581     0.1877    2.97
menstruationpre:includedhorm_contra                      0.0286     0.0442    0.65
menstruationyes:includedhorm_contra                      0.0811     0.0427    1.90
cycle_length_groups(25,30]:includedhorm_contra          -0.0530     0.1765   -0.30
cycle_length_groups(30,35]:includedhorm_contra          -0.4717     0.2678   -1.76
cycle_length_groups(35,41]:includedhorm_contra          -0.3979     0.3452   -1.15
cycle_length_groups(25,30]:fertile                      -0.4064     0.2008   -2.02
cycle_length_groups(30,35]:fertile                      -0.6172     0.2361   -2.61
cycle_length_groups(35,41]:fertile                      -0.6853     0.3307   -2.07
includedhorm_contra:fertile                             -0.7761     0.2200   -3.53
cycle_length_groups(25,30]:includedhorm_contra:fertile   0.4757     0.2363    2.01
cycle_length_groups(30,35]:includedhorm_contra:fertile   0.3919     0.3681    1.06
cycle_length_groups(35,41]:includedhorm_contra:fertile   1.7007     0.4340    3.92
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-4" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">84243</td>
<td align="center">84349</td>
<td align="center">-42108</td>
<td align="center">84217</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">84243</td>
<td align="center">84366</td>
<td align="center">-42106</td>
<td align="center">84213</td>
<td align="center">3.536</td>
<td align="center">2</td>
<td align="center">0.1707</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 84268

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.041 -0.631  0.032  0.661  3.656 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.709    0.842   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          3.4897     0.2159   16.17
menstruationpre                                     -0.1093     0.0344   -3.17
menstruationyes                                     -0.2501     0.0324   -7.72
fertile_mean                                        -0.0628     0.3509   -0.18
certainty_menstruation                               0.0601     0.0492    1.22
includedhorm_contra                                 -0.2066     0.2708   -0.76
fertile                                             -0.3476     0.2816   -1.23
menstruationpre:includedhorm_contra                  0.0267     0.0442    0.61
menstruationyes:includedhorm_contra                  0.0697     0.0425    1.64
certainty_menstruation:includedhorm_contra           0.0449     0.0630    0.71
certainty_menstruation:fertile                       0.1200     0.0658    1.82
includedhorm_contra:fertile                          0.1075     0.3612    0.30
certainty_menstruation:includedhorm_contra:fertile  -0.0963     0.0834   -1.15
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-4" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84248</td>
<td align="center">84370</td>
<td align="center">-42109</td>
<td align="center">84218</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84250</td>
<td align="center">84406</td>
<td align="center">-42106</td>
<td align="center">84212</td>
<td align="center">5.381</td>
<td align="center">4</td>
<td align="center">0.2503</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 84268

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.044 -0.630  0.031  0.659  3.674 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.712    0.844   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         3.8346     0.0892    43.0
menstruationpre                                                                    -0.1098     0.0344    -3.2
menstruationyes                                                                    -0.2521     0.0324    -7.8
fertile_mean                                                                        0.0117     0.3525     0.0
cycle_regularityslightly irregular,\nup to 5 days off                              -0.2311     0.1024    -2.3
cycle_regularityirregular,\nmore than 5 days off                                   -0.1552     0.1228    -1.3
includedhorm_contra                                                                -0.0931     0.0809    -1.2
fertile                                                                             0.2538     0.0963     2.6
menstruationpre:includedhorm_contra                                                 0.0263     0.0442     0.6
menstruationyes:includedhorm_contra                                                 0.0706     0.0424     1.7
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.1228     0.1546     0.8
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.0134     0.1844     0.1
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      -0.1535     0.1325    -1.2
cycle_regularityirregular,\nmore than 5 days off:fertile                           -0.2519     0.1654    -1.5
includedhorm_contra:fertile                                                        -0.3726     0.1127    -3.3
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.0689     0.1966    -0.4
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.3187     0.2444     1.3
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-4" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84246</td>
<td align="center">84369</td>
<td align="center">-42108</td>
<td align="center">84216</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84241</td>
<td align="center">84397</td>
<td align="center">-42102</td>
<td align="center">84203</td>
<td align="center">13.26</td>
<td align="center">4</td>
<td align="center">0.01008</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 84263

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.033 -0.631  0.032  0.660  3.646 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.712    0.844   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 3.6726     0.0867    42.4
menstruationpre                                            -0.1114     0.0344    -3.2
menstruationyes                                            -0.2538     0.0324    -7.8
fertile_mean                                               -0.0185     0.3514    -0.1
cohabitationLive in same city                               0.1803     0.1164     1.5
cohabitationLong-distance                                   0.0910     0.1098     0.8
includedhorm_contra                                        -0.0833     0.0929    -0.9
fertile                                                     0.2950     0.0876     3.4
menstruationpre:includedhorm_contra                         0.0273     0.0441     0.6
menstruationyes:includedhorm_contra                         0.0718     0.0424     1.7
cohabitationLive in same city:includedhorm_contra           0.0712     0.1486     0.5
cohabitationLong-distance:includedhorm_contra               0.0497     0.1423     0.3
cohabitationLive in same city:fertile                      -0.4972     0.1586    -3.1
cohabitationLong-distance:fertile                          -0.2084     0.1429    -1.5
includedhorm_contra:fertile                                -0.4972     0.1272    -3.9
cohabitationLive in same city:includedhorm_contra:fertile   0.6720     0.1981     3.4
cohabitationLong-distance:includedhorm_contra:fertile       0.2153     0.1839     1.2
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-4" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84245</td>
<td align="center">84368</td>
<td align="center">-42107</td>
<td align="center">84215</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84249</td>
<td align="center">84404</td>
<td align="center">-42105</td>
<td align="center">84211</td>
<td align="center">4.236</td>
<td align="center">4</td>
<td align="center">0.375</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/desirability_1-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: desirability_1 ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 84261

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.053 -0.629  0.032  0.661  3.655 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.709    0.842   
 Residual             1.266    1.125   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       3.76229    0.08053    46.7
menstruationpre                                                  -0.11141    0.03442    -3.2
menstruationyes                                                  -0.25302    0.03238    -7.8
fertile_mean                                                      0.00157    0.35050     0.0
relationship_status_cleanVerheiratet                             -0.13555    0.10769    -1.3
relationship_status_cleanVerlobt                                 -0.04413    0.20364    -0.2
includedhorm_contra                                              -0.01669    0.06898    -0.2
fertile                                                           0.10845    0.07957     1.4
menstruationpre:includedhorm_contra                               0.02802    0.04414     0.6
menstruationyes:includedhorm_contra                               0.07133    0.04243     1.7
relationship_status_cleanVerheiratet:includedhorm_contra         -0.42135    0.20688    -2.0
relationship_status_cleanVerlobt:includedhorm_contra              0.03032    0.30092     0.1
relationship_status_cleanVerheiratet:fertile                      0.22504    0.14144     1.6
relationship_status_cleanVerlobt:fertile                         -0.22773    0.26187    -0.9
includedhorm_contra:fertile                                      -0.23928    0.09688    -2.5
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.37859    0.26401    -1.4
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.17049    0.40673     0.4
</code></pre>
</div>
</div>
<div id="specific-robustness-checks-for-desirability" class="section level3 tab-content">
<h3>Specific robustness checks for desirability</h3>
<p>Although desirability is associated with self esteem, sexy and showy clothes, adjusting for them only makes the effect stronger.</p>
<pre class="r"><code>summary(lmer(desirability_1 ~ self_esteem_1 + sexy_clothes + showy_clothes + included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary))</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: desirability_1 ~ self_esteem_1 + sexy_clothes + showy_clothes +  
##     included * (menstruation + fertile) + fertile_mean + (1 |      person)
##    Data: diary
## 
## REML criterion at convergence: 75262
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.826 -0.590  0.000  0.605  5.552 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.296    0.544   
##  Residual             0.918    0.958   
## Number of obs: 26549, groups:  person, 1043
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                             0.50706     0.06134  2659.00000    8.27  2.2e-16 ***
## self_esteem_1                           0.50257     0.00660 25630.00000   76.10  &lt; 2e-16 ***
## sexy_clothes                            0.32297     0.00728 26323.00000   44.35  &lt; 2e-16 ***
## showy_clothes                           0.02991     0.00611 26316.00000    4.89  1.0e-06 ***
## includedhorm_contra                    -0.01438     0.04321  1640.00000   -0.33  0.73939    
## menstruationpre                        -0.05215     0.02925 26045.00000   -1.78  0.07465 .  
## menstruationyes                        -0.14355     0.02751 26179.00000   -5.22  1.8e-07 ***
## fertile                                 0.19815     0.05929 26006.00000    3.34  0.00083 ***
## fertile_mean                           -0.10748     0.24638  1672.00000   -0.44  0.66272    
## includedhorm_contra:menstruationpre    -0.01096     0.03750 26048.00000   -0.29  0.77011    
## includedhorm_contra:menstruationyes    -0.01900     0.03603 26151.00000   -0.53  0.59806    
## includedhorm_contra:fertile            -0.32123     0.07483 26166.00000   -4.29  1.8e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) slf__1 sxy_cl shwy_c incld_ mnstrtnp mnstrtny fertil frtl_m
## self_estm_1             -0.405                                                            
## sexy_cloths             -0.151 -0.143                                                     
## showy_clths             -0.055 -0.044 -0.524                                              
## inclddhrm_c             -0.406  0.012 -0.017  0.003                                       
## menstrutnpr             -0.198  0.007  0.014  0.002  0.275                                
## menstrutnys             -0.201  0.022  0.019  0.005  0.263  0.397                         
## fertile                 -0.185  0.007  0.000  0.004  0.336  0.468    0.386                
## fertile_men             -0.662  0.009 -0.010 -0.007 -0.036 -0.007   -0.005   -0.082       
## inclddhrm_cntr:mnstrtnp  0.160 -0.008 -0.002 -0.003 -0.343 -0.780   -0.310   -0.364 -0.006
## inclddhrm_cntr:mnstrtny  0.158 -0.019 -0.008 -0.002 -0.322 -0.303   -0.763   -0.294 -0.006
## inclddhrm_cntr:f         0.183 -0.014  0.007  0.002 -0.424 -0.371   -0.305   -0.788  0.009
##                         inclddhrm_cntr:mnstrtnp inclddhrm_cntr:mnstrtny
## self_estm_1                                                            
## sexy_cloths                                                            
## showy_clths                                                            
## inclddhrm_c                                                            
## menstrutnpr                                                            
## menstrutnys                                                            
## fertile                                                                
## fertile_men                                                            
## inclddhrm_cntr:mnstrtnp                                                
## inclddhrm_cntr:mnstrtny  0.382                                         
## inclddhrm_cntr:f         0.467                   0.382</code></pre>
</div>
</div>
<div id="petting" class="section level2 tab-content">
<h2>Petting</h2>
<pre class="r"><code>model_summaries$had_petting</code></pre>
<div id="model-summary-10" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-11" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23984    24066   -11982    23964    26557 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.277 -0.499 -0.348 -0.177  5.356 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.367    0.605   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                         -1.08106    0.07023  -15.39   &lt;2e-16 ***
includedhorm_contra                  0.18663    0.05716    3.26   0.0011 ** 
menstruationpre                     -0.06238    0.04925   -1.27   0.2053    
menstruationyes                     -0.12167    0.04665   -2.61   0.0091 ** 
fertile                              0.13667    0.09787    1.40   0.1626    
fertile_mean                        -0.06740    0.32725   -0.21   0.8368    
includedhorm_contra:menstruationpre  0.00581    0.06172    0.09   0.9250    
includedhorm_contra:menstruationyes -0.03329    0.05988   -0.56   0.5782    
includedhorm_contra:fertile         -0.27152    0.12159   -2.23   0.0255 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.484                                                               
menstrutnpr             -0.274  0.342                                                        
menstrutnys             -0.256  0.321  0.377                                                 
fertile                 -0.266  0.424  0.461    0.376                                        
fertile_men             -0.759 -0.041 -0.005   -0.007   -0.100                               
inclddhrm_cntr:mnstrtnp  0.228 -0.419 -0.798   -0.301   -0.367 -0.007                        
inclddhrm_cntr:mnstrtny  0.207 -0.385 -0.294   -0.779   -0.292 -0.005  0.364                 
inclddhrm_cntr:f         0.264 -0.523 -0.371   -0.303   -0.798  0.016  0.461                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.371                 
convergence code: 0
Model failed to converge with max|grad| = 0.0376619 (tol = 0.001, component 1)
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.14 [-0.06;0.33].</p>
</div>
<div id="marginal-effect-plots-5" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-5" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-5" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-5" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-5" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-10" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-20" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-20" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-20" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-10" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-21" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-21" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-21" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-5" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-11" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-22" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-22" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-22" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-11" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-23" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-23" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-23" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-had_petting-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-5" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-5" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23928    24084   -11945    23890    26548 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.110 -0.488 -0.332 -0.170  4.771 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     0.408    0.639                     
        fertile         0.601    0.775    -0.20            
        menstruationpre 0.104    0.322    -0.22  0.75      
        menstruationyes 0.223    0.473    -0.17  0.07  0.45
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                         -1.09828    0.07411  -14.82  &lt; 2e-16 ***
includedhorm_contra                  0.19752    0.05998    3.29  0.00099 ***
menstruationpre                     -0.06347    0.05890   -1.08  0.28121    
menstruationyes                     -0.17713    0.06313   -2.81  0.00501 ** 
fertile                              0.08001    0.12041    0.66  0.50636    
fertile_mean                        -0.05808    0.34137   -0.17  0.86489    
includedhorm_contra:menstruationpre -0.00404    0.06801   -0.06  0.95260    
includedhorm_contra:menstruationyes -0.04323    0.07311   -0.59  0.55431    
includedhorm_contra:fertile         -0.26539    0.13958   -1.90  0.05726 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.491                                                               
menstrutnpr             -0.317  0.353                                                        
menstrutnys             -0.261  0.305  0.348                                                 
fertile                 -0.292  0.422  0.485    0.300                                        
fertile_men             -0.744 -0.043  0.004   -0.010   -0.108                               
inclddhrm_cntr:mnstrtnp  0.254 -0.449 -0.765   -0.278   -0.384 -0.011                        
inclddhrm_cntr:mnstrtny  0.214 -0.386 -0.279   -0.732   -0.231 -0.004  0.364                 
inclddhrm_cntr:f         0.276 -0.536 -0.383   -0.232   -0.769  0.020  0.501                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.300                 
convergence code: 0
Model failed to converge with max|grad| = 0.41568 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">23984</td>
<td align="center">24066</td>
<td align="center">-11982</td>
<td align="center">23964</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">23928</td>
<td align="center">24084</td>
<td align="center">-11945</td>
<td align="center">23890</td>
<td align="center">73.51</td>
<td align="center">9</td>
<td align="center">3.106e-12</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-5" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-5" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-5" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
   21702    21847   -10833    21666    24252 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.980 -0.497 -0.337 -0.177  5.297 

Random effects:
 Groups Name                                   Variance     Std.Dev.
 person (Intercept)                            0.3671502775 0.605929
 Xr.2   s(days_filled_out):includedhorm_contra 0.0000056452 0.002376
 Xr.1   s(days_filled_out):includedcycling     0.0891353020 0.298555
 Xr.0   s(day_number):includedhorm_contra      0.0000000229 0.000151
 Xr     s(day_number):includedcycling          0.0002352082 0.015336
Number of obs: 24270, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value    Pr(&gt;|z|)    
X(Intercept)                               -1.11299    0.07220  -15.42     &lt; 2e-16 ***
Xincludedhorm_contra                        0.16722    0.05958    2.81       0.005 ** 
Xmenstruationpre                           -0.04943    0.05148   -0.96       0.337    
Xmenstruationyes                           -0.12136    0.04987   -2.43       0.015 *  
Xfertile                                    0.11291    0.10477    1.08       0.281    
Xfertile_mean                               0.02622    0.33237    0.08       0.937    
Xincludedhorm_contra:menstruationpre        0.00577    0.06455    0.09       0.929    
Xincludedhorm_contra:menstruationyes       -0.03855    0.06400   -0.60       0.547    
Xincludedhorm_contra:fertile               -0.21730    0.13016   -1.67       0.095 .  
Xs(day_number):includedcyclingFx1           0.29993    0.07369    4.07 0.000046937 ***
Xs(day_number):includedhorm_contraFx1       0.33037    0.05847    5.65 0.000000016 ***
Xs(days_filled_out):includedcyclingFx1     -0.11005    0.15814   -0.70       0.486    
Xs(days_filled_out):includedhorm_contraFx1 -0.31355    0.06005   -5.22 0.000000177 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
had_petting ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                         -1.11299    0.07045  -15.80   &lt;2e-16 ***
includedhorm_contra                  0.16722    0.05865    2.85   0.0044 ** 
menstruationpre                     -0.04943    0.05071   -0.97   0.3297    
menstruationyes                     -0.12136    0.04916   -2.47   0.0136 *  
fertile                              0.11291    0.10292    1.10   0.2726    
fertile_mean                         0.02622    0.32485    0.08   0.9357    
includedhorm_contra:menstruationpre  0.00577    0.06359    0.09   0.9277    
includedhorm_contra:menstruationyes -0.03855    0.06313   -0.61   0.5414    
includedhorm_contra:fertile         -0.21730    0.12795   -1.70   0.0894 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq      p-value    
s(day_number):includedcycling          1.01   1.01   17.8 0.0000260594 ***
s(day_number):includedhorm_contra      1.00   1.00   33.2 0.0000000083 ***
s(days_filled_out):includedcycling     3.04   3.04   21.5 0.0000844010 ***
s(days_filled_out):includedhorm_contra 1.00   1.00   28.3 0.0000001048 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00338   
glmer.ML =  19562  Scale est. = 1         n = 24270
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-5" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-5" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_petting-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
   15891    16030    -7928    15855    17026 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.009 -0.516 -0.368 -0.192  6.239 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.321    0.567   
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                               -0.9620     0.1266   -7.60    3e-14 ***
fertile_mean                                               0.3566     0.5981    0.60    0.551    
contraceptive_methodsfertility_awareness                   0.0125     0.1832    0.07    0.946    
contraceptive_methodsnone                                 -0.2745     0.1969   -1.39    0.163    
contraceptive_methodshormonal                              0.0154     0.0901    0.17    0.865    
fertile                                                   -0.1447     0.1696   -0.85    0.394    
menstruationpre                                           -0.1081     0.0816   -1.32    0.185    
menstruationyes                                           -0.1415     0.0789   -1.79    0.073 .  
contraceptive_methodsfertility_awareness:fertile           0.2666     0.3853    0.69    0.489    
contraceptive_methodsnone:fertile                          0.2859     0.4287    0.67    0.505    
contraceptive_methodshormonal:fertile                      0.0199     0.1888    0.11    0.916    
contraceptive_methodsfertility_awareness:menstruationpre  -0.1694     0.1925   -0.88    0.379    
contraceptive_methodsnone:menstruationpre                 -0.2808     0.2195   -1.28    0.201    
contraceptive_methodshormonal:menstruationpre              0.0821     0.0917    0.90    0.371    
contraceptive_methodsfertility_awareness:menstruationyes  -0.2382     0.1973   -1.21    0.227    
contraceptive_methodsnone:menstruationyes                 -0.1147     0.2209   -0.52    0.604    
contraceptive_methodshormonal:menstruationyes             -0.0223     0.0899   -0.25    0.804    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.128336 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">15886</td>
<td align="center">15979</td>
<td align="center">-7931</td>
<td align="center">15862</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">15891</td>
<td align="center">16030</td>
<td align="center">-7928</td>
<td align="center">15855</td>
<td align="center">7.422</td>
<td align="center">6</td>
<td align="center">0.2836</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-5" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">23935</td>
<td align="center">24083</td>
<td align="center">-11950</td>
<td align="center">23899</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">23947</td>
<td align="center">24160</td>
<td align="center">-11948</td>
<td align="center">23895</td>
<td align="center">4.131</td>
<td align="center">8</td>
<td align="center">0.8451</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + age_group +  
    included + fertile + menstruation:included + age_group:included +  
    age_group:fertile + included:fertile + age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23947    24160   -11948    23895    26541 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.121 -0.502 -0.348 -0.176  5.751 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.344    0.586   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error z value       Pr(&gt;|z|)    
(Intercept)                                  -0.874286   0.131900   -6.63 0.000000000034 ***
menstruationpre                              -0.063136   0.049318   -1.28        0.20048    
menstruationyes                              -0.121914   0.046717   -2.61        0.00906 ** 
fertile_mean                                 -0.096405   0.323388   -0.30        0.76562    
age_group(20,25]                             -0.066751   0.136910   -0.49        0.62587    
age_group(25,30]                             -0.111641   0.141860   -0.79        0.43130    
age_group(30,35]                             -0.380626   0.168211   -2.26        0.02365 *  
age_group(35,70]                             -0.596174   0.154086   -3.87        0.00011 ***
includedhorm_contra                           0.193939   0.138420    1.40        0.16119    
fertile                                      -0.004144   0.269216   -0.02        0.98772    
menstruationpre:includedhorm_contra           0.003738   0.061783    0.06        0.95175    
menstruationyes:includedhorm_contra          -0.035578   0.059938   -0.59        0.55279    
age_group(20,25]:includedhorm_contra         -0.125124   0.155042   -0.81        0.41965    
age_group(25,30]:includedhorm_contra         -0.299477   0.173322   -1.73        0.08401 .  
age_group(30,35]:includedhorm_contra         -0.177660   0.232330   -0.76        0.44446    
age_group(35,70]:includedhorm_contra         -0.164851   0.273156   -0.60        0.54617    
age_group(20,25]:fertile                      0.168725   0.296204    0.57        0.56893    
age_group(25,30]:fertile                      0.128793   0.307120    0.42        0.67496    
age_group(30,35]:fertile                      0.292852   0.369530    0.79        0.42807    
age_group(35,70]:fertile                      0.050321   0.349177    0.14        0.88541    
includedhorm_contra:fertile                  -0.272669   0.296471   -0.92        0.35772    
age_group(20,25]:includedhorm_contra:fertile -0.003892   0.330230   -0.01        0.99060    
age_group(25,30]:includedhorm_contra:fertile  0.236151   0.370455    0.64        0.52382    
age_group(30,35]:includedhorm_contra:fertile -0.237594   0.516034   -0.46        0.64521    
age_group(35,70]:includedhorm_contra:fertile  0.000318   0.639450    0.00        0.99960    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0561776 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-5" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">23738</td>
<td align="center">23836</td>
<td align="center">-11857</td>
<td align="center">23714</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">23740</td>
<td align="center">23855</td>
<td align="center">-11856</td>
<td align="center">23712</td>
<td align="center">1.585</td>
<td align="center">2</td>
<td align="center">0.4527</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + weekend +  
    included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23740    23855   -11856    23712    26553 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.258 -0.496 -0.337 -0.167  5.861 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.376    0.614   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value     Pr(&gt;|z|)    
(Intercept)                             -1.19369    0.07359  -16.22      &lt; 2e-16 ***
menstruationpre                         -0.06674    0.04952   -1.35       0.1778    
menstruationyes                         -0.12466    0.04683   -2.66       0.0078 ** 
fertile_mean                            -0.04763    0.33118   -0.14       0.8856    
weekendTRUE                              0.24947    0.04298    5.80 0.0000000065 ***
includedhorm_contra                      0.16483    0.06260    2.63       0.0085 ** 
fertile                                  0.07660    0.12376    0.62       0.5360    
menstruationpre:includedhorm_contra      0.00652    0.06207    0.11       0.9163    
menstruationyes:includedhorm_contra     -0.03039    0.06017   -0.51       0.6135    
weekendTRUE:includedhorm_contra          0.05583    0.05404    1.03       0.3016    
weekendTRUE:fertile                      0.11037    0.16447    0.67       0.5022    
includedhorm_contra:fertile             -0.28264    0.15495   -1.82       0.0681 .  
weekendTRUE:includedhorm_contra:fertile  0.02064    0.20582    0.10       0.9201    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0104775 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-5" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">23532</td>
<td align="center">23713</td>
<td align="center">-11744</td>
<td align="center">23488</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">23547</td>
<td align="center">23826</td>
<td align="center">-11740</td>
<td align="center">23479</td>
<td align="center">9.199</td>
<td align="center">12</td>
<td align="center">0.6858</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + weekday +  
    included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23547    23826   -11740    23479    26533 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.536 -0.490 -0.327 -0.161  6.507 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.386    0.621   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept)                                  -0.97601    0.08683  -11.24   &lt; 2e-16 ***
menstruationpre                              -0.06937    0.04982   -1.39    0.1638    
menstruationyes                              -0.12845    0.04708   -2.73    0.0064 ** 
fertile_mean                                 -0.06400    0.33502   -0.19    0.8485    
weekdayTuesday                               -0.33121    0.07979   -4.15 0.0000331 ***
weekdayWednesday                             -0.37275    0.08049   -4.63 0.0000036 ***
weekdayThursday                              -0.20365    0.07909   -2.57    0.0100 *  
weekdayFriday                                -0.17843    0.07963   -2.24    0.0250 *  
weekdaySaturday                               0.11349    0.07705    1.47    0.1408    
weekdaySunday                                 0.13998    0.07407    1.89    0.0588 .  
includedhorm_contra                           0.20426    0.08432    2.42    0.0154 *  
fertile                                      -0.09775    0.21492   -0.45    0.6492    
menstruationpre:includedhorm_contra           0.00899    0.06248    0.14    0.8855    
menstruationyes:includedhorm_contra          -0.02329    0.06051   -0.38    0.7003    
weekdayTuesday:includedhorm_contra           -0.10447    0.10073   -1.04    0.2997    
weekdayWednesday:includedhorm_contra          0.01138    0.10128    0.11    0.9106    
weekdayThursday:includedhorm_contra          -0.08890    0.09979   -0.89    0.3730    
weekdayFriday:includedhorm_contra            -0.00125    0.09972   -0.01    0.9900    
weekdaySaturday:includedhorm_contra          -0.04113    0.09689   -0.42    0.6712    
weekdaySunday:includedhorm_contra             0.07915    0.09309    0.85    0.3952    
weekdayTuesday:fertile                        0.28582    0.30649    0.93    0.3511    
weekdayWednesday:fertile                      0.40756    0.30975    1.32    0.1882    
weekdayThursday:fertile                       0.05872    0.31174    0.19    0.8506    
weekdayFriday:fertile                         0.44806    0.30287    1.48    0.1390    
weekdaySaturday:fertile                       0.02169    0.29901    0.07    0.9422    
weekdaySunday:fertile                         0.40139    0.28612    1.40    0.1607    
includedhorm_contra:fertile                  -0.28738    0.26981   -1.07    0.2868    
weekdayTuesday:includedhorm_contra:fertile    0.02881    0.38714    0.07    0.9407    
weekdayWednesday:includedhorm_contra:fertile -0.25191    0.39184   -0.64    0.5203    
weekdayThursday:includedhorm_contra:fertile   0.27546    0.38934    0.71    0.4793    
weekdayFriday:includedhorm_contra:fertile    -0.06407    0.37939   -0.17    0.8659    
weekdaySaturday:includedhorm_contra:fertile   0.21888    0.37423    0.58    0.5586    
weekdaySunday:includedhorm_contra:fertile    -0.07679    0.35896   -0.21    0.8306    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0552067 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-5" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">23990</td>
<td align="center">24121</td>
<td align="center">-11979</td>
<td align="center">23958</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">23998</td>
<td align="center">24178</td>
<td align="center">-11977</td>
<td align="center">23954</td>
<td align="center">4.421</td>
<td align="center">6</td>
<td align="center">0.6199</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + included_levels +  
    included + fertile + menstruation:included + included_levels:included +  
    included_levels:fertile + included:fertile + included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23998    24178   -11977    23954    26545 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.324 -0.499 -0.347 -0.177  5.280 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.366    0.605   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                             -1.13203    0.07852  -14.42   &lt;2e-16 ***
menstruationpre                                         -0.06609    0.04930   -1.34    0.180    
menstruationyes                                         -0.12021    0.04667   -2.58    0.010 *  
fertile_mean                                            -0.08464    0.33359   -0.25    0.800    
included_levelslax                                       0.21984    0.13888    1.58    0.113    
included_levelsconservative                              0.13551    0.11033    1.23    0.219    
included_levelsstrict                                    0.06644    0.10954    0.61    0.544    
includedhorm_contra                                      0.18948    0.08050    2.35    0.019 *  
fertile                                                  0.19389    0.12603    1.54    0.124    
menstruationpre:includedhorm_contra                      0.00911    0.06181    0.15    0.883    
menstruationyes:includedhorm_contra                     -0.03549    0.05995   -0.59    0.554    
included_levelslax:includedhorm_contra                  -0.24863    0.17084   -1.46    0.146    
included_levelsconservative:includedhorm_contra          0.02052    0.13843    0.15    0.882    
included_levelsstrict:includedhorm_contra               -0.00641    0.13521   -0.05    0.962    
included_levelslax:fertile                              -0.45165    0.30484   -1.48    0.138    
included_levelsconservative:fertile                     -0.10800    0.22153   -0.49    0.626    
included_levelsstrict:fertile                            0.02119    0.22439    0.09    0.925    
includedhorm_contra:fertile                             -0.30980    0.18684   -1.66    0.097 .  
included_levelslax:includedhorm_contra:fertile           0.55695    0.36673    1.52    0.129    
included_levelsconservative:includedhorm_contra:fertile -0.03787    0.28538   -0.13    0.894    
included_levelsstrict:includedhorm_contra:fertile       -0.00944    0.28407   -0.03    0.974    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.072295 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-5" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">23994</td>
<td align="center">24125</td>
<td align="center">-11981</td>
<td align="center">23962</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">24004</td>
<td align="center">24184</td>
<td align="center">-11980</td>
<td align="center">23960</td>
<td align="center">1.922</td>
<td align="center">6</td>
<td align="center">0.9267</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-cycle_length-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + cycle_length_groups +  
    included + fertile + menstruation:included + cycle_length_groups:included +  
    cycle_length_groups:fertile + included:fertile + cycle_length_groups:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   24004    24184   -11980    23960    26545 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.279 -0.499 -0.348 -0.177  5.364 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.367    0.606   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                            -1.22414    0.13370   -9.16   &lt;2e-16 ***
menstruationpre                                        -0.06198    0.04933   -1.26   0.2090    
menstruationyes                                        -0.12111    0.04698   -2.58   0.0099 ** 
fertile_mean                                           -0.06229    0.33190   -0.19   0.8511    
cycle_length_groups(25,30]                              0.15348    0.12993    1.18   0.2375    
cycle_length_groups(30,35]                              0.18044    0.15254    1.18   0.2368    
cycle_length_groups(35,41]                              0.15120    0.21009    0.72   0.4717    
includedhorm_contra                                     0.30776    0.14601    2.11   0.0350 *  
fertile                                                 0.08400    0.28335    0.30   0.7669    
menstruationpre:includedhorm_contra                     0.00526    0.06180    0.09   0.9322    
menstruationyes:includedhorm_contra                    -0.03407    0.06023   -0.57   0.5716    
cycle_length_groups(25,30]:includedhorm_contra         -0.12364    0.15544   -0.80   0.4264    
cycle_length_groups(30,35]:includedhorm_contra         -0.19274    0.22902   -0.84   0.4000    
cycle_length_groups(35,41]:includedhorm_contra         -0.17046    0.28888   -0.59   0.5551    
cycle_length_groups(25,30]:fertile                      0.07411    0.30028    0.25   0.8051    
cycle_length_groups(30,35]:fertile                     -0.11432    0.34702   -0.33   0.7418    
cycle_length_groups(35,41]:fertile                      0.40568    0.46160    0.88   0.3795    
includedhorm_contra:fertile                            -0.21150    0.32424   -0.65   0.5142    
cycle_length_groups(25,30]:includedhorm_contra:fertile -0.09050    0.34549   -0.26   0.7934    
cycle_length_groups(30,35]:includedhorm_contra:fertile  0.09383    0.51959    0.18   0.8567    
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.24755    0.59303   -0.42   0.6764    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.049217 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-5" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">23987</td>
<td align="center">24085</td>
<td align="center">-11981</td>
<td align="center">23963</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">23989</td>
<td align="center">24103</td>
<td align="center">-11980</td>
<td align="center">23961</td>
<td align="center">2.315</td>
<td align="center">2</td>
<td align="center">0.3142</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + certainty_menstruation +  
    included + fertile + menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23989    24103   -11980    23961    26553 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.245 -0.500 -0.347 -0.177  5.270 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.367    0.606   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept)                                        -0.88426    0.18473   -4.79 0.0000017 ***
menstruationpre                                    -0.05978    0.04926   -1.21      0.22    
menstruationyes                                    -0.11952    0.04671   -2.56      0.01 *  
fertile_mean                                       -0.07138    0.32893   -0.22      0.83    
certainty_menstruation                             -0.04818    0.04211   -1.14      0.25    
includedhorm_contra                                -0.14950    0.23072   -0.65      0.52    
fertile                                            -0.27818    0.39513   -0.70      0.48    
menstruationpre:includedhorm_contra                 0.00406    0.06174    0.07      0.95    
menstruationyes:includedhorm_contra                -0.03564    0.05994   -0.59      0.55    
certainty_menstruation:includedhorm_contra          0.08098    0.05359    1.51      0.13    
certainty_menstruation:fertile                      0.10077    0.09254    1.09      0.28    
includedhorm_contra:fertile                         0.44469    0.50123    0.89      0.37    
certainty_menstruation:includedhorm_contra:fertile -0.17064    0.11592   -1.47      0.14    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.121403 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-5" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">23991</td>
<td align="center">24106</td>
<td align="center">-11982</td>
<td align="center">23963</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">23998</td>
<td align="center">24145</td>
<td align="center">-11981</td>
<td align="center">23962</td>
<td align="center">1.489</td>
<td align="center">4</td>
<td align="center">0.8286</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + cycle_regularity +  
    included + fertile + menstruation:included + cycle_regularity:included +  
    cycle_regularity:fertile + included:fertile + cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23998    24145   -11981    23962    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.294 -0.499 -0.348 -0.177  5.387 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.366    0.605   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                       -1.06435    0.08201  -12.98
menstruationpre                                                                   -0.06434    0.04928   -1.31
menstruationyes                                                                   -0.12350    0.04668   -2.65
fertile_mean                                                                      -0.06075    0.32916   -0.18
cycle_regularityslightly irregular,\nup to 5 days off                             -0.01682    0.08784   -0.19
cycle_regularityirregular,\nmore than 5 days off                                  -0.06099    0.10734   -0.57
includedhorm_contra                                                                0.16592    0.07305    2.27
fertile                                                                            0.07399    0.13769    0.54
menstruationpre:includedhorm_contra                                                0.00792    0.06175    0.13
menstruationyes:includedhorm_contra                                               -0.03162    0.05992   -0.53
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.08256    0.12977    0.64
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.01113    0.15670    0.07
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.03879    0.18647    0.21
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.23638    0.23050    1.03
includedhorm_contra:fertile                                                       -0.22091    0.15860   -1.39
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.02031    0.27097   -0.07
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.09255    0.33251   -0.28
                                                                                  Pr(&gt;|z|)    
(Intercept)                                                                         &lt;2e-16 ***
menstruationpre                                                                     0.1917    
menstruationyes                                                                     0.0081 ** 
fertile_mean                                                                        0.8536    
cycle_regularityslightly irregular,\nup to 5 days off                               0.8482    
cycle_regularityirregular,\nmore than 5 days off                                    0.5699    
includedhorm_contra                                                                 0.0231 *  
fertile                                                                             0.5910    
menstruationpre:includedhorm_contra                                                 0.8979    
menstruationyes:includedhorm_contra                                                 0.5976    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.5246    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.9434    
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.8352    
cycle_regularityirregular,\nmore than 5 days off:fertile                            0.3051    
includedhorm_contra:fertile                                                         0.1637    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile   0.9403    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.7808    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0464108 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-5" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">23947</td>
<td align="center">24061</td>
<td align="center">-11959</td>
<td align="center">23919</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">23954</td>
<td align="center">24102</td>
<td align="center">-11959</td>
<td align="center">23918</td>
<td align="center">0.6636</td>
<td align="center">4</td>
<td align="center">0.9557</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + cohabitation +  
    included + fertile + menstruation:included + cohabitation:included +  
    cohabitation:fertile + included:fertile + cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23954    24102   -11959    23918    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.182 -0.498 -0.349 -0.175  5.250 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.345    0.587   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                               -1.15129    0.07884  -14.60  &lt; 2e-16 ***
menstruationpre                                           -0.06298    0.04922   -1.28  0.20072    
menstruationyes                                           -0.12236    0.04664   -2.62  0.00870 ** 
fertile_mean                                              -0.08770    0.32243   -0.27  0.78563    
cohabitationLive in same city                              0.32647    0.09649    3.38  0.00072 ***
cohabitationLong-distance                                  0.02027    0.09397    0.22  0.82920    
includedhorm_contra                                        0.07350    0.08221    0.89  0.37131    
fertile                                                    0.18780    0.12484    1.50  0.13249    
menstruationpre:includedhorm_contra                        0.00293    0.06171    0.05  0.96212    
menstruationyes:includedhorm_contra                       -0.03570    0.05986   -0.60  0.55089    
cohabitationLive in same city:includedhorm_contra          0.07083    0.12317    0.58  0.56528    
cohabitationLong-distance:includedhorm_contra              0.13346    0.12050    1.11  0.26806    
cohabitationLive in same city:fertile                     -0.09085    0.20966   -0.43  0.66477    
cohabitationLong-distance:fertile                         -0.11766    0.20574   -0.57  0.56740    
includedhorm_contra:fertile                               -0.36127    0.18250   -1.98  0.04776 *  
cohabitationLive in same city:includedhorm_contra:fertile  0.10826    0.26627    0.41  0.68432    
cohabitationLong-distance:includedhorm_contra:fertile      0.18589    0.26308    0.71  0.47982    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0291875 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-5" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">23952</td>
<td align="center">24067</td>
<td align="center">-11962</td>
<td align="center">23924</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">23956</td>
<td align="center">24103</td>
<td align="center">-11960</td>
<td align="center">23920</td>
<td align="center">4.264</td>
<td align="center">4</td>
<td align="center">0.3715</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_petting-rel_status-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_petting ~ menstruation + fertile_mean + (1 | person) + relationship_status_clean +  
    included + fertile + menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   23956    24103   -11960    23920    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.286 -0.500 -0.348 -0.179  5.328 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.351    0.592   
Number of obs: 26567, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                      -0.97941    0.07260  -13.49  &lt; 2e-16 ***
menstruationpre                                                  -0.06337    0.04926   -1.29   0.1983    
menstruationyes                                                  -0.12518    0.04667   -2.68   0.0073 ** 
fertile_mean                                                     -0.03098    0.32401   -0.10   0.9238    
relationship_status_cleanVerheiratet                             -0.39777    0.09610   -4.14 0.000035 ***
relationship_status_cleanVerlobt                                 -0.29925    0.17231   -1.74   0.0824 .  
includedhorm_contra                                               0.11380    0.06168    1.85   0.0650 .  
fertile                                                           0.09573    0.10924    0.88   0.3809    
menstruationpre:includedhorm_contra                               0.00513    0.06174    0.08   0.9337    
menstruationyes:includedhorm_contra                              -0.02979    0.05989   -0.50   0.6189    
relationship_status_cleanVerheiratet:includedhorm_contra         -0.30108    0.18693   -1.61   0.1073    
relationship_status_cleanVerlobt:includedhorm_contra              0.14831    0.25840    0.57   0.5660    
relationship_status_cleanVerheiratet:fertile                      0.01382    0.21449    0.06   0.9486    
relationship_status_cleanVerlobt:fertile                          0.65588    0.35874    1.83   0.0675 .  
includedhorm_contra:fertile                                      -0.24751    0.13171   -1.88   0.0602 .  
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  0.34187    0.42533    0.80   0.4215    
relationship_status_cleanVerlobt:includedhorm_contra:fertile     -0.47060    0.57864   -0.81   0.4160    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.108505 (tol = 0.001, component 1)
</code></pre>
</div>
</div>
</div>
<div id="sexual-intercourse" class="section level2 tab-content">
<h2>Sexual intercourse</h2>
<pre class="r"><code>model_summaries$had_sexual_intercourse</code></pre>
<div id="model-summary-12" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-13" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25595    25677   -12788    25575    26558 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.639 -0.546 -0.376 -0.187  6.316 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.31     0.557   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value   Pr(&gt;|z|)    
(Intercept)                          -1.0246     0.0656  -15.62    &lt; 2e-16 ***
includedhorm_contra                   0.2678     0.0536    5.00 0.00000058 ***
menstruationpre                      -0.0193     0.0471   -0.41    0.68157    
menstruationyes                      -0.4100     0.0479   -8.57    &lt; 2e-16 ***
fertile                               0.1144     0.0951    1.20    0.22930    
fertile_mean                          0.4204     0.3041    1.38    0.16688    
includedhorm_contra:menstruationpre  -0.0713     0.0588   -1.21    0.22549    
includedhorm_contra:menstruationyes  -0.2139     0.0622   -3.44    0.00059 ***
includedhorm_contra:fertile          -0.3426     0.1175   -2.92    0.00355 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.488                                                               
menstrutnpr             -0.288  0.357                                                        
menstrutnys             -0.245  0.306  0.358                                                 
fertile                 -0.279  0.439  0.472    0.356                                        
fertile_men             -0.757 -0.043 -0.005   -0.005   -0.101                               
inclddhrm_cntr:mnstrtnp  0.239 -0.434 -0.800   -0.287   -0.376 -0.007                        
inclddhrm_cntr:mnstrtny  0.198 -0.362 -0.276   -0.768   -0.274 -0.006  0.339                 
inclddhrm_cntr:f         0.279 -0.539 -0.382   -0.288   -0.803  0.013  0.469                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.346                 
convergence code: 0
Model failed to converge with max|grad| = 0.010743 (tol = 0.001, component 1)
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.11 [-0.07;0.30].</p>
</div>
<div id="marginal-effect-plots-6" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-6" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-6" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-6" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-6" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-12" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-24" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-24" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-24" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-12" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-25" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-25" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-25" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-6" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-13" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-26" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-26" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-26" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-13" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-27" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-27" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-27" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-had_sexual_intercourse-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-6" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-6" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25553    25708   -12757    25515    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.427 -0.542 -0.366 -0.158  4.832 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     0.3341   0.578                     
        fertile         0.2739   0.523    -0.25            
        menstruationpre 0.0662   0.257    -0.24  0.97      
        menstruationyes 0.2650   0.515     0.06 -0.06  0.08
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                          -1.0295     0.0678  -15.19  &lt; 2e-16 ***
includedhorm_contra                   0.2769     0.0553    5.01  5.4e-07 ***
menstruationpre                      -0.0218     0.0531   -0.41   0.6807    
menstruationyes                      -0.5540     0.0709   -7.82  5.5e-15 ***
fertile                               0.1204     0.1066    1.13   0.2584    
fertile_mean                          0.3808     0.3109    1.22   0.2206    
includedhorm_contra:menstruationpre  -0.0675     0.0631   -1.07   0.2847    
includedhorm_contra:menstruationyes  -0.2313     0.0790   -2.93   0.0034 ** 
includedhorm_contra:fertile          -0.3494     0.1263   -2.77   0.0057 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.495                                                               
menstrutnpr             -0.325  0.372                                                        
menstrutnys             -0.174  0.212  0.251                                                 
fertile                 -0.311  0.455  0.502    0.244                                        
fertile_men             -0.747 -0.042  0.007   -0.010   -0.104                               
inclddhrm_cntr:mnstrtnp  0.266 -0.464 -0.790   -0.202   -0.403 -0.014                        
inclddhrm_cntr:mnstrtny  0.155 -0.273 -0.213   -0.675   -0.203 -0.004  0.269                 
inclddhrm_cntr:f         0.300 -0.567 -0.406   -0.194   -0.787  0.013  0.516                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.257                 
convergence code: 0
Model failed to converge with max|grad| = 0.655201 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="22%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">25595</td>
<td align="center">25677</td>
<td align="center">-12788</td>
<td align="center">25575</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">25553</td>
<td align="center">25708</td>
<td align="center">-12757</td>
<td align="center">25515</td>
<td align="center">60.45</td>
<td align="center">9</td>
<td align="center">0.000000001096</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-6" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-6" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-6" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
   22979    23125   -11472    22943    24253 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.499 -0.535 -0.366 -0.187  6.563 

Random effects:
 Groups Name                                   Variance    Std.Dev.
 person (Intercept)                            0.308100809 0.555068
 Xr.2   s(days_filled_out):includedhorm_contra 0.224315547 0.473620
 Xr.1   s(days_filled_out):includedcycling     0.000008902 0.002984
 Xr.0   s(day_number):includedhorm_contra      0.290115573 0.538624
 Xr     s(day_number):includedcycling          0.000000131 0.000363
Number of obs: 24271, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value  Pr(&gt;|z|)    
X(Intercept)                               -1.08444    0.06737  -16.10   &lt; 2e-16 ***
Xincludedhorm_contra                        0.24568    0.05586    4.40 0.0000109 ***
Xmenstruationpre                           -0.00853    0.04943   -0.17   0.86304    
Xmenstruationyes                           -0.43417    0.05179   -8.38   &lt; 2e-16 ***
Xfertile                                    0.08855    0.10222    0.87   0.38637    
Xfertile_mean                               0.54425    0.30814    1.77   0.07735 .  
Xincludedhorm_contra:menstruationpre       -0.05251    0.06180   -0.85   0.39556    
Xincludedhorm_contra:menstruationyes       -0.18547    0.06723   -2.76   0.00580 ** 
Xincludedhorm_contra:fertile               -0.26986    0.12615   -2.14   0.03242 *  
Xs(day_number):includedcyclingFx1           0.30620    0.06901    4.44 0.0000091 ***
Xs(day_number):includedhorm_contraFx1       0.79923    0.27162    2.94   0.00326 ** 
Xs(days_filled_out):includedcyclingFx1     -0.27416    0.07126   -3.85   0.00012 ***
Xs(days_filled_out):includedhorm_contraFx1 -0.55695    0.18614   -2.99   0.00277 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
had_sexual_intercourse ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                         -1.08444    0.06586  -16.47  &lt; 2e-16 ***
includedhorm_contra                  0.24568    0.05502    4.47 0.000008 ***
menstruationpre                     -0.00853    0.04859   -0.18   0.8607    
menstruationyes                     -0.43417    0.05119   -8.48  &lt; 2e-16 ***
fertile                              0.08855    0.10027    0.88   0.3772    
fertile_mean                         0.54425    0.30134    1.81   0.0709 .  
includedhorm_contra:menstruationpre -0.05251    0.06079   -0.86   0.3877    
includedhorm_contra:menstruationyes -0.18547    0.06653   -2.79   0.0053 ** 
includedhorm_contra:fertile         -0.26986    0.12385   -2.18   0.0293 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq p-value    
s(day_number):includedcycling          1.00   1.00   20.6 5.8e-06 ***
s(day_number):includedhorm_contra      4.24   4.24   62.0 2.3e-12 ***
s(days_filled_out):includedcycling     1.00   1.00   15.4 8.6e-05 ***
s(days_filled_out):includedhorm_contra 3.82   3.82   60.2 4.0e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.0162   
glmer.ML =  20904  Scale est. = 1         n = 24271
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-6" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-6" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
   16493    16632    -8228    16457    17026 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.091 -0.552 -0.389 -0.184  6.451 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.243    0.493   
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                               -0.8688     0.1144   -7.60  3.0e-14 ***
fertile_mean                                               0.0768     0.5337    0.14   0.8856    
contraceptive_methodsfertility_awareness                  -0.0213     0.1665   -0.13   0.8982    
contraceptive_methodsnone                                 -0.6270     0.1987   -3.15   0.0016 ** 
contraceptive_methodshormonal                              0.1374     0.0833    1.65   0.0990 .  
fertile                                                   -0.0633     0.1689   -0.37   0.7080    
menstruationpre                                           -0.0473     0.0799   -0.59   0.5538    
menstruationyes                                           -0.5078     0.0847   -5.99  2.1e-09 ***
contraceptive_methodsfertility_awareness:fertile           0.3632     0.3700    0.98   0.3263    
contraceptive_methodsnone:fertile                          0.4952     0.4772    1.04   0.2994    
contraceptive_methodshormonal:fertile                     -0.1253     0.1868   -0.67   0.5025    
contraceptive_methodsfertility_awareness:menstruationpre   0.0726     0.1767    0.41   0.6809    
contraceptive_methodsnone:menstruationpre                  0.0555     0.2227    0.25   0.8033    
contraceptive_methodshormonal:menstruationpre             -0.0126     0.0893   -0.14   0.8883    
contraceptive_methodsfertility_awareness:menstruationyes   0.2861     0.1860    1.54   0.1241    
contraceptive_methodsnone:menstruationyes                 -0.2610     0.3173   -0.82   0.4107    
contraceptive_methodshormonal:menstruationyes             -0.1414     0.0967   -1.46   0.1435    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.153005 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">16486</td>
<td align="center">16579</td>
<td align="center">-8231</td>
<td align="center">16462</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">16493</td>
<td align="center">16632</td>
<td align="center">-8228</td>
<td align="center">16457</td>
<td align="center">5.269</td>
<td align="center">6</td>
<td align="center">0.5098</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-6" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">25593</td>
<td align="center">25740</td>
<td align="center">-12778</td>
<td align="center">25557</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">25595</td>
<td align="center">25808</td>
<td align="center">-12772</td>
<td align="center">25543</td>
<td align="center">13.17</td>
<td align="center">8</td>
<td align="center">0.1062</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25595    25808   -12772    25543    26542 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.978 -0.544 -0.378 -0.180  6.029 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.303    0.551   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                  -1.12625    0.13085   -8.61  &lt; 2e-16 ***
menstruationpre                              -0.01756    0.04709   -0.37  0.70925    
menstruationyes                              -0.41204    0.04790   -8.60  &lt; 2e-16 ***
fertile_mean                                  0.43218    0.30292    1.43  0.15367    
age_group(20,25]                              0.10952    0.13618    0.80  0.42126    
age_group(25,30]                              0.23870    0.13974    1.71  0.08762 .  
age_group(30,35]                              0.00894    0.16152    0.06  0.95584    
age_group(35,70]                             -0.00752    0.14767   -0.05  0.95938    
includedhorm_contra                           0.42440    0.13711    3.10  0.00197 ** 
fertile                                      -0.06959    0.29504   -0.24  0.81353    
menstruationpre:includedhorm_contra          -0.07492    0.05884   -1.27  0.20292    
menstruationyes:includedhorm_contra          -0.21422    0.06226   -3.44  0.00058 ***
age_group(20,25]:includedhorm_contra         -0.13722    0.15288   -0.90  0.36940    
age_group(25,30]:includedhorm_contra         -0.34852    0.16802   -2.07  0.03806 *  
age_group(30,35]:includedhorm_contra         -0.19935    0.21915   -0.91  0.36302    
age_group(35,70]:includedhorm_contra         -0.70538    0.26083   -2.70  0.00684 ** 
age_group(20,25]:fertile                      0.07749    0.32171    0.24  0.80965    
age_group(25,30]:fertile                      0.10564    0.32683    0.32  0.74652    
age_group(30,35]:fertile                      0.63744    0.37428    1.70  0.08855 .  
age_group(35,70]:fertile                      0.28490    0.34770    0.82  0.41257    
includedhorm_contra:fertile                  -0.18740    0.31915   -0.59  0.55708    
age_group(20,25]:includedhorm_contra:fertile -0.06298    0.35193   -0.18  0.85798    
age_group(25,30]:includedhorm_contra:fertile  0.03446    0.38099    0.09  0.92794    
age_group(30,35]:includedhorm_contra:fertile -1.14419    0.50479   -2.27  0.02341 *  
age_group(35,70]:includedhorm_contra:fertile  0.68564    0.57980    1.18  0.23699    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.175868 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-6" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">25320</td>
<td align="center">25418</td>
<td align="center">-12648</td>
<td align="center">25296</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">25323</td>
<td align="center">25437</td>
<td align="center">-12647</td>
<td align="center">25295</td>
<td align="center">0.7628</td>
<td align="center">2</td>
<td align="center">0.6829</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25323    25437   -12647    25295    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.737 -0.536 -0.363 -0.165  6.164 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.32     0.566   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value      Pr(&gt;|z|)    
(Intercept)                              -1.1398     0.0689  -16.53       &lt; 2e-16 ***
menstruationpre                          -0.0226     0.0473   -0.48        0.6322    
menstruationyes                          -0.4197     0.0482   -8.72       &lt; 2e-16 ***
fertile_mean                              0.4336     0.3074    1.41        0.1584    
weekendTRUE                               0.2641     0.0422    6.26 0.00000000038 ***
includedhorm_contra                       0.2352     0.0590    3.99 0.00006743879 ***
fertile                                   0.0456     0.1201    0.38        0.7039    
menstruationpre:includedhorm_contra      -0.0722     0.0592   -1.22        0.2225    
menstruationyes:includedhorm_contra      -0.2079     0.0626   -3.32        0.0009 ***
weekendTRUE:includedhorm_contra           0.0756     0.0529    1.43        0.1531    
weekendTRUE:fertile                       0.1247     0.1599    0.78        0.4356    
includedhorm_contra:fertile              -0.2611     0.1490   -1.75        0.0799 .  
weekendTRUE:includedhorm_contra:fertile  -0.1692     0.1993   -0.85        0.3957    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0268182 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-6" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">25120</td>
<td align="center">25300</td>
<td align="center">-12538</td>
<td align="center">25076</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">25136</td>
<td align="center">25414</td>
<td align="center">-12534</td>
<td align="center">25068</td>
<td align="center">7.823</td>
<td align="center">12</td>
<td align="center">0.7988</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25136    25414   -12534    25068    26534 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.106 -0.531 -0.353 -0.154  5.995 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.328    0.572   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                   -0.9397     0.0823  -11.42  &lt; 2e-16 ***
menstruationpre                               -0.0181     0.0475   -0.38  0.70356    
menstruationyes                               -0.4209     0.0484   -8.70  &lt; 2e-16 ***
fertile_mean                                   0.4390     0.3104    1.41  0.15725    
weekdayTuesday                                -0.2770     0.0776   -3.57  0.00036 ***
weekdayWednesday                              -0.2987     0.0780   -3.83  0.00013 ***
weekdayThursday                               -0.2854     0.0788   -3.62  0.00029 ***
weekdayFriday                                 -0.1601     0.0781   -2.05  0.04029 *  
weekdaySaturday                                0.1477     0.0757    1.95  0.05101 .  
weekdaySunday                                  0.1636     0.0729    2.24  0.02483 *  
includedhorm_contra                            0.2618     0.0811    3.23  0.00125 ** 
fertile                                       -0.0239     0.2080   -0.11  0.90859    
menstruationpre:includedhorm_contra           -0.0768     0.0595   -1.29  0.19679    
menstruationyes:includedhorm_contra           -0.2052     0.0629   -3.26  0.00111 ** 
weekdayTuesday:includedhorm_contra            -0.1024     0.0979   -1.05  0.29592    
weekdayWednesday:includedhorm_contra          -0.0383     0.0985   -0.39  0.69750    
weekdayThursday:includedhorm_contra            0.0485     0.0988    0.49  0.62342    
weekdayFriday:includedhorm_contra              0.0392     0.0977    0.40  0.68830    
weekdaySaturday:includedhorm_contra            0.0547     0.0950    0.58  0.56507    
weekdaySunday:includedhorm_contra              0.0685     0.0918    0.75  0.45580    
weekdayTuesday:fertile                         0.0302     0.2972    0.10  0.91907    
weekdayWednesday:fertile                       0.1527     0.2990    0.51  0.60947    
weekdayThursday:fertile                        0.1527     0.3041    0.50  0.61569    
weekdayFriday:fertile                          0.3897     0.2934    1.33  0.18407    
weekdaySaturday:fertile                       -0.0225     0.2895   -0.08  0.93814    
weekdaySunday:fertile                          0.2728     0.2799    0.97  0.32965    
includedhorm_contra:fertile                   -0.2475     0.2596   -0.95  0.34032    
weekdayTuesday:includedhorm_contra:fertile     0.2337     0.3717    0.63  0.52949    
weekdayWednesday:includedhorm_contra:fertile  -0.2278     0.3771   -0.60  0.54583    
weekdayThursday:includedhorm_contra:fertile   -0.0848     0.3774   -0.22  0.82213    
weekdayFriday:includedhorm_contra:fertile     -0.2841     0.3660   -0.78  0.43760    
weekdaySaturday:includedhorm_contra:fertile   -0.1401     0.3613   -0.39  0.69830    
weekdaySunday:includedhorm_contra:fertile     -0.1664     0.3498   -0.48  0.63426    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.214847 (tol = 0.001, component 1)
failure to converge in 10000 evaluations
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-6" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">25598</td>
<td align="center">25729</td>
<td align="center">-12783</td>
<td align="center">25566</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">25608</td>
<td align="center">25788</td>
<td align="center">-12782</td>
<td align="center">25564</td>
<td align="center">1.481</td>
<td align="center">6</td>
<td align="center">0.9607</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25608    25788   -12782    25564    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.656 -0.546 -0.376 -0.186  6.189 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.304    0.552   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                              -1.0052     0.0723  -13.90  &lt; 2e-16 ***
menstruationpre                                          -0.0178     0.0471   -0.38  0.70489    
menstruationyes                                          -0.4090     0.0479   -8.54  &lt; 2e-16 ***
fertile_mean                                              0.4763     0.3065    1.55  0.12017    
included_levelslax                                        0.0441     0.1303    0.34  0.73511    
included_levelsconservative                              -0.0408     0.1030   -0.40  0.69208    
included_levelsstrict                                    -0.1666     0.1024   -1.63  0.10383    
includedhorm_contra                                       0.3257     0.0743    4.38 0.000012 ***
fertile                                                   0.1413     0.1196    1.18  0.23725    
menstruationpre:includedhorm_contra                      -0.0700     0.0589   -1.19  0.23437    
menstruationyes:includedhorm_contra                      -0.2139     0.0623   -3.43  0.00059 ***
included_levelslax:includedhorm_contra                   -0.2798     0.1597   -1.75  0.07974 .  
included_levelsconservative:includedhorm_contra          -0.0376     0.1289   -0.29  0.77056    
included_levelsstrict:includedhorm_contra                 0.0542     0.1258    0.43  0.66653    
included_levelslax:fertile                               -0.2783     0.2957   -0.94  0.34656    
included_levelsconservative:fertile                      -0.0257     0.2168   -0.12  0.90564    
included_levelsstrict:fertile                             0.0204     0.2238    0.09  0.92733    
includedhorm_contra:fertile                              -0.4375     0.1761   -2.48  0.01299 *  
included_levelslax:includedhorm_contra:fertile            0.4102     0.3552    1.15  0.24819    
included_levelsconservative:includedhorm_contra:fertile   0.0864     0.2762    0.31  0.75441    
included_levelsstrict:includedhorm_contra:fertile         0.0795     0.2778    0.29  0.77461    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.04871 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-6" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">25606</td>
<td align="center">25737</td>
<td align="center">-12787</td>
<td align="center">25574</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">25611</td>
<td align="center">25792</td>
<td align="center">-12784</td>
<td align="center">25567</td>
<td align="center">6.4</td>
<td align="center">6</td>
<td align="center">0.3799</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-cycle_length-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25611    25792   -12784    25567    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.706 -0.544 -0.377 -0.186  6.535 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.311    0.558   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                            -1.12963    0.12364   -9.14  &lt; 2e-16 ***
menstruationpre                                        -0.02044    0.04714   -0.43  0.66454    
menstruationyes                                        -0.41102    0.04811   -8.54  &lt; 2e-16 ***
fertile_mean                                            0.41022    0.30725    1.34  0.18183    
cycle_length_groups(25,30]                              0.12567    0.12008    1.05  0.29532    
cycle_length_groups(30,35]                              0.11192    0.14164    0.79  0.42942    
cycle_length_groups(35,41]                              0.08123    0.19783    0.41  0.68134    
includedhorm_contra                                     0.40192    0.13497    2.98  0.00290 ** 
fertile                                                 0.25025    0.26738    0.94  0.34930    
menstruationpre:includedhorm_contra                    -0.06694    0.05889   -1.14  0.25561    
menstruationyes:includedhorm_contra                    -0.20683    0.06250   -3.31  0.00093 ***
cycle_length_groups(25,30]:includedhorm_contra         -0.16146    0.14375   -1.12  0.26137    
cycle_length_groups(30,35]:includedhorm_contra         -0.24733    0.21494   -1.15  0.24986    
cycle_length_groups(35,41]:includedhorm_contra          0.02201    0.26921    0.08  0.93483    
cycle_length_groups(25,30]:fertile                     -0.20194    0.28350   -0.71  0.47627    
cycle_length_groups(30,35]:fertile                      0.00681    0.32882    0.02  0.98348    
cycle_length_groups(35,41]:fertile                      0.04179    0.45733    0.09  0.92718    
includedhorm_contra:fertile                            -0.66966    0.30734   -2.18  0.02934 *  
cycle_length_groups(25,30]:includedhorm_contra:fertile  0.45674    0.32746    1.39  0.16308    
cycle_length_groups(30,35]:includedhorm_contra:fertile  0.28800    0.50775    0.57  0.57058    
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.33968    0.58497   -0.58  0.56146    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.191098 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-6" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">25593</td>
<td align="center">25691</td>
<td align="center">-12784</td>
<td align="center">25569</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">25595</td>
<td align="center">25709</td>
<td align="center">-12783</td>
<td align="center">25567</td>
<td align="center">2.044</td>
<td align="center">2</td>
<td align="center">0.3598</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25595    25710   -12783    25567    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.743 -0.546 -0.375 -0.187  6.298 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.307    0.554   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                         -1.3129     0.1753   -7.49  6.9e-14 ***
menstruationpre                                     -0.0120     0.0471   -0.26  0.79813    
menstruationyes                                     -0.4042     0.0479   -8.43  &lt; 2e-16 ***
fertile_mean                                         0.4144     0.3039    1.36  0.17276    
certainty_menstruation                               0.0694     0.0397    1.75  0.08039 .  
includedhorm_contra                                  0.5416     0.2164    2.50  0.01230 *  
fertile                                             -0.4479     0.4014   -1.12  0.26444    
menstruationpre:includedhorm_contra                 -0.0784     0.0588   -1.33  0.18250    
menstruationyes:includedhorm_contra                 -0.2184     0.0623   -3.51  0.00045 ***
certainty_menstruation:includedhorm_contra          -0.0657     0.0501   -1.31  0.18970    
certainty_menstruation:fertile                       0.1342     0.0925    1.45  0.14675    
includedhorm_contra:fertile                          0.3092     0.4945    0.63  0.53182    
certainty_menstruation:includedhorm_contra:fertile  -0.1548     0.1133   -1.37  0.17193    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.483679 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-6" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">25598</td>
<td align="center">25713</td>
<td align="center">-12785</td>
<td align="center">25570</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">25605</td>
<td align="center">25752</td>
<td align="center">-12784</td>
<td align="center">25569</td>
<td align="center">1.34</td>
<td align="center">4</td>
<td align="center">0.8545</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25605    25752   -12784    25569    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.687 -0.545 -0.376 -0.186  6.399 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.309    0.556   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                        -0.9471     0.0761  -12.45
menstruationpre                                                                    -0.0217     0.0471   -0.46
menstruationyes                                                                    -0.4122     0.0479   -8.61
fertile_mean                                                                        0.4074     0.3048    1.34
cycle_regularityslightly irregular,\nup to 5 days off                              -0.1008     0.0819   -1.23
cycle_regularityirregular,\nmore than 5 days off                                   -0.2144     0.1016   -2.11
includedhorm_contra                                                                 0.1940     0.0677    2.87
fertile                                                                             0.1325     0.1284    1.03
menstruationpre:includedhorm_contra                                                -0.0688     0.0588   -1.17
menstruationyes:includedhorm_contra                                                -0.2109     0.0623   -3.39
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.1154     0.1213    0.95
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.1737     0.1470    1.18
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      -0.1202     0.1801   -0.67
cycle_regularityirregular,\nmore than 5 days off:fertile                            0.1358     0.2300    0.59
includedhorm_contra:fertile                                                        -0.3524     0.1487   -2.37
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile   0.0536     0.2629    0.20
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       -0.1450     0.3267   -0.44
                                                                                  Pr(&gt;|z|)    
(Intercept)                                                                        &lt; 2e-16 ***
menstruationpre                                                                    0.64444    
menstruationyes                                                                    &lt; 2e-16 ***
fertile_mean                                                                       0.18141    
cycle_regularityslightly irregular,\nup to 5 days off                              0.21838    
cycle_regularityirregular,\nmore than 5 days off                                   0.03477 *  
includedhorm_contra                                                                0.00417 ** 
fertile                                                                            0.30212    
menstruationpre:includedhorm_contra                                                0.24259    
menstruationyes:includedhorm_contra                                                0.00071 ***
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.34157    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.23729    
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.50461    
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.55476    
includedhorm_contra:fertile                                                        0.01780 *  
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.83841    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.65708    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0363869 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-6" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">25553</td>
<td align="center">25668</td>
<td align="center">-12763</td>
<td align="center">25525</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">25550</td>
<td align="center">25697</td>
<td align="center">-12757</td>
<td align="center">25514</td>
<td align="center">11.36</td>
<td align="center">4</td>
<td align="center">0.02278</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25550    25697   -12757    25514    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.718 -0.545 -0.376 -0.181  6.063 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.289    0.538   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                               -0.95971    0.07263  -13.21  &lt; 2e-16 ***
menstruationpre                                           -0.01893    0.04700   -0.40  0.68702    
menstruationyes                                           -0.40670    0.04781   -8.51  &lt; 2e-16 ***
fertile_mean                                               0.36236    0.29893    1.21  0.22544    
cohabitationLive in same city                              0.00931    0.09117    0.10  0.91865    
cohabitationLong-distance                                 -0.21216    0.08870   -2.39  0.01676 *  
includedhorm_contra                                        0.10826    0.07544    1.44  0.15126    
fertile                                                    0.25857    0.11644    2.22  0.02638 *  
menstruationpre:includedhorm_contra                       -0.07448    0.05878   -1.27  0.20508    
menstruationyes:includedhorm_contra                       -0.21863    0.06220   -3.52  0.00044 ***
cohabitationLive in same city:includedhorm_contra          0.32223    0.11538    2.79  0.00522 ** 
cohabitationLong-distance:includedhorm_contra              0.19181    0.11301    1.70  0.08964 .  
cohabitationLive in same city:fertile                     -0.10999    0.20902   -0.53  0.59875    
cohabitationLong-distance:fertile                         -0.58386    0.20913   -2.79  0.00524 ** 
includedhorm_contra:fertile                               -0.30319    0.16784   -1.81  0.07085 .  
cohabitationLive in same city:includedhorm_contra:fertile -0.15463    0.25884   -0.60  0.55025    
cohabitationLong-distance:includedhorm_contra:fertile      0.33961    0.25995    1.31  0.19140    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0425127 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-6" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">25591</td>
<td align="center">25706</td>
<td align="center">-12782</td>
<td align="center">25563</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">25592</td>
<td align="center">25740</td>
<td align="center">-12778</td>
<td align="center">25556</td>
<td align="center">6.894</td>
<td align="center">4</td>
<td align="center">0.1416</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/had_sexual_intercourse-rel_status-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: had_sexual_intercourse ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   25592    25740   -12778    25556    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.574 -0.547 -0.376 -0.185  6.250 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.306    0.553   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error z value  Pr(&gt;|z|)    
(Intercept)                                                       -0.9967     0.0685  -14.56   &lt; 2e-16 ***
menstruationpre                                                   -0.0200     0.0471   -0.42   0.67133    
menstruationyes                                                   -0.4103     0.0479   -8.57   &lt; 2e-16 ***
fertile_mean                                                       0.4272     0.3024    1.41   0.15777    
relationship_status_cleanVerheiratet                              -0.0973     0.0877   -1.11   0.26757    
relationship_status_cleanVerlobt                                  -0.1162     0.1651   -0.70   0.48163    
includedhorm_contra                                                0.2645     0.0586    4.51 0.0000064 ***
fertile                                                            0.0347     0.1083    0.32   0.74859    
menstruationpre:includedhorm_contra                               -0.0719     0.0588   -1.22   0.22127    
menstruationyes:includedhorm_contra                               -0.2148     0.0622   -3.45   0.00056 ***
relationship_status_cleanVerheiratet:includedhorm_contra          -0.4466     0.1703   -2.62   0.00874 ** 
relationship_status_cleanVerlobt:includedhorm_contra               0.0367     0.2437    0.15   0.88030    
relationship_status_cleanVerheiratet:fertile                       0.3579     0.1927    1.86   0.06319 .  
relationship_status_cleanVerlobt:fertile                          -0.0862     0.3704   -0.23   0.81593    
includedhorm_contra:fertile                                       -0.2895     0.1292   -2.24   0.02506 *  
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.2040     0.3760    0.54   0.58740    
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.3134     0.5489    0.57   0.56800    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0312618 (tol = 0.001, component 1)
</code></pre>
</div>
</div>
<div id="specific-robustness-analyses-for-sexual-intercourse" class="section level3 tab-content">
<h3>Specific robustness analyses for sexual intercourse</h3>
<pre class="r"><code>xtabs(~ spent_night_with_partner + had_sexual_intercourse, data = diary %&gt;% filter(!is.na(fertile), !is.na(included)))</code></pre>
<pre><code>##                         had_sexual_intercourse
## spent_night_with_partner     0     1
##                        0 11681   681
##                        1  9156  5050</code></pre>
<pre class="r"><code>possible_nights = diary %&gt;% filter(spent_night_with_partner == 1)
m1_night_with_partner = glmer(had_sexual_intercourse ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = possible_nights, family = binomial(link = &quot;probit&quot;))
m1_night_with_partner %&gt;% 
  print_summary()  %&gt;% 
  plot_all_effects()</code></pre>
<pre><code>## 
## 
## ```
## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( probit )
## Formula: had_sexual_intercourse ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
##    Data: possible_nights
## 
##      AIC      BIC   logLik deviance df.resid 
##    15802    15878    -7891    15782    14196 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -4.300 -0.620 -0.343  0.685  6.629 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  person (Intercept) 0.658    0.811   
## Number of obs: 14206, groups:  person, 962
## 
## Fixed effects:
##                                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                         -0.54997    0.09284   -5.92  3.2e-09 ***
## includedhorm_contra                  0.54920    0.07644    7.19  6.7e-13 ***
## menstruationpre                     -0.00473    0.05976   -0.08  0.93687    
## menstruationyes                     -0.51980    0.05979   -8.69  &lt; 2e-16 ***
## fertile                              0.22427    0.12063    1.86  0.06300 .  
## fertile_mean                         0.23423    0.43489    0.54  0.59017    
## includedhorm_contra:menstruationpre -0.06655    0.07780   -0.86  0.39232    
## includedhorm_contra:menstruationyes -0.29407    0.08062   -3.65  0.00026 ***
## includedhorm_contra:fertile         -0.37098    0.15506   -2.39  0.01674 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.471                                                               
## menstrutnpr             -0.255  0.321                                                        
## menstrutnys             -0.221  0.278  0.373                                                 
## fertile                 -0.248  0.387  0.480    0.372                                        
## fertile_men             -0.765 -0.044 -0.011   -0.011   -0.088                               
## inclddhrm_cntr:mnstrtnp  0.205 -0.402 -0.768   -0.286   -0.368 -0.004                        
## inclddhrm_cntr:mnstrtny  0.174 -0.344 -0.276   -0.740   -0.275 -0.003  0.352                 
## inclddhrm_cntr:f         0.250 -0.493 -0.372   -0.288   -0.772 -0.006  0.470                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.358                 
## 
## ```</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/rob_sex-1.png" width="768" /></p>
<p>In-pair desire predicts having sex.</p>
<pre class="r"><code>summary(glmer(had_sexual_intercourse ~ in_pair_desire + included + menstruation + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;)))</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( probit )
## Formula: had_sexual_intercourse ~ in_pair_desire + included + menstruation +      (1 | person)
##    Data: diary
## 
##      AIC      BIC   logLik deviance df.resid 
##    18835    18884    -9412    18823    27562 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
##  -6.56  -0.37  -0.12  -0.01 124.00 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  person (Intercept) 0.619    0.787   
## Number of obs: 27568, groups:  person, 1043
## 
## Fixed effects:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -4.7371     0.0777   -61.0   &lt;2e-16 ***
## in_pair_desire        0.9439     0.0140    67.6   &lt;2e-16 ***
## includedhorm_contra   0.0856     0.0592     1.4     0.15    
## menstruationpre      -0.0217     0.0306    -0.7     0.48    
## menstruationyes      -0.5430     0.0345   -15.8   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) in_pr_ incld_ mnstrtnp
## in_pair_dsr -0.792                       
## inclddhrm_c -0.475  0.000                
## menstrutnpr -0.091  0.011  0.009         
## menstrutnys -0.030 -0.059  0.015  0.202</code></pre>
<p>Ovulatory but menstrual changes in sex are mediated by in-pair desire.</p>
<pre class="r"><code>summary(glmer(had_sexual_intercourse ~ in_pair_desire + included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary, family = binomial(link = &quot;probit&quot;)))</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( probit )
## Formula: had_sexual_intercourse ~ in_pair_desire + included * (menstruation +  
##     fertile) + fertile_mean + (1 | person)
##    Data: diary
## 
##      AIC      BIC   logLik deviance df.resid 
##    17957    18047    -8968    17935    26533 
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
##  -6.34  -0.36  -0.12  -0.01  94.07 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  person (Intercept) 0.621    0.788   
## Number of obs: 26544, groups:  person, 1043
## 
## Fixed effects:
##                                     Estimate Std. Error z value     Pr(&gt;|z|)    
## (Intercept)                          -4.9128     0.1095   -44.9      &lt; 2e-16 ***
## in_pair_desire                        0.9530     0.0144    66.0      &lt; 2e-16 ***
## includedhorm_contra                   0.1434     0.0713     2.0        0.044 *  
## menstruationpre                       0.0148     0.0579     0.3        0.799    
## menstruationyes                      -0.3779     0.0585    -6.5 0.0000000001 ***
## fertile                              -0.1117     0.1166    -1.0        0.338    
## fertile_mean                          0.6422     0.4129     1.6        0.120    
## includedhorm_contra:menstruationpre  -0.0921     0.0723    -1.3        0.202    
## includedhorm_contra:menstruationyes  -0.3491     0.0761    -4.6 0.0000044756 ***
## includedhorm_contra:fertile          -0.0187     0.1442    -0.1        0.897    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) in_pr_ incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## in_pair_dsr             -0.590                                                                      
## inclddhrm_c             -0.382 -0.002                                                               
## menstrutnpr             -0.215  0.012  0.326                                                        
## menstrutnys             -0.172 -0.010  0.282  0.357                                                 
## fertile                 -0.191 -0.023  0.403  0.469    0.357                                        
## fertile_men             -0.627  0.014 -0.047 -0.006   -0.008   -0.090                               
## inclddhrm_cntr:mnstrtnp  0.180 -0.011 -0.395 -0.801   -0.286   -0.375 -0.006                        
## inclddhrm_cntr:mnstrtny  0.167 -0.040 -0.331 -0.275   -0.768   -0.272 -0.005  0.338                 
## inclddhrm_cntr:f         0.191  0.023 -0.493 -0.379   -0.288   -0.803  0.010  0.465                 
##                         inclddhrm_cntr:mnstrtny
## in_pair_dsr                                    
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.343                 
## convergence code: 0
## Model failed to converge with max|grad| = 0.0386809 (tol = 0.001, component 1)</code></pre>
</div>
</div>
<div id="partner-initiated-sex" class="section level2 tab-content">
<h2>Partner initiated sex</h2>
<pre class="r"><code>model_summaries$partner_initiated_sexual_intercourse</code></pre>
<div id="model-summary-14" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-15" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ included * (menstruation +  
    fertile) + fertile_mean + (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7622     7688    -3801     7602     5720 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.742 -1.111  0.658  0.780  1.285 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0921   0.303   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                           0.1477     0.0829    1.78   0.0747 . 
includedhorm_contra                   0.0966     0.0734    1.32   0.1881   
menstruationpre                       0.0322     0.0881    0.37   0.7147   
menstruationyes                       0.0607     0.0960    0.63   0.5272   
fertile                              -0.2883     0.1772   -1.63   0.1038   
fertile_mean                          0.6308     0.3694    1.71   0.0878 . 
includedhorm_contra:menstruationpre  -0.1066     0.1090   -0.98   0.3281   
includedhorm_contra:menstruationyes  -0.3442     0.1265   -2.72   0.0065 **
includedhorm_contra:fertile           0.3242     0.2171    1.49   0.1354   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.553                                                               
menstrutnpr             -0.421  0.484                                                        
menstrutnys             -0.319  0.369  0.307                                                 
fertile                 -0.427  0.600  0.474    0.311                                        
fertile_men             -0.689 -0.055 -0.010   -0.010   -0.143                               
inclddhrm_cntr:mnstrtnp  0.350 -0.582 -0.808   -0.248   -0.380 -0.008                        
inclddhrm_cntr:mnstrtny  0.241 -0.424 -0.233   -0.759   -0.235  0.008  0.286                 
inclddhrm_cntr:f         0.426 -0.727 -0.386   -0.253   -0.800  0.005  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.296                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.29 [-0.64;0.06].</p>
</div>
<div id="marginal-effect-plots-7" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-7" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-7" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-7" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-7" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-14" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-28" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-28" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-28" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-14" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-29" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-29" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-29" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-7" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-15" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-30" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-30" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-30" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-15" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-31" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-31" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-31" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-partner_initiated_sexual_intercourse-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-7" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-7" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ included + menstruation +  
    fertile + fertile_mean + (1 + fertile + menstruation | person) +  
    included:menstruation + included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7632     7759    -3797     7594     5711 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.800 -1.090  0.647  0.769  1.491 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     0.1068   0.327                     
        fertile         0.1247   0.353    -0.35            
        menstruationpre 0.0326   0.181     0.34 -0.64      
        menstruationyes 0.1305   0.361    -0.54  0.80 -0.95
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                           0.1425     0.0841    1.69    0.090 .
includedhorm_contra                   0.1021     0.0747    1.37    0.172  
menstruationpre                       0.0517     0.0931    0.56    0.579  
menstruationyes                       0.0533     0.1025    0.52    0.603  
fertile                              -0.2778     0.1816   -1.53    0.126  
fertile_mean                          0.6522     0.3744    1.74    0.081 .
includedhorm_contra:menstruationpre  -0.1151     0.1138   -1.01    0.312  
includedhorm_contra:menstruationyes  -0.3436     0.1338   -2.57    0.010 *
includedhorm_contra:fertile           0.3022     0.2214    1.36    0.172  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.556                                                               
menstrutnpr             -0.395  0.448                                                        
menstrutnys             -0.339  0.388  0.249                                                 
fertile                 -0.433  0.602  0.447    0.328                                        
fertile_men             -0.683 -0.053 -0.014   -0.012   -0.149                               
inclddhrm_cntr:mnstrtnp  0.329 -0.543 -0.806   -0.201   -0.357 -0.006                        
inclddhrm_cntr:mnstrtny  0.257 -0.448 -0.187   -0.764   -0.247  0.008  0.232                 
inclddhrm_cntr:f         0.432 -0.734 -0.360   -0.266   -0.795  0.003  0.439                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.312                 
convergence code: 0
Model failed to converge with max|grad| = 0.00863234 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">7622</td>
<td align="center">7688</td>
<td align="center">-3801</td>
<td align="center">7602</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">7632</td>
<td align="center">7759</td>
<td align="center">-3797</td>
<td align="center">7594</td>
<td align="center">7.726</td>
<td align="center">9</td>
<td align="center">0.562</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-7" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-7" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-7" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
    6773     6891    -3369     6737     5052 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.675 -1.107  0.662  0.787  1.302 

Random effects:
 Groups Name                                   Variance     Std.Dev.
 person (Intercept)                            0.0885284754 0.297537
 Xr.2   s(days_filled_out):includedhorm_contra 0.0000005052 0.000711
 Xr.1   s(days_filled_out):includedcycling     0.0000000384 0.000196
 Xr.0   s(day_number):includedhorm_contra      0.0000006597 0.000812
 Xr     s(day_number):includedcycling          0.0000000305 0.000175
Number of obs: 5070, groups:  person, 837; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value Pr(&gt;|z|)  
X(Intercept)                                0.14443    0.08768    1.65    0.099 .
Xincludedhorm_contra                        0.06425    0.07892    0.81    0.416  
Xmenstruationpre                           -0.00761    0.09271   -0.08    0.935  
Xmenstruationyes                           -0.00454    0.10495   -0.04    0.965  
Xfertile                                   -0.39287    0.19163   -2.05    0.040 *
Xfertile_mean                               0.81000    0.38471    2.10    0.035 *
Xincludedhorm_contra:menstruationpre       -0.04225    0.11469   -0.37    0.713  
Xincludedhorm_contra:menstruationyes       -0.29137    0.13781   -2.11    0.034 *
Xincludedhorm_contra:fertile                0.41166    0.23445    1.76    0.079 .
Xs(day_number):includedcyclingFx1          -0.02519    0.10191   -0.25    0.805  
Xs(day_number):includedhorm_contraFx1       0.06068    0.07959    0.76    0.446  
Xs(days_filled_out):includedcyclingFx1      0.00389    0.10308    0.04    0.970  
Xs(days_filled_out):includedhorm_contraFx1 -0.01832    0.08009   -0.23    0.819  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
partner_initiated_sexual_intercourse ~ included + menstruation + 
    fertile + fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                          0.14443    0.08603    1.68    0.093 .
includedhorm_contra                  0.06425    0.07755    0.83    0.407  
menstruationpre                     -0.00761    0.09093   -0.08    0.933  
menstruationyes                     -0.00454    0.10333   -0.04    0.965  
fertile                             -0.39287    0.18798   -2.09    0.037 *
fertile_mean                         0.81000    0.37778    2.14    0.032 *
includedhorm_contra:menstruationpre -0.04225    0.11255   -0.38    0.707  
includedhorm_contra:menstruationyes -0.29137    0.13560   -2.15    0.032 *
includedhorm_contra:fertile          0.41166    0.22999    1.79    0.073 .
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                       edf Ref.df Chi.sq p-value
s(day_number):includedcycling            1      1   0.06    0.80
s(day_number):includedhorm_contra        1      1   0.61    0.44
s(days_filled_out):includedcycling       1      1   0.00    0.97
s(days_filled_out):includedhorm_contra   1      1   0.05    0.82

R-sq.(adj) =  0.00464   
glmer.ML = 6326.1  Scale est. = 1         n = 5070
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-7" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-7" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ fertile_mean + (1 | person) +  
    contraceptive_methods + fertile + menstruation + fertile:contraceptive_methods +  
    menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
    4866     4978    -2415     4830     3631 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.752 -1.120  0.657  0.776  1.517 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0961   0.31    
Number of obs: 3649, groups:  person, 470

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                                                0.1663     0.1388    1.20     0.23
fertile_mean                                               0.5798     0.5934    0.98     0.33
contraceptive_methodsfertility_awareness                  -0.0837     0.2408   -0.35     0.73
contraceptive_methodsnone                                 -0.2306     0.3384   -0.68     0.50
contraceptive_methodshormonal                              0.0584     0.1194    0.49     0.62
fertile                                                   -0.1082     0.3212   -0.34     0.74
menstruationpre                                            0.0876     0.1497    0.59     0.56
menstruationyes                                            0.0980     0.1771    0.55     0.58
contraceptive_methodsfertility_awareness:fertile          -0.0334     0.6737   -0.05     0.96
contraceptive_methodsnone:fertile                         -0.7337     1.0294   -0.71     0.48
contraceptive_methodshormonal:fertile                      0.2191     0.3538    0.62     0.54
contraceptive_methodsfertility_awareness:menstruationpre  -0.3440     0.3304   -1.04     0.30
contraceptive_methodsnone:menstruationpre                  0.0681     0.4711    0.14     0.89
contraceptive_methodshormonal:menstruationpre             -0.1194     0.1670   -0.72     0.47
contraceptive_methodsfertility_awareness:menstruationyes  -0.0495     0.3684   -0.13     0.89
contraceptive_methodsnone:menstruationyes                  0.6279     0.8282    0.76     0.45
contraceptive_methodshormonal:menstruationyes             -0.3129     0.2041   -1.53     0.13
convergence code: 0
Model failed to converge with max|grad| = 0.00895839 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">4858</td>
<td align="center">4932</td>
<td align="center">-2417</td>
<td align="center">4834</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">4866</td>
<td align="center">4978</td>
<td align="center">-2415</td>
<td align="center">4830</td>
<td align="center">3.134</td>
<td align="center">6</td>
<td align="center">0.7919</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-7" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">7630</td>
<td align="center">7750</td>
<td align="center">-3797</td>
<td align="center">7594</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">7642</td>
<td align="center">7815</td>
<td align="center">-3795</td>
<td align="center">7590</td>
<td align="center">4.128</td>
<td align="center">8</td>
<td align="center">0.8454</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7642     7815    -3795     7590     5704 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.934 -1.110  0.653  0.783  1.363 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0879   0.296   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                    0.0265     0.1639    0.16   0.8714   
menstruationpre                                0.0343     0.0883    0.39   0.6973   
menstruationyes                                0.0650     0.0963    0.68   0.4996   
fertile_mean                                   0.6291     0.3702    1.70   0.0893 . 
age_group(20,25]                               0.0916     0.1691    0.54   0.5880   
age_group(25,30]                               0.0384     0.1716    0.22   0.8231   
age_group(30,35]                               0.1419     0.2032    0.70   0.4850   
age_group(35,70]                               0.3673     0.1884    1.95   0.0512 . 
includedhorm_contra                            0.2198     0.1713    1.28   0.1994   
fertile                                        0.2031     0.5756    0.35   0.7242   
menstruationpre:includedhorm_contra           -0.1071     0.1091   -0.98   0.3263   
menstruationyes:includedhorm_contra           -0.3450     0.1267   -2.72   0.0065 **
age_group(20,25]:includedhorm_contra          -0.1227     0.1864   -0.66   0.5102   
age_group(25,30]:includedhorm_contra           0.0493     0.2032    0.24   0.8084   
age_group(30,35]:includedhorm_contra          -0.1273     0.2756   -0.46   0.6440   
age_group(35,70]:includedhorm_contra          -0.3093     0.3669   -0.84   0.3992   
age_group(20,25]:fertile                      -0.3269     0.6250   -0.52   0.6010   
age_group(25,30]:fertile                      -0.4376     0.6266   -0.70   0.4849   
age_group(30,35]:fertile                      -0.9254     0.7090   -1.30   0.1918   
age_group(35,70]:fertile                      -0.7935     0.6871   -1.16   0.2482   
includedhorm_contra:fertile                   -0.0883     0.6172   -0.14   0.8862   
age_group(20,25]:includedhorm_contra:fertile   0.2884     0.6780    0.42   0.6706   
age_group(25,30]:includedhorm_contra:fertile   0.1209     0.7222    0.17   0.8670   
age_group(30,35]:includedhorm_contra:fertile   0.9393     1.0138    0.93   0.3542   
age_group(35,70]:includedhorm_contra:fertile   0.1404     1.1688    0.12   0.9044   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00407261 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-7" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">7624</td>
<td align="center">7704</td>
<td align="center">-3800</td>
<td align="center">7600</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">7626</td>
<td align="center">7719</td>
<td align="center">-3799</td>
<td align="center">7598</td>
<td align="center">1.673</td>
<td align="center">2</td>
<td align="center">0.4332</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7626     7719    -3799     7598     5716 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.775 -1.111  0.654  0.780  1.337 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.092    0.303   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                               0.1559     0.0914    1.70   0.0881 . 
menstruationpre                           0.0318     0.0882    0.36   0.7188   
menstruationyes                           0.0602     0.0961    0.63   0.5310   
fertile_mean                              0.6308     0.3696    1.71   0.0879 . 
weekendTRUE                              -0.0143     0.0811   -0.18   0.8604   
includedhorm_contra                       0.0657     0.0876    0.75   0.4538   
fertile                                  -0.4889     0.2320   -2.11   0.0351 * 
menstruationpre:includedhorm_contra      -0.1079     0.1091   -0.99   0.3224   
menstruationyes:includedhorm_contra      -0.3432     0.1265   -2.71   0.0067 **
weekendTRUE:includedhorm_contra           0.0610     0.1006    0.61   0.5446   
weekendTRUE:fertile                       0.3882     0.3003    1.29   0.1961   
includedhorm_contra:fertile               0.5261     0.2868    1.83   0.0666 . 
weekendTRUE:includedhorm_contra:fertile  -0.3950     0.3734   -1.06   0.2901   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0066886 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-7" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">7630</td>
<td align="center">7777</td>
<td align="center">-3793</td>
<td align="center">7586</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">7639</td>
<td align="center">7865</td>
<td align="center">-3785</td>
<td align="center">7571</td>
<td align="center">15.8</td>
<td align="center">12</td>
<td align="center">0.2005</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7639     7865    -3785     7571     5696 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.008 -1.093  0.644  0.776  1.484 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0921   0.304   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                   0.01705    0.12083    0.14   0.8878   
menstruationpre                               0.04125    0.08851    0.47   0.6412   
menstruationyes                               0.06496    0.09640    0.67   0.5004   
fertile_mean                                  0.66101    0.37081    1.78   0.0746 . 
weekdayTuesday                                0.06970    0.15159    0.46   0.6457   
weekdayWednesday                              0.21807    0.15565    1.40   0.1612   
weekdayThursday                               0.30535    0.15919    1.92   0.0551 . 
weekdayFriday                                 0.12230    0.15120    0.81   0.4186   
weekdaySaturday                               0.08115    0.13904    0.58   0.5595   
weekdaySunday                                 0.14310    0.13357    1.07   0.2840   
includedhorm_contra                           0.17712    0.13176    1.34   0.1789   
fertile                                      -0.20634    0.38584   -0.54   0.5928   
menstruationpre:includedhorm_contra          -0.11274    0.10944   -1.03   0.3029   
menstruationyes:includedhorm_contra          -0.34376    0.12690   -2.71   0.0068 **
weekdayTuesday:includedhorm_contra            0.06398    0.19108    0.34   0.7378   
weekdayWednesday:includedhorm_contra         -0.11047    0.19446   -0.57   0.5700   
weekdayThursday:includedhorm_contra          -0.42998    0.19487   -2.21   0.0273 * 
weekdayFriday:includedhorm_contra            -0.08116    0.18618   -0.44   0.6629   
weekdaySaturday:includedhorm_contra          -0.00766    0.17175   -0.04   0.9644   
weekdaySunday:includedhorm_contra            -0.06629    0.16520   -0.40   0.6882   
weekdayTuesday:fertile                       -0.51674    0.56841   -0.91   0.3633   
weekdayWednesday:fertile                     -0.62283    0.58793   -1.06   0.2894   
weekdayThursday:fertile                      -0.09179    0.60811   -0.15   0.8800   
weekdayFriday:fertile                        -0.46452    0.55309   -0.84   0.4010   
weekdaySaturday:fertile                       0.19553    0.52142    0.38   0.7077   
weekdaySunday:fertile                         0.47764    0.50439    0.95   0.3437   
includedhorm_contra:fertile                   0.40338    0.47524    0.85   0.3960   
weekdayTuesday:includedhorm_contra:fertile   -0.10077    0.71411   -0.14   0.8878   
weekdayWednesday:includedhorm_contra:fertile  0.02935    0.73879    0.04   0.9683   
weekdayThursday:includedhorm_contra:fertile   0.49762    0.74187    0.67   0.5024   
weekdayFriday:includedhorm_contra:fertile     0.67435    0.68911    0.98   0.3278   
weekdaySaturday:includedhorm_contra:fertile  -0.35710    0.64688   -0.55   0.5809   
weekdaySunday:includedhorm_contra:fertile    -0.86996    0.62163   -1.40   0.1617   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00400906 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-7" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">7626</td>
<td align="center">7733</td>
<td align="center">-3797</td>
<td align="center">7594</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">7637</td>
<td align="center">7783</td>
<td align="center">-3796</td>
<td align="center">7593</td>
<td align="center">1.345</td>
<td align="center">6</td>
<td align="center">0.9691</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7637     7783    -3796     7593     5708 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.784 -1.104  0.652  0.784  1.274 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0887   0.298   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                               0.1480     0.0923    1.60   0.1090   
menstruationpre                                           0.0346     0.0882    0.39   0.6950   
menstruationyes                                           0.0586     0.0960    0.61   0.5414   
fertile_mean                                              0.7277     0.3752    1.94   0.0524 . 
included_levelslax                                       -0.0524     0.1486   -0.35   0.7242   
included_levelsconservative                               0.0185     0.1237    0.15   0.8810   
included_levelsstrict                                    -0.0865     0.1274   -0.68   0.4973   
includedhorm_contra                                       0.0944     0.0976    0.97   0.3335   
fertile                                                  -0.3730     0.2204   -1.69   0.0905 . 
menstruationpre:includedhorm_contra                      -0.1101     0.1092   -1.01   0.3137   
menstruationyes:includedhorm_contra                      -0.3393     0.1265   -2.68   0.0073 **
included_levelslax:includedhorm_contra                   -0.0964     0.1852   -0.52   0.6029   
included_levelsconservative:includedhorm_contra          -0.0975     0.1531   -0.64   0.5243   
included_levelsstrict:includedhorm_contra                 0.1689     0.1540    1.10   0.2728   
included_levelslax:fertile                                0.2442     0.5471    0.45   0.6554   
included_levelsconservative:fertile                       0.0667     0.4070    0.16   0.8699   
included_levelsstrict:fertile                             0.2790     0.4216    0.66   0.5082   
includedhorm_contra:fertile                               0.3524     0.3164    1.11   0.2654   
included_levelslax:includedhorm_contra:fertile           -0.1986     0.6558   -0.30   0.7621   
included_levelsconservative:includedhorm_contra:fertile   0.1481     0.5110    0.29   0.7719   
included_levelsstrict:includedhorm_contra:fertile        -0.3063     0.5189   -0.59   0.5550   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00724527 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-7" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">7620</td>
<td align="center">7727</td>
<td align="center">-3794</td>
<td align="center">7588</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">7626</td>
<td align="center">7773</td>
<td align="center">-3791</td>
<td align="center">7582</td>
<td align="center">6.095</td>
<td align="center">6</td>
<td align="center">0.4126</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-cycle_length-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + cycle_length_groups + included + fertile +  
    menstruation:included + cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7626     7773    -3791     7582     5708 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.018 -1.100  0.647  0.785  1.326 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0901   0.3     
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                              0.5859     0.1625    3.60  0.00031 ***
menstruationpre                                          0.0415     0.0884    0.47  0.63905    
menstruationyes                                          0.0725     0.0966    0.75  0.45291    
fertile_mean                                             0.5102     0.3734    1.37  0.17184    
cycle_length_groups(25,30]                              -0.4794     0.1581   -3.03  0.00243 ** 
cycle_length_groups(30,35]                              -0.4051     0.1848   -2.19  0.02835 *  
cycle_length_groups(35,41]                              -0.5804     0.2507   -2.32  0.02060 *  
includedhorm_contra                                     -0.1343     0.1758   -0.76  0.44498    
fertile                                                 -1.1826     0.5141   -2.30  0.02143 *  
menstruationpre:includedhorm_contra                     -0.1169     0.1094   -1.07  0.28493    
menstruationyes:includedhorm_contra                     -0.3503     0.1271   -2.76  0.00583 ** 
cycle_length_groups(25,30]:includedhorm_contra           0.2576     0.1828    1.41  0.15892    
cycle_length_groups(30,35]:includedhorm_contra           0.1173     0.2621    0.45  0.65459    
cycle_length_groups(35,41]:includedhorm_contra           0.3888     0.3164    1.23  0.21911    
cycle_length_groups(25,30]:fertile                       1.0324     0.5426    1.90  0.05709 .  
cycle_length_groups(30,35]:fertile                       1.0175     0.6261    1.63  0.10413    
cycle_length_groups(35,41]:fertile                       0.6004     0.8548    0.70  0.48246    
includedhorm_contra:fertile                              0.9497     0.5900    1.61  0.10747    
cycle_length_groups(25,30]:includedhorm_contra:fertile  -0.6803     0.6257   -1.09  0.27689    
cycle_length_groups(30,35]:includedhorm_contra:fertile  -0.7689     0.9415   -0.82  0.41411    
cycle_length_groups(35,41]:includedhorm_contra:fertile  -0.8645     1.0927   -0.79  0.42889    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0230175 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-7" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">7626</td>
<td align="center">7705</td>
<td align="center">-3801</td>
<td align="center">7602</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">7629</td>
<td align="center">7722</td>
<td align="center">-3801</td>
<td align="center">7601</td>
<td align="center">0.5486</td>
<td align="center">2</td>
<td align="center">0.7601</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + certainty_menstruation + included + fertile +  
    menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7629     7722    -3800     7601     5716 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.740 -1.108  0.658  0.779  1.296 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0917   0.303   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                   Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                         0.10979    0.22197    0.50   0.6209   
menstruationpre                                     0.03081    0.08836    0.35   0.7273   
menstruationyes                                     0.05877    0.09614    0.61   0.5410   
fertile_mean                                        0.62168    0.37062    1.68   0.0935 . 
certainty_menstruation                              0.00923    0.05023    0.18   0.8542   
includedhorm_contra                                 0.08795    0.26783    0.33   0.7426   
fertile                                             0.26937    0.77006    0.35   0.7265   
menstruationpre:includedhorm_contra                -0.10491    0.10919   -0.96   0.3367   
menstruationyes:includedhorm_contra                -0.34272    0.12655   -2.71   0.0068 **
certainty_menstruation:includedhorm_contra          0.00204    0.06137    0.03   0.9735   
certainty_menstruation:fertile                     -0.12898    0.17462   -0.74   0.4601   
includedhorm_contra:fertile                        -0.19582    0.92850   -0.21   0.8330   
certainty_menstruation:includedhorm_contra:fertile  0.12012    0.21071    0.57   0.5686   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0244305 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-7" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">7626</td>
<td align="center">7720</td>
<td align="center">-3799</td>
<td align="center">7598</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">7627</td>
<td align="center">7747</td>
<td align="center">-3795</td>
<td align="center">7591</td>
<td align="center">7.464</td>
<td align="center">4</td>
<td align="center">0.1133</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7627     7747    -3796     7591     5712 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.817 -1.110  0.655  0.777  1.356 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.0889   0.298   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                        0.25733    0.09732    2.64
menstruationpre                                                                    0.02039    0.08832    0.23
menstruationyes                                                                    0.05763    0.09608    0.60
fertile_mean                                                                       0.58155    0.36975    1.57
cycle_regularityslightly irregular,\nup to 5 days off                             -0.22128    0.09980   -2.22
cycle_regularityirregular,\nmore than 5 days off                                  -0.13091    0.12977   -1.01
includedhorm_contra                                                                0.02251    0.08937    0.25
fertile                                                                           -0.67872    0.23484   -2.89
menstruationpre:includedhorm_contra                                               -0.09472    0.10917   -0.87
menstruationyes:includedhorm_contra                                               -0.33946    0.12645   -2.68
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.08376    0.14195    0.59
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.00271    0.17733   -0.02
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.73025    0.33454    2.18
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.84385    0.43983    1.92
includedhorm_contra:fertile                                                        0.66050    0.27187    2.43
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.48102    0.48806   -0.99
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.51778    0.61629   -0.84
                                                                                  Pr(&gt;|z|)   
(Intercept)                                                                         0.0082 **
menstruationpre                                                                     0.8174   
menstruationyes                                                                     0.5486   
fertile_mean                                                                        0.1158   
cycle_regularityslightly irregular,\nup to 5 days off                               0.0266 * 
cycle_regularityirregular,\nmore than 5 days off                                    0.3131   
includedhorm_contra                                                                 0.8012   
fertile                                                                             0.0039 **
menstruationpre:includedhorm_contra                                                 0.3856   
menstruationyes:includedhorm_contra                                                 0.0073 **
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.5551   
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.9878   
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.0290 * 
cycle_regularityirregular,\nmore than 5 days off:fertile                            0.0550 . 
includedhorm_contra:fertile                                                         0.0151 * 
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile   0.3243   
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.4008   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00828677 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-7" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">7624</td>
<td align="center">7717</td>
<td align="center">-3798</td>
<td align="center">7596</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">7627</td>
<td align="center">7746</td>
<td align="center">-3795</td>
<td align="center">7591</td>
<td align="center">5.539</td>
<td align="center">4</td>
<td align="center">0.2364</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7627     7746    -3795     7591     5712 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.807 -1.107  0.656  0.778  1.333 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.09     0.3     
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                                 0.1944     0.0936    2.08   0.0379 * 
menstruationpre                                             0.0360     0.0882    0.41   0.6830   
menstruationyes                                             0.0593     0.0961    0.62   0.5373   
fertile_mean                                                0.5901     0.3705    1.59   0.1112   
cohabitationLive in same city                              -0.0209     0.1142   -0.18   0.8545   
cohabitationLong-distance                                  -0.1833     0.1142   -1.60   0.1086   
includedhorm_contra                                        -0.0286     0.0995   -0.29   0.7741   
fertile                                                    -0.5487     0.2121   -2.59   0.0097 **
menstruationpre:includedhorm_contra                        -0.1153     0.1091   -1.06   0.2907   
menstruationyes:includedhorm_contra                        -0.3463     0.1265   -2.74   0.0062 **
cohabitationLive in same city:includedhorm_contra           0.1364     0.1416    0.96   0.3351   
cohabitationLong-distance:includedhorm_contra               0.3067     0.1434    2.14   0.0325 * 
cohabitationLive in same city:fertile                       0.6211     0.3916    1.59   0.1127   
cohabitationLong-distance:fertile                           0.7858     0.4050    1.94   0.0523 . 
includedhorm_contra:fertile                                 0.6020     0.3107    1.94   0.0527 . 
cohabitationLive in same city:includedhorm_contra:fertile  -0.5742     0.4815   -1.19   0.2331   
cohabitationLong-distance:includedhorm_contra:fertile      -0.8988     0.5021   -1.79   0.0734 . 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0126101 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-7" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">7623</td>
<td align="center">7716</td>
<td align="center">-3797</td>
<td align="center">7595</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">7628</td>
<td align="center">7748</td>
<td align="center">-3796</td>
<td align="center">7592</td>
<td align="center">2.519</td>
<td align="center">4</td>
<td align="center">0.6412</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_initiated_sexual_intercourse-rel_status-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: partner_initiated_sexual_intercourse ~ menstruation + fertile_mean +  
    (1 | person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
    7628     7748    -3796     7592     5712 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-1.766 -1.110  0.656  0.777  1.336 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.088    0.297   
Number of obs: 5730, groups:  person, 853

Fixed effects:
                                                                 Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                                        0.1484     0.0863    1.72   0.0856 . 
menstruationpre                                                    0.0334     0.0882    0.38   0.7052   
menstruationyes                                                    0.0690     0.0961    0.72   0.4728   
fertile_mean                                                       0.6082     0.3683    1.65   0.0987 . 
relationship_status_cleanVerheiratet                               0.0775     0.1120    0.69   0.4892   
relationship_status_cleanVerlobt                                  -0.2849     0.1961   -1.45   0.1463   
includedhorm_contra                                                0.1165     0.0790    1.48   0.1401   
fertile                                                           -0.2954     0.2039   -1.45   0.1473   
menstruationpre:includedhorm_contra                               -0.1094     0.1090   -1.00   0.3155   
menstruationyes:includedhorm_contra                               -0.3565     0.1265   -2.82   0.0048 **
relationship_status_cleanVerheiratet:includedhorm_contra          -0.3428     0.2348   -1.46   0.1443   
relationship_status_cleanVerlobt:includedhorm_contra              -0.1040     0.2990   -0.35   0.7280   
relationship_status_cleanVerheiratet:fertile                      -0.1745     0.3560   -0.49   0.6240   
relationship_status_cleanVerlobt:fertile                           0.8904     0.6543    1.36   0.1736   
includedhorm_contra:fertile                                        0.3237     0.2405    1.35   0.1784   
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.4229     0.7810    0.54   0.5882   
relationship_status_cleanVerlobt:includedhorm_contra:fertile      -0.7119     1.0094   -0.70   0.4807   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00502918 (tol = 0.001, component 1)
</code></pre>
</div>
</div>
</div>
<div id="satisfaction-with-sex" class="section level2 tab-content">
<h2>Satisfaction with sex</h2>
<pre class="r"><code>model_summaries$sexual_intercourse_satisfaction</code></pre>
<div id="model-summary-16" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-17" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ included * (menstruation +  
    fertile) + fertile_mean + (1 | person)
   Data: diary

REML criterion at convergence: 14959

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.120 -0.533  0.159  0.648  2.806 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.321    0.566   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                      Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)                            5.05870    0.07605 1344.00000   66.52   &lt;2e-16 ***
includedhorm_contra                    0.08419    0.06178 1820.00000    1.36     0.17    
menstruationpre                       -0.01794    0.05745 5405.00000   -0.31     0.75    
menstruationyes                       -0.05785    0.06300 5415.00000   -0.92     0.36    
fertile                                0.06954    0.11593 5395.00000    0.60     0.55    
fertile_mean                          -0.04958    0.35353 1197.00000   -0.14     0.89    
includedhorm_contra:menstruationpre    0.04394    0.07091 5393.00000    0.62     0.54    
includedhorm_contra:menstruationyes   -0.00527    0.08296 5385.00000   -0.06     0.95    
includedhorm_contra:fertile           -0.23183    0.14204 5436.00000   -1.63     0.10    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.488                                                               
menstrutnpr             -0.295  0.375                                                        
menstrutnys             -0.228  0.286  0.322                                                 
fertile                 -0.302  0.467  0.485    0.317                                        
fertile_men             -0.754 -0.057 -0.012   -0.005   -0.097                               
inclddhrm_cntr:mnstrtnp  0.249 -0.450 -0.810   -0.261   -0.392 -0.003                        
inclddhrm_cntr:mnstrtny  0.176 -0.325 -0.244   -0.759   -0.241  0.000  0.296                 
inclddhrm_cntr:f         0.301 -0.563 -0.395   -0.259   -0.809  0.007  0.477                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.298                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.09 [-0.20;0.37].</p>
</div>
<div id="marginal-effect-plots-8" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-8" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-8" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-8" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-8" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-16" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-32" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-32" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-32" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-16" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-33" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-33" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-33" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-8" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-17" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-34" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-34" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-34" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-17" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-35" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-35" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-35" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-sexual_intercourse_satisfaction-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-8" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-8" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 14922

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.045 -0.511  0.158  0.633  2.643 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.3332   0.577                     
          fertile         0.3260   0.571    -0.11            
          menstruationpre 0.0126   0.112    -0.07  0.30      
          menstruationyes 0.2400   0.490    -0.31  0.56 -0.57
 Residual                 0.6222   0.789                     
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          5.05122    0.07658    66.0
includedhorm_contra                  0.08520    0.06234     1.4
menstruationpre                     -0.00139    0.05757     0.0
menstruationyes                     -0.04437    0.07547    -0.6
fertile                              0.06534    0.12296     0.5
fertile_mean                        -0.02105    0.35590    -0.1
includedhorm_contra:menstruationpre  0.03433    0.07099     0.5
includedhorm_contra:menstruationyes -0.02783    0.09852    -0.3
includedhorm_contra:fertile         -0.22551    0.15064    -1.5

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.491                                                               
menstrutnpr             -0.294  0.373                                                        
menstrutnys             -0.253  0.318  0.227                                                 
fertile                 -0.303  0.465  0.471    0.339                                        
fertile_men             -0.752 -0.058 -0.013   -0.008   -0.094                               
inclddhrm_cntr:mnstrtnp  0.248 -0.447 -0.811   -0.184   -0.381 -0.003                        
inclddhrm_cntr:mnstrtny  0.196 -0.364 -0.174   -0.766   -0.259  0.003  0.208                 
inclddhrm_cntr:f         0.300 -0.559 -0.384   -0.276   -0.810  0.007  0.462                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.317                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">14949</td>
<td align="center">15022</td>
<td align="center">-7463</td>
<td align="center">14927</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">14930</td>
<td align="center">15064</td>
<td align="center">-7445</td>
<td align="center">14890</td>
<td align="center">36.32</td>
<td align="center">9</td>
<td align="center">0.00003479</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-8" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-8" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-8" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 13148

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.203 -0.537  0.159  0.646  3.215 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.325579 0.5706  
 Xr.2     s(days_filled_out):includedhorm_contra 0.000000 0.0000  
 Xr.1     s(days_filled_out):includedcycling     0.000000 0.0000  
 Xr.0     s(day_number):includedhorm_contra      0.000398 0.0199  
 Xr       s(day_number):includedcycling          0.000000 0.0000  
 Residual                                        0.629937 0.7937  
Number of obs: 5069, groups:  person, 837; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                5.05916    0.07856    64.4
Xincludedhorm_contra                        0.09456    0.06489     1.5
Xmenstruationpre                           -0.00375    0.05979    -0.1
Xmenstruationyes                            0.02418    0.06834     0.4
Xfertile                                    0.13087    0.12404     1.1
Xfertile_mean                              -0.16180    0.36015    -0.4
Xincludedhorm_contra:menstruationpre        0.03564    0.07386     0.5
Xincludedhorm_contra:menstruationyes       -0.02759    0.08972    -0.3
Xincludedhorm_contra:fertile               -0.23724    0.15204    -1.6
Xs(day_number):includedcyclingFx1           0.04897    0.07951     0.6
Xs(day_number):includedhorm_contraFx1       0.01454    0.06001     0.2
Xs(days_filled_out):includedcyclingFx1     -0.04483    0.08171    -0.5
Xs(days_filled_out):includedhorm_contraFx1 -0.00163    0.06085     0.0
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
sexual_intercourse_satisfaction ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          5.05916    0.07856   64.40   &lt;2e-16 ***
includedhorm_contra                  0.09456    0.06489    1.46     0.15    
menstruationpre                     -0.00375    0.05979   -0.06     0.95    
menstruationyes                      0.02418    0.06834    0.35     0.72    
fertile                              0.13087    0.12404    1.06     0.29    
fertile_mean                        -0.16180    0.36015   -0.45     0.65    
includedhorm_contra:menstruationpre  0.03564    0.07386    0.48     0.63    
includedhorm_contra:menstruationyes -0.02759    0.08972   -0.31     0.76    
includedhorm_contra:fertile         -0.23724    0.15204   -1.56     0.12    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value
s(day_number):includedcycling          1.00   1.00 0.38    0.54
s(day_number):includedhorm_contra      1.08   1.08 0.03    0.84
s(days_filled_out):includedcycling     1.00   1.00 0.30    0.58
s(days_filled_out):includedhorm_contra 1.00   1.00 0.00    0.98

R-sq.(adj) =  -0.00227   
lmer.REML =  13148  Scale est. = 0.62994   n = 5069
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  14942 15022  -7459

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.5581   0.8144

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.1941 
Fixed effects: sexual_intercourse_satisfaction ~ included * (menstruation +      fertile) + fertile_mean 
                                     Value Std.Error   DF t-value p-value
(Intercept)                          5.051    0.0767 4870   65.88  0.0000
includedhorm_contra                  0.087    0.0627  850    1.38  0.1682
menstruationpre                     -0.012    0.0596 4870   -0.21  0.8354
menstruationyes                     -0.058    0.0652 4870   -0.89  0.3751
fertile                              0.060    0.1211 4870    0.50  0.6205
fertile_mean                        -0.013    0.3552  850   -0.04  0.9703
includedhorm_contra:menstruationpre  0.028    0.0736 4870    0.38  0.7006
includedhorm_contra:menstruationyes -0.006    0.0854 4870   -0.07  0.9432
includedhorm_contra:fertile         -0.233    0.1483 4870   -1.57  0.1165
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.493                                                               
menstruationpre                     -0.302  0.381                                                        
menstruationyes                     -0.237  0.293  0.324                                                 
fertile                             -0.309  0.476  0.475    0.313                                        
fertile_mean                        -0.750 -0.056 -0.012   -0.004   -0.101                               
includedhorm_contra:menstruationpre  0.254 -0.458 -0.810   -0.263   -0.384 -0.003                        
includedhorm_contra:menstruationyes  0.183 -0.334 -0.247   -0.763   -0.239 -0.001  0.299                 
includedhorm_contra:fertile          0.309 -0.575 -0.387   -0.255   -0.809  0.007  0.468                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.295                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-5.1176 -0.5309  0.1705  0.6519  2.7081 

Number of Observations: 5729
Number of Groups: 853 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  14944 15030  -7459

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.5589   0.8137

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
0.01937 0.18274 
Fixed effects: sexual_intercourse_satisfaction ~ included * (menstruation +      fertile) + fertile_mean 
                                     Value Std.Error   DF t-value p-value
(Intercept)                          5.052    0.0766 4870   65.96  0.0000
includedhorm_contra                  0.086    0.0626  850    1.38  0.1679
menstruationpre                     -0.013    0.0594 4870   -0.22  0.8233
menstruationyes                     -0.058    0.0650 4870   -0.89  0.3752
fertile                              0.062    0.1205 4870    0.52  0.6061
fertile_mean                        -0.018    0.3548  850   -0.05  0.9604
includedhorm_contra:menstruationpre  0.029    0.0733 4870    0.40  0.6926
includedhorm_contra:menstruationyes -0.005    0.0852 4870   -0.05  0.9571
includedhorm_contra:fertile         -0.233    0.1476 4870   -1.58  0.1137
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.493                                                               
menstruationpre                     -0.302  0.381                                                        
menstruationyes                     -0.236  0.293  0.324                                                 
fertile                             -0.309  0.475  0.477    0.314                                        
fertile_mean                        -0.750 -0.056 -0.012   -0.004   -0.100                               
includedhorm_contra:menstruationpre  0.254 -0.458 -0.810   -0.262   -0.385 -0.003                        
includedhorm_contra:menstruationyes  0.183 -0.333 -0.247   -0.763   -0.239 -0.001  0.298                 
includedhorm_contra:fertile          0.308 -0.574 -0.389   -0.256   -0.809  0.007  0.470                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.296                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-5.1121 -0.5307  0.1688  0.6516  2.7179 

Number of Observations: 5729
Number of Groups: 853 
</code></pre>
</div>
<div id="m_d-other-designs-8" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-8" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ fertile_mean + (1 | person) +  
    contraceptive_methods + fertile + menstruation + fertile:contraceptive_methods +  
    menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 9254

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.239 -0.550  0.154  0.659  2.650 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.297    0.545   
 Residual             0.611    0.782   
Number of obs: 3648, groups:  person, 470

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               5.21738    0.13413    38.9
fertile_mean                                             -0.51699    0.63327    -0.8
contraceptive_methodsfertility_awareness                 -0.08470    0.19473    -0.4
contraceptive_methodsnone                                -0.44323    0.26809    -1.7
contraceptive_methodshormonal                             0.02822    0.09864     0.3
fertile                                                   0.00995    0.20524     0.0
menstruationpre                                          -0.13066    0.09382    -1.4
menstruationyes                                           0.10969    0.11344     1.0
contraceptive_methodsfertility_awareness:fertile          0.22959    0.42250     0.5
contraceptive_methodsnone:fertile                        -0.64355    0.64121    -1.0
contraceptive_methodshormonal:fertile                    -0.15156    0.22549    -0.7
contraceptive_methodsfertility_awareness:menstruationpre -0.04603    0.20604    -0.2
contraceptive_methodsnone:menstruationpre                 0.01257    0.29155     0.0
contraceptive_methodshormonal:menstruationpre             0.18988    0.10458     1.8
contraceptive_methodsfertility_awareness:menstruationyes -0.33015    0.23064    -1.4
contraceptive_methodsnone:menstruationyes                -0.46542    0.52285    -0.9
contraceptive_methodshormonal:menstruationyes            -0.20615    0.13008    -1.6
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">9253</td>
<td align="center">9334</td>
<td align="center">-4614</td>
<td align="center">9227</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">9259</td>
<td align="center">9377</td>
<td align="center">-4611</td>
<td align="center">9221</td>
<td align="center">6.118</td>
<td align="center">6</td>
<td align="center">0.4101</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-8" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">14960</td>
<td align="center">15086</td>
<td align="center">-7461</td>
<td align="center">14922</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">14971</td>
<td align="center">15151</td>
<td align="center">-7459</td>
<td align="center">14917</td>
<td align="center">4.459</td>
<td align="center">8</td>
<td align="center">0.8135</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 14974

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.063 -0.532  0.165  0.646  2.818 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.322    0.567   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   5.11002    0.15935    32.1
menstruationpre                              -0.01956    0.05752    -0.3
menstruationyes                              -0.05758    0.06312    -0.9
fertile_mean                                 -0.02913    0.35602    -0.1
age_group(20,25]                             -0.07629    0.16667    -0.5
age_group(25,30]                             -0.10287    0.16957    -0.6
age_group(30,35]                             -0.03469    0.19628    -0.2
age_group(35,70]                              0.02395    0.18130     0.1
includedhorm_contra                           0.00458    0.16577     0.0
fertile                                      -0.37897    0.37094    -1.0
menstruationpre:includedhorm_contra           0.04752    0.07100     0.7
menstruationyes:includedhorm_contra          -0.00596    0.08311    -0.1
age_group(20,25]:includedhorm_contra          0.10272    0.18373     0.6
age_group(25,30]:includedhorm_contra          0.09352    0.19940     0.5
age_group(30,35]:includedhorm_contra          0.31059    0.26259     1.2
age_group(35,70]:includedhorm_contra          0.02374    0.33242     0.1
age_group(20,25]:fertile                      0.33683    0.40482     0.8
age_group(25,30]:fertile                      0.53492    0.40503     1.3
age_group(30,35]:fertile                      0.48244    0.45641     1.1
age_group(35,70]:fertile                      0.66886    0.44179     1.5
includedhorm_contra:fertile                   0.22288    0.39771     0.6
age_group(20,25]:includedhorm_contra:fertile -0.30783    0.43902    -0.7
age_group(25,30]:includedhorm_contra:fertile -0.55406    0.46639    -1.2
age_group(30,35]:includedhorm_contra:fertile -0.75507    0.64734    -1.2
age_group(35,70]:includedhorm_contra:fertile -1.27151    0.76008    -1.7
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-8" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">14952</td>
<td align="center">15039</td>
<td align="center">-7463</td>
<td align="center">14926</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">14955</td>
<td align="center">15055</td>
<td align="center">-7463</td>
<td align="center">14925</td>
<td align="center">0.9696</td>
<td align="center">2</td>
<td align="center">0.6158</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 14971

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.116 -0.537  0.158  0.650  2.807 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.321    0.566   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              5.05479    0.08014    63.1
menstruationpre                         -0.01826    0.05751    -0.3
menstruationyes                         -0.05817    0.06306    -0.9
fertile_mean                            -0.04547    0.35357    -0.1
weekendTRUE                              0.00701    0.05235     0.1
includedhorm_contra                      0.11157    0.06924     1.6
fertile                                  0.07197    0.15143     0.5
menstruationpre:includedhorm_contra      0.04566    0.07098     0.6
menstruationyes:includedhorm_contra     -0.00465    0.08301    -0.1
weekendTRUE:includedhorm_contra         -0.05516    0.06488    -0.9
weekendTRUE:fertile                     -0.00666    0.19443     0.0
includedhorm_contra:fertile             -0.30367    0.18666    -1.6
weekendTRUE:includedhorm_contra:fertile  0.14539    0.24029     0.6
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-8" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">14948</td>
<td align="center">15101</td>
<td align="center">-7451</td>
<td align="center">14902</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">14961</td>
<td align="center">15194</td>
<td align="center">-7445</td>
<td align="center">14891</td>
<td align="center">11.1</td>
<td align="center">12</td>
<td align="center">0.5202</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 14983

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.270 -0.532  0.155  0.646  2.802 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.318    0.564   
 Residual             0.652    0.807   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   5.057267   0.094913    53.3
menstruationpre                              -0.015243   0.057557    -0.3
menstruationyes                              -0.055538   0.063045    -0.9
fertile_mean                                 -0.063949   0.353168    -0.2
weekdayTuesday                               -0.008813   0.097793    -0.1
weekdayWednesday                             -0.001441   0.099373     0.0
weekdayThursday                               0.000774   0.101000     0.0
weekdayFriday                                -0.078798   0.097469    -0.8
weekdaySaturday                               0.055239   0.089914     0.6
weekdaySunday                                 0.017900   0.085504     0.2
includedhorm_contra                           0.222059   0.093671     2.4
fertile                                       0.286065   0.250758     1.1
menstruationpre:includedhorm_contra           0.040304   0.071033     0.6
menstruationyes:includedhorm_contra           0.000414   0.083046     0.0
weekdayTuesday:includedhorm_contra           -0.149316   0.122356    -1.2
weekdayWednesday:includedhorm_contra         -0.241538   0.124098    -1.9
weekdayThursday:includedhorm_contra          -0.121726   0.123974    -1.0
weekdayFriday:includedhorm_contra            -0.104731   0.119530    -0.9
weekdaySaturday:includedhorm_contra          -0.257871   0.110588    -2.3
weekdaySunday:includedhorm_contra            -0.121104   0.105671    -1.1
weekdayTuesday:fertile                       -0.614705   0.366179    -1.7
weekdayWednesday:fertile                     -0.040996   0.379258    -0.1
weekdayThursday:fertile                      -0.256378   0.387721    -0.7
weekdayFriday:fertile                        -0.365905   0.357488    -1.0
weekdaySaturday:fertile                      -0.303061   0.336829    -0.9
weekdaySunday:fertile                        -0.006174   0.322232     0.0
includedhorm_contra:fertile                  -0.603321   0.306998    -2.0
weekdayTuesday:includedhorm_contra:fertile    0.715507   0.457864     1.6
weekdayWednesday:includedhorm_contra:fertile  0.399936   0.474103     0.8
weekdayThursday:includedhorm_contra:fertile   0.268467   0.471275     0.6
weekdayFriday:includedhorm_contra:fertile     0.555471   0.440621     1.3
weekdaySaturday:includedhorm_contra:fertile   0.775774   0.414485     1.9
weekdaySunday:includedhorm_contra:fertile     0.045880   0.396288     0.1
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-8" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">14956</td>
<td align="center">15069</td>
<td align="center">-7461</td>
<td align="center">14922</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">14963</td>
<td align="center">15116</td>
<td align="center">-7458</td>
<td align="center">14917</td>
<td align="center">5.516</td>
<td align="center">6</td>
<td align="center">0.4795</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 14973

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.208 -0.533  0.155  0.651  2.820 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.321    0.567   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              5.06880    0.08470    59.8
menstruationpre                                         -0.01706    0.05755    -0.3
menstruationyes                                         -0.05836    0.06304    -0.9
fertile_mean                                            -0.07810    0.35911    -0.2
included_levelslax                                       0.03969    0.15113     0.3
included_levelsconservative                             -0.05503    0.12072    -0.5
included_levelsstrict                                    0.00194    0.12223     0.0
includedhorm_contra                                      0.01509    0.08611     0.2
fertile                                                  0.04788    0.14403     0.3
menstruationpre:includedhorm_contra                      0.04329    0.07108     0.6
menstruationyes:includedhorm_contra                     -0.00381    0.08305     0.0
included_levelslax:includedhorm_contra                   0.13237    0.18424     0.7
included_levelsconservative:includedhorm_contra          0.18627    0.14889     1.3
included_levelsstrict:includedhorm_contra                0.02120    0.14741     0.1
included_levelslax:fertile                               0.20137    0.35998     0.6
included_levelsconservative:fertile                      0.12625    0.26465     0.5
included_levelsstrict:fertile                           -0.10169    0.27808    -0.4
includedhorm_contra:fertile                             -0.19626    0.20836    -0.9
included_levelslax:includedhorm_contra:fertile          -0.11408    0.43077    -0.3
included_levelsconservative:includedhorm_contra:fertile -0.38112    0.33271    -1.1
included_levelsstrict:includedhorm_contra:fertile        0.23384    0.34032     0.7
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-8" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">14953</td>
<td align="center">15067</td>
<td align="center">-7460</td>
<td align="center">14919</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">14961</td>
<td align="center">15114</td>
<td align="center">-7458</td>
<td align="center">14915</td>
<td align="center">4.43</td>
<td align="center">6</td>
<td align="center">0.6187</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + cycle_length_groups + included + fertile +  
    menstruation:included + cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 14963

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.117 -0.534  0.160  0.654  2.886 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.318    0.564   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             4.74967    0.14674    32.4
menstruationpre                                        -0.02159    0.05761    -0.4
menstruationyes                                        -0.06450    0.06332    -1.0
fertile_mean                                           -0.01031    0.35725     0.0
cycle_length_groups(25,30]                              0.34772    0.14394     2.4
cycle_length_groups(30,35]                              0.27307    0.16827     1.6
cycle_length_groups(35,41]                              0.47261    0.23431     2.0
includedhorm_contra                                     0.41697    0.15872     2.6
fertile                                                 0.62852    0.32904     1.9
menstruationpre:includedhorm_contra                     0.04547    0.07107     0.6
menstruationyes:includedhorm_contra                     0.00143    0.08328     0.0
cycle_length_groups(25,30]:includedhorm_contra         -0.38432    0.16869    -2.3
cycle_length_groups(30,35]:includedhorm_contra         -0.09047    0.25000    -0.4
cycle_length_groups(35,41]:includedhorm_contra         -0.73517    0.30744    -2.4
cycle_length_groups(25,30]:fertile                     -0.61649    0.34875    -1.8
cycle_length_groups(30,35]:fertile                     -0.55837    0.40309    -1.4
cycle_length_groups(35,41]:fertile                     -0.97464    0.54878    -1.8
includedhorm_contra:fertile                            -0.79108    0.37607    -2.1
cycle_length_groups(25,30]:includedhorm_contra:fertile  0.60437    0.40037     1.5
cycle_length_groups(30,35]:includedhorm_contra:fertile  0.57816    0.61505     0.9
cycle_length_groups(35,41]:includedhorm_contra:fertile  1.21770    0.70456     1.7
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-8" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">14951</td>
<td align="center">15037</td>
<td align="center">-7462</td>
<td align="center">14925</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">14944</td>
<td align="center">15044</td>
<td align="center">-7457</td>
<td align="center">14914</td>
<td align="center">10.44</td>
<td align="center">2</td>
<td align="center">0.005394</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + certainty_menstruation + included + fertile +  
    menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 14962

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.069 -0.532  0.157  0.651  2.804 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.321    0.566   
 Residual             0.651    0.807   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          5.1488     0.2063   24.96
menstruationpre                                     -0.0106     0.0575   -0.19
menstruationyes                                     -0.0513     0.0630   -0.81
fertile_mean                                        -0.0590     0.3546   -0.17
certainty_menstruation                              -0.0209     0.0468   -0.45
includedhorm_contra                                 -0.1134     0.2505   -0.45
fertile                                             -1.4997     0.5039   -2.98
menstruationpre:includedhorm_contra                  0.0366     0.0709    0.52
menstruationyes:includedhorm_contra                 -0.0117     0.0829   -0.14
certainty_menstruation:includedhorm_contra           0.0465     0.0579    0.80
certainty_menstruation:fertile                       0.3644     0.1142    3.19
includedhorm_contra:fertile                          1.1704     0.6077    1.93
certainty_menstruation:includedhorm_contra:fertile  -0.3256     0.1377   -2.37
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-8" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">14942</td>
<td align="center">15042</td>
<td align="center">-7456</td>
<td align="center">14912</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">14949</td>
<td align="center">15076</td>
<td align="center">-7456</td>
<td align="center">14911</td>
<td align="center">1.038</td>
<td align="center">4</td>
<td align="center">0.9039</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 14959

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.071 -0.533  0.154  0.653  2.758 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.315    0.561   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        5.17495    0.08832    58.6
menstruationpre                                                                   -0.01773    0.05753    -0.3
menstruationyes                                                                   -0.05650    0.06305    -0.9
fertile_mean                                                                      -0.05108    0.35358    -0.1
cycle_regularityslightly irregular,\nup to 5 days off                             -0.28505    0.09526    -3.0
cycle_regularityirregular,\nmore than 5 days off                                  -0.09801    0.12172    -0.8
includedhorm_contra                                                               -0.01959    0.07744    -0.3
fertile                                                                            0.14915    0.15196     1.0
menstruationpre:includedhorm_contra                                                0.04269    0.07099     0.6
menstruationyes:includedhorm_contra                                               -0.00685    0.08300    -0.1
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.24748    0.13803     1.8
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.00353    0.16897     0.0
cycle_regularityslightly irregular,\nup to 5 days off:fertile                     -0.14051    0.22052    -0.6
cycle_regularityirregular,\nmore than 5 days off:fertile                          -0.19257    0.28704    -0.7
includedhorm_contra:fertile                                                       -0.29398    0.17623    -1.7
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.00665    0.31904     0.0
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.12003    0.39946     0.3
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-8" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">14947</td>
<td align="center">15047</td>
<td align="center">-7458</td>
<td align="center">14917</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">14953</td>
<td align="center">15079</td>
<td align="center">-7457</td>
<td align="center">14915</td>
<td align="center">1.763</td>
<td align="center">4</td>
<td align="center">0.7792</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 14966

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.146 -0.531  0.153  0.644  2.820 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.317    0.563   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                4.98241    0.08620    57.8
menstruationpre                                           -0.01898    0.05746    -0.3
menstruationyes                                           -0.05753    0.06303    -0.9
fertile_mean                                               0.00329    0.35358     0.0
cohabitationLive in same city                              0.05860    0.10757     0.5
cohabitationLong-distance                                  0.26295    0.10940     2.4
includedhorm_contra                                        0.08347    0.08869     0.9
fertile                                                    0.14432    0.13818     1.0
menstruationpre:includedhorm_contra                        0.04370    0.07094     0.6
menstruationyes:includedhorm_contra                       -0.00723    0.08299    -0.1
cohabitationLive in same city:includedhorm_contra         -0.03370    0.13425    -0.3
cohabitationLong-distance:includedhorm_contra             -0.09250    0.13676    -0.7
cohabitationLive in same city:fertile                     -0.18581    0.25447    -0.7
cohabitationLong-distance:fertile                         -0.17303    0.26880    -0.6
includedhorm_contra:fertile                               -0.22778    0.20272    -1.1
cohabitationLive in same city:includedhorm_contra:fertile  0.13397    0.31235     0.4
cohabitationLong-distance:includedhorm_contra:fertile     -0.00793    0.33128     0.0
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-8" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">14953</td>
<td align="center">15052</td>
<td align="center">-7461</td>
<td align="center">14923</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">14960</td>
<td align="center">15086</td>
<td align="center">-7461</td>
<td align="center">14922</td>
<td align="center">0.7288</td>
<td align="center">4</td>
<td align="center">0.9477</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexual_intercourse_satisfaction-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexual_intercourse_satisfaction ~ menstruation + fertile_mean +  
    (1 | person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 14962

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.047 -0.531  0.161  0.650  2.802 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.321    0.567   
 Residual             0.653    0.808   
Number of obs: 5729, groups:  person, 853

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       5.07310    0.07975    63.6
menstruationpre                                                  -0.02001    0.05751    -0.3
menstruationyes                                                  -0.05985    0.06312    -0.9
fertile_mean                                                     -0.01508    0.35474     0.0
relationship_status_cleanVerheiratet                             -0.08357    0.10406    -0.8
relationship_status_cleanVerlobt                                 -0.01446    0.20415    -0.1
includedhorm_contra                                               0.07255    0.06808     1.1
fertile                                                           0.03991    0.13405     0.3
menstruationpre:includedhorm_contra                               0.04567    0.07097     0.6
menstruationyes:includedhorm_contra                              -0.00471    0.08308    -0.1
relationship_status_cleanVerheiratet:includedhorm_contra         -0.18774    0.21257    -0.9
relationship_status_cleanVerlobt:includedhorm_contra              0.05682    0.29189     0.2
relationship_status_cleanVerheiratet:fertile                      0.14535    0.23210     0.6
relationship_status_cleanVerlobt:fertile                         -0.12761    0.42362    -0.3
includedhorm_contra:fertile                                      -0.20043    0.15795    -1.3
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.29899    0.51274    -0.6
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.25100    0.66356     0.4
</code></pre>
</div>
</div>
</div>
<div id="spent-night-with-partner" class="section level2 tab-content">
<h2>Spent night with partner</h2>
<pre class="r"><code>model_summaries$spent_night_with_partner</code></pre>
<div id="model-summary-18" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-19" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26904    26986   -13442    26884    26558 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.357 -0.601  0.128  0.518  4.810 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.4      1.18    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                     Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                          0.351659   0.108268    3.25   0.0012 **
includedhorm_contra                 -0.211716   0.087344   -2.42   0.0154 * 
menstruationpre                     -0.021845   0.047772   -0.46   0.6475   
menstruationyes                     -0.022537   0.045402   -0.50   0.6196   
fertile                             -0.226559   0.097179   -2.33   0.0197 * 
fertile_mean                         0.350331   0.502706    0.70   0.4859   
includedhorm_contra:menstruationpre -0.065367   0.059647   -1.10   0.2731   
includedhorm_contra:menstruationyes -0.093620   0.057776   -1.62   0.1051   
includedhorm_contra:fertile         -0.000476   0.119797    0.00   0.9968   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.467                                                               
menstrutnpr             -0.172  0.221                                                        
menstrutnys             -0.166  0.212  0.395                                                 
fertile                 -0.166  0.273  0.466    0.386                                        
fertile_men             -0.775 -0.037 -0.008   -0.007   -0.068                               
inclddhrm_cntr:mnstrtnp  0.145 -0.270 -0.801   -0.316   -0.373 -0.002                        
inclddhrm_cntr:mnstrtny  0.136 -0.255 -0.310   -0.786   -0.302 -0.002  0.382                 
inclddhrm_cntr:f         0.166 -0.336 -0.378   -0.312   -0.809  0.015  0.466                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.381                 
convergence code: 0
Model failed to converge with max|grad| = 0.00206029 (tol = 0.001, component 1)
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.23 [-0.42;-0.04].</p>
</div>
<div id="marginal-effect-plots-9" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-9" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-9" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-9" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-9" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-18" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-36" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-36" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-36" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-18" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-37" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-37" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-37" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-9" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-19" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-38" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-38" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-38" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-19" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-39" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-39" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-39" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-spent_night_with_partner-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-9" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-9" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26670    26826   -13316    26632    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.802 -0.577  0.126  0.489  4.595 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     1.414    1.189                     
        fertile         1.221    1.105     0.01            
        menstruationpre 0.323    0.568    -0.14  0.28      
        menstruationyes 0.353    0.594     0.31  0.21  0.59
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                          0.34464    0.11156    3.09    0.002 **
includedhorm_contra                 -0.20665    0.08858   -2.33    0.020 * 
menstruationpre                      0.00273    0.06139    0.04    0.965   
menstruationyes                      0.05305    0.06143    0.86    0.388   
fertile                             -0.14523    0.12378   -1.17    0.241   
fertile_mean                         0.35755    0.52713    0.68    0.498   
includedhorm_contra:menstruationpre -0.09482    0.07617   -1.25    0.213   
includedhorm_contra:menstruationyes -0.15038    0.07720   -1.95    0.051 . 
includedhorm_contra:fertile         -0.07165    0.15225   -0.47    0.638   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.456                                                               
menstrutnpr             -0.191  0.244                                                        
menstrutnys             -0.047  0.071  0.440                                                 
fertile                 -0.136  0.245  0.399    0.309                                        
fertile_men             -0.781 -0.042 -0.008   -0.016   -0.077                               
inclddhrm_cntr:mnstrtnp  0.159 -0.301 -0.790   -0.349   -0.315 -0.004                        
inclddhrm_cntr:mnstrtny  0.040 -0.073 -0.344   -0.781   -0.239  0.005  0.438                 
inclddhrm_cntr:f         0.141 -0.298 -0.318   -0.245   -0.799  0.020  0.397                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.304                 
convergence code: 0
Model failed to converge with max|grad| = 0.123492 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">26904</td>
<td align="center">26986</td>
<td align="center">-13442</td>
<td align="center">26884</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">26670</td>
<td align="center">26826</td>
<td align="center">-13316</td>
<td align="center">26632</td>
<td align="center">252.4</td>
<td align="center">9</td>
<td align="center">3.1e-49</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-9" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-9" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-9" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
   24444    24590   -12204    24408    24253 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.470 -0.602  0.124  0.505  5.125 

Random effects:
 Groups Name                                   Variance    Std.Dev.
 person (Intercept)                            1.480552331 1.216779
 Xr.2   s(days_filled_out):includedhorm_contra 0.018404837 0.135664
 Xr.1   s(days_filled_out):includedcycling     0.000002023 0.001422
 Xr.0   s(day_number):includedhorm_contra      0.039896431 0.199741
 Xr     s(day_number):includedcycling          0.000000063 0.000251
Number of obs: 24271, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value Pr(&gt;|z|)    
X(Intercept)                                0.35061    0.11180    3.14  0.00171 ** 
Xincludedhorm_contra                       -0.23661    0.09096   -2.60  0.00929 ** 
Xmenstruationpre                            0.00668    0.05024    0.13  0.89419    
Xmenstruationyes                           -0.03838    0.04868   -0.79  0.43044    
Xfertile                                   -0.25493    0.10444   -2.44  0.01465 *  
Xfertile_mean                               0.40236    0.51659    0.78  0.43605    
Xincludedhorm_contra:menstruationpre       -0.08083    0.06282   -1.29  0.19820    
Xincludedhorm_contra:menstruationyes       -0.09457    0.06194   -1.53  0.12681    
Xincludedhorm_contra:fertile                0.04109    0.12871    0.32  0.74952    
Xs(day_number):includedcyclingFx1           0.05773    0.08083    0.71  0.47511    
Xs(day_number):includedhorm_contraFx1       0.45348    0.20450    2.22  0.02659 *  
Xs(days_filled_out):includedcyclingFx1      0.01644    0.08331    0.20  0.84352    
Xs(days_filled_out):includedhorm_contraFx1 -0.32721    0.09316   -3.51  0.00044 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
spent_night_with_partner ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                          0.35061    0.10861    3.23   0.0012 **
includedhorm_contra                 -0.23661    0.08997   -2.63   0.0085 **
menstruationpre                      0.00668    0.05014    0.13   0.8940   
menstruationyes                     -0.03838    0.04814   -0.80   0.4253   
fertile                             -0.25493    0.10351   -2.46   0.0138 * 
fertile_mean                         0.40236    0.49547    0.81   0.4167   
includedhorm_contra:menstruationpre -0.08083    0.06244   -1.29   0.1955   
includedhorm_contra:menstruationyes -0.09457    0.06115   -1.55   0.1220   
includedhorm_contra:fertile          0.04109    0.12751    0.32   0.7473   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq   p-value    
s(day_number):includedcycling          1.00   1.00   0.52      0.47    
s(day_number):includedhorm_contra      2.67   2.67  28.81 0.0000026 ***
s(days_filled_out):includedcycling     1.00   1.00   0.04      0.84    
s(days_filled_out):includedhorm_contra 1.89   1.89  27.67 0.0000063 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00927   
glmer.ML =  21011  Scale est. = 1         n = 24271
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-9" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-9" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
   17622    17761    -8793    17586    17026 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-6.192 -0.611  0.100  0.544  4.796 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.23     1.11    
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                                               0.174970   0.217700    0.80    0.422  
fertile_mean                                             -0.059485   1.059445   -0.06    0.955  
contraceptive_methodsfertility_awareness                  0.742310   0.289283    2.57    0.010 *
contraceptive_methodsnone                                 0.665138   0.311950    2.13    0.033 *
contraceptive_methodshormonal                            -0.120814   0.143322   -0.84    0.399  
fertile                                                  -0.063575   0.170444   -0.37    0.709  
menstruationpre                                          -0.000879   0.081591   -0.01    0.991  
menstruationyes                                          -0.082962   0.078580   -1.06    0.291  
contraceptive_methodsfertility_awareness:fertile         -0.485002   0.397316   -1.22    0.222  
contraceptive_methodsnone:fertile                        -0.917013   0.448574   -2.04    0.041 *
contraceptive_methodshormonal:fertile                    -0.155433   0.188588   -0.82    0.410  
contraceptive_methodsfertility_awareness:menstruationpre -0.089338   0.187748   -0.48    0.634  
contraceptive_methodsnone:menstruationpre                -0.261499   0.210883   -1.24    0.215  
contraceptive_methodshormonal:menstruationpre            -0.065593   0.090994   -0.72    0.471  
contraceptive_methodsfertility_awareness:menstruationyes  0.231772   0.199886    1.16    0.246  
contraceptive_methodsnone:menstruationyes                -0.163427   0.218227   -0.75    0.454  
contraceptive_methodshormonal:menstruationyes            -0.018864   0.088626   -0.21    0.831  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00389633 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">17618</td>
<td align="center">17711</td>
<td align="center">-8797</td>
<td align="center">17594</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">17622</td>
<td align="center">17761</td>
<td align="center">-8793</td>
<td align="center">17586</td>
<td align="center">8.329</td>
<td align="center">6</td>
<td align="center">0.215</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-9" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">26817</td>
<td align="center">26964</td>
<td align="center">-13390</td>
<td align="center">26781</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">26825</td>
<td align="center">27038</td>
<td align="center">-13387</td>
<td align="center">26773</td>
<td align="center">7.741</td>
<td align="center">8</td>
<td align="center">0.4592</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26825    27038   -13387    26773    26542 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.468 -0.601  0.125  0.516  5.067 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.24     1.11    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value   Pr(&gt;|z|)    
(Intercept)                                   -0.3817     0.2102   -1.82      0.069 .  
menstruationpre                               -0.0245     0.0478   -0.51      0.608    
menstruationyes                               -0.0266     0.0454   -0.59      0.557    
fertile_mean                                   0.2957     0.4834    0.61      0.541    
age_group(20,25]                               0.3076     0.2232    1.38      0.168    
age_group(25,30]                               1.1466     0.2313    4.96 0.00000072 ***
age_group(30,35]                               1.0746     0.2672    4.02 0.00005775 ***
age_group(35,70]                               1.1456     0.2440    4.70 0.00000266 ***
includedhorm_contra                            0.1057     0.2234    0.47      0.636    
fertile                                       -0.3488     0.2602   -1.34      0.180    
menstruationpre:includedhorm_contra           -0.0616     0.0596   -1.03      0.302    
menstruationyes:includedhorm_contra           -0.0898     0.0578   -1.55      0.120    
age_group(20,25]:includedhorm_contra           0.0833     0.2540    0.33      0.743    
age_group(25,30]:includedhorm_contra          -0.2355     0.2822   -0.83      0.404    
age_group(30,35]:includedhorm_contra          -0.1367     0.3695   -0.37      0.711    
age_group(35,70]:includedhorm_contra          -0.0776     0.4160   -0.19      0.852    
age_group(20,25]:fertile                       0.0110     0.2880    0.04      0.970    
age_group(25,30]:fertile                       0.2819     0.3063    0.92      0.357    
age_group(30,35]:fertile                       0.1716     0.3606    0.48      0.634    
age_group(35,70]:fertile                       0.1860     0.3283    0.57      0.571    
includedhorm_contra:fertile                   -0.0141     0.2868   -0.05      0.961    
age_group(20,25]:includedhorm_contra:fertile   0.1722     0.3205    0.54      0.591    
age_group(25,30]:includedhorm_contra:fertile   0.0393     0.3682    0.11      0.915    
age_group(30,35]:includedhorm_contra:fertile  -0.4879     0.4918   -0.99      0.321    
age_group(35,70]:includedhorm_contra:fertile   0.4104     0.5966    0.69      0.492    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0736293 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-9" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">26682</td>
<td align="center">26780</td>
<td align="center">-13329</td>
<td align="center">26658</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">26686</td>
<td align="center">26800</td>
<td align="center">-13329</td>
<td align="center">26658</td>
<td align="center">0.4097</td>
<td align="center">2</td>
<td align="center">0.8148</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26686    26800   -13329    26658    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-6.540 -0.588  0.128  0.523  4.899 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.42     1.19    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                               0.2707     0.1102    2.46   0.0141 *  
menstruationpre                          -0.0242     0.0479   -0.51   0.6127    
menstruationyes                          -0.0240     0.0455   -0.53   0.5978    
fertile_mean                              0.3718     0.5054    0.74   0.4620    
weekendTRUE                               0.1953     0.0418    4.67 0.000003 ***
includedhorm_contra                      -0.2594     0.0905   -2.87   0.0041 ** 
fertile                                  -0.2712     0.1190   -2.28   0.0227 *  
menstruationpre:includedhorm_contra      -0.0678     0.0598   -1.13   0.2572    
menstruationyes:includedhorm_contra      -0.0928     0.0580   -1.60   0.1095    
weekendTRUE:includedhorm_contra           0.1187     0.0524    2.26   0.0236 *  
weekendTRUE:fertile                       0.0861     0.1629    0.53   0.5973    
includedhorm_contra:fertile               0.0143     0.1476    0.10   0.9226    
weekendTRUE:includedhorm_contra:fertile  -0.0409     0.2017   -0.20   0.8395    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00814985 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-9" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">26428</td>
<td align="center">26608</td>
<td align="center">-13192</td>
<td align="center">26384</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">26450</td>
<td align="center">26728</td>
<td align="center">-13191</td>
<td align="center">26382</td>
<td align="center">1.989</td>
<td align="center">12</td>
<td align="center">0.9994</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26450    26728   -13191    26382    26534 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-7.364 -0.573  0.125  0.517  5.194 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.46     1.21    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value    Pr(&gt;|z|)    
(Intercept)                                   0.54818    0.12105    4.53 0.000005938 ***
menstruationpre                              -0.02686    0.04815   -0.56      0.5770    
menstruationyes                              -0.02706    0.04576   -0.59      0.5544    
fertile_mean                                  0.36599    0.51214    0.71      0.4748    
weekdayTuesday                               -0.32483    0.07566   -4.29 0.000017590 ***
weekdayWednesday                             -0.41507    0.07590   -5.47 0.000000045 ***
weekdayThursday                              -0.34741    0.07629   -4.55 0.000005272 ***
weekdayFriday                                -0.24450    0.07757   -3.15      0.0016 ** 
weekdaySaturday                              -0.01819    0.07818   -0.23      0.8160    
weekdaySunday                                 0.03470    0.07563    0.46      0.6464    
includedhorm_contra                          -0.25964    0.10824   -2.40      0.0165 *  
fertile                                      -0.25955    0.21719   -1.20      0.2321    
menstruationpre:includedhorm_contra          -0.06467    0.06020   -1.07      0.2827    
menstruationyes:includedhorm_contra          -0.09055    0.05832   -1.55      0.1205    
weekdayTuesday:includedhorm_contra           -0.05904    0.09500   -0.62      0.5343    
weekdayWednesday:includedhorm_contra         -0.00351    0.09561   -0.04      0.9707    
weekdayThursday:includedhorm_contra           0.03257    0.09593    0.34      0.7342    
weekdayFriday:includedhorm_contra             0.05432    0.09683    0.56      0.5748    
weekdaySaturday:includedhorm_contra           0.12915    0.09758    1.32      0.1857    
weekdaySunday:includedhorm_contra             0.16390    0.09466    1.73      0.0834 .  
weekdayTuesday:fertile                       -0.01162    0.29602   -0.04      0.9687    
weekdayWednesday:fertile                      0.08129    0.29979    0.27      0.7863    
weekdayThursday:fertile                      -0.11881    0.30175   -0.39      0.6938    
weekdayFriday:fertile                         0.01322    0.30151    0.04      0.9650    
weekdaySaturday:fertile                       0.05060    0.30458    0.17      0.8681    
weekdaySunday:fertile                         0.16548    0.29776    0.56      0.5784    
includedhorm_contra:fertile                  -0.00892    0.26868   -0.03      0.9735    
weekdayTuesday:includedhorm_contra:fertile    0.03833    0.36828    0.10      0.9171    
weekdayWednesday:includedhorm_contra:fertile  0.01082    0.37341    0.03      0.9769    
weekdayThursday:includedhorm_contra:fertile   0.08804    0.37430    0.24      0.8140    
weekdayFriday:includedhorm_contra:fertile     0.14644    0.37284    0.39      0.6945    
weekdaySaturday:includedhorm_contra:fertile  -0.05244    0.37623   -0.14      0.8892    
weekdaySunday:includedhorm_contra:fertile    -0.15311    0.36768   -0.42      0.6771    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0470979 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-9" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">26893</td>
<td align="center">27024</td>
<td align="center">-13431</td>
<td align="center">26861</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">26899</td>
<td align="center">27079</td>
<td align="center">-13428</td>
<td align="center">26855</td>
<td align="center">6.367</td>
<td align="center">6</td>
<td align="center">0.3834</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26899    27079   -13428    26855    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.369 -0.601  0.130  0.517  5.201 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.37     1.17    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                              0.40457    0.11923    3.39  0.00069 ***
menstruationpre                                         -0.02037    0.04779   -0.43  0.66998    
menstruationyes                                         -0.02238    0.04541   -0.49  0.62217    
fertile_mean                                             0.39113    0.50291    0.78  0.43672    
included_levelslax                                      -0.44695    0.23704   -1.89  0.05935 .  
included_levelsconservative                             -0.06946    0.18753   -0.37  0.71111    
included_levelsstrict                                   -0.10214    0.18375   -0.56  0.57830    
includedhorm_contra                                     -0.00809    0.12220   -0.07  0.94724    
fertile                                                 -0.22145    0.12339   -1.79  0.07269 .  
menstruationpre:includedhorm_contra                     -0.06474    0.05969   -1.08  0.27809    
menstruationyes:includedhorm_contra                     -0.09413    0.05784   -1.63  0.10367    
included_levelslax:includedhorm_contra                  -0.14473    0.28896   -0.50  0.61645    
included_levelsconservative:includedhorm_contra         -0.24667    0.23318   -1.06  0.29012    
included_levelsstrict:includedhorm_contra               -0.29112    0.22515   -1.29  0.19601    
included_levelslax:fertile                               0.12255    0.29725    0.41  0.68013    
included_levelsconservative:fertile                     -0.28082    0.22366   -1.26  0.20927    
included_levelsstrict:fertile                            0.22632    0.22429    1.01  0.31296    
includedhorm_contra:fertile                              0.05734    0.18144    0.32  0.75197    
included_levelslax:includedhorm_contra:fertile          -0.38183    0.35858   -1.06  0.28695    
included_levelsconservative:includedhorm_contra:fertile  0.17615    0.28334    0.62  0.53416    
included_levelsstrict:includedhorm_contra:fertile       -0.20464    0.27863   -0.73  0.46267    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.116179 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-9" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">26903</td>
<td align="center">27034</td>
<td align="center">-13436</td>
<td align="center">26871</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">26912</td>
<td align="center">27092</td>
<td align="center">-13434</td>
<td align="center">26868</td>
<td align="center">3.623</td>
<td align="center">6</td>
<td align="center">0.7275</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-cycle_length-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26912    27092   -13434    26868    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.218 -0.600  0.128  0.518  4.806 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.38     1.18    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                                              0.0017     0.2082    0.01    0.993  
menstruationpre                                         -0.0225     0.0478   -0.47    0.638  
menstruationyes                                         -0.0226     0.0457   -0.49    0.622  
fertile_mean                                             0.5249     0.5077    1.03    0.301  
cycle_length_groups(25,30]                               0.2745     0.2052    1.34    0.181  
cycle_length_groups(30,35]                               0.5739     0.2452    2.34    0.019 *
cycle_length_groups(35,41]                               0.8269     0.3496    2.37    0.018 *
includedhorm_contra                                     -0.0945     0.2303   -0.41    0.682  
fertile                                                 -0.1673     0.2747   -0.61    0.542  
menstruationpre:includedhorm_contra                     -0.0633     0.0597   -1.06    0.289  
menstruationyes:includedhorm_contra                     -0.0907     0.0581   -1.56    0.119  
cycle_length_groups(25,30]:includedhorm_contra          -0.0313     0.2491   -0.13    0.900  
cycle_length_groups(30,35]:includedhorm_contra          -0.2979     0.3778   -0.79    0.430  
cycle_length_groups(35,41]:includedhorm_contra          -0.7448     0.4876   -1.53    0.127  
cycle_length_groups(25,30]:fertile                      -0.0558     0.2918   -0.19    0.848  
cycle_length_groups(30,35]:fertile                      -0.2349     0.3371   -0.70    0.486  
cycle_length_groups(35,41]:fertile                       0.5721     0.5078    1.13    0.260  
includedhorm_contra:fertile                             -0.1478     0.3117   -0.47    0.635  
cycle_length_groups(25,30]:includedhorm_contra:fertile   0.1722     0.3331    0.52    0.605  
cycle_length_groups(30,35]:includedhorm_contra:fertile   0.3368     0.5054    0.67    0.505  
cycle_length_groups(35,41]:includedhorm_contra:fertile  -0.5967     0.6126   -0.97    0.330  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00505019 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-9" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">26901</td>
<td align="center">26999</td>
<td align="center">-13438</td>
<td align="center">26877</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">26901</td>
<td align="center">27016</td>
<td align="center">-13437</td>
<td align="center">26873</td>
<td align="center">3.677</td>
<td align="center">2</td>
<td align="center">0.1591</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26901    27016   -13437    26873    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.285 -0.600  0.128  0.518  4.910 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.39     1.18    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                         -0.4782     0.3060   -1.56   0.1181   
menstruationpre                                     -0.0226     0.0478   -0.47   0.6365   
menstruationyes                                     -0.0234     0.0454   -0.52   0.6059   
fertile_mean                                         0.3153     0.5012    0.63   0.5293   
certainty_menstruation                               0.2030     0.0700    2.90   0.0037 **
includedhorm_contra                                  0.6197     0.3823    1.62   0.1050   
fertile                                              0.1566     0.3921    0.40   0.6896   
menstruationpre:includedhorm_contra                 -0.0645     0.0597   -1.08   0.2801   
menstruationyes:includedhorm_contra                 -0.0941     0.0578   -1.63   0.1034   
certainty_menstruation:includedhorm_contra          -0.2020     0.0892   -2.27   0.0235 * 
certainty_menstruation:fertile                      -0.0936     0.0925   -1.01   0.3118   
includedhorm_contra:fertile                          0.0952     0.4928    0.19   0.8468   
certainty_menstruation:includedhorm_contra:fertile  -0.0173     0.1145   -0.15   0.8798   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0769239 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-9" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">26905</td>
<td align="center">27020</td>
<td align="center">-13439</td>
<td align="center">26877</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">26911</td>
<td align="center">27058</td>
<td align="center">-13437</td>
<td align="center">26875</td>
<td align="center">2.632</td>
<td align="center">4</td>
<td align="center">0.6212</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26911    27058   -13437    26875    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.535 -0.600  0.127  0.520  4.931 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.39     1.18    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                         0.5238     0.1275    4.11
menstruationpre                                                                    -0.0222     0.0478   -0.46
menstruationyes                                                                    -0.0222     0.0454   -0.49
fertile_mean                                                                        0.4001     0.5059    0.79
cycle_regularityslightly irregular,\nup to 5 days off                              -0.3167     0.1453   -2.18
cycle_regularityirregular,\nmore than 5 days off                                   -0.3632     0.1744   -2.08
includedhorm_contra                                                                -0.3987     0.1148   -3.47
fertile                                                                            -0.3083     0.1373   -2.24
menstruationpre:includedhorm_contra                                                -0.0649     0.0597   -1.09
menstruationyes:includedhorm_contra                                                -0.0940     0.0578   -1.63
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.2621     0.2186    1.20
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.5198     0.2610    1.99
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.2420     0.1844    1.31
cycle_regularityirregular,\nmore than 5 days off:fertile                           -0.0737     0.2312   -0.32
includedhorm_contra:fertile                                                         0.0689     0.1567    0.44
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.1784     0.2678   -0.67
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.1592     0.3351    0.48
                                                                                  Pr(&gt;|z|)    
(Intercept)                                                                        0.00004 ***
menstruationpre                                                                    0.64207    
menstruationyes                                                                    0.62475    
fertile_mean                                                                       0.42900    
cycle_regularityslightly irregular,\nup to 5 days off                              0.02931 *  
cycle_regularityirregular,\nmore than 5 days off                                   0.03734 *  
includedhorm_contra                                                                0.00052 ***
fertile                                                                            0.02477 *  
menstruationpre:includedhorm_contra                                                0.27666    
menstruationyes:includedhorm_contra                                                0.10372    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.23048    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.04645 *  
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.18945    
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.74981    
includedhorm_contra:fertile                                                        0.66039    
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.50522    
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.63463    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0223521 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-9" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">26249</td>
<td align="center">26364</td>
<td align="center">-13111</td>
<td align="center">26221</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">26253</td>
<td align="center">26400</td>
<td align="center">-13108</td>
<td align="center">26217</td>
<td align="center">4.632</td>
<td align="center">4</td>
<td align="center">0.3272</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26253    26400   -13108    26217    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.603 -0.595  0.136  0.498  4.842 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.632    0.795   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                 1.1331     0.0956   11.85   &lt;2e-16 ***
menstruationpre                                            -0.0169     0.0480   -0.35    0.725    
menstruationyes                                            -0.0162     0.0456   -0.36    0.722    
fertile_mean                                                0.3437     0.3881    0.89    0.376    
cohabitationLive in same city                              -1.4246     0.1189  -11.98   &lt;2e-16 ***
cohabitationLong-distance                                  -1.9432     0.1150  -16.90   &lt;2e-16 ***
includedhorm_contra                                         0.1953     0.1019    1.92    0.055 .  
fertile                                                    -0.1986     0.1318   -1.51    0.132    
menstruationpre:includedhorm_contra                        -0.0632     0.0599   -1.05    0.292    
menstruationyes:includedhorm_contra                        -0.0916     0.0580   -1.58    0.115    
cohabitationLive in same city:includedhorm_contra           0.0571     0.1527    0.37    0.708    
cohabitationLong-distance:includedhorm_contra              -0.0809     0.1484   -0.54    0.586    
cohabitationLive in same city:fertile                       0.1943     0.2049    0.95    0.343    
cohabitationLong-distance:fertile                          -0.2351     0.2016   -1.17    0.243    
includedhorm_contra:fertile                                -0.1302     0.1917   -0.68    0.497    
cohabitationLive in same city:includedhorm_contra:fertile  -0.0145     0.2636   -0.06    0.956    
cohabitationLong-distance:includedhorm_contra:fertile       0.3279     0.2605    1.26    0.208    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0443107 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-9" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">26807</td>
<td align="center">26922</td>
<td align="center">-13390</td>
<td align="center">26779</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">26813</td>
<td align="center">26960</td>
<td align="center">-13389</td>
<td align="center">26777</td>
<td align="center">2.216</td>
<td align="center">4</td>
<td align="center">0.6962</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/spent_night_with_partner-rel_status-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: spent_night_with_partner ~ menstruation + fertile_mean + (1 |  
    person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   26813    26960   -13389    26777    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.671 -0.600  0.127  0.514  4.832 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 1.27     1.12    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                       0.06163    0.11183    0.55   0.5816    
menstruationpre                                                  -0.01801    0.04839   -0.37   0.7098    
menstruationyes                                                  -0.02413    0.04601   -0.52   0.5999    
fertile_mean                                                      0.36888    0.49472    0.75   0.4559    
relationship_status_cleanVerheiratet                              1.21308    0.15448    7.85  4.1e-15 ***
relationship_status_cleanVerlobt                                  0.30458    0.28261    1.08   0.2812    
includedhorm_contra                                              -0.00151    0.09381   -0.02   0.9871    
fertile                                                          -0.26216    0.10849   -2.42   0.0157 *  
menstruationpre:includedhorm_contra                              -0.07408    0.06026   -1.23   0.2189    
menstruationyes:includedhorm_contra                              -0.09715    0.05840   -1.66   0.0962 .  
relationship_status_cleanVerheiratet:includedhorm_contra         -0.34662    0.29174   -1.19   0.2348    
relationship_status_cleanVerlobt:includedhorm_contra              1.24147    0.43577    2.85   0.0044 ** 
relationship_status_cleanVerheiratet:fertile                      0.09648    0.22313    0.43   0.6655    
relationship_status_cleanVerlobt:fertile                          0.44483    0.40229    1.11   0.2688    
includedhorm_contra:fertile                                       0.01317    0.13002    0.10   0.9193    
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  0.31176    0.43791    0.71   0.4765    
relationship_status_cleanVerlobt:includedhorm_contra:fertile     -0.32332    0.62360   -0.52   0.6041    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.230833 (tol = 0.001, component 1)
</code></pre>
</div>
</div>
</div>
<div id="male-mate-retention" class="section level2 tab-content">
<h2>Male mate retention</h2>
<pre class="r"><code>model_summaries$partner_mate_retention</code></pre>
<div id="model-summary-20" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-21" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

REML criterion at convergence: 66649

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.686 -0.609  0.010  0.614  4.864 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.539    0.734   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)                             2.8096     0.0632  1331.0000   44.49   &lt;2e-16 ***
includedhorm_contra                     0.0806     0.0517  1281.0000    1.56   0.1194    
menstruationpre                        -0.0313     0.0246 25794.0000   -1.27   0.2032    
menstruationyes                        -0.0599     0.0231 25891.0000   -2.59   0.0096 ** 
fertile                                 0.0417     0.0498 25789.0000    0.84   0.4021    
fertile_mean                           -0.0567     0.2904  1444.0000   -0.20   0.8453    
includedhorm_contra:menstruationpre     0.0203     0.0315 25794.0000    0.64   0.5203    
includedhorm_contra:menstruationyes     0.0129     0.0303 25875.0000    0.43   0.6704    
includedhorm_contra:fertile            -0.1023     0.0629 25899.0000   -1.62   0.1042    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.470                                                               
menstrutnpr             -0.150  0.192                                                        
menstrutnys             -0.147  0.185  0.400                                                 
fertile                 -0.145  0.236  0.469    0.387                                        
fertile_men             -0.771 -0.033 -0.008   -0.006   -0.060                               
inclddhrm_cntr:mnstrtnp  0.124 -0.239 -0.780   -0.312   -0.366 -0.003                        
inclddhrm_cntr:mnstrtny  0.118 -0.227 -0.305   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.145 -0.298 -0.371   -0.306   -0.789  0.008  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.05 [-0.07;0.17].</p>
</div>
<div id="marginal-effect-plots-10" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-10" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-10" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-10" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-10" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-20" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-40" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-40" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-40" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-20" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-41" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-41" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-41" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-10" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-21" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-42" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-42" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-42" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-21" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-43" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-43" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-43" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-partner_mate_retention-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-10" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-10" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 66459

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.750 -0.594  0.006  0.594  4.993 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.5416   0.736                     
          fertile         0.3653   0.604    -0.10            
          menstruationpre 0.0737   0.271    -0.07  0.29      
          menstruationyes 0.0728   0.270    -0.14  0.52  0.53
 Residual                 0.6176   0.786                     
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          2.80707    0.06346    44.2
includedhorm_contra                  0.08282    0.05195     1.6
menstruationpre                     -0.02451    0.02900    -0.8
menstruationyes                     -0.05895    0.02757    -2.1
fertile                              0.05611    0.06024     0.9
fertile_mean                        -0.05393    0.29319    -0.2
includedhorm_contra:menstruationpre  0.01773    0.03719     0.5
includedhorm_contra:menstruationyes  0.00999    0.03589     0.3
includedhorm_contra:fertile         -0.10939    0.07631    -1.4

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.150  0.191                                                        
menstrutnys             -0.170  0.216  0.432                                                 
fertile                 -0.147  0.243  0.410    0.427                                        
fertile_men             -0.771 -0.034 -0.007   -0.008   -0.065                               
inclddhrm_cntr:mnstrtnp  0.124 -0.238 -0.780   -0.337   -0.319 -0.003                        
inclddhrm_cntr:mnstrtny  0.137 -0.266 -0.332   -0.768   -0.328 -0.002  0.421                 
inclddhrm_cntr:f         0.148 -0.305 -0.323   -0.337   -0.787  0.010  0.408                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.422                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">66627</td>
<td align="center">66717</td>
<td align="center">-33303</td>
<td align="center">66605</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">66458</td>
<td align="center">66622</td>
<td align="center">-33209</td>
<td align="center">66418</td>
<td align="center">187.3</td>
<td align="center">9</td>
<td align="center">1.534e-35</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-10" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-10" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-10" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 60692

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.707 -0.608  0.013  0.607  4.840 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.5478   0.740   
 Xr.2     s(days_filled_out):includedhorm_contra 0.0851   0.292   
 Xr.1     s(days_filled_out):includedcycling     0.0163   0.128   
 Xr.0     s(day_number):includedhorm_contra      0.1286   0.359   
 Xr       s(day_number):includedcycling          0.0846   0.291   
 Residual                                        0.6317   0.795   
Number of obs: 24250, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                2.79467    0.06388    43.7
Xincludedhorm_contra                        0.07319    0.05270     1.4
Xmenstruationpre                           -0.02415    0.02544    -0.9
Xmenstruationyes                           -0.05616    0.02443    -2.3
Xfertile                                    0.00978    0.05266     0.2
Xfertile_mean                              -0.00241    0.29219     0.0
Xincludedhorm_contra:menstruationpre        0.01557    0.03262     0.5
Xincludedhorm_contra:menstruationyes        0.00572    0.03196     0.2
Xincludedhorm_contra:fertile               -0.05920    0.06653    -0.9
Xs(day_number):includedcyclingFx1           0.18030    0.08579     2.1
Xs(day_number):includedhorm_contraFx1       0.39294    0.10060     3.9
Xs(days_filled_out):includedcyclingFx1     -0.10817    0.06476    -1.7
Xs(days_filled_out):includedhorm_contraFx1 -0.31911    0.09398    -3.4
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
partner_mate_retention ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          2.79467    0.06388   43.75   &lt;2e-16 ***
includedhorm_contra                  0.07319    0.05270    1.39    0.165    
menstruationpre                     -0.02415    0.02544   -0.95    0.343    
menstruationyes                     -0.05616    0.02443   -2.30    0.022 *  
fertile                              0.00978    0.05266    0.19    0.853    
fertile_mean                        -0.00241    0.29219   -0.01    0.993    
includedhorm_contra:menstruationpre  0.01557    0.03262    0.48    0.633    
includedhorm_contra:menstruationyes  0.00572    0.03196    0.18    0.858    
includedhorm_contra:fertile         -0.05920    0.06653   -0.89    0.374    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F   p-value    
s(day_number):includedcycling          4.03   4.03 3.43    0.0071 ** 
s(day_number):includedhorm_contra      4.68   4.68 7.53 0.0000013 ***
s(days_filled_out):includedcycling     2.12   2.12 2.60    0.0717 .  
s(days_filled_out):includedhorm_contra 4.01   4.01 7.88 0.0000024 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00157   
lmer.REML =  60692  Scale est. = 0.63166   n = 24250
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  65595 65694 -32786

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7239   0.8107

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2426 
Fixed effects: partner_mate_retention ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.8097   0.06394 25495   43.94  0.0000
includedhorm_contra                  0.0829   0.05254  1040    1.58  0.1147
menstruationpre                     -0.0260   0.02787 25495   -0.93  0.3504
menstruationyes                     -0.0551   0.02602 25495   -2.12  0.0343
fertile                              0.0594   0.05870 25495    1.01  0.3120
fertile_mean                        -0.0387   0.29414  1040   -0.13  0.8953
includedhorm_contra:menstruationpre  0.0150   0.03575 25495    0.42  0.6739
includedhorm_contra:menstruationyes  0.0183   0.03395 25495    0.54  0.5894
includedhorm_contra:fertile         -0.1136   0.07411 25495   -1.53  0.1253
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.167  0.211                                                        
menstruationyes                     -0.164  0.206  0.403                                                 
fertile                             -0.162  0.266  0.439    0.369                                        
fertile_mean                        -0.769 -0.033 -0.008   -0.006   -0.071                               
includedhorm_contra:menstruationpre  0.138 -0.263 -0.779   -0.314   -0.342 -0.003                        
includedhorm_contra:menstruationyes  0.131 -0.251 -0.309   -0.766   -0.282 -0.002  0.388                 
includedhorm_contra:fertile          0.163 -0.335 -0.348   -0.292   -0.789  0.011  0.438                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.363                 

Standardized Within-Group Residuals:
      Min        Q1       Med        Q3       Max 
-4.592864 -0.617268  0.003603  0.597726  4.748709 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  65540 65647 -32757

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7196   0.8137

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.4880 -0.2608 
Fixed effects: partner_mate_retention ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.8075   0.06405 25495   43.83  0.0000
includedhorm_contra                  0.0847   0.05268  1040    1.61  0.1080
menstruationpre                     -0.0239   0.02830 25495   -0.85  0.3980
menstruationyes                     -0.0545   0.02653 25495   -2.05  0.0400
fertile                              0.0645   0.06066 25495    1.06  0.2879
fertile_mean                        -0.0352   0.29481  1040   -0.12  0.9049
includedhorm_contra:menstruationpre  0.0140   0.03633 25495    0.39  0.7002
includedhorm_contra:menstruationyes  0.0165   0.03455 25495    0.48  0.6339
includedhorm_contra:fertile         -0.1206   0.07657 25495   -1.57  0.1154
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.169  0.212                                                        
menstruationyes                     -0.167  0.209  0.411                                                 
fertile                             -0.163  0.270  0.420    0.362                                        
fertile_mean                        -0.768 -0.033 -0.007   -0.006   -0.074                               
includedhorm_contra:menstruationpre  0.138 -0.264 -0.779   -0.320   -0.326 -0.003                        
includedhorm_contra:menstruationyes  0.134 -0.255 -0.315   -0.768   -0.278 -0.002  0.396                 
includedhorm_contra:fertile          0.166 -0.340 -0.332   -0.287   -0.789  0.011  0.418                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.355                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-4.56148 -0.61594  0.00668  0.59720  4.73160 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-10" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-10" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 42595

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.677 -0.617  0.021  0.610  4.850 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.506    0.711   
 Residual             0.646    0.804   
Number of obs: 17026, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                                2.9302     0.1357   21.59
fertile_mean                                              -0.4258     0.6610   -0.64
contraceptive_methodsfertility_awareness                   0.1892     0.1755    1.08
contraceptive_methodsnone                                  0.0980     0.1860    0.53
contraceptive_methodshormonal                              0.0399     0.0885    0.45
fertile                                                   -0.0139     0.0897   -0.16
menstruationpre                                           -0.0440     0.0433   -1.02
menstruationyes                                           -0.0278     0.0414   -0.67
contraceptive_methodsfertility_awareness:fertile           0.1874     0.2037    0.92
contraceptive_methodsnone:fertile                          0.0330     0.2205    0.15
contraceptive_methodshormonal:fertile                     -0.0894     0.1002   -0.89
contraceptive_methodsfertility_awareness:menstruationpre   0.0676     0.0959    0.70
contraceptive_methodsnone:menstruationpre                 -0.0599     0.1003   -0.60
contraceptive_methodshormonal:menstruationpre              0.0167     0.0488    0.34
contraceptive_methodsfertility_awareness:menstruationyes   0.0411     0.0964    0.43
contraceptive_methodsnone:menstruationyes                 -0.0949     0.1049   -0.91
contraceptive_methodshormonal:menstruationyes             -0.0429     0.0472   -0.91
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">42568</td>
<td align="center">42669</td>
<td align="center">-21271</td>
<td align="center">42542</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">42578</td>
<td align="center">42725</td>
<td align="center">-21270</td>
<td align="center">42540</td>
<td align="center">2.417</td>
<td align="center">6</td>
<td align="center">0.8777</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-10" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">66605</td>
<td align="center">66761</td>
<td align="center">-33284</td>
<td align="center">66567</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">66601</td>
<td align="center">66822</td>
<td align="center">-33274</td>
<td align="center">66547</td>
<td align="center">20.4</td>
<td align="center">8</td>
<td align="center">0.008939</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 66629

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.684 -0.606  0.008  0.613  4.870 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.525    0.725   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    3.0442     0.1307   23.29
menstruationpre                               -0.0323     0.0246   -1.31
menstruationyes                               -0.0606     0.0231   -2.62
fertile_mean                                  -0.0978     0.2888   -0.34
age_group(20,25]                              -0.1304     0.1400   -0.93
age_group(25,30]                              -0.1530     0.1441   -1.06
age_group(30,35]                              -0.4340     0.1653   -2.62
age_group(35,70]                              -0.4979     0.1519   -3.28
includedhorm_contra                            0.0518     0.1402    0.37
fertile                                       -0.0194     0.1413   -0.14
menstruationpre:includedhorm_contra            0.0194     0.0315    0.62
menstruationyes:includedhorm_contra            0.0116     0.0303    0.38
age_group(20,25]:includedhorm_contra          -0.0803     0.1597   -0.50
age_group(25,30]:includedhorm_contra          -0.1681     0.1758   -0.96
age_group(30,35]:includedhorm_contra           0.0739     0.2291    0.32
age_group(35,70]:includedhorm_contra          -0.2092     0.2583   -0.81
age_group(20,25]:fertile                       0.1668     0.1565    1.07
age_group(25,30]:fertile                      -0.0805     0.1614   -0.50
age_group(30,35]:fertile                       0.2959     0.1869    1.58
age_group(35,70]:fertile                      -0.0564     0.1703   -0.33
includedhorm_contra:fertile                   -0.1135     0.1567   -0.72
age_group(20,25]:includedhorm_contra:fertile  -0.0845     0.1754   -0.48
age_group(25,30]:includedhorm_contra:fertile   0.2440     0.1943    1.26
age_group(30,35]:includedhorm_contra:fertile  -0.4912     0.2508   -1.96
age_group(35,70]:includedhorm_contra:fertile   0.6145     0.2862    2.15
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-10" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66514</td>
<td align="center">66621</td>
<td align="center">-33244</td>
<td align="center">66488</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66516</td>
<td align="center">66639</td>
<td align="center">-33243</td>
<td align="center">66486</td>
<td align="center">2.598</td>
<td align="center">2</td>
<td align="center">0.2729</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 66550

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.635 -0.606  0.006  0.608  4.795 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.539    0.734   
 Residual             0.640    0.800   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              2.77087    0.06373    43.5
menstruationpre                         -0.03134    0.02451    -1.3
menstruationyes                         -0.06059    0.02307    -2.6
fertile_mean                            -0.04523    0.29024    -0.2
weekendTRUE                              0.09166    0.02139     4.3
includedhorm_contra                      0.07983    0.05288     1.5
fertile                                  0.00486    0.06044     0.1
menstruationpre:includedhorm_contra      0.01950    0.03144     0.6
menstruationyes:includedhorm_contra      0.01482    0.03023     0.5
weekendTRUE:includedhorm_contra          0.00454    0.02748     0.2
weekendTRUE:fertile                      0.08534    0.08335     1.0
includedhorm_contra:fertile             -0.10069    0.07661    -1.3
weekendTRUE:includedhorm_contra:fertile -0.00457    0.10564     0.0
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-10" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">66467</td>
<td align="center">66655</td>
<td align="center">-33210</td>
<td align="center">66421</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">66481</td>
<td align="center">66767</td>
<td align="center">-33205</td>
<td align="center">66411</td>
<td align="center">9.837</td>
<td align="center">12</td>
<td align="center">0.6303</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 66554

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.597 -0.604  0.008  0.607  4.728 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.639    0.799   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.82836    0.06786    41.7
menstruationpre                              -0.03138    0.02449    -1.3
menstruationyes                              -0.06092    0.02305    -2.6
fertile_mean                                 -0.05140    0.29028    -0.2
weekdayTuesday                               -0.10441    0.03818    -2.7
weekdayWednesday                             -0.04758    0.03814    -1.2
weekdayThursday                              -0.07429    0.03858    -1.9
weekdayFriday                                -0.02431    0.03922    -0.6
weekdaySaturday                               0.07038    0.03965     1.8
weekdaySunday                                 0.06112    0.03830     1.6
includedhorm_contra                           0.08581    0.06065     1.4
fertile                                       0.03254    0.10803     0.3
menstruationpre:includedhorm_contra           0.02018    0.03141     0.6
menstruationyes:includedhorm_contra           0.01573    0.03020     0.5
weekdayTuesday:includedhorm_contra           -0.01171    0.04899    -0.2
weekdayWednesday:includedhorm_contra         -0.04934    0.04916    -1.0
weekdayThursday:includedhorm_contra           0.03766    0.04965     0.8
weekdayFriday:includedhorm_contra             0.00479    0.05031     0.1
weekdaySaturday:includedhorm_contra          -0.02136    0.05093    -0.4
weekdaySunday:includedhorm_contra             0.00937    0.04935     0.2
weekdayTuesday:fertile                       -0.04962    0.14862    -0.3
weekdayWednesday:fertile                     -0.17501    0.14958    -1.2
weekdayThursday:fertile                       0.12698    0.15181     0.8
weekdayFriday:fertile                         0.02826    0.15196     0.2
weekdaySaturday:fertile                       0.01973    0.15398     0.1
weekdaySunday:fertile                         0.13126    0.14970     0.9
includedhorm_contra:fertile                  -0.19676    0.13778    -1.4
weekdayTuesday:includedhorm_contra:fertile    0.19644    0.18917     1.0
weekdayWednesday:includedhorm_contra:fertile  0.23770    0.19087     1.2
weekdayThursday:includedhorm_contra:fertile  -0.05598    0.19252    -0.3
weekdayFriday:includedhorm_contra:fertile     0.14822    0.19300     0.8
weekdaySaturday:includedhorm_contra:fertile   0.06031    0.19577     0.3
weekdaySunday:includedhorm_contra:fertile     0.05820    0.19055     0.3
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-10" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">66631</td>
<td align="center">66770</td>
<td align="center">-33298</td>
<td align="center">66597</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">66635</td>
<td align="center">66824</td>
<td align="center">-33295</td>
<td align="center">66589</td>
<td align="center">7.215</td>
<td align="center">6</td>
<td align="center">0.3014</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 66666

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.694 -0.608  0.014  0.613  4.876 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.537    0.733   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                               2.7608     0.0701    39.4
menstruationpre                                          -0.0323     0.0246    -1.3
menstruationyes                                          -0.0595     0.0231    -2.6
fertile_mean                                             -0.0978     0.2922    -0.3
included_levelslax                                       -0.0308     0.1448    -0.2
included_levelsconservative                               0.2289     0.1130     2.0
included_levelsstrict                                     0.1740     0.1113     1.6
includedhorm_contra                                       0.1248     0.0723     1.7
fertile                                                   0.0629     0.0632     1.0
menstruationpre:includedhorm_contra                       0.0206     0.0315     0.7
menstruationyes:includedhorm_contra                       0.0113     0.0303     0.4
included_levelslax:includedhorm_contra                   -0.0194     0.1760    -0.1
included_levelsconservative:includedhorm_contra          -0.1360     0.1410    -1.0
included_levelsstrict:includedhorm_contra                -0.1876     0.1365    -1.4
included_levelslax:fertile                               -0.1922     0.1528    -1.3
included_levelsconservative:fertile                       0.0295     0.1143     0.3
included_levelsstrict:fertile                            -0.0515     0.1143    -0.5
includedhorm_contra:fertile                              -0.0570     0.0961    -0.6
included_levelslax:includedhorm_contra:fertile            0.0245     0.1864     0.1
included_levelsconservative:includedhorm_contra:fertile  -0.1704     0.1485    -1.1
included_levelsstrict:includedhorm_contra:fertile         0.0524     0.1462     0.4
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-10" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">66635</td>
<td align="center">66774</td>
<td align="center">-33300</td>
<td align="center">66601</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">66644</td>
<td align="center">66833</td>
<td align="center">-33299</td>
<td align="center">66598</td>
<td align="center">2.388</td>
<td align="center">6</td>
<td align="center">0.8808</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 66667

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.687 -0.609  0.009  0.612  4.845 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             2.64830    0.12374   21.40
menstruationpre                                        -0.03101    0.02460   -1.26
menstruationyes                                        -0.05986    0.02329   -2.57
fertile_mean                                           -0.08311    0.29390   -0.28
cycle_length_groups(25,30]                              0.21737    0.12243    1.78
cycle_length_groups(30,35]                              0.11033    0.14630    0.75
cycle_length_groups(35,41]                              0.05463    0.20629    0.26
includedhorm_contra                                     0.21382    0.13822    1.55
fertile                                                 0.05420    0.13408    0.40
menstruationpre:includedhorm_contra                     0.01973    0.03154    0.63
menstruationyes:includedhorm_contra                     0.01097    0.03047    0.36
cycle_length_groups(25,30]:includedhorm_contra         -0.17766    0.14977   -1.19
cycle_length_groups(30,35]:includedhorm_contra         -0.05365    0.22781   -0.24
cycle_length_groups(35,41]:includedhorm_contra         -0.05378    0.29468   -0.18
cycle_length_groups(25,30]:fertile                     -0.01622    0.14339   -0.11
cycle_length_groups(30,35]:fertile                      0.03233    0.16861    0.19
cycle_length_groups(35,41]:fertile                     -0.15490    0.23620   -0.66
includedhorm_contra:fertile                            -0.02916    0.15711   -0.19
cycle_length_groups(25,30]:includedhorm_contra:fertile -0.08846    0.16874   -0.52
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.06354    0.26282   -0.24
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.00758    0.30996   -0.02
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-10" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66627</td>
<td align="center">66733</td>
<td align="center">-33300</td>
<td align="center">66601</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66625</td>
<td align="center">66747</td>
<td align="center">-33297</td>
<td align="center">66595</td>
<td align="center">5.932</td>
<td align="center">2</td>
<td align="center">0.05151</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 66657

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.690 -0.609  0.009  0.611  4.870 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.538    0.733   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         2.57845    0.18321   14.07
menstruationpre                                    -0.02964    0.02458   -1.21
menstruationyes                                    -0.05734    0.02315   -2.48
fertile_mean                                       -0.08003    0.29059   -0.28
certainty_menstruation                              0.05673    0.04180    1.36
includedhorm_contra                                 0.11127    0.22997    0.48
fertile                                            -0.35695    0.20102   -1.78
menstruationpre:includedhorm_contra                 0.01862    0.03151    0.59
menstruationyes:includedhorm_contra                 0.00959    0.03032    0.32
certainty_menstruation:includedhorm_contra         -0.00872    0.05359   -0.16
certainty_menstruation:fertile                      0.09630    0.04700    2.05
includedhorm_contra:fertile                         0.50319    0.25793    1.95
certainty_menstruation:includedhorm_contra:fertile -0.14450    0.05957   -2.43
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-10" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">66632</td>
<td align="center">66755</td>
<td align="center">-33301</td>
<td align="center">66602</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">66627</td>
<td align="center">66783</td>
<td align="center">-33295</td>
<td align="center">66589</td>
<td align="center">12.66</td>
<td align="center">4</td>
<td align="center">0.01304</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 66654

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.689 -0.607  0.010  0.613  4.868 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         2.8680     0.0746    38.5
menstruationpre                                                                    -0.0331     0.0246    -1.3
menstruationyes                                                                    -0.0611     0.0231    -2.6
fertile_mean                                                                       -0.0861     0.2922    -0.3
cycle_regularityslightly irregular,\nup to 5 days off                              -0.0876     0.0870    -1.0
cycle_regularityirregular,\nmore than 5 days off                                   -0.1179     0.1040    -1.1
includedhorm_contra                                                                 0.0468     0.0681     0.7
fertile                                                                            -0.0984     0.0687    -1.4
menstruationpre:includedhorm_contra                                                 0.0214     0.0315     0.7
menstruationyes:includedhorm_contra                                                 0.0126     0.0303     0.4
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.0808     0.1316     0.6
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               -0.1112     0.1567    -0.7
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.2401     0.0946     2.5
cycle_regularityirregular,\nmore than 5 days off:fertile                            0.2793     0.1181     2.4
includedhorm_contra:fertile                                                         0.0160     0.0804     0.2
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.2185     0.1403    -1.6
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       -0.0288     0.1747    -0.2
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-10" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">66634</td>
<td align="center">66757</td>
<td align="center">-33302</td>
<td align="center">66604</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">66642</td>
<td align="center">66797</td>
<td align="center">-33302</td>
<td align="center">66604</td>
<td align="center">0.1408</td>
<td align="center">4</td>
<td align="center">0.9976</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 66672

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.687 -0.609  0.010  0.613  4.863 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.541    0.736   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 2.7994     0.0726    38.6
menstruationpre                                            -0.0313     0.0246    -1.3
menstruationyes                                            -0.0600     0.0231    -2.6
fertile_mean                                               -0.0694     0.2914    -0.2
cohabitationLive in same city                              -0.0264     0.0989    -0.3
cohabitationLong-distance                                   0.0714     0.0932     0.8
includedhorm_contra                                         0.0765     0.0784     1.0
fertile                                                     0.0285     0.0625     0.5
menstruationpre:includedhorm_contra                         0.0202     0.0315     0.6
menstruationyes:includedhorm_contra                         0.0129     0.0303     0.4
cohabitationLive in same city:includedhorm_contra           0.0595     0.1263     0.5
cohabitationLong-distance:includedhorm_contra              -0.0559     0.1209    -0.5
cohabitationLive in same city:fertile                       0.0293     0.1133     0.3
cohabitationLong-distance:fertile                           0.0301     0.1021     0.3
includedhorm_contra:fertile                                -0.0846     0.0908    -0.9
cohabitationLive in same city:includedhorm_contra:fertile  -0.0403     0.1415    -0.3
cohabitationLong-distance:includedhorm_contra:fertile      -0.0320     0.1313    -0.2
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-10" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">66621</td>
<td align="center">66744</td>
<td align="center">-33295</td>
<td align="center">66591</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">66623</td>
<td align="center">66778</td>
<td align="center">-33292</td>
<td align="center">66585</td>
<td align="center">6.148</td>
<td align="center">4</td>
<td align="center">0.1884</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/partner_mate_retention-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 66644

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.686 -0.608  0.009  0.613  4.865 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.534    0.731   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                        2.8403     0.0672    42.3
menstruationpre                                                   -0.0311     0.0246    -1.3
menstruationyes                                                   -0.0598     0.0231    -2.6
fertile_mean                                                      -0.0309     0.2896    -0.1
relationship_status_cleanVerheiratet                              -0.1480     0.0911    -1.6
relationship_status_cleanVerlobt                                  -0.0048     0.1732     0.0
includedhorm_contra                                                0.0514     0.0576     0.9
fertile                                                            0.0823     0.0568     1.4
menstruationpre:includedhorm_contra                                0.0198     0.0315     0.6
menstruationyes:includedhorm_contra                                0.0127     0.0303     0.4
relationship_status_cleanVerheiratet:includedhorm_contra          -0.2016     0.1755    -1.1
relationship_status_cleanVerlobt:includedhorm_contra               0.3493     0.2551     1.4
relationship_status_cleanVerheiratet:fertile                      -0.1983     0.1010    -2.0
relationship_status_cleanVerlobt:fertile                           0.1147     0.1870     0.6
includedhorm_contra:fertile                                       -0.1520     0.0692    -2.2
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.2666     0.1884     1.4
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.1434     0.2903     0.5
</code></pre>
<pre class="r"><code>do_moderators(models$partner_mate_retention, diary)</code></pre>
</div>
</div>
<div id="moderators-2" class="section level3 tab-content">
<h3>Moderators</h3>
<div id="partners-physical-attractiveness-2" class="section level4">
<h4>Partner’s physical attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s physical attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_physical&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66599</td>
<td align="center">66705</td>
<td align="center">-33286</td>
<td align="center">66573</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66601</td>
<td align="center">66724</td>
<td align="center">-33286</td>
<td align="center">66571</td>
<td align="center">1.346</td>
<td align="center">2</td>
<td align="center">0.5102</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/phys_attr-18-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_physical + included + fertile + menstruation:included +  
    partner_attractiveness_physical:included + partner_attractiveness_physical:fertile +  
    included:fertile + partner_attractiveness_physical:included:fertile
   Data: diary

REML criterion at convergence: 66638

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.690 -0.610  0.009  0.613  4.863 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.523    0.723   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                  1.85590    0.19622    9.46
menstruationpre                                             -0.03179    0.02457   -1.29
menstruationyes                                             -0.06076    0.02312   -2.63
fertile_mean                                                -0.09321    0.28704   -0.32
partner_attractiveness_physical                              0.12066    0.02348    5.14
includedhorm_contra                                          0.58408    0.25490    2.29
fertile                                                      0.22772    0.21993    1.04
menstruationpre:includedhorm_contra                          0.02073    0.03150    0.66
menstruationyes:includedhorm_contra                          0.01349    0.03029    0.45
partner_attractiveness_physical:includedhorm_contra         -0.06486    0.03102   -2.09
partner_attractiveness_physical:fertile                     -0.02339    0.02685   -0.87
includedhorm_contra:fertile                                 -0.14841    0.28865   -0.51
partner_attractiveness_physical:includedhorm_contra:fertile  0.00641    0.03483    0.18
</code></pre>
</div>
<div id="partners-short-term-attractiveness-2" class="section level4">
<h4>Partner’s short-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s short-term attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66604</td>
<td align="center">66710</td>
<td align="center">-33289</td>
<td align="center">66578</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66606</td>
<td align="center">66729</td>
<td align="center">-33288</td>
<td align="center">66576</td>
<td align="center">1.407</td>
<td align="center">2</td>
<td align="center">0.4948</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr-19-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm + included + fertile + menstruation:included +  
    partner_attractiveness_shortterm:included + partner_attractiveness_shortterm:fertile +  
    included:fertile + partner_attractiveness_shortterm:included:fertile
   Data: diary

REML criterion at convergence: 66639

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.681 -0.609  0.010  0.612  4.866 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.526    0.725   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                             Estimate Std. Error t value
(Intercept)                                                    2.8283     0.0627    45.1
menstruationpre                                               -0.0314     0.0246    -1.3
menstruationyes                                               -0.0606     0.0231    -2.6
fertile_mean                                                  -0.0791     0.2876    -0.3
partner_attractiveness_shortterm                               0.1521     0.0370     4.1
includedhorm_contra                                            0.0539     0.0514     1.0
fertile                                                        0.0372     0.0499     0.7
menstruationpre:includedhorm_contra                            0.0202     0.0315     0.6
menstruationyes:includedhorm_contra                            0.0133     0.0303     0.4
partner_attractiveness_shortterm:includedhorm_contra          -0.0418     0.0494    -0.8
partner_attractiveness_shortterm:fertile                      -0.0495     0.0422    -1.2
includedhorm_contra:fertile                                   -0.0989     0.0633    -1.6
partner_attractiveness_shortterm:includedhorm_contra:fertile   0.0557     0.0549     1.0
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-4" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) top-right (high LT, low ST), then top-left (low LT, low ST), then bottom-left (low LT, high ST), then bottom-right (high LT/ST).</p>
<pre class="r"><code>add_main = update.formula(formula(model), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * included + partner_attractiveness_shortterm * included + partner_attractiveness_longterm * partner_attractiveness_shortterm&quot;))) # reorder so that the triptych looks nice
add_mod_formula = update.formula(update.formula(formula(model), new = . ~ . - included * fertile), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * fertile * partner_attractiveness_shortterm * included&quot;))) # reorder so that the triptych looks nice

update(model, formula = add_main) -&gt; with_main
update(model, formula = add_mod_formula) -&gt; with_mod
cat(pander(anova(with_main, with_mod)))</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">66587</td>
<td align="center">66718</td>
<td align="center">-33278</td>
<td align="center">66555</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">66593</td>
<td align="center">66781</td>
<td align="center">-33273</td>
<td align="center">66547</td>
<td align="center">8.901</td>
<td align="center">7</td>
<td align="center">0.2599</td>
</tr>
</tbody>
</table>
<pre class="r"><code>effs = allEffects(with_mod)
effs = data.frame(effs$`partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included`) %&gt;% 
  filter(partner_attractiveness_longterm %in% c(-2,0),partner_attractiveness_shortterm %in% c(-2,0))
ggplot(effs, aes(fertile, fit, ymin = lower, ymax = upper, color = included)) + 
  facet_grid(partner_attractiveness_shortterm ~ partner_attractiveness_longterm) +
  geom_smooth(stat=&#39;identity&#39;) +
  scale_color_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  scale_fill_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  ggtitle(&quot;Moderation&quot;, &quot;top-to-bottom: short-term,\nleft-to-right: long-term attractiveness of the partner&quot;)+
  ylab(names(model@frame)[1])</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/st_vs_lt-20-1.png" width="768" /></p>
<pre class="r"><code>print_summary(with_mod)</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + fertile + partner_attractiveness_shortterm +  
    included + menstruation:included + partner_attractiveness_longterm:fertile +  
    partner_attractiveness_longterm:partner_attractiveness_shortterm +  
    fertile:partner_attractiveness_shortterm + partner_attractiveness_longterm:included +  
    fertile:included + partner_attractiveness_shortterm:included +  
    partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm +  
    partner_attractiveness_longterm:fertile:included + partner_attractiveness_longterm:partner_attractiveness_shortterm:included +  
    fertile:partner_attractiveness_shortterm:included + partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included
   Data: diary

REML criterion at convergence: 66647

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.680 -0.609  0.008  0.611  4.873 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.515    0.718   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                             Estimate
(Intercept)                                                                                   2.81517
menstruationpre                                                                              -0.03138
menstruationyes                                                                              -0.05993
fertile_mean                                                                                 -0.02444
partner_attractiveness_longterm                                                               0.14260
fertile                                                                                       0.04274
partner_attractiveness_shortterm                                                              0.08910
includedhorm_contra                                                                           0.05976
menstruationpre:includedhorm_contra                                                           0.02078
menstruationyes:includedhorm_contra                                                           0.01316
partner_attractiveness_longterm:fertile                                                       0.02199
partner_attractiveness_longterm:partner_attractiveness_shortterm                             -0.00622
fertile:partner_attractiveness_shortterm                                                     -0.06483
partner_attractiveness_longterm:includedhorm_contra                                          -0.05495
fertile:includedhorm_contra                                                                  -0.12572
partner_attractiveness_shortterm:includedhorm_contra                                          0.00217
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                     -0.01895
partner_attractiveness_longterm:fertile:includedhorm_contra                                   0.03491
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra         -0.01366
fertile:partner_attractiveness_shortterm:includedhorm_contra                                  0.05033
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra  0.11641
                                                                                             Std. Error
(Intercept)                                                                                     0.06378
menstruationpre                                                                                 0.02457
menstruationyes                                                                                 0.02315
fertile_mean                                                                                    0.28571
partner_attractiveness_longterm                                                                 0.04385
fertile                                                                                         0.05218
partner_attractiveness_shortterm                                                                0.04116
includedhorm_contra                                                                             0.05351
menstruationpre:includedhorm_contra                                                             0.03151
menstruationyes:includedhorm_contra                                                             0.03031
partner_attractiveness_longterm:fertile                                                         0.05021
partner_attractiveness_longterm:partner_attractiveness_shortterm                                0.03238
fertile:partner_attractiveness_shortterm                                                        0.04641
partner_attractiveness_longterm:includedhorm_contra                                             0.05576
fertile:includedhorm_contra                                                                     0.06559
partner_attractiveness_shortterm:includedhorm_contra                                            0.05312
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        0.03741
partner_attractiveness_longterm:fertile:includedhorm_contra                                     0.06360
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            0.05025
fertile:partner_attractiveness_shortterm:includedhorm_contra                                    0.05898
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra    0.05761
                                                                                             t value
(Intercept)                                                                                     44.1
menstruationpre                                                                                 -1.3
menstruationyes                                                                                 -2.6
fertile_mean                                                                                    -0.1
partner_attractiveness_longterm                                                                  3.3
fertile                                                                                          0.8
partner_attractiveness_shortterm                                                                 2.2
includedhorm_contra                                                                              1.1
menstruationpre:includedhorm_contra                                                              0.7
menstruationyes:includedhorm_contra                                                              0.4
partner_attractiveness_longterm:fertile                                                          0.4
partner_attractiveness_longterm:partner_attractiveness_shortterm                                -0.2
fertile:partner_attractiveness_shortterm                                                        -1.4
partner_attractiveness_longterm:includedhorm_contra                                             -1.0
fertile:includedhorm_contra                                                                     -1.9
partner_attractiveness_shortterm:includedhorm_contra                                             0.0
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        -0.5
partner_attractiveness_longterm:fertile:includedhorm_contra                                      0.5
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            -0.3
fertile:partner_attractiveness_shortterm:includedhorm_contra                                     0.9
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra     2.0
</code></pre>
</div>
<div id="relative-attractiveness-to-self-2" class="section level4">
<h4>Relative attractiveness to self</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s relative attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_rel_to_self&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66631</td>
<td align="center">66737</td>
<td align="center">-33303</td>
<td align="center">66605</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66632</td>
<td align="center">66754</td>
<td align="center">-33301</td>
<td align="center">66602</td>
<td align="center">3.362</td>
<td align="center">2</td>
<td align="center">0.1862</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/rel_self-21-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_rel_to_self + included + fertile +  
    menstruation:included + partner_attractiveness_rel_to_self:included +  
    partner_attractiveness_rel_to_self:fertile + included:fertile +  
    partner_attractiveness_rel_to_self:included:fertile
   Data: diary

REML criterion at convergence: 66662

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.687 -0.608  0.010  0.612  4.865 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                               Estimate Std. Error t value
(Intercept)                                                      2.8169     0.0711    39.6
menstruationpre                                                 -0.0313     0.0246    -1.3
menstruationyes                                                 -0.0601     0.0231    -2.6
fertile_mean                                                    -0.0597     0.2906    -0.2
partner_attractiveness_rel_to_self                               0.0196     0.0908     0.2
includedhorm_contra                                              0.0732     0.0610     1.2
fertile                                                          0.0300     0.0593     0.5
menstruationpre:includedhorm_contra                              0.0205     0.0315     0.7
menstruationyes:includedhorm_contra                              0.0137     0.0303     0.5
partner_attractiveness_rel_to_self:includedhorm_contra          -0.0187     0.0944    -0.2
partner_attractiveness_rel_to_self:fertile                      -0.0353     0.0963    -0.4
includedhorm_contra:fertile                                     -0.0756     0.0712    -1.1
partner_attractiveness_rel_to_self:includedhorm_contra:fertile  -0.0128     0.1000    -0.1
</code></pre>
</div>
<div id="partners-shortterm-attractiveness-alternative-specification-2" class="section level4">
<h4>Partner’s shortterm attractiveness, alternative specification</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm_v2&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66612</td>
<td align="center">66718</td>
<td align="center">-33293</td>
<td align="center">66586</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66613</td>
<td align="center">66736</td>
<td align="center">-33291</td>
<td align="center">66583</td>
<td align="center">2.986</td>
<td align="center">2</td>
<td align="center">0.2247</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr2-22-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm_v2 + included + fertile +  
    menstruation:included + partner_attractiveness_shortterm_v2:included +  
    partner_attractiveness_shortterm_v2:fertile + included:fertile +  
    partner_attractiveness_shortterm_v2:included:fertile
   Data: diary

REML criterion at convergence: 66646

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.688 -0.610  0.010  0.614  4.863 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.530    0.728   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                Estimate Std. Error t value
(Intercept)                                                       2.8216     0.0628    44.9
menstruationpre                                                  -0.0316     0.0246    -1.3
menstruationyes                                                  -0.0610     0.0231    -2.6
fertile_mean                                                     -0.0891     0.2886    -0.3
partner_attractiveness_shortterm_v2                               0.1547     0.0373     4.2
includedhorm_contra                                               0.0713     0.0514     1.4
fertile                                                           0.0392     0.0498     0.8
menstruationpre:includedhorm_contra                               0.0205     0.0315     0.7
menstruationyes:includedhorm_contra                               0.0137     0.0303     0.5
partner_attractiveness_shortterm_v2:includedhorm_contra          -0.0901     0.0492    -1.8
partner_attractiveness_shortterm_v2:fertile                      -0.0725     0.0420    -1.7
includedhorm_contra:fertile                                      -0.0998     0.0630    -1.6
partner_attractiveness_shortterm_v2:includedhorm_contra:fertile   0.0729     0.0543     1.3
</code></pre>
</div>
<div id="partners-global-attractiveness-2" class="section level4">
<h4>Partner’s global attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_global&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66618</td>
<td align="center">66725</td>
<td align="center">-33296</td>
<td align="center">66592</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66616</td>
<td align="center">66739</td>
<td align="center">-33293</td>
<td align="center">66586</td>
<td align="center">6.578</td>
<td align="center">2</td>
<td align="center">0.03728</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/global_attr-23-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_global + included + fertile + menstruation:included +  
    partner_attractiveness_global:included + partner_attractiveness_global:fertile +  
    included:fertile + partner_attractiveness_global:included:fertile
   Data: diary

REML criterion at convergence: 66649

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.690 -0.609  0.011  0.613  4.866 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.534    0.730   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 2.8125     0.0629    44.7
menstruationpre                                            -0.0321     0.0246    -1.3
menstruationyes                                            -0.0610     0.0231    -2.6
fertile_mean                                               -0.0844     0.2893    -0.3
partner_attractiveness_global                               0.1410     0.0369     3.8
includedhorm_contra                                         0.0831     0.0515     1.6
fertile                                                     0.0414     0.0498     0.8
menstruationpre:includedhorm_contra                         0.0212     0.0315     0.7
menstruationyes:includedhorm_contra                         0.0141     0.0303     0.5
partner_attractiveness_global:includedhorm_contra          -0.1027     0.0487    -2.1
partner_attractiveness_global:fertile                      -0.0981     0.0410    -2.4
includedhorm_contra:fertile                                -0.1022     0.0629    -1.6
partner_attractiveness_global:includedhorm_contra:fertile   0.0670     0.0530     1.3
</code></pre>
</div>
<div id="partners-longterm-attractiveness-2" class="section level4">
<h4>Partner’s longterm attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_longterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66593</td>
<td align="center">66699</td>
<td align="center">-33283</td>
<td align="center">66567</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66595</td>
<td align="center">66718</td>
<td align="center">-33282</td>
<td align="center">66565</td>
<td align="center">1.872</td>
<td align="center">2</td>
<td align="center">0.3923</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-24-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + included + fertile + menstruation:included +  
    partner_attractiveness_longterm:included + partner_attractiveness_longterm:fertile +  
    included:fertile + partner_attractiveness_longterm:included:fertile
   Data: diary

REML criterion at convergence: 66628

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.682 -0.608  0.011  0.613  4.871 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.519    0.721   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                  2.80009    0.06222    45.0
menstruationpre                                             -0.03169    0.02457    -1.3
menstruationyes                                             -0.06012    0.02314    -2.6
fertile_mean                                                -0.00518    0.28632     0.0
partner_attractiveness_longterm                              0.18480    0.03755     4.9
includedhorm_contra                                          0.07626    0.05093     1.5
fertile                                                      0.04153    0.04982     0.8
menstruationpre:includedhorm_contra                          0.02088    0.03151     0.7
menstruationyes:includedhorm_contra                          0.01363    0.03031     0.4
partner_attractiveness_longterm:includedhorm_contra         -0.07380    0.05032    -1.5
partner_attractiveness_longterm:fertile                      0.00493    0.04395     0.1
includedhorm_contra:fertile                                 -0.10667    0.06303    -1.7
partner_attractiveness_longterm:includedhorm_contra:fertile  0.04682    0.05807     0.8
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-5" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>We also test this specification of the short-term vs. long-term moderator prediction, but we think this is a suboptimal way to test it.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_st_vs_lt&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66630</td>
<td align="center">66737</td>
<td align="center">-33302</td>
<td align="center">66604</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66632</td>
<td align="center">66755</td>
<td align="center">-33301</td>
<td align="center">66602</td>
<td align="center">2.283</td>
<td align="center">2</td>
<td align="center">0.3194</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-25-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_st_vs_lt + included + fertile + menstruation:included +  
    partner_st_vs_lt:included + partner_st_vs_lt:fertile + included:fertile +  
    partner_st_vs_lt:included:fertile
   Data: diary

REML criterion at convergence: 66666

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.686 -0.609  0.010  0.613  4.864 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    2.8051     0.0634    44.2
menstruationpre                               -0.0310     0.0246    -1.3
menstruationyes                               -0.0592     0.0231    -2.6
fertile_mean                                  -0.0421     0.2907    -0.1
partner_st_vs_lt                              -0.0232     0.0353    -0.7
includedhorm_contra                            0.0823     0.0519     1.6
fertile                                        0.0361     0.0500     0.7
menstruationpre:includedhorm_contra            0.0202     0.0315     0.6
menstruationyes:includedhorm_contra            0.0124     0.0303     0.4
partner_st_vs_lt:includedhorm_contra           0.0260     0.0447     0.6
partner_st_vs_lt:fertile                      -0.0474     0.0389    -1.2
includedhorm_contra:fertile                   -0.0950     0.0631    -1.5
partner_st_vs_lt:includedhorm_contra:fertile   0.0211     0.0488     0.4
</code></pre>
</div>
<div id="partners-mate-value-2" class="section level4">
<h4>Partner’s mate value</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;MV_P_short&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66611</td>
<td align="center">66718</td>
<td align="center">-33293</td>
<td align="center">66585</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66609</td>
<td align="center">66732</td>
<td align="center">-33289</td>
<td align="center">66579</td>
<td align="center">6.513</td>
<td align="center">2</td>
<td align="center">0.03852</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/mvp_attr-26-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    MV_P_short + included + fertile + menstruation:included +  
    MV_P_short:included + MV_P_short:fertile + included:fertile +      MV_P_short:included:fertile
   Data: diary

REML criterion at convergence: 66640

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.690 -0.609  0.011  0.612  4.868 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.529    0.727   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                              2.1262     0.1659   12.82
menstruationpre                         -0.0322     0.0246   -1.31
menstruationyes                         -0.0606     0.0231   -2.62
fertile_mean                            -0.0776     0.2883   -0.27
MV_P_short                               0.2036     0.0457    4.46
includedhorm_contra                      0.5254     0.2097    2.51
fertile                                  0.3430     0.1809    1.90
menstruationpre:includedhorm_contra      0.0215     0.0315    0.68
menstruationyes:includedhorm_contra      0.0137     0.0303    0.45
MV_P_short:includedhorm_contra          -0.1310     0.0605   -2.16
MV_P_short:fertile                      -0.0897     0.0517   -1.74
includedhorm_contra:fertile             -0.1394     0.2327   -0.60
MV_P_short:includedhorm_contra:fertile   0.0106     0.0668    0.16
</code></pre>
</div>
<div id="partners-job-and-income-2" class="section level4">
<h4>Partner’s job and income</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_money&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">66630</td>
<td align="center">66737</td>
<td align="center">-33302</td>
<td align="center">66604</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">66634</td>
<td align="center">66757</td>
<td align="center">-33302</td>
<td align="center">66604</td>
<td align="center">0.1366</td>
<td align="center">2</td>
<td align="center">0.934</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/income_attr-27-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: partner_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_money + included + fertile + menstruation:included +  
    partner_attractiveness_money:included + partner_attractiveness_money:fertile +  
    included:fertile + partner_attractiveness_money:included:fertile
   Data: diary

REML criterion at convergence: 66666

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.686 -0.609  0.010  0.614  4.864 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.643    0.802   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               2.94056    0.15003   19.60
menstruationpre                                          -0.03122    0.02457   -1.27
menstruationyes                                          -0.05998    0.02312   -2.59
fertile_mean                                             -0.06238    0.29087   -0.21
partner_attractiveness_money                             -0.04126    0.04278   -0.96
includedhorm_contra                                      -0.02741    0.18752   -0.15
fertile                                                  -0.00891    0.15766   -0.06
menstruationpre:includedhorm_contra                       0.02022    0.03151    0.64
menstruationyes:includedhorm_contra                       0.01303    0.03030    0.43
partner_attractiveness_money:includedhorm_contra          0.03390    0.05864    0.58
partner_attractiveness_money:fertile                      0.01595    0.04725    0.34
includedhorm_contra:fertile                              -0.07082    0.20673   -0.34
partner_attractiveness_money:includedhorm_contra:fertile -0.00948    0.06392   -0.15
</code></pre>
</div>
</div>
</div>
<div id="female-mate-retention" class="section level2 tab-content">
<h2>Female mate retention</h2>
<pre class="r"><code>model_summaries$female_mate_retention</code></pre>
<div id="model-summary-22" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-23" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

REML criterion at convergence: 69308

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.145 -0.629 -0.003  0.632  4.532 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.544    0.738   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value Pr(&gt;|t|)    
(Intercept)                             3.03175     0.06405  1357.00000   47.34   &lt;2e-16 ***
includedhorm_contra                     0.16901     0.05240  1310.00000    3.23   0.0013 ** 
menstruationpre                        -0.00651     0.02587 25820.00000   -0.25   0.8012    
menstruationyes                         0.01904     0.02434 25920.00000    0.78   0.4340    
fertile                                 0.05127     0.05243 25812.00000    0.98   0.3281    
fertile_mean                           -0.09523     0.29495  1473.00000   -0.32   0.7468    
includedhorm_contra:menstruationpre    -0.03531     0.03317 25819.00000   -1.06   0.2872    
includedhorm_contra:menstruationyes    -0.02425     0.03189 25903.00000   -0.76   0.4469    
includedhorm_contra:fertile            -0.21407     0.06626 25927.00000   -3.23   0.0012 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.157  0.199                                                        
menstrutnys             -0.153  0.192  0.399                                                 
fertile                 -0.151  0.246  0.469    0.387                                        
fertile_men             -0.772 -0.033 -0.008   -0.006   -0.062                               
inclddhrm_cntr:mnstrtnp  0.129 -0.248 -0.780   -0.311   -0.365 -0.003                        
inclddhrm_cntr:mnstrtny  0.122 -0.235 -0.305   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.151 -0.309 -0.371   -0.306   -0.789  0.008  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.06 [-0.06;0.18].</p>
</div>
<div id="marginal-effect-plots-11" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-11" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-11" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-11" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-11" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-22" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-44" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-44" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-44" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-22" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-45" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-45" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-45" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-11" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-23" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-46" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-46" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-46" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-23" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-47" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-47" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-47" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-female_mate_retention-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-11" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-11" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 69059

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.041 -0.615 -0.005  0.615  4.660 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.5640   0.751                     
          fertile         0.4100   0.640    -0.18            
          menstruationpre 0.0887   0.298    -0.10  0.27      
          menstruationyes 0.1054   0.325    -0.12  0.33  0.43
 Residual                 0.6792   0.824                     
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          3.03402    0.06470    46.9
includedhorm_contra                  0.16596    0.05332     3.1
menstruationpre                     -0.00235    0.03084    -0.1
menstruationyes                      0.01129    0.03030     0.4
fertile                              0.04933    0.06349     0.8
fertile_mean                        -0.09647    0.29767    -0.3
includedhorm_contra:menstruationpre -0.03337    0.03955    -0.8
includedhorm_contra:menstruationyes -0.01662    0.03945    -0.4
includedhorm_contra:fertile         -0.20982    0.08038    -2.6

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.473                                                               
menstrutnpr             -0.163  0.204                                                        
menstrutnys             -0.167  0.208  0.402                                                 
fertile                 -0.171  0.276  0.400    0.364                                        
fertile_men             -0.767 -0.033 -0.006   -0.005   -0.070                               
inclddhrm_cntr:mnstrtnp  0.134 -0.255 -0.780   -0.314   -0.311 -0.004                        
inclddhrm_cntr:mnstrtny  0.134 -0.256 -0.309   -0.768   -0.280 -0.003  0.392                 
inclddhrm_cntr:f         0.170 -0.348 -0.315   -0.288   -0.787  0.010  0.399                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.360                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">69287</td>
<td align="center">69377</td>
<td align="center">-34632</td>
<td align="center">69265</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">69059</td>
<td align="center">69223</td>
<td align="center">-34509</td>
<td align="center">69019</td>
<td align="center">246</td>
<td align="center">9</td>
<td align="center">6.938e-48</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-11" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-11" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-11" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 62976

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.322 -0.627 -0.003  0.628  4.472 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.5503   0.742   
 Xr.2     s(days_filled_out):includedhorm_contra 0.3133   0.560   
 Xr.1     s(days_filled_out):includedcycling     0.0926   0.304   
 Xr.0     s(day_number):includedhorm_contra      0.4115   0.641   
 Xr       s(day_number):includedcycling          0.0654   0.256   
 Residual                                        0.6962   0.834   
Number of obs: 24251, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                3.00395    0.06466    46.5
Xincludedhorm_contra                        0.17326    0.05335     3.2
Xmenstruationpre                            0.00915    0.02670     0.3
Xmenstruationyes                            0.01969    0.02564     0.8
Xfertile                                    0.03923    0.05529     0.7
Xfertile_mean                              -0.07163    0.29603    -0.2
Xincludedhorm_contra:menstruationpre       -0.03826    0.03424    -1.1
Xincludedhorm_contra:menstruationyes       -0.02401    0.03354    -0.7
Xincludedhorm_contra:fertile               -0.18389    0.06985    -2.6
Xs(day_number):includedcyclingFx1           0.26137    0.09206     2.8
Xs(day_number):includedhorm_contraFx1       0.57409    0.14500     4.0
Xs(days_filled_out):includedcyclingFx1     -0.15801    0.09922    -1.6
Xs(days_filled_out):includedhorm_contraFx1 -0.52798    0.13910    -3.8
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
female_mate_retention ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          3.00395    0.06466   46.46   &lt;2e-16 ***
includedhorm_contra                  0.17326    0.05335    3.25   0.0012 ** 
menstruationpre                      0.00915    0.02670    0.34   0.7318    
menstruationyes                      0.01969    0.02564    0.77   0.4425    
fertile                              0.03923    0.05529    0.71   0.4780    
fertile_mean                        -0.07163    0.29603   -0.24   0.8088    
includedhorm_contra:menstruationpre -0.03826    0.03424   -1.12   0.2638    
includedhorm_contra:menstruationyes -0.02401    0.03354   -0.72   0.4741    
includedhorm_contra:fertile         -0.18389    0.06985   -2.63   0.0085 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F      p-value    
s(day_number):includedcycling          3.35   3.35 5.78      0.00038 ***
s(day_number):includedhorm_contra      5.85   5.85 8.58 0.0000000043 ***
s(days_filled_out):includedcycling     3.75   3.75 5.47      0.00050 ***
s(days_filled_out):includedhorm_contra 5.38   5.38 8.09 0.0000000635 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00109   
lmer.REML =  62976  Scale est. = 0.69618   n = 24251
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  67496 67594 -33736

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:        0.72   0.8577

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.3116 
Fixed effects: female_mate_retention ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          3.0420   0.06503 25496   46.78  0.0000
includedhorm_contra                  0.1630   0.05346  1040    3.05  0.0024
menstruationpre                     -0.0052   0.03012 25496   -0.17  0.8620
menstruationyes                      0.0095   0.02807 25496    0.34  0.7341
fertile                              0.0575   0.06463 25496    0.89  0.3740
fertile_mean                        -0.0655   0.29985  1040   -0.22  0.8272
includedhorm_contra:menstruationpre -0.0334   0.03866 25496   -0.86  0.3882
includedhorm_contra:menstruationyes -0.0057   0.03656 25496   -0.16  0.8756
includedhorm_contra:fertile         -0.2165   0.08157 25496   -2.65  0.0080
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.178  0.224                                                        
menstruationyes                     -0.175  0.218  0.405                                                 
fertile                             -0.172  0.284  0.426    0.361                                        
fertile_mean                        -0.768 -0.033 -0.008   -0.006   -0.077                               
includedhorm_contra:menstruationpre  0.146 -0.278 -0.779   -0.315   -0.331 -0.004                        
includedhorm_contra:menstruationyes  0.140 -0.265 -0.311   -0.768   -0.276 -0.003  0.389                 
includedhorm_contra:fertile          0.174 -0.357 -0.337   -0.286   -0.789  0.012  0.424                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.354                 

Standardized Within-Group Residuals:
      Min        Q1       Med        Q3       Max 
-4.016449 -0.641356 -0.008956  0.613604  4.490198 

Number of Observations: 26545
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  67490 67596 -33732

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7185   0.8585

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
    Phi1   Theta1 
 0.37421 -0.06895 
Fixed effects: female_mate_retention ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          3.0416   0.06507 25496   46.75  0.0000
includedhorm_contra                  0.1630   0.05351  1040    3.05  0.0024
menstruationpre                     -0.0049   0.03027 25496   -0.16  0.8702
menstruationyes                      0.0083   0.02823 25496    0.30  0.7675
fertile                              0.0587   0.06526 25496    0.90  0.3681
fertile_mean                        -0.0642   0.30007  1040   -0.21  0.8307
includedhorm_contra:menstruationpre -0.0335   0.03885 25496   -0.86  0.3886
includedhorm_contra:menstruationyes -0.0045   0.03675 25496   -0.12  0.9018
includedhorm_contra:fertile         -0.2180   0.08236 25496   -2.65  0.0081
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.178  0.224                                                        
menstruationyes                     -0.176  0.219  0.406                                                 
fertile                             -0.173  0.285  0.420    0.359                                        
fertile_mean                        -0.768 -0.034 -0.007   -0.006   -0.078                               
includedhorm_contra:menstruationpre  0.146 -0.278 -0.779   -0.317   -0.327 -0.004                        
includedhorm_contra:menstruationyes  0.140 -0.267 -0.312   -0.768   -0.275 -0.003  0.391                 
includedhorm_contra:fertile          0.175 -0.359 -0.333   -0.284   -0.788  0.012  0.419                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.351                 

Standardized Within-Group Residuals:
      Min        Q1       Med        Q3       Max 
-3.999891 -0.641970 -0.009114  0.614577  4.479268 

Number of Observations: 26545
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-11" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-11" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 44329

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.126 -0.635 -0.008  0.636  4.544 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.533    0.730   
 Residual             0.716    0.846   
Number of obs: 17027, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               3.12885    0.13961   22.41
fertile_mean                                             -0.56419    0.67951   -0.83
contraceptive_methodsfertility_awareness                  0.20089    0.18082    1.11
contraceptive_methodsnone                                 0.20051    0.19163    1.05
contraceptive_methodshormonal                             0.17031    0.09119    1.87
fertile                                                   0.02230    0.09443    0.24
menstruationpre                                          -0.02745    0.04561   -0.60
menstruationyes                                           0.07601    0.04356    1.74
contraceptive_methodsfertility_awareness:fertile         -0.16329    0.21445   -0.76
contraceptive_methodsnone:fertile                        -0.26221    0.23216   -1.13
contraceptive_methodshormonal:fertile                    -0.21183    0.10550   -2.01
contraceptive_methodsfertility_awareness:menstruationpre -0.04443    0.10102   -0.44
contraceptive_methodsnone:menstruationpre                -0.16554    0.10562   -1.57
contraceptive_methodshormonal:menstruationpre            -0.00909    0.05137   -0.18
contraceptive_methodsfertility_awareness:menstruationyes -0.02864    0.10153   -0.28
contraceptive_methodsnone:menstruationyes                -0.13480    0.11044   -1.22
contraceptive_methodshormonal:menstruationyes            -0.10226    0.04968   -2.06
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">44304</td>
<td align="center">44405</td>
<td align="center">-22139</td>
<td align="center">44278</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">44313</td>
<td align="center">44460</td>
<td align="center">-22137</td>
<td align="center">44275</td>
<td align="center">3.327</td>
<td align="center">6</td>
<td align="center">0.7668</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-11" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">69285</td>
<td align="center">69440</td>
<td align="center">-34623</td>
<td align="center">69247</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">69294</td>
<td align="center">69515</td>
<td align="center">-34620</td>
<td align="center">69240</td>
<td align="center">6.874</td>
<td align="center">8</td>
<td align="center">0.5503</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 69321

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.137 -0.629 -0.002  0.632  4.537 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.540    0.735   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.09988    0.13331   23.25
menstruationpre                              -0.00606    0.02587   -0.23
menstruationyes                               0.01812    0.02435    0.74
fertile_mean                                 -0.10124    0.29560   -0.34
age_group(20,25]                              0.03507    0.14264    0.25
age_group(25,30]                             -0.02141    0.14681   -0.15
age_group(30,35]                             -0.22260    0.16846   -1.32
age_group(35,70]                             -0.24872    0.15472   -1.61
includedhorm_contra                           0.21869    0.14286    1.53
fertile                                       0.11051    0.14884    0.74
menstruationpre:includedhorm_contra          -0.03668    0.03318   -1.11
menstruationyes:includedhorm_contra          -0.02435    0.03190   -0.76
age_group(20,25]:includedhorm_contra         -0.13953    0.16271   -0.86
age_group(25,30]:includedhorm_contra         -0.18338    0.17917   -1.02
age_group(30,35]:includedhorm_contra         -0.14250    0.23336   -0.61
age_group(35,70]:includedhorm_contra         -0.19426    0.26317   -0.74
age_group(20,25]:fertile                     -0.05460    0.16487   -0.33
age_group(25,30]:fertile                     -0.21929    0.16994   -1.29
age_group(30,35]:fertile                      0.04038    0.19685    0.21
age_group(35,70]:fertile                      0.06406    0.17938    0.36
includedhorm_contra:fertile                  -0.27087    0.16508   -1.64
age_group(20,25]:includedhorm_contra:fertile  0.04515    0.18469    0.24
age_group(25,30]:includedhorm_contra:fertile  0.20951    0.20467    1.02
age_group(30,35]:includedhorm_contra:fertile -0.09832    0.26417   -0.37
age_group(35,70]:includedhorm_contra:fertile  0.18975    0.30139    0.63
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-11" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">68996</td>
<td align="center">69103</td>
<td align="center">-34485</td>
<td align="center">68970</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">68999</td>
<td align="center">69122</td>
<td align="center">-34485</td>
<td align="center">68969</td>
<td align="center">1.063</td>
<td align="center">2</td>
<td align="center">0.5876</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 69032

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.072 -0.624  0.007  0.633  4.632 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.545    0.738   
 Residual             0.705    0.840   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                               2.9672     0.0646    45.9
menstruationpre                          -0.0066     0.0257    -0.3
menstruationyes                           0.0179     0.0242     0.7
fertile_mean                             -0.0806     0.2946    -0.3
weekendTRUE                               0.1539     0.0225     6.9
includedhorm_contra                       0.1592     0.0537     3.0
fertile                                   0.0373     0.0634     0.6
menstruationpre:includedhorm_contra      -0.0366     0.0330    -1.1
menstruationyes:includedhorm_contra      -0.0207     0.0317    -0.7
weekendTRUE:includedhorm_contra           0.0291     0.0288     1.0
weekendTRUE:fertile                       0.0279     0.0875     0.3
includedhorm_contra:fertile              -0.2306     0.0804    -2.9
weekendTRUE:includedhorm_contra:fertile   0.0389     0.1109     0.4
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-11" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">68809</td>
<td align="center">68997</td>
<td align="center">-34381</td>
<td align="center">68763</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">68826</td>
<td align="center">69113</td>
<td align="center">-34378</td>
<td align="center">68756</td>
<td align="center">6.421</td>
<td align="center">12</td>
<td align="center">0.8934</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 68897

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.182 -0.624  0.008  0.632  4.630 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.546    0.739   
 Residual             0.700    0.837   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   3.088652   0.069079    44.7
menstruationpre                              -0.006706   0.025627    -0.3
menstruationyes                               0.017242   0.024114     0.7
fertile_mean                                 -0.094997   0.294590    -0.3
weekdayTuesday                               -0.161891   0.039963    -4.1
weekdayWednesday                             -0.162959   0.039914    -4.1
weekdayThursday                              -0.151986   0.040376    -3.8
weekdayFriday                                -0.080908   0.041043    -2.0
weekdaySaturday                               0.068065   0.041493     1.6
weekdaySunday                                 0.115773   0.040080     2.9
includedhorm_contra                           0.154787   0.061998     2.5
fertile                                      -0.028447   0.113052    -0.3
menstruationpre:includedhorm_contra          -0.035134   0.032864    -1.1
menstruationyes:includedhorm_contra          -0.018449   0.031595    -0.6
weekdayTuesday:includedhorm_contra           -0.021026   0.051275    -0.4
weekdayWednesday:includedhorm_contra         -0.007536   0.051454    -0.1
weekdayThursday:includedhorm_contra           0.044518   0.051954     0.9
weekdayFriday:includedhorm_contra             0.043753   0.052655     0.8
weekdaySaturday:includedhorm_contra           0.029600   0.053297     0.6
weekdaySunday:includedhorm_contra             0.026172   0.051651     0.5
weekdayTuesday:fertile                       -0.011512   0.155535    -0.1
weekdayWednesday:fertile                      0.090590   0.156547     0.6
weekdayThursday:fertile                       0.203984   0.158869     1.3
weekdayFriday:fertile                         0.076396   0.159038     0.5
weekdaySaturday:fertile                       0.033320   0.161146     0.2
weekdaySunday:fertile                         0.188692   0.156666     1.2
includedhorm_contra:fertile                  -0.234148   0.144191    -1.6
weekdayTuesday:includedhorm_contra:fertile    0.119358   0.197976     0.6
weekdayWednesday:includedhorm_contra:fertile -0.040828   0.199752    -0.2
weekdayThursday:includedhorm_contra:fertile  -0.065544   0.201471    -0.3
weekdayFriday:includedhorm_contra:fertile     0.046162   0.201982     0.2
weekdaySaturday:includedhorm_contra:fertile   0.068888   0.204882     0.3
weekdaySunday:includedhorm_contra:fertile     0.000258   0.199418     0.0
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-11" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">69291</td>
<td align="center">69430</td>
<td align="center">-34628</td>
<td align="center">69257</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">69295</td>
<td align="center">69483</td>
<td align="center">-34625</td>
<td align="center">69249</td>
<td align="center">7.919</td>
<td align="center">6</td>
<td align="center">0.2441</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 69324

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.163 -0.631 -0.004  0.634  4.530 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.544    0.737   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              3.00473    0.07113    42.2
menstruationpre                                         -0.00795    0.02588    -0.3
menstruationyes                                          0.01881    0.02435     0.8
fertile_mean                                            -0.12704    0.29718    -0.4
included_levelslax                                      -0.05603    0.14613    -0.4
included_levelsconservative                              0.09116    0.11412     0.8
included_levelsstrict                                    0.15462    0.11231     1.4
includedhorm_contra                                      0.17543    0.07340     2.4
fertile                                                  0.09694    0.06658     1.5
menstruationpre:includedhorm_contra                     -0.03485    0.03320    -1.0
menstruationyes:includedhorm_contra                     -0.02541    0.03193    -0.8
included_levelslax:includedhorm_contra                  -0.06330    0.17771    -0.4
included_levelsconservative:includedhorm_contra          0.00594    0.14236     0.0
included_levelsstrict:includedhorm_contra               -0.08550    0.13786    -0.6
included_levelslax:fertile                              -0.09559    0.16088    -0.6
included_levelsconservative:fertile                      0.02407    0.12030     0.2
included_levelsstrict:fertile                           -0.22745    0.12038    -1.9
includedhorm_contra:fertile                             -0.18619    0.10110    -1.8
included_levelslax:includedhorm_contra:fertile          -0.09367    0.19627    -0.5
included_levelsconservative:includedhorm_contra:fertile -0.13866    0.15631    -0.9
included_levelsstrict:includedhorm_contra:fertile        0.19618    0.15390     1.3
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-11" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">69285</td>
<td align="center">69424</td>
<td align="center">-34626</td>
<td align="center">69251</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">69291</td>
<td align="center">69479</td>
<td align="center">-34623</td>
<td align="center">69245</td>
<td align="center">6.234</td>
<td align="center">6</td>
<td align="center">0.3975</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 69312

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.149 -0.629 -0.004  0.633  4.530 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.541    0.735   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             2.77320    0.12470   22.24
menstruationpre                                        -0.00515    0.02590   -0.20
menstruationyes                                         0.01931    0.02452    0.79
fertile_mean                                           -0.08382    0.29757   -0.28
cycle_length_groups(25,30]                              0.31324    0.12327    2.54
cycle_length_groups(30,35]                              0.16636    0.14725    1.13
cycle_length_groups(35,41]                              0.39557    0.20761    1.91
includedhorm_contra                                     0.25969    0.13919    1.87
fertile                                                 0.08240    0.14113    0.58
menstruationpre:includedhorm_contra                    -0.03577    0.03320   -1.08
menstruationyes:includedhorm_contra                    -0.02373    0.03208   -0.74
cycle_length_groups(25,30]:includedhorm_contra         -0.11634    0.15075   -0.77
cycle_length_groups(30,35]:includedhorm_contra         -0.01104    0.22918   -0.05
cycle_length_groups(35,41]:includedhorm_contra         -0.13199    0.29621   -0.45
cycle_length_groups(25,30]:fertile                     -0.01838    0.15093   -0.12
cycle_length_groups(30,35]:fertile                      0.01231    0.17748    0.07
cycle_length_groups(35,41]:fertile                     -0.42543    0.24863   -1.71
includedhorm_contra:fertile                            -0.23073    0.16537   -1.40
cycle_length_groups(25,30]:includedhorm_contra:fertile  0.01321    0.17761    0.07
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.31289    0.27666   -1.13
cycle_length_groups(35,41]:includedhorm_contra:fertile  0.44295    0.32629    1.36
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-11" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69289</td>
<td align="center">69395</td>
<td align="center">-34632</td>
<td align="center">69263</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69292</td>
<td align="center">69415</td>
<td align="center">-34631</td>
<td align="center">69262</td>
<td align="center">0.8605</td>
<td align="center">2</td>
<td align="center">0.6504</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 69323

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.146 -0.629 -0.004  0.631  4.536 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.545    0.738   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         2.94889    0.18533   15.91
menstruationpre                                    -0.00585    0.02588   -0.23
menstruationyes                                     0.02009    0.02437    0.82
fertile_mean                                       -0.11674    0.29554   -0.40
certainty_menstruation                              0.02086    0.04228    0.49
includedhorm_contra                                 0.07636    0.23261    0.33
fertile                                            -0.11174    0.21164   -0.53
menstruationpre:includedhorm_contra                -0.03591    0.03318   -1.08
menstruationyes:includedhorm_contra                -0.02556    0.03192   -0.80
certainty_menstruation:includedhorm_contra          0.02120    0.05419    0.39
certainty_menstruation:fertile                      0.03941    0.04949    0.80
includedhorm_contra:fertile                         0.02765    0.27156    0.10
certainty_menstruation:includedhorm_contra:fertile -0.05776    0.06271   -0.92
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-11" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">69292</td>
<td align="center">69414</td>
<td align="center">-34631</td>
<td align="center">69262</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">69292</td>
<td align="center">69448</td>
<td align="center">-34627</td>
<td align="center">69254</td>
<td align="center">7.289</td>
<td align="center">4</td>
<td align="center">0.1214</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 69318

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.144 -0.628 -0.003  0.630  4.525 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.546    0.739   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        3.03277    0.07558    40.1
menstruationpre                                                                   -0.00851    0.02588    -0.3
menstruationyes                                                                    0.01746    0.02434     0.7
fertile_mean                                                                      -0.12471    0.29682    -0.4
cycle_regularityslightly irregular,\nup to 5 days off                              0.01425    0.08791     0.2
cycle_regularityirregular,\nmore than 5 days off                                   0.00059    0.10511     0.0
includedhorm_contra                                                                0.18998    0.06892     2.8
fertile                                                                           -0.01530    0.07234    -0.2
menstruationpre:includedhorm_contra                                               -0.03347    0.03318    -1.0
menstruationyes:includedhorm_contra                                               -0.02293    0.03190    -0.7
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra         -0.02027    0.13293    -0.2
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.20499    0.15831    -1.3
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.01804    0.09958     0.2
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.31864    0.12431     2.6
includedhorm_contra:fertile                                                       -0.15219    0.08468    -1.8
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.00765    0.14772    -0.1
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.27525    0.18391    -1.5
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-11" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">69286</td>
<td align="center">69409</td>
<td align="center">-34628</td>
<td align="center">69256</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">69293</td>
<td align="center">69448</td>
<td align="center">-34627</td>
<td align="center">69255</td>
<td align="center">1.28</td>
<td align="center">4</td>
<td align="center">0.8648</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 69322

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.126 -0.629 -0.004  0.631  4.527 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.542    0.736   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                3.09178    0.07331    42.2
menstruationpre                                           -0.00632    0.02587    -0.2
menstruationyes                                            0.01938    0.02435     0.8
fertile_mean                                              -0.11205    0.29505    -0.4
cohabitationLive in same city                             -0.20799    0.09956    -2.1
cohabitationLong-distance                                 -0.05280    0.09386    -0.6
includedhorm_contra                                        0.20634    0.07901     2.6
fertile                                                    0.06009    0.06583     0.9
menstruationpre:includedhorm_contra                       -0.03461    0.03318    -1.0
menstruationyes:includedhorm_contra                       -0.02411    0.03189    -0.8
cohabitationLive in same city:includedhorm_contra          0.11000    0.12711     0.9
cohabitationLong-distance:includedhorm_contra             -0.11934    0.12171    -1.0
cohabitationLive in same city:fertile                      0.00631    0.11923     0.1
cohabitationLong-distance:fertile                         -0.03822    0.10745    -0.4
includedhorm_contra:fertile                               -0.28206    0.09562    -2.9
cohabitationLive in same city:includedhorm_contra:fertile  0.07644    0.14895     0.5
cohabitationLong-distance:includedhorm_contra:fertile      0.12095    0.13823     0.9
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-11" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">69287</td>
<td align="center">69410</td>
<td align="center">-34628</td>
<td align="center">69257</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">69292</td>
<td align="center">69448</td>
<td align="center">-34627</td>
<td align="center">69254</td>
<td align="center">2.689</td>
<td align="center">4</td>
<td align="center">0.6111</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_mate_retention-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 69312

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.143 -0.628 -0.004  0.631  4.528 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.542    0.736   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       3.02580    0.06823    44.3
menstruationpre                                                  -0.00631    0.02587    -0.2
menstruationyes                                                   0.01894    0.02434     0.8
fertile_mean                                                     -0.06957    0.29484    -0.2
relationship_status_cleanVerheiratet                              0.00315    0.09225     0.0
relationship_status_cleanVerlobt                                  0.01820    0.17523     0.1
includedhorm_contra                                               0.17167    0.05853     2.9
fertile                                                           0.02526    0.05980     0.4
menstruationpre:includedhorm_contra                              -0.03576    0.03317    -1.1
menstruationyes:includedhorm_contra                              -0.02432    0.03189    -0.8
relationship_status_cleanVerheiratet:includedhorm_contra         -0.25963    0.17765    -1.5
relationship_status_cleanVerlobt:includedhorm_contra              0.34991    0.25823     1.4
relationship_status_cleanVerheiratet:fertile                      0.04109    0.10630     0.4
relationship_status_cleanVerlobt:fertile                          0.28843    0.19685     1.5
includedhorm_contra:fertile                                      -0.19230    0.07284    -2.6
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.03316    0.19840    -0.2
relationship_status_cleanVerlobt:includedhorm_contra:fertile     -0.12230    0.30566    -0.4
</code></pre>
<pre class="r"><code>do_moderators(models$female_mate_retention, diary)</code></pre>
</div>
</div>
<div id="moderators-3" class="section level3 tab-content">
<h3>Moderators</h3>
<div id="partners-physical-attractiveness-3" class="section level4">
<h4>Partner’s physical attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s physical attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_physical&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69240</td>
<td align="center">69347</td>
<td align="center">-34607</td>
<td align="center">69214</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69243</td>
<td align="center">69366</td>
<td align="center">-34607</td>
<td align="center">69213</td>
<td align="center">0.7525</td>
<td align="center">2</td>
<td align="center">0.6864</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/phys_attr-28-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_physical + included + fertile + menstruation:included +  
    partner_attractiveness_physical:included + partner_attractiveness_physical:fertile +  
    included:fertile + partner_attractiveness_physical:included:fertile
   Data: diary

REML criterion at convergence: 69279

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.147 -0.628 -0.003  0.633  4.525 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.519    0.721   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                            Estimate Std. Error t value
(Intercept)                                                  1.89474    0.19698    9.62
menstruationpre                                             -0.00697    0.02586   -0.27
menstruationyes                                              0.01879    0.02434    0.77
fertile_mean                                                -0.14083    0.28974   -0.49
partner_attractiveness_physical                              0.14389    0.02356    6.11
includedhorm_contra                                          0.79403    0.25574    3.10
fertile                                                     -0.14475    0.23148   -0.63
menstruationpre:includedhorm_contra                         -0.03501    0.03316   -1.06
menstruationyes:includedhorm_contra                         -0.02436    0.03189   -0.76
partner_attractiveness_physical:includedhorm_contra         -0.08032    0.03111   -2.58
partner_attractiveness_physical:fertile                      0.02447    0.02826    0.87
includedhorm_contra:fertile                                 -0.00729    0.30382   -0.02
partner_attractiveness_physical:includedhorm_contra:fertile -0.02579    0.03666   -0.70
</code></pre>
</div>
<div id="partners-short-term-attractiveness-3" class="section level4">
<h4>Partner’s short-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s short-term attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69253</td>
<td align="center">69359</td>
<td align="center">-34613</td>
<td align="center">69227</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69256</td>
<td align="center">69379</td>
<td align="center">-34613</td>
<td align="center">69226</td>
<td align="center">0.3752</td>
<td align="center">2</td>
<td align="center">0.829</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr-29-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm + included + fertile + menstruation:included +  
    partner_attractiveness_shortterm:included + partner_attractiveness_shortterm:fertile +  
    included:fertile + partner_attractiveness_shortterm:included:fertile
   Data: diary

REML criterion at convergence: 69288

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.163 -0.629 -0.004  0.632  4.516 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.525    0.725   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                             Estimate Std. Error t value
(Intercept)                                                   3.05420    0.06330    48.3
menstruationpre                                              -0.00664    0.02586    -0.3
menstruationyes                                               0.01860    0.02434     0.8
fertile_mean                                                 -0.12179    0.29100    -0.4
partner_attractiveness_shortterm                              0.18366    0.03719     4.9
includedhorm_contra                                           0.13883    0.05190     2.7
fertile                                                       0.05041    0.05256     1.0
menstruationpre:includedhorm_contra                          -0.03548    0.03317    -1.1
menstruationyes:includedhorm_contra                          -0.02423    0.03189    -0.8
partner_attractiveness_shortterm:includedhorm_contra         -0.06812    0.04973    -1.4
partner_attractiveness_shortterm:fertile                     -0.00524    0.04442    -0.1
includedhorm_contra:fertile                                  -0.21669    0.06658    -3.3
partner_attractiveness_shortterm:includedhorm_contra:fertile  0.02750    0.05783     0.5
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-6" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) top-right (high LT, low ST), then top-left (low LT, low ST), then bottom-left (low LT, high ST), then bottom-right (high LT/ST).</p>
<pre class="r"><code>add_main = update.formula(formula(model), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * included + partner_attractiveness_shortterm * included + partner_attractiveness_longterm * partner_attractiveness_shortterm&quot;))) # reorder so that the triptych looks nice
add_mod_formula = update.formula(update.formula(formula(model), new = . ~ . - included * fertile), new = as.formula(paste0(&quot;. ~ . + partner_attractiveness_longterm * fertile * partner_attractiveness_shortterm * included&quot;))) # reorder so that the triptych looks nice

update(model, formula = add_main) -&gt; with_main
update(model, formula = add_mod_formula) -&gt; with_mod
cat(pander(anova(with_main, with_mod)))</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">69193</td>
<td align="center">69324</td>
<td align="center">-34581</td>
<td align="center">69161</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">69198</td>
<td align="center">69386</td>
<td align="center">-34576</td>
<td align="center">69152</td>
<td align="center">9.651</td>
<td align="center">7</td>
<td align="center">0.2093</td>
</tr>
</tbody>
</table>
<pre class="r"><code>effs = allEffects(with_mod)
effs = data.frame(effs$`partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included`) %&gt;% 
  filter(partner_attractiveness_longterm %in% c(-2,0),partner_attractiveness_shortterm %in% c(-2,0))
ggplot(effs, aes(fertile, fit, ymin = lower, ymax = upper, color = included)) + 
  facet_grid(partner_attractiveness_shortterm ~ partner_attractiveness_longterm) +
  geom_smooth(stat=&#39;identity&#39;) +
  scale_color_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  scale_fill_manual(values = c(&quot;cycling&quot; = &#39;red&#39;, &#39;horm_contra&#39; = &#39;black&#39;), guide = F) +
  ggtitle(&quot;Moderation&quot;, &quot;top-to-bottom: short-term,\nleft-to-right: long-term attractiveness of the partner&quot;)+
  ylab(names(model@frame)[1])</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/st_vs_lt-30-1.png" width="768" /></p>
<pre class="r"><code>print_summary(with_mod)</code></pre>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + fertile + partner_attractiveness_shortterm +  
    included + menstruation:included + partner_attractiveness_longterm:fertile +  
    partner_attractiveness_longterm:partner_attractiveness_shortterm +  
    fertile:partner_attractiveness_shortterm + partner_attractiveness_longterm:included +  
    fertile:included + partner_attractiveness_shortterm:included +  
    partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm +  
    partner_attractiveness_longterm:fertile:included + partner_attractiveness_longterm:partner_attractiveness_shortterm:included +  
    fertile:partner_attractiveness_shortterm:included + partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:included
   Data: diary

REML criterion at convergence: 69251

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.204 -0.628 -0.004  0.631  4.567 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.492    0.702   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                                             Estimate
(Intercept)                                                                                   3.01964
menstruationpre                                                                              -0.00649
menstruationyes                                                                               0.01925
fertile_mean                                                                                 -0.04754
partner_attractiveness_longterm                                                               0.25197
fertile                                                                                       0.07196
partner_attractiveness_shortterm                                                              0.08795
includedhorm_contra                                                                           0.16969
menstruationpre:includedhorm_contra                                                          -0.03509
menstruationyes:includedhorm_contra                                                          -0.02457
partner_attractiveness_longterm:fertile                                                      -0.02006
partner_attractiveness_longterm:partner_attractiveness_shortterm                              0.02600
fertile:partner_attractiveness_shortterm                                                     -0.01789
partner_attractiveness_longterm:includedhorm_contra                                          -0.07623
fertile:includedhorm_contra                                                                  -0.26025
partner_attractiveness_shortterm:includedhorm_contra                                         -0.01081
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                     -0.05375
partner_attractiveness_longterm:fertile:includedhorm_contra                                   0.04317
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra         -0.08795
fertile:partner_attractiveness_shortterm:includedhorm_contra                                  0.02572
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra  0.16258
                                                                                             Std. Error
(Intercept)                                                                                     0.06329
menstruationpre                                                                                 0.02586
menstruationyes                                                                                 0.02436
fertile_mean                                                                                    0.28430
partner_attractiveness_longterm                                                                 0.04326
fertile                                                                                         0.05492
partner_attractiveness_shortterm                                                                0.04060
includedhorm_contra                                                                             0.05303
menstruationpre:includedhorm_contra                                                             0.03316
menstruationyes:includedhorm_contra                                                             0.03190
partner_attractiveness_longterm:fertile                                                         0.05284
partner_attractiveness_longterm:partner_attractiveness_shortterm                                0.03194
fertile:partner_attractiveness_shortterm                                                        0.04884
partner_attractiveness_longterm:includedhorm_contra                                             0.05500
fertile:includedhorm_contra                                                                     0.06903
partner_attractiveness_shortterm:includedhorm_contra                                            0.05238
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        0.03936
partner_attractiveness_longterm:fertile:includedhorm_contra                                     0.06693
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            0.04957
fertile:partner_attractiveness_shortterm:includedhorm_contra                                    0.06207
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra    0.06063
                                                                                             t value
(Intercept)                                                                                     47.7
menstruationpre                                                                                 -0.3
menstruationyes                                                                                  0.8
fertile_mean                                                                                    -0.2
partner_attractiveness_longterm                                                                  5.8
fertile                                                                                          1.3
partner_attractiveness_shortterm                                                                 2.2
includedhorm_contra                                                                              3.2
menstruationpre:includedhorm_contra                                                             -1.1
menstruationyes:includedhorm_contra                                                             -0.8
partner_attractiveness_longterm:fertile                                                         -0.4
partner_attractiveness_longterm:partner_attractiveness_shortterm                                 0.8
fertile:partner_attractiveness_shortterm                                                        -0.4
partner_attractiveness_longterm:includedhorm_contra                                             -1.4
fertile:includedhorm_contra                                                                     -3.8
partner_attractiveness_shortterm:includedhorm_contra                                            -0.2
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm                        -1.4
partner_attractiveness_longterm:fertile:includedhorm_contra                                      0.6
partner_attractiveness_longterm:partner_attractiveness_shortterm:includedhorm_contra            -1.8
fertile:partner_attractiveness_shortterm:includedhorm_contra                                     0.4
partner_attractiveness_longterm:fertile:partner_attractiveness_shortterm:includedhorm_contra     2.7
</code></pre>
</div>
<div id="relative-attractiveness-to-self-3" class="section level4">
<h4>Relative attractiveness to self</h4>
<p>Predicted fertile phase effect sizes (in red): biggest (EP desire, partner mate retention)/smallest (IP desire) when partner’s relative attractiveness is low.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_rel_to_self&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69291</td>
<td align="center">69397</td>
<td align="center">-34632</td>
<td align="center">69265</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69294</td>
<td align="center">69417</td>
<td align="center">-34632</td>
<td align="center">69264</td>
<td align="center">0.6098</td>
<td align="center">2</td>
<td align="center">0.7372</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/rel_self-31-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_rel_to_self + included + fertile +  
    menstruation:included + partner_attractiveness_rel_to_self:included +  
    partner_attractiveness_rel_to_self:fertile + included:fertile +  
    partner_attractiveness_rel_to_self:included:fertile
   Data: diary

REML criterion at convergence: 69324

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.140 -0.628 -0.003  0.631  4.531 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.545    0.739   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                               Estimate Std. Error t value
(Intercept)                                                     3.03634    0.07206    42.1
menstruationpre                                                -0.00655    0.02587    -0.3
menstruationyes                                                 0.01883    0.02435     0.8
fertile_mean                                                   -0.09692    0.29524    -0.3
partner_attractiveness_rel_to_self                              0.01237    0.09172     0.1
includedhorm_contra                                             0.16276    0.06175     2.6
fertile                                                         0.03788    0.06239     0.6
menstruationpre:includedhorm_contra                            -0.03515    0.03317    -1.1
menstruationyes:includedhorm_contra                            -0.02375    0.03190    -0.7
partner_attractiveness_rel_to_self:includedhorm_contra         -0.00595    0.09530    -0.1
partner_attractiveness_rel_to_self:fertile                     -0.04016    0.10140    -0.4
includedhorm_contra:fertile                                    -0.19479    0.07491    -2.6
partner_attractiveness_rel_to_self:includedhorm_contra:fertile  0.02121    0.10525     0.2
</code></pre>
</div>
<div id="partners-shortterm-attractiveness-alternative-specification-3" class="section level4">
<h4>Partner’s shortterm attractiveness, alternative specification</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_shortterm_v2&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69260</td>
<td align="center">69366</td>
<td align="center">-34617</td>
<td align="center">69234</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69264</td>
<td align="center">69386</td>
<td align="center">-34617</td>
<td align="center">69234</td>
<td align="center">0.2961</td>
<td align="center">2</td>
<td align="center">0.8624</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/st_attr2-32-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_shortterm_v2 + included + fertile +  
    menstruation:included + partner_attractiveness_shortterm_v2:included +  
    partner_attractiveness_shortterm_v2:fertile + included:fertile +  
    partner_attractiveness_shortterm_v2:included:fertile
   Data: diary

REML criterion at convergence: 69296

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.160 -0.628 -0.003  0.631  4.518 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.530    0.728   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                Estimate Std. Error t value
(Intercept)                                                      3.04688    0.06342    48.0
menstruationpre                                                 -0.00705    0.02586    -0.3
menstruationyes                                                  0.01819    0.02434     0.7
fertile_mean                                                    -0.13833    0.29198    -0.5
partner_attractiveness_shortterm_v2                              0.18779    0.03747     5.0
includedhorm_contra                                              0.15833    0.05186     3.1
fertile                                                          0.05002    0.05244     1.0
menstruationpre:includedhorm_contra                             -0.03499    0.03317    -1.1
menstruationyes:includedhorm_contra                             -0.02375    0.03189    -0.7
partner_attractiveness_shortterm_v2:includedhorm_contra         -0.11783    0.04944    -2.4
partner_attractiveness_shortterm_v2:fertile                     -0.00867    0.04419    -0.2
includedhorm_contra:fertile                                     -0.21426    0.06632    -3.2
partner_attractiveness_shortterm_v2:includedhorm_contra:fertile  0.02706    0.05715     0.5
</code></pre>
</div>
<div id="partners-global-attractiveness-3" class="section level4">
<h4>Partner’s global attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_global&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69276</td>
<td align="center">69382</td>
<td align="center">-34625</td>
<td align="center">69250</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69277</td>
<td align="center">69400</td>
<td align="center">-34624</td>
<td align="center">69247</td>
<td align="center">2.868</td>
<td align="center">2</td>
<td align="center">0.2384</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/global_attr-33-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_global + included + fertile + menstruation:included +  
    partner_attractiveness_global:included + partner_attractiveness_global:fertile +  
    included:fertile + partner_attractiveness_global:included:fertile
   Data: diary

REML criterion at convergence: 69309

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.153 -0.628 -0.003  0.630  4.518 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.538    0.733   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                3.03486    0.06374    47.6
menstruationpre                                           -0.00724    0.02586    -0.3
menstruationyes                                            0.01798    0.02434     0.7
fertile_mean                                              -0.12569    0.29370    -0.4
partner_attractiveness_global                              0.14975    0.03728     4.0
includedhorm_contra                                        0.17162    0.05213     3.3
fertile                                                    0.05073    0.05243     1.0
menstruationpre:includedhorm_contra                       -0.03465    0.03317    -1.0
menstruationyes:includedhorm_contra                       -0.02331    0.03189    -0.7
partner_attractiveness_global:includedhorm_contra         -0.12556    0.04919    -2.6
partner_attractiveness_global:fertile                     -0.07121    0.04319    -1.6
includedhorm_contra:fertile                               -0.21332    0.06626    -3.2
partner_attractiveness_global:includedhorm_contra:fertile  0.08485    0.05579     1.5
</code></pre>
</div>
<div id="partners-longterm-attractiveness-3" class="section level4">
<h4>Partner’s longterm attractiveness</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_longterm&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69197</td>
<td align="center">69304</td>
<td align="center">-34586</td>
<td align="center">69171</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69201</td>
<td align="center">69324</td>
<td align="center">-34586</td>
<td align="center">69171</td>
<td align="center">0.333</td>
<td align="center">2</td>
<td align="center">0.8466</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-34-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_longterm + included + fertile + menstruation:included +  
    partner_attractiveness_longterm:included + partner_attractiveness_longterm:fertile +  
    included:fertile + partner_attractiveness_longterm:included:fertile
   Data: diary

REML criterion at convergence: 69233

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.153 -0.630 -0.004  0.631  4.550 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.496    0.704   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                             Estimate Std. Error t value
(Intercept)                                                  3.018711   0.061770    48.9
menstruationpre                                             -0.007160   0.025859    -0.3
menstruationyes                                              0.018470   0.024352     0.8
fertile_mean                                                -0.024834   0.284926    -0.1
partner_attractiveness_longterm                              0.276423   0.037075     7.5
includedhorm_contra                                          0.160991   0.050509     3.2
fertile                                                      0.051395   0.052439     1.0
menstruationpre:includedhorm_contra                         -0.034652   0.033162    -1.0
menstruationyes:includedhorm_contra                         -0.023566   0.031896    -0.7
partner_attractiveness_longterm:includedhorm_contra         -0.079445   0.049670    -1.6
partner_attractiveness_longterm:fertile                     -0.000459   0.046240     0.0
includedhorm_contra:fertile                                 -0.216731   0.066327    -3.3
partner_attractiveness_longterm:includedhorm_contra:fertile  0.023517   0.061102     0.4
</code></pre>
</div>
<div id="partners-short-term-vs.long-term-attractiveness-7" class="section level4">
<h4>Partner’s short-term vs. long-term attractiveness</h4>
<p>We also test this specification of the short-term vs. long-term moderator prediction, but we think this is a suboptimal way to test it.</p>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_st_vs_lt&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69283</td>
<td align="center">69389</td>
<td align="center">-34628</td>
<td align="center">69257</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69287</td>
<td align="center">69410</td>
<td align="center">-34628</td>
<td align="center">69257</td>
<td align="center">0.0284</td>
<td align="center">2</td>
<td align="center">0.9859</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/lt_attr-35-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_st_vs_lt + included + fertile + menstruation:included +  
    partner_st_vs_lt:included + partner_st_vs_lt:fertile + included:fertile +  
    partner_st_vs_lt:included:fertile
   Data: diary

REML criterion at convergence: 69320

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.143 -0.629 -0.004  0.631  4.540 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.541    0.736   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.01916    0.06414    47.1
menstruationpre                              -0.00660    0.02587    -0.3
menstruationyes                               0.01914    0.02435     0.8
fertile_mean                                 -0.06489    0.29454    -0.2
partner_st_vs_lt                             -0.07386    0.03559    -2.1
includedhorm_contra                           0.17941    0.05242     3.4
fertile                                       0.05072    0.05267     1.0
menstruationpre:includedhorm_contra          -0.03517    0.03317    -1.1
menstruationyes:includedhorm_contra          -0.02421    0.03190    -0.8
partner_st_vs_lt:includedhorm_contra          0.02511    0.04496     0.6
partner_st_vs_lt:fertile                     -0.00616    0.04099    -0.2
includedhorm_contra:fertile                  -0.21377    0.06648    -3.2
partner_st_vs_lt:includedhorm_contra:fertile  0.00847    0.05136     0.2
</code></pre>
</div>
<div id="partners-mate-value-3" class="section level4">
<h4>Partner’s mate value</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;MV_P_short&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69272</td>
<td align="center">69378</td>
<td align="center">-34623</td>
<td align="center">69246</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69273</td>
<td align="center">69395</td>
<td align="center">-34621</td>
<td align="center">69243</td>
<td align="center">3.459</td>
<td align="center">2</td>
<td align="center">0.1774</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/mvp_attr-36-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    MV_P_short + included + fertile + menstruation:included +  
    MV_P_short:included + MV_P_short:fertile + included:fertile +      MV_P_short:included:fertile
   Data: diary

REML criterion at convergence: 69303

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.141 -0.630 -0.003  0.629  4.510 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.535    0.731   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                             2.32979    0.16780   13.88
menstruationpre                        -0.00751    0.02587   -0.29
menstruationyes                         0.01821    0.02434    0.75
fertile_mean                           -0.11349    0.29296   -0.39
MV_P_short                              0.20904    0.04619    4.53
includedhorm_contra                     0.74039    0.21192    3.49
fertile                                 0.38507    0.19046    2.02
menstruationpre:includedhorm_contra    -0.03424    0.03317   -1.03
menstruationyes:includedhorm_contra    -0.02347    0.03189   -0.74
MV_P_short:includedhorm_contra         -0.16894    0.06118   -2.76
MV_P_short:fertile                     -0.09943    0.05445   -1.83
includedhorm_contra:fertile            -0.49593    0.24499   -2.02
MV_P_short:includedhorm_contra:fertile  0.08388    0.07034    1.19
</code></pre>
</div>
<div id="partners-job-and-income-3" class="section level4">
<h4>Partner’s job and income</h4>
<pre class="r"><code>model %&gt;%
  test_moderator(&quot;partner_attractiveness_money&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">69290</td>
<td align="center">69396</td>
<td align="center">-34632</td>
<td align="center">69264</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">69294</td>
<td align="center">69417</td>
<td align="center">-34632</td>
<td align="center">69264</td>
<td align="center">0.03491</td>
<td align="center">2</td>
<td align="center">0.9827</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/income_attr-37-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_mate_retention ~ menstruation + fertile_mean + (1 | person) +  
    partner_attractiveness_money + included + fertile + menstruation:included +  
    partner_attractiveness_money:included + partner_attractiveness_money:fertile +  
    included:fertile + partner_attractiveness_money:included:fertile
   Data: diary

REML criterion at convergence: 69324

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.148 -0.629 -0.003  0.632  4.533 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.545    0.738   
 Residual             0.713    0.845   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               3.02165    0.15159   19.93
menstruationpre                                          -0.00652    0.02587   -0.25
menstruationyes                                           0.01907    0.02434    0.78
fertile_mean                                             -0.10557    0.29540   -0.36
partner_attractiveness_money                              0.00375    0.04320    0.09
includedhorm_contra                                       0.06899    0.18940    0.36
fertile                                                   0.06973    0.16598    0.42
menstruationpre:includedhorm_contra                      -0.03525    0.03317   -1.06
menstruationyes:includedhorm_contra                      -0.02428    0.03189   -0.76
partner_attractiveness_money:includedhorm_contra          0.03368    0.05922    0.57
partner_attractiveness_money:fertile                     -0.00579    0.04974   -0.12
includedhorm_contra:fertile                              -0.25244    0.21763   -1.16
partner_attractiveness_money:includedhorm_contra:fertile  0.01247    0.06729    0.19
</code></pre>
</div>
</div>
</div>
<div id="sexy-clothes" class="section level2 tab-content">
<h2>Sexy clothes</h2>
<pre class="r"><code>model_summaries$sexy_clothes</code></pre>
<div id="model-summary-24" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-25" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 75522

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.219 -0.611 -0.020  0.617  4.491 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.579    0.761   
 Residual             0.907    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value   Pr(&gt;|t|)    
(Intercept)                             2.9834     0.0673  1404.0000   44.31    &lt; 2e-16 ***
includedhorm_contra                     0.1129     0.0550  1366.0000    2.05      0.040 *  
menstruationpre                        -0.0956     0.0291 25871.0000   -3.28      0.001 ** 
menstruationyes                        -0.1445     0.0274 25978.0000   -5.27 0.00000014 ***
fertile                                -0.0410     0.0591 25859.0000   -0.69      0.487    
fertile_mean                            0.5629     0.3109  1523.0000    1.81      0.070 .  
includedhorm_contra:menstruationpre     0.0366     0.0374 25872.0000    0.98      0.327    
includedhorm_contra:menstruationyes     0.0902     0.0359 25960.0000    2.51      0.012 *  
includedhorm_contra:fertile            -0.0903     0.0746 25982.0000   -1.21      0.227    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.169  0.214                                                        
menstrutnys             -0.164  0.206  0.399                                                 
fertile                 -0.162  0.263  0.469    0.387                                        
fertile_men             -0.772 -0.034 -0.008   -0.006   -0.066                               
inclddhrm_cntr:mnstrtnp  0.139 -0.267 -0.780   -0.311   -0.365 -0.004                        
inclddhrm_cntr:mnstrtny  0.131 -0.252 -0.304   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.162 -0.331 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.04 [-0.16;0.08].</p>
</div>
<div id="marginal-effect-plots-12" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-12" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-12" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-12" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-12" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-24" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-48" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-48" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-48" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-24" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-49" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-49" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-49" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-12" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-25" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-50" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-50" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-50" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-25" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-51" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-51" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-51" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-sexy_clothes-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-12" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-12" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 75390

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.152 -0.605 -0.013  0.606  4.468 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.5956   0.772                     
          fertile         0.4870   0.698    -0.16            
          menstruationpre 0.0718   0.268    -0.08  0.41      
          menstruationyes 0.0769   0.277    -0.16  0.24  0.62
 Residual                 0.8772   0.937                     
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           2.9844     0.0679    43.9
includedhorm_contra                   0.1151     0.0558     2.1
menstruationpre                      -0.0962     0.0328    -2.9
menstruationyes                      -0.1415     0.0315    -4.5
fertile                              -0.0396     0.0710    -0.6
fertile_mean                          0.5477     0.3140     1.7
includedhorm_contra:menstruationpre   0.0372     0.0420     0.9
includedhorm_contra:menstruationyes   0.0916     0.0411     2.2
includedhorm_contra:fertile          -0.0938     0.0898    -1.0

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.472                                                               
menstrutnpr             -0.168  0.215                                                        
menstrutnys             -0.189  0.233  0.446                                                 
fertile                 -0.175  0.284  0.447    0.346                                        
fertile_men             -0.768 -0.035 -0.012   -0.002   -0.074                               
inclddhrm_cntr:mnstrtnp  0.140 -0.268 -0.780   -0.348   -0.348 -0.003                        
inclddhrm_cntr:mnstrtny  0.150 -0.286 -0.342   -0.767   -0.265 -0.004  0.434                 
inclddhrm_cntr:f         0.175 -0.358 -0.353   -0.273   -0.786  0.011  0.446                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.341                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">75503</td>
<td align="center">75593</td>
<td align="center">-37740</td>
<td align="center">75481</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">75390</td>
<td align="center">75554</td>
<td align="center">-37675</td>
<td align="center">75350</td>
<td align="center">130.6</td>
<td align="center">9</td>
<td align="center">9.045e-24</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-12" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-12" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-12" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 69010

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.288 -0.608 -0.016  0.615  4.470 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.572    0.756   
 Xr.2     s(days_filled_out):includedhorm_contra 0.000    0.000   
 Xr.1     s(days_filled_out):includedcycling     0.000    0.000   
 Xr.0     s(day_number):includedhorm_contra      0.167    0.408   
 Xr       s(day_number):includedcycling          0.000    0.000   
 Residual                                        0.901    0.949   
Number of obs: 24257, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 3.0022     0.0675    44.5
Xincludedhorm_contra                         0.1077     0.0556     1.9
Xmenstruationpre                            -0.0904     0.0303    -3.0
Xmenstruationyes                            -0.1288     0.0291    -4.4
Xfertile                                    -0.0111     0.0627    -0.2
Xfertile_mean                                0.5228     0.3102     1.7
Xincludedhorm_contra:menstruationpre         0.0411     0.0389     1.1
Xincludedhorm_contra:menstruationyes         0.0840     0.0381     2.2
Xincludedhorm_contra:fertile                -0.0774     0.0792    -1.0
Xs(day_number):includedcyclingFx1           -0.0499     0.0487    -1.0
Xs(day_number):includedhorm_contraFx1        0.0885     0.0908     1.0
Xs(days_filled_out):includedcyclingFx1       0.1130     0.0503     2.2
Xs(days_filled_out):includedhorm_contraFx1   0.0537     0.0427     1.3
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
sexy_clothes ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)                           3.0022     0.0675   44.48   &lt; 2e-16 ***
includedhorm_contra                   0.1077     0.0556    1.94    0.0526 .  
menstruationpre                      -0.0904     0.0303   -2.98    0.0029 ** 
menstruationyes                      -0.1288     0.0291   -4.43 0.0000097 ***
fertile                              -0.0111     0.0627   -0.18    0.8594    
fertile_mean                          0.5228     0.3102    1.69    0.0919 .  
includedhorm_contra:menstruationpre   0.0411     0.0389    1.06    0.2906    
includedhorm_contra:menstruationyes   0.0840     0.0381    2.21    0.0273 *  
includedhorm_contra:fertile          -0.0774     0.0792   -0.98    0.3287    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F     p-value    
s(day_number):includedcycling          1.00   1.00 1.05       0.305    
s(day_number):includedhorm_contra      5.06   5.06 8.73 0.000000026 ***
s(days_filled_out):includedcycling     1.00   1.00 5.06       0.025 *  
s(days_filled_out):includedhorm_contra 1.00   1.00 1.58       0.209    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00567   
lmer.REML =  69010  Scale est. = 0.90079   n = 24257
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  74678 74776 -37327

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7482   0.9603

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2145 
Fixed effects: sexy_clothes ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.9844   0.06818 25503   43.77  0.0000
includedhorm_contra                  0.1117   0.05596  1040    2.00  0.0462
menstruationpre                     -0.0877   0.03263 25503   -2.69  0.0072
menstruationyes                     -0.1396   0.03048 25503   -4.58  0.0000
fertile                             -0.0306   0.06830 25503   -0.45  0.6546
fertile_mean                         0.5615   0.31493  1040    1.78  0.0749
includedhorm_contra:menstruationpre  0.0332   0.04186 25503    0.79  0.4281
includedhorm_contra:menstruationyes  0.0868   0.03980 25503    2.18  0.0292
includedhorm_contra:fertile         -0.0876   0.08620 25503   -1.02  0.3094
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.185  0.233                                                        
menstruationyes                     -0.181  0.226  0.402                                                 
fertile                             -0.179  0.292  0.444    0.372                                        
fertile_mean                        -0.769 -0.034 -0.008   -0.006   -0.076                               
includedhorm_contra:menstruationpre  0.152 -0.290 -0.779   -0.313   -0.345 -0.004                        
includedhorm_contra:menstruationyes  0.145 -0.276 -0.308   -0.766   -0.284 -0.003  0.386                 
includedhorm_contra:fertile          0.180 -0.367 -0.351   -0.294   -0.789  0.011  0.442                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.366                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-4.09951 -0.60350 -0.02201  0.61635  4.39994 

Number of Observations: 26552
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  74498 74604 -37236

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7338   0.9692

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.6694 -0.4790 
Fixed effects: sexy_clothes ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.9780    0.0684 25503   43.56  0.0000
includedhorm_contra                  0.1166    0.0561  1040    2.08  0.0381
menstruationpre                     -0.0750    0.0332 25503   -2.26  0.0241
menstruationyes                     -0.1346    0.0314 25503   -4.28  0.0000
fertile                             -0.0120    0.0722 25503   -0.17  0.8674
fertile_mean                         0.5592    0.3164  1040    1.77  0.0774
includedhorm_contra:menstruationpre  0.0190    0.0427 25503    0.44  0.6567
includedhorm_contra:menstruationyes  0.0760    0.0409 25503    1.86  0.0632
includedhorm_contra:fertile         -0.1075    0.0910 25503   -1.18  0.2376
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.187  0.232                                                        
menstruationyes                     -0.187  0.233  0.422                                                 
fertile                             -0.179  0.298  0.397    0.357                                        
fertile_mean                        -0.768 -0.036 -0.005   -0.005   -0.082                               
includedhorm_contra:menstruationpre  0.151 -0.288 -0.779   -0.328   -0.308 -0.004                        
includedhorm_contra:menstruationyes  0.149 -0.283 -0.324   -0.769   -0.274 -0.003  0.409                 
includedhorm_contra:fertile          0.183 -0.375 -0.314   -0.283   -0.789  0.012  0.395                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.351                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-3.99880 -0.60564 -0.01511  0.62013  4.27814 

Number of Observations: 26552
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-12" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-12" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 47798

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.158 -0.612 -0.013  0.617  4.193 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.549    0.741   
 Residual             0.882    0.939   
Number of obs: 17031, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                                3.1618     0.1428   22.14
fertile_mean                                               0.5211     0.6937    0.75
contraceptive_methodsfertility_awareness                  -0.0469     0.1861   -0.25
contraceptive_methodsnone                                 -0.1194     0.1973   -0.61
contraceptive_methodshormonal                             -0.0197     0.0938   -0.21
fertile                                                   -0.2175     0.1048   -2.08
menstruationpre                                           -0.1696     0.0506   -3.35
menstruationyes                                           -0.1925     0.0483   -3.98
contraceptive_methodsfertility_awareness:fertile          -0.2080     0.2379   -0.87
contraceptive_methodsnone:fertile                          0.1993     0.2576    0.77
contraceptive_methodshormonal:fertile                      0.0346     0.1170    0.30
contraceptive_methodsfertility_awareness:menstruationpre   0.1708     0.1121    1.52
contraceptive_methodsnone:menstruationpre                  0.1436     0.1172    1.22
contraceptive_methodshormonal:menstruationpre              0.0856     0.0570    1.50
contraceptive_methodsfertility_awareness:menstruationyes   0.1134     0.1127    1.01
contraceptive_methodsnone:menstruationyes                 -0.0617     0.1225   -0.50
contraceptive_methodshormonal:menstruationyes              0.1363     0.0551    2.47
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">47782</td>
<td align="center">47883</td>
<td align="center">-23878</td>
<td align="center">47756</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">47784</td>
<td align="center">47931</td>
<td align="center">-23873</td>
<td align="center">47746</td>
<td align="center">10.17</td>
<td align="center">6</td>
<td align="center">0.1175</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-12" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">75486</td>
<td align="center">75642</td>
<td align="center">-37724</td>
<td align="center">75448</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">75488</td>
<td align="center">75709</td>
<td align="center">-37717</td>
<td align="center">75434</td>
<td align="center">14.13</td>
<td align="center">8</td>
<td align="center">0.07845</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + age_group +  
    included + fertile + menstruation:included + age_group:included +  
    age_group:fertile + included:fertile + age_group:included:fertile
   Data: diary

REML criterion at convergence: 75511

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.223 -0.610 -0.016  0.616  4.559 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.565    0.752   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   3.01760    0.13835   21.81
menstruationpre                              -0.09448    0.02914   -3.24
menstruationyes                              -0.14495    0.02742   -5.29
fertile_mean                                  0.54034    0.30968    1.74
age_group(20,25]                              0.11476    0.14769    0.78
age_group(25,30]                             -0.00912    0.15203   -0.06
age_group(30,35]                             -0.19454    0.17443   -1.12
age_group(35,70]                             -0.23129    0.16015   -1.44
includedhorm_contra                           0.30850    0.14801    2.08
fertile                                      -0.20557    0.16769   -1.23
menstruationpre:includedhorm_contra           0.03471    0.03737    0.93
menstruationyes:includedhorm_contra           0.09019    0.03593    2.51
age_group(20,25]:includedhorm_contra         -0.35172    0.16839   -2.09
age_group(25,30]:includedhorm_contra         -0.39277    0.18551   -2.12
age_group(30,35]:includedhorm_contra         -0.25181    0.24146   -1.04
age_group(35,70]:includedhorm_contra         -0.34696    0.27240   -1.27
age_group(20,25]:fertile                      0.17717    0.18573    0.95
age_group(25,30]:fertile                      0.07607    0.19144    0.40
age_group(30,35]:fertile                     -0.02891    0.22173   -0.13
age_group(35,70]:fertile                      0.46918    0.20209    2.32
includedhorm_contra:fertile                   0.04468    0.18598    0.24
age_group(20,25]:includedhorm_contra:fertile -0.13317    0.20805   -0.64
age_group(25,30]:includedhorm_contra:fertile  0.05518    0.23053    0.24
age_group(30,35]:includedhorm_contra:fertile -0.23907    0.29755   -0.80
age_group(35,70]:includedhorm_contra:fertile -0.49482    0.33955   -1.46
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-12" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">75501</td>
<td align="center">75608</td>
<td align="center">-37738</td>
<td align="center">75475</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">75503</td>
<td align="center">75626</td>
<td align="center">-37737</td>
<td align="center">75473</td>
<td align="center">2.081</td>
<td align="center">2</td>
<td align="center">0.3532</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + weekend +  
    included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 75533

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.183 -0.609 -0.018  0.617  4.477 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.579    0.761   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              2.97779    0.06814    43.7
menstruationpre                         -0.09563    0.02914    -3.3
menstruationyes                         -0.14457    0.02742    -5.3
fertile_mean                             0.56808    0.31095     1.8
weekendTRUE                              0.01186    0.02544     0.5
includedhorm_contra                      0.11295    0.05661     2.0
fertile                                 -0.05119    0.07186    -0.7
menstruationpre:includedhorm_contra      0.03634    0.03737     1.0
menstruationyes:includedhorm_contra      0.09037    0.03592     2.5
weekendTRUE:includedhorm_contra          0.00124    0.03269     0.0
weekendTRUE:fertile                      0.02389    0.09913     0.2
includedhorm_contra:fertile             -0.12654    0.09105    -1.4
weekendTRUE:includedhorm_contra:fertile  0.08590    0.12564     0.7
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-12" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">75468</td>
<td align="center">75656</td>
<td align="center">-37711</td>
<td align="center">75422</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">75486</td>
<td align="center">75772</td>
<td align="center">-37708</td>
<td align="center">75416</td>
<td align="center">5.984</td>
<td align="center">12</td>
<td align="center">0.9169</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + weekday +  
    included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 75548

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.128 -0.609 -0.013  0.614  4.414 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.579    0.761   
 Residual             0.905    0.951   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.96818    0.07354    40.4
menstruationpre                              -0.09495    0.02912    -3.3
menstruationyes                              -0.14445    0.02740    -5.3
fertile_mean                                  0.57673    0.31095     1.9
weekdayTuesday                               -0.00437    0.04543    -0.1
weekdayWednesday                              0.01649    0.04538     0.4
weekdayThursday                               0.01715    0.04591     0.4
weekdayFriday                                 0.02636    0.04666     0.6
weekdaySaturday                               0.12302    0.04717     2.6
weekdaySunday                                -0.07839    0.04557    -1.7
includedhorm_contra                           0.12257    0.06673     1.8
fertile                                      -0.04607    0.12853    -0.4
menstruationpre:includedhorm_contra           0.03482    0.03735     0.9
menstruationyes:includedhorm_contra           0.08923    0.03590     2.5
weekdayTuesday:includedhorm_contra           -0.03861    0.05829    -0.7
weekdayWednesday:includedhorm_contra         -0.01200    0.05850    -0.2
weekdayThursday:includedhorm_contra           0.01984    0.05907     0.3
weekdayFriday:includedhorm_contra            -0.00712    0.05986    -0.1
weekdaySaturday:includedhorm_contra          -0.03520    0.06060    -0.6
weekdaySunday:includedhorm_contra             0.01515    0.05872     0.3
weekdayTuesday:fertile                       -0.06509    0.17683    -0.4
weekdayWednesday:fertile                      0.01383    0.17799     0.1
weekdayThursday:fertile                       0.03983    0.18062     0.2
weekdayFriday:fertile                         0.00567    0.18082     0.0
weekdaySaturday:fertile                      -0.05488    0.18322    -0.3
weekdaySunday:fertile                         0.08882    0.17812     0.5
includedhorm_contra:fertile                  -0.23831    0.16392    -1.5
weekdayTuesday:includedhorm_contra:fertile    0.22479    0.22509     1.0
weekdayWednesday:includedhorm_contra:fertile  0.10070    0.22711     0.4
weekdayThursday:includedhorm_contra:fertile   0.10409    0.22902     0.5
weekdayFriday:includedhorm_contra:fertile     0.24574    0.22964     1.1
weekdaySaturday:includedhorm_contra:fertile   0.17385    0.23295     0.7
weekdaySunday:includedhorm_contra:fertile     0.18019    0.22672     0.8
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-12" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">75506</td>
<td align="center">75645</td>
<td align="center">-37736</td>
<td align="center">75472</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">75495</td>
<td align="center">75683</td>
<td align="center">-37724</td>
<td align="center">75449</td>
<td align="center">23.68</td>
<td align="center">6</td>
<td align="center">0.0005983</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + included_levels +  
    included + fertile + menstruation:included + included_levels:included +  
    included_levels:fertile + included:fertile + included_levels:included:fertile
   Data: diary

REML criterion at convergence: 75520

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.268 -0.612 -0.015  0.615  4.461 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.578    0.760   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              2.90332    0.07476    38.8
menstruationpre                                         -0.09962    0.02915    -3.4
menstruationyes                                         -0.14671    0.02742    -5.4
fertile_mean                                             0.48918    0.31354     1.6
included_levelslax                                       0.30115    0.15188     2.0
included_levelsconservative                              0.20194    0.11866     1.7
included_levelsstrict                                    0.24848    0.11675     2.1
includedhorm_contra                                      0.14383    0.07713     1.9
fertile                                                  0.08426    0.07497     1.1
menstruationpre:includedhorm_contra                      0.03881    0.03740     1.0
menstruationyes:includedhorm_contra                      0.08995    0.03595     2.5
included_levelslax:includedhorm_contra                  -0.17695    0.18486    -1.0
included_levelsconservative:includedhorm_contra         -0.06585    0.14817    -0.4
included_levelsstrict:includedhorm_contra               -0.20365    0.14347    -1.4
included_levelslax:fertile                               0.00184    0.18124     0.0
included_levelsconservative:fertile                     -0.51109    0.13551    -3.8
included_levelsstrict:fertile                           -0.17325    0.13560    -1.3
includedhorm_contra:fertile                             -0.10364    0.11374    -0.9
included_levelslax:includedhorm_contra:fertile          -0.16237    0.22102    -0.7
included_levelsconservative:includedhorm_contra:fertile  0.22971    0.17600     1.3
included_levelsstrict:includedhorm_contra:fertile        0.14612    0.17330     0.8
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-12" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">75506</td>
<td align="center">75645</td>
<td align="center">-37736</td>
<td align="center">75472</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">75499</td>
<td align="center">75688</td>
<td align="center">-37727</td>
<td align="center">75453</td>
<td align="center">18.91</td>
<td align="center">6</td>
<td align="center">0.004318</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + cycle_length_groups +  
    included + fertile + menstruation:included + cycle_length_groups:included +  
    cycle_length_groups:fertile + included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 75517

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.214 -0.612 -0.017  0.616  4.467 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.577    0.760   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              2.9577     0.1306   22.65
menstruationpre                                         -0.0936     0.0292   -3.21
menstruationyes                                         -0.1425     0.0276   -5.16
fertile_mean                                             0.5247     0.3142    1.67
cycle_length_groups(25,30]                               0.0414     0.1289    0.32
cycle_length_groups(30,35]                               0.0236     0.1539    0.15
cycle_length_groups(35,41]                              -0.0228     0.2169   -0.11
includedhorm_contra                                      0.0034     0.1456    0.02
fertile                                                 -0.1254     0.1590   -0.79
menstruationpre:includedhorm_contra                      0.0345     0.0374    0.92
menstruationyes:includedhorm_contra                      0.0867     0.0361    2.40
cycle_length_groups(25,30]:includedhorm_contra           0.1389     0.1575    0.88
cycle_length_groups(30,35]:includedhorm_contra          -0.1074     0.2393   -0.45
cycle_length_groups(35,41]:includedhorm_contra           0.2815     0.3088    0.91
cycle_length_groups(25,30]:fertile                       0.1676     0.1700    0.99
cycle_length_groups(30,35]:fertile                      -0.1988     0.1999   -0.99
cycle_length_groups(35,41]:fertile                       0.1535     0.2801    0.55
includedhorm_contra:fertile                              0.0741     0.1862    0.40
cycle_length_groups(25,30]:includedhorm_contra:fertile  -0.2660     0.2000   -1.33
cycle_length_groups(30,35]:includedhorm_contra:fertile  -0.3847     0.3116   -1.23
cycle_length_groups(35,41]:includedhorm_contra:fertile   0.2607     0.3675    0.71
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-12" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">75506</td>
<td align="center">75612</td>
<td align="center">-37740</td>
<td align="center">75480</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">75506</td>
<td align="center">75629</td>
<td align="center">-37738</td>
<td align="center">75476</td>
<td align="center">3.622</td>
<td align="center">2</td>
<td align="center">0.1635</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + certainty_menstruation +  
    included + fertile + menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 75535

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.210 -0.609 -0.018  0.617  4.471 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.580    0.761   
 Residual             0.907    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         2.92236    0.19336   15.11
menstruationpre                                    -0.09652    0.02915   -3.31
menstruationyes                                    -0.14597    0.02745   -5.32
fertile_mean                                        0.54772    0.31168    1.76
certainty_menstruation                              0.01549    0.04410    0.35
includedhorm_contra                                 0.10579    0.24263    0.44
fertile                                             0.20883    0.23841    0.88
menstruationpre:includedhorm_contra                 0.03778    0.03738    1.01
menstruationyes:includedhorm_contra                 0.09281    0.03595    2.58
certainty_menstruation:includedhorm_contra          0.00104    0.05650    0.02
certainty_menstruation:fertile                     -0.06027    0.05574   -1.08
includedhorm_contra:fertile                        -0.63153    0.30582   -2.07
certainty_menstruation:includedhorm_contra:fertile  0.12819    0.07063    1.81
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-12" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">75506</td>
<td align="center">75629</td>
<td align="center">-37738</td>
<td align="center">75476</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">75506</td>
<td align="center">75661</td>
<td align="center">-37734</td>
<td align="center">75468</td>
<td align="center">8.864</td>
<td align="center">4</td>
<td align="center">0.06459</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + cycle_regularity +  
    included + fertile + menstruation:included + cycle_regularity:included +  
    cycle_regularity:fertile + included:fertile + cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 75529

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.233 -0.610 -0.019  0.617  4.485 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.579    0.761   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         2.9837     0.0793    37.6
menstruationpre                                                                    -0.0943     0.0292    -3.2
menstruationyes                                                                    -0.1431     0.0274    -5.2
fertile_mean                                                                        0.5195     0.3126     1.7
cycle_regularityslightly irregular,\nup to 5 days off                               0.0750     0.0916     0.8
cycle_regularityirregular,\nmore than 5 days off                                   -0.1006     0.1096    -0.9
includedhorm_contra                                                                 0.1171     0.0721     1.6
fertile                                                                            -0.0171     0.0815    -0.2
menstruationpre:includedhorm_contra                                                 0.0350     0.0374     0.9
menstruationyes:includedhorm_contra                                                 0.0888     0.0359     2.5
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          -0.0273     0.1384    -0.2
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.0641     0.1649     0.4
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.0598     0.1122     0.5
cycle_regularityirregular,\nmore than 5 days off:fertile                           -0.2451     0.1400    -1.8
includedhorm_contra:fertile                                                        -0.0838     0.0954    -0.9
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.3128     0.1664    -1.9
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.2339     0.2070     1.1
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-12" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">75498</td>
<td align="center">75620</td>
<td align="center">-37734</td>
<td align="center">75468</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">75501</td>
<td align="center">75657</td>
<td align="center">-37731</td>
<td align="center">75463</td>
<td align="center">4.703</td>
<td align="center">4</td>
<td align="center">0.3192</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + cohabitation +  
    included + fertile + menstruation:included + cohabitation:included +  
    cohabitation:fertile + included:fertile + cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 75527

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.210 -0.610 -0.018  0.619  4.550 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.574    0.758   
 Residual             0.907    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 2.9457     0.0768    38.3
menstruationpre                                            -0.0958     0.0291    -3.3
menstruationyes                                            -0.1451     0.0274    -5.3
fertile_mean                                                0.5482     0.3106     1.8
cohabitationLive in same city                               0.0782     0.1037     0.8
cohabitationLong-distance                                   0.0993     0.0978     1.0
includedhorm_contra                                        -0.0028     0.0825     0.0
fertile                                                     0.0164     0.0742     0.2
menstruationpre:includedhorm_contra                         0.0359     0.0374     1.0
menstruationyes:includedhorm_contra                         0.0896     0.0359     2.5
cohabitationLive in same city:includedhorm_contra           0.1961     0.1324     1.5
cohabitationLong-distance:includedhorm_contra               0.0837     0.1267     0.7
cohabitationLive in same city:fertile                      -0.2692     0.1343    -2.0
cohabitationLong-distance:fertile                          -0.0286     0.1210    -0.2
includedhorm_contra:fertile                                -0.1589     0.1077    -1.5
cohabitationLive in same city:includedhorm_contra:fertile   0.2463     0.1677     1.5
cohabitationLong-distance:includedhorm_contra:fertile       0.0741     0.1557     0.5
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-12" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">75499</td>
<td align="center">75622</td>
<td align="center">-37735</td>
<td align="center">75469</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">75499</td>
<td align="center">75654</td>
<td align="center">-37730</td>
<td align="center">75461</td>
<td align="center">8.328</td>
<td align="center">4</td>
<td align="center">0.08029</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/sexy_clothes-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: sexy_clothes ~ menstruation + fertile_mean + (1 | person) + relationship_status_clean +  
    included + fertile + menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 75516

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.220 -0.610 -0.017  0.618  4.504 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.574    0.758   
 Residual             0.906    0.952   
Number of obs: 26552, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                        2.9899     0.0715    41.8
menstruationpre                                                   -0.0958     0.0291    -3.3
menstruationyes                                                   -0.1442     0.0274    -5.3
fertile_mean                                                       0.5593     0.3104     1.8
relationship_status_cleanVerheiratet                              -0.0609     0.0961    -0.6
relationship_status_cleanVerlobt                                   0.1574     0.1820     0.9
includedhorm_contra                                                0.1312     0.0613     2.1
fertile                                                           -0.0903     0.0674    -1.3
menstruationpre:includedhorm_contra                                0.0365     0.0374     1.0
menstruationyes:includedhorm_contra                                0.0896     0.0359     2.5
relationship_status_cleanVerheiratet:includedhorm_contra          -0.4327     0.1847    -2.3
relationship_status_cleanVerlobt:includedhorm_contra              -0.2170     0.2686    -0.8
relationship_status_cleanVerheiratet:fertile                       0.2710     0.1197     2.3
relationship_status_cleanVerlobt:fertile                          -0.2655     0.2217    -1.2
includedhorm_contra:fertile                                       -0.0409     0.0820    -0.5
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  -0.3778     0.2235    -1.7
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.4605     0.3443     1.3
</code></pre>
</div>
</div>
</div>
<div id="showy-clothes" class="section level2 tab-content">
<h2>Showy clothes</h2>
<pre class="r"><code>model_summaries$showy_clothes</code></pre>
<div id="model-summary-26" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-27" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: showy_clothes ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 84293

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.711 -0.630 -0.102  0.623  4.112 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.807    0.898   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)                             2.6243     0.0795  1420.0000   33.02   &lt;2e-16 ***
includedhorm_contra                     0.0497     0.0649  1381.0000    0.77   0.4441    
menstruationpre                        -0.0699     0.0344 25876.0000   -2.03   0.0421 *  
menstruationyes                        -0.1146     0.0323 25980.0000   -3.54   0.0004 ***
fertile                                -0.0635     0.0697 25864.0000   -0.91   0.3623    
fertile_mean                            0.5580     0.3670  1540.0000    1.52   0.1287    
includedhorm_contra:menstruationpre     0.0379     0.0441 25876.0000    0.86   0.3895    
includedhorm_contra:menstruationyes     0.0683     0.0424 25963.0000    1.61   0.1070    
includedhorm_contra:fertile            -0.0802     0.0881 25986.0000   -0.91   0.3622    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.168  0.214                                                        
menstrutnys             -0.164  0.206  0.399                                                 
fertile                 -0.162  0.263  0.469    0.387                                        
fertile_men             -0.772 -0.034 -0.008   -0.006   -0.066                               
inclddhrm_cntr:mnstrtnp  0.139 -0.267 -0.780   -0.311   -0.365 -0.004                        
inclddhrm_cntr:mnstrtny  0.131 -0.252 -0.304   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.162 -0.331 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.06 [-0.18;0.07].</p>
</div>
<div id="marginal-effect-plots-13" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-13" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-13" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-13" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-13" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-26" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-52" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-52" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-52" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-26" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-53" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-53" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-53" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-13" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-27" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-54" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-54" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-54" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-27" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-55" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-55" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-55" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-showy_clothes-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-13" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-13" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 84189

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.549 -0.620 -0.098  0.621  3.987 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.824    0.907                     
          fertile         0.445    0.667    -0.10            
          menstruationpre 0.080    0.283    -0.02  0.25      
          menstruationyes 0.103    0.321    -0.18  0.23  0.27
 Residual                 1.226    1.107                     
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           2.6244     0.0800    32.8
includedhorm_contra                   0.0504     0.0656     0.8
menstruationpre                      -0.0690     0.0380    -1.8
menstruationyes                      -0.1126     0.0370    -3.0
fertile                              -0.0644     0.0792    -0.8
fertile_mean                          0.5578     0.3700     1.5
includedhorm_contra:menstruationpre   0.0372     0.0487     0.8
includedhorm_contra:menstruationyes   0.0700     0.0483     1.4
includedhorm_contra:fertile          -0.0811     0.1002    -0.8

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.470                                                               
menstrutnpr             -0.156  0.199                                                        
menstrutnys             -0.194  0.238  0.368                                                 
fertile                 -0.164  0.269  0.420    0.350                                        
fertile_men             -0.770 -0.034 -0.009   -0.001   -0.071                               
inclddhrm_cntr:mnstrtnp  0.130 -0.248 -0.780   -0.287   -0.327 -0.003                        
inclddhrm_cntr:mnstrtny  0.153 -0.294 -0.282   -0.767   -0.268 -0.005  0.356                 
inclddhrm_cntr:f         0.164 -0.337 -0.331   -0.277   -0.787  0.010  0.419                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.346                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">84277</td>
<td align="center">84367</td>
<td align="center">-42127</td>
<td align="center">84255</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">84193</td>
<td align="center">84357</td>
<td align="center">-42076</td>
<td align="center">84153</td>
<td align="center">101.7</td>
<td align="center">9</td>
<td align="center">7.081e-18</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-13" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-13" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-13" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 77080

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.611 -0.637 -0.101  0.625  4.165 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.79447  0.8913  
 Xr.2     s(days_filled_out):includedhorm_contra 0.00000  0.0000  
 Xr.1     s(days_filled_out):includedcycling     0.01872  0.1368  
 Xr.0     s(day_number):includedhorm_contra      0.00891  0.0944  
 Xr       s(day_number):includedcycling          0.00000  0.0000  
 Residual                                        1.25742  1.1213  
Number of obs: 24255, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 2.6332     0.0796    33.1
Xincludedhorm_contra                         0.0601     0.0656     0.9
Xmenstruationpre                            -0.0584     0.0358    -1.6
Xmenstruationyes                            -0.0738     0.0344    -2.1
Xfertile                                    -0.0578     0.0741    -0.8
Xfertile_mean                                0.5420     0.3658     1.5
Xincludedhorm_contra:menstruationpre         0.0331     0.0459     0.7
Xincludedhorm_contra:menstruationyes         0.0254     0.0450     0.6
Xincludedhorm_contra:fertile                -0.0906     0.0936    -1.0
Xs(day_number):includedcyclingFx1           -0.0517     0.0587    -0.9
Xs(day_number):includedhorm_contraFx1       -0.0624     0.0579    -1.1
Xs(days_filled_out):includedcyclingFx1       0.1217     0.0746     1.6
Xs(days_filled_out):includedhorm_contraFx1   0.1394     0.0502     2.8
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
showy_clothes ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           2.6332     0.0796   33.07   &lt;2e-16 ***
includedhorm_contra                   0.0601     0.0656    0.92    0.360    
menstruationpre                      -0.0584     0.0358   -1.63    0.103    
menstruationyes                      -0.0738     0.0344   -2.15    0.032 *  
fertile                              -0.0578     0.0741   -0.78    0.435    
fertile_mean                          0.5420     0.3658    1.48    0.138    
includedhorm_contra:menstruationpre   0.0331     0.0459    0.72    0.471    
includedhorm_contra:menstruationyes   0.0254     0.0450    0.57    0.571    
includedhorm_contra:fertile          -0.0906     0.0936   -0.97    0.333    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value   
s(day_number):includedcycling          1.00   1.00 0.77  0.3790   
s(day_number):includedhorm_contra      2.32   2.32 3.24  0.0439 * 
s(days_filled_out):includedcycling     2.44   2.44 4.77  0.0041 **
s(days_filled_out):includedhorm_contra 1.00   1.00 7.71  0.0055 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00466   
lmer.REML =  77080  Scale est. = 1.2574    n = 24255
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  83636 83734 -41806

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.8872    1.131

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.1888 
Fixed effects: showy_clothes ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.6312    0.0805 25500   32.70  0.0000
includedhorm_contra                  0.0460    0.0660  1040    0.70  0.4865
menstruationpre                     -0.0728    0.0380 25500   -1.91  0.0557
menstruationyes                     -0.1196    0.0356 25500   -3.36  0.0008
fertile                             -0.0627    0.0792 25500   -0.79  0.4285
fertile_mean                         0.5489    0.3716  1040    1.48  0.1399
includedhorm_contra:menstruationpre  0.0412    0.0488 25500    0.84  0.3981
includedhorm_contra:menstruationyes  0.0753    0.0465 25500    1.62  0.1049
includedhorm_contra:fertile         -0.0732    0.1000 25500   -0.73  0.4638
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.183  0.231                                                        
menstruationyes                     -0.179  0.224  0.401                                                 
fertile                             -0.176  0.288  0.448    0.374                                        
fertile_mean                        -0.769 -0.034 -0.008   -0.006   -0.075                               
includedhorm_contra:menstruationpre  0.151 -0.287 -0.779   -0.313   -0.348 -0.004                        
includedhorm_contra:menstruationyes  0.143 -0.273 -0.307   -0.765   -0.286 -0.003  0.386                 
includedhorm_contra:fertile          0.177 -0.362 -0.354   -0.296   -0.789  0.011  0.446                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.368                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.6692 -0.6282 -0.1081  0.6228  4.0552 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  83495 83601 -41734

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:       0.872    1.141

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.6825 -0.5161 
Fixed effects: showy_clothes ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.6273    0.0807 25500   32.55  0.0000
includedhorm_contra                  0.0454    0.0663  1040    0.68  0.4936
menstruationpre                     -0.0644    0.0387 25500   -1.66  0.0964
menstruationyes                     -0.1161    0.0367 25500   -3.17  0.0016
fertile                             -0.0581    0.0835 25500   -0.70  0.4868
fertile_mean                         0.5637    0.3734  1040    1.51  0.1314
includedhorm_contra:menstruationpre  0.0312    0.0497 25500    0.63  0.5310
includedhorm_contra:menstruationyes  0.0703    0.0478 25500    1.47  0.1414
includedhorm_contra:fertile         -0.0758    0.1053 25500   -0.72  0.4719
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.471                                                               
menstruationpre                     -0.184  0.230                                                        
menstruationyes                     -0.184  0.230  0.421                                                 
fertile                             -0.177  0.293  0.402    0.360                                        
fertile_mean                        -0.769 -0.035 -0.005   -0.005   -0.080                               
includedhorm_contra:menstruationpre  0.150 -0.285 -0.779   -0.328   -0.312 -0.004                        
includedhorm_contra:menstruationyes  0.147 -0.280 -0.324   -0.768   -0.276 -0.003  0.408                 
includedhorm_contra:fertile          0.180 -0.369 -0.318   -0.285   -0.789  0.012  0.400                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.354                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.5876 -0.6248 -0.1151  0.6234  3.9951 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-13" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-13" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/showy_clothes-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 53710

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.741 -0.636 -0.095  0.630  4.148 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.816    0.903   
 Residual             1.247    1.117   
Number of obs: 17029, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               2.95016    0.17369   16.99
fertile_mean                                              0.31980    0.84426    0.38
contraceptive_methodsfertility_awareness                 -0.27038    0.22597   -1.20
contraceptive_methodsnone                                -0.23437    0.23952   -0.98
contraceptive_methodshormonal                            -0.18856    0.11392   -1.66
fertile                                                  -0.19729    0.12460   -1.58
menstruationpre                                          -0.11203    0.06018   -1.86
menstruationyes                                          -0.11624    0.05748   -2.02
contraceptive_methodsfertility_awareness:fertile         -0.18511    0.28297   -0.65
contraceptive_methodsnone:fertile                         0.25855    0.30634    0.84
contraceptive_methodshormonal:fertile                     0.00228    0.13918    0.02
contraceptive_methodsfertility_awareness:menstruationpre  0.16107    0.13330    1.21
contraceptive_methodsnone:menstruationpre                 0.13697    0.13936    0.98
contraceptive_methodshormonal:menstruationpre             0.04427    0.06779    0.65
contraceptive_methodsfertility_awareness:menstruationyes  0.16848    0.13397    1.26
contraceptive_methodsnone:menstruationyes                -0.05162    0.14573   -0.35
contraceptive_methodshormonal:menstruationyes             0.05648    0.06555    0.86
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">53698</td>
<td align="center">53799</td>
<td align="center">-26836</td>
<td align="center">53672</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">53702</td>
<td align="center">53849</td>
<td align="center">-26832</td>
<td align="center">53664</td>
<td align="center">7.97</td>
<td align="center">6</td>
<td align="center">0.2403</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-13" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">84258</td>
<td align="center">84413</td>
<td align="center">-42110</td>
<td align="center">84220</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">84255</td>
<td align="center">84476</td>
<td align="center">-42100</td>
<td align="center">84201</td>
<td align="center">18.9</td>
<td align="center">8</td>
<td align="center">0.01539</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 84269

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.709 -0.630 -0.102  0.624  4.113 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.784    0.885   
 Residual             1.261    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    2.7465     0.1630   16.85
menstruationpre                               -0.0694     0.0344   -2.02
menstruationyes                               -0.1164     0.0324   -3.60
fertile_mean                                   0.5271     0.3649    1.44
age_group(20,25]                               0.0313     0.1740    0.18
age_group(25,30]                              -0.0274     0.1791   -0.15
age_group(30,35]                              -0.4776     0.2055   -2.32
age_group(35,70]                              -0.3342     0.1887   -1.77
includedhorm_contra                            0.2011     0.1744    1.15
fertile                                       -0.2350     0.1978   -1.19
menstruationpre:includedhorm_contra            0.0351     0.0441    0.80
menstruationyes:includedhorm_contra            0.0678     0.0424    1.60
age_group(20,25]:includedhorm_contra          -0.3032     0.1984   -1.53
age_group(25,30]:includedhorm_contra          -0.5331     0.2185   -2.44
age_group(30,35]:includedhorm_contra           0.1143     0.2845    0.40
age_group(35,70]:includedhorm_contra          -0.3407     0.3209   -1.06
age_group(20,25]:fertile                       0.2702     0.2191    1.23
age_group(25,30]:fertile                      -0.0898     0.2259   -0.40
age_group(30,35]:fertile                       0.0851     0.2616    0.33
age_group(35,70]:fertile                       0.4956     0.2384    2.08
includedhorm_contra:fertile                   -0.0349     0.2194   -0.16
age_group(20,25]:includedhorm_contra:fertile  -0.1576     0.2454   -0.64
age_group(25,30]:includedhorm_contra:fertile   0.3884     0.2720    1.43
age_group(30,35]:includedhorm_contra:fertile   0.0934     0.3510    0.27
age_group(35,70]:includedhorm_contra:fertile   0.0990     0.4006    0.25
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-13" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">84277</td>
<td align="center">84383</td>
<td align="center">-42125</td>
<td align="center">84251</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">84281</td>
<td align="center">84403</td>
<td align="center">-42125</td>
<td align="center">84251</td>
<td align="center">0.4362</td>
<td align="center">2</td>
<td align="center">0.804</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 84306

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.724 -0.629 -0.103  0.624  4.117 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.807    0.898   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              2.61791    0.08043    32.6
menstruationpre                         -0.06991    0.03438    -2.0
menstruationyes                         -0.11474    0.03235    -3.5
fertile_mean                             0.56055    0.36702     1.5
weekendTRUE                              0.01488    0.03002     0.5
includedhorm_contra                      0.07086    0.06682     1.1
fertile                                 -0.08138    0.08479    -1.0
menstruationpre:includedhorm_contra      0.03813    0.04409     0.9
menstruationyes:includedhorm_contra      0.06790    0.04238     1.6
weekendTRUE:includedhorm_contra         -0.05285    0.03857    -1.4
weekendTRUE:fertile                      0.04250    0.11697     0.4
includedhorm_contra:fertile             -0.08308    0.10743    -0.8
weekendTRUE:includedhorm_contra:fertile  0.00772    0.14825     0.1
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-13" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">84259</td>
<td align="center">84448</td>
<td align="center">-42107</td>
<td align="center">84213</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">84277</td>
<td align="center">84564</td>
<td align="center">-42104</td>
<td align="center">84207</td>
<td align="center">6.14</td>
<td align="center">12</td>
<td align="center">0.9088</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 84329

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.737 -0.632 -0.100  0.625  4.130 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.807    0.899   
 Residual             1.261    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.59075    0.08683   29.84
menstruationpre                              -0.06927    0.03437   -2.02
menstruationyes                              -0.11450    0.03234   -3.54
fertile_mean                                  0.56440    0.36712    1.54
weekdayTuesday                                0.00657    0.05363    0.12
weekdayWednesday                              0.04621    0.05356    0.86
weekdayThursday                               0.04951    0.05418    0.91
weekdayFriday                                 0.07305    0.05508    1.33
weekdaySaturday                               0.11095    0.05568    1.99
weekdaySunday                                -0.05158    0.05378   -0.96
includedhorm_contra                           0.07000    0.07877    0.89
fertile                                      -0.16596    0.15170   -1.09
menstruationpre:includedhorm_contra           0.03679    0.04408    0.83
menstruationyes:includedhorm_contra           0.06715    0.04237    1.58
weekdayTuesday:includedhorm_contra            0.01448    0.06881    0.21
weekdayWednesday:includedhorm_contra          0.00221    0.06905    0.03
weekdayThursday:includedhorm_contra          -0.00688    0.06972   -0.10
weekdayFriday:includedhorm_contra            -0.06015    0.07065   -0.85
weekdaySaturday:includedhorm_contra          -0.05585    0.07152   -0.78
weekdaySunday:includedhorm_contra            -0.03989    0.06931   -0.58
weekdayTuesday:fertile                        0.11817    0.20870    0.57
weekdayWednesday:fertile                      0.17860    0.21007    0.85
weekdayThursday:fertile                       0.04792    0.21318    0.22
weekdayFriday:fertile                         0.03900    0.21341    0.18
weekdaySaturday:fertile                       0.04372    0.21624    0.20
weekdaySunday:fertile                         0.27757    0.21022    1.32
includedhorm_contra:fertile                  -0.14271    0.19347   -0.74
weekdayTuesday:includedhorm_contra:fertile    0.17268    0.26565    0.65
weekdayWednesday:includedhorm_contra:fertile -0.04113    0.26804   -0.15
weekdayThursday:includedhorm_contra:fertile   0.08956    0.27030    0.33
weekdayFriday:includedhorm_contra:fertile     0.13228    0.27103    0.49
weekdaySaturday:includedhorm_contra:fertile   0.13711    0.27493    0.50
weekdaySunday:includedhorm_contra:fertile    -0.05012    0.26759   -0.19
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-13" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">84276</td>
<td align="center">84415</td>
<td align="center">-42121</td>
<td align="center">84242</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">84279</td>
<td align="center">84467</td>
<td align="center">-42117</td>
<td align="center">84233</td>
<td align="center">9.125</td>
<td align="center">6</td>
<td align="center">0.1667</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 84298

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.706 -0.629 -0.102  0.621  4.101 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.802    0.896   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                               2.5032     0.0881   28.42
menstruationpre                                          -0.0746     0.0344   -2.17
menstruationyes                                          -0.1166     0.0324   -3.60
fertile_mean                                              0.5257     0.3695    1.42
included_levelslax                                        0.4630     0.1789    2.59
included_levelsconservative                               0.3155     0.1398    2.26
included_levelsstrict                                     0.2814     0.1375    2.05
includedhorm_contra                                       0.1174     0.0909    1.29
fertile                                                   0.0700     0.0885    0.79
menstruationpre:includedhorm_contra                       0.0412     0.0441    0.93
menstruationyes:includedhorm_contra                       0.0690     0.0424    1.63
included_levelslax:includedhorm_contra                   -0.3078     0.2177   -1.41
included_levelsconservative:includedhorm_contra          -0.3049     0.1745   -1.75
included_levelsstrict:includedhorm_contra                -0.1575     0.1690   -0.93
included_levelslax:fertile                               -0.1087     0.2139   -0.51
included_levelsconservative:fertile                      -0.4389     0.1599   -2.74
included_levelsstrict:fertile                            -0.2388     0.1600   -1.49
includedhorm_contra:fertile                              -0.1529     0.1342   -1.14
included_levelslax:includedhorm_contra:fertile            0.0459     0.2608    0.18
included_levelsconservative:includedhorm_contra:fertile   0.3955     0.2077    1.90
included_levelsstrict:includedhorm_contra:fertile         0.1201     0.2045    0.59
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-13" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">84284</td>
<td align="center">84423</td>
<td align="center">-42125</td>
<td align="center">84250</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">84292</td>
<td align="center">84481</td>
<td align="center">-42123</td>
<td align="center">84246</td>
<td align="center">3.794</td>
<td align="center">6</td>
<td align="center">0.7046</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 84303

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.714 -0.631 -0.102  0.623  4.112 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.809    0.899   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              2.5068     0.1545   16.23
menstruationpre                                         -0.0687     0.0344   -2.00
menstruationyes                                         -0.1110     0.0326   -3.41
fertile_mean                                             0.5308     0.3716    1.43
cycle_length_groups(25,30]                               0.1509     0.1525    0.99
cycle_length_groups(30,35]                               0.0499     0.1820    0.27
cycle_length_groups(35,41]                               0.2533     0.2566    0.99
includedhorm_contra                                      0.0850     0.1723    0.49
fertile                                                 -0.2125     0.1876   -1.13
menstruationpre:includedhorm_contra                      0.0363     0.0441    0.82
menstruationyes:includedhorm_contra                      0.0611     0.0426    1.43
cycle_length_groups(25,30]:includedhorm_contra          -0.0326     0.1864   -0.18
cycle_length_groups(30,35]:includedhorm_contra          -0.1749     0.2831   -0.62
cycle_length_groups(35,41]:includedhorm_contra          -0.2117     0.3653   -0.58
cycle_length_groups(25,30]:fertile                       0.1627     0.2006    0.81
cycle_length_groups(30,35]:fertile                       0.1924     0.2359    0.82
cycle_length_groups(35,41]:fertile                       0.1810     0.3305    0.55
includedhorm_contra:fertile                              0.2343     0.2198    1.07
cycle_length_groups(25,30]:includedhorm_contra:fertile  -0.3609     0.2361   -1.53
cycle_length_groups(30,35]:includedhorm_contra:fertile  -0.3457     0.3678   -0.94
cycle_length_groups(35,41]:includedhorm_contra:fertile  -0.5243     0.4337   -1.21
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-13" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">84276</td>
<td align="center">84382</td>
<td align="center">-42125</td>
<td align="center">84250</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">84276</td>
<td align="center">84399</td>
<td align="center">-42123</td>
<td align="center">84246</td>
<td align="center">3.986</td>
<td align="center">2</td>
<td align="center">0.1363</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 84300

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.703 -0.628 -0.100  0.623  4.111 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.805    0.897   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          2.9479     0.2279   12.94
menstruationpre                                     -0.0713     0.0344   -2.07
menstruationyes                                     -0.1167     0.0324   -3.60
fertile_mean                                         0.5962     0.3674    1.62
certainty_menstruation                              -0.0797     0.0520   -1.53
includedhorm_contra                                 -0.0067     0.2859   -0.02
fertile                                              0.2506     0.2813    0.89
menstruationpre:includedhorm_contra                  0.0394     0.0441    0.89
menstruationyes:includedhorm_contra                  0.0718     0.0424    1.69
certainty_menstruation:includedhorm_contra           0.0154     0.0666    0.23
certainty_menstruation:fertile                      -0.0759     0.0658   -1.15
includedhorm_contra:fertile                         -0.7521     0.3609   -2.08
certainty_menstruation:includedhorm_contra:fertile   0.1593     0.0833    1.91
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-13" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84284</td>
<td align="center">84407</td>
<td align="center">-42127</td>
<td align="center">84254</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84289</td>
<td align="center">84444</td>
<td align="center">-42125</td>
<td align="center">84251</td>
<td align="center">3.292</td>
<td align="center">4</td>
<td align="center">0.5102</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 84306

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.711 -0.629 -0.104  0.622  4.117 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.81     0.90    
 Residual             1.26     1.12    
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         2.6554     0.0937   28.33
menstruationpre                                                                    -0.0715     0.0344   -2.08
menstruationyes                                                                    -0.1157     0.0324   -3.58
fertile_mean                                                                        0.5504     0.3695    1.49
cycle_regularityslightly irregular,\nup to 5 days off                              -0.0356     0.1083   -0.33
cycle_regularityirregular,\nmore than 5 days off                                   -0.0878     0.1296   -0.68
includedhorm_contra                                                                 0.0193     0.0853    0.23
fertile                                                                            -0.1570     0.0962   -1.63
menstruationpre:includedhorm_contra                                                 0.0401     0.0441    0.91
menstruationyes:includedhorm_contra                                                 0.0704     0.0424    1.66
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          -0.0250     0.1636   -0.15
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.1807     0.1950    0.93
cycle_regularityslightly irregular,\nup to 5 days off:fertile                       0.1292     0.1324    0.98
cycle_regularityirregular,\nmore than 5 days off:fertile                            0.2447     0.1652    1.48
includedhorm_contra:fertile                                                         0.0211     0.1126    0.19
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.0918     0.1964   -0.47
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       -0.4005     0.2442   -1.64
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-13" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84275</td>
<td align="center">84398</td>
<td align="center">-42123</td>
<td align="center">84245</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84281</td>
<td align="center">84436</td>
<td align="center">-42121</td>
<td align="center">84243</td>
<td align="center">2.637</td>
<td align="center">4</td>
<td align="center">0.6203</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 84301

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.722 -0.630 -0.103  0.626  4.113 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.802    0.896   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 2.5499     0.0908   28.08
menstruationpre                                            -0.0704     0.0344   -2.05
menstruationyes                                            -0.1154     0.0324   -3.57
fertile_mean                                                0.5407     0.3671    1.47
cohabitationLive in same city                               0.0908     0.1226    0.74
cohabitationLong-distance                                   0.2333     0.1156    2.02
includedhorm_contra                                        -0.0019     0.0975   -0.02
fertile                                                    -0.0912     0.0875   -1.04
menstruationpre:includedhorm_contra                         0.0374     0.0441    0.85
menstruationyes:includedhorm_contra                         0.0683     0.0424    1.61
cohabitationLive in same city:includedhorm_contra           0.0976     0.1565    0.62
cohabitationLong-distance:includedhorm_contra              -0.0476     0.1498   -0.32
cohabitationLive in same city:fertile                      -0.0131     0.1584   -0.08
cohabitationLong-distance:fertile                           0.1157     0.1428    0.81
includedhorm_contra:fertile                                 0.0205     0.1271    0.16
cohabitationLive in same city:includedhorm_contra:fertile  -0.1439     0.1979   -0.73
cohabitationLong-distance:includedhorm_contra:fertile      -0.1691     0.1837   -0.92
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-13" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">84279</td>
<td align="center">84402</td>
<td align="center">-42124</td>
<td align="center">84249</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">84280</td>
<td align="center">84436</td>
<td align="center">-42121</td>
<td align="center">84242</td>
<td align="center">6.425</td>
<td align="center">4</td>
<td align="center">0.1696</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/showy_clothes-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: showy_clothes ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 84292

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.715 -0.630 -0.104  0.623  4.107 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.806    0.898   
 Residual             1.262    1.123   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                        2.6549     0.0846   31.37
menstruationpre                                                   -0.0699     0.0344   -2.03
menstruationyes                                                   -0.1144     0.0323   -3.54
fertile_mean                                                       0.5496     0.3673    1.50
relationship_status_cleanVerheiratet                              -0.1464     0.1138   -1.29
relationship_status_cleanVerlobt                                   0.0957     0.2155    0.44
includedhorm_contra                                                0.0463     0.0725    0.64
fertile                                                           -0.1186     0.0795   -1.49
menstruationpre:includedhorm_contra                                0.0373     0.0441    0.85
menstruationyes:includedhorm_contra                                0.0679     0.0424    1.60
relationship_status_cleanVerheiratet:includedhorm_contra          -0.2759     0.2188   -1.26
relationship_status_cleanVerlobt:includedhorm_contra              -0.3209     0.3181   -1.01
relationship_status_cleanVerheiratet:fertile                       0.2377     0.1413    1.68
relationship_status_cleanVerlobt:fertile                          -0.0153     0.2616   -0.06
includedhorm_contra:fertile                                       -0.0489     0.0968   -0.51
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.1388     0.2637    0.53
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.2836     0.4063    0.70
</code></pre>
</div>
</div>
</div>
<div id="male-attention" class="section level2 tab-content">
<h2>Male attention</h2>
<pre class="r"><code>model_summaries$male_attention_1</code></pre>
<div id="model-summary-28" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-29" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 101508

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8696 -0.7348  0.0005  0.7180  2.8632 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.992    0.996   
 Residual             2.454    1.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value Pr(&gt;|t|)    
(Intercept)                             3.51139     0.09349  1493.00000   37.56  &lt; 2e-16 ***
includedhorm_contra                     0.19210     0.07631  1505.00000    2.52  0.01193 *  
menstruationpre                        -0.05100     0.04786 25968.00000   -1.07  0.28663    
menstruationyes                        -0.17158     0.04500 26093.00000   -3.81  0.00014 ***
fertile                                 0.08275     0.09703 25940.00000    0.85  0.39376    
fertile_mean                            0.04549     0.43450  1599.00000    0.10  0.91662    
includedhorm_contra:menstruationpre    -0.04317     0.06138 25972.00000   -0.70  0.48181    
includedhorm_contra:menstruationyes    -0.00139     0.05897 26073.00000   -0.02  0.98114    
includedhorm_contra:fertile            -0.36891     0.12250 26092.00000   -3.01  0.00260 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.470                                                               
menstrutnpr             -0.202  0.254                                                        
menstrutnys             -0.195  0.244  0.398                                                 
fertile                 -0.193  0.312  0.469    0.386                                        
fertile_men             -0.771 -0.035 -0.007   -0.005   -0.076                               
inclddhrm_cntr:mnstrtnp  0.166 -0.317 -0.780   -0.310   -0.365 -0.005                        
inclddhrm_cntr:mnstrtny  0.156 -0.299 -0.303   -0.763   -0.294 -0.005  0.382                 
inclddhrm_cntr:f         0.193 -0.392 -0.371   -0.306   -0.788  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.382                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.05 [-0.07;0.17].</p>
</div>
<div id="marginal-effect-plots-14" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-14" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-14" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-14" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-14" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-28" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-56" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-56" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-56" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-28" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-57" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-57" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-57" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-14" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-29" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-58" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-58" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-58" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-29" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-59" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-59" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-59" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-male_attention_1-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-14" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-14" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 101266

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.9196 -0.7194 -0.0046  0.7010  2.8077 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     1.113    1.055                     
          fertile         1.704    1.305    -0.28            
          menstruationpre 0.356    0.596    -0.31  0.51      
          menstruationyes 0.340    0.583    -0.26  0.37  0.46
 Residual                 2.337    1.529                     
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           3.5050     0.0958    36.6
includedhorm_contra                   0.1945     0.0800     2.4
menstruationpre                      -0.0432     0.0582    -0.7
menstruationyes                      -0.1646     0.0554    -3.0
fertile                               0.1119     0.1212     0.9
fertile_mean                          0.0615     0.4406     0.1
includedhorm_contra:menstruationpre  -0.0404     0.0747    -0.5
includedhorm_contra:menstruationyes  -0.0133     0.0721    -0.2
includedhorm_contra:fertile          -0.3819     0.1534    -2.5

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.482                                                               
menstrutnpr             -0.258  0.316                                                        
menstrutnys             -0.244  0.295  0.413                                                 
fertile                 -0.233  0.356  0.476    0.379                                        
fertile_men             -0.758 -0.035 -0.007   -0.003   -0.082                               
inclddhrm_cntr:mnstrtnp  0.212 -0.397 -0.780   -0.322   -0.370 -0.008                        
inclddhrm_cntr:mnstrtny  0.193 -0.364 -0.317   -0.768   -0.290 -0.006  0.402                 
inclddhrm_cntr:f         0.225 -0.449 -0.376   -0.299   -0.785  0.010  0.475                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.374                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="13%" />
<col width="9%" />
<col width="11%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">101496</td>
<td align="center">101586</td>
<td align="center">-50737</td>
<td align="center">101474</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">101275</td>
<td align="center">101438</td>
<td align="center">-50617</td>
<td align="center">101235</td>
<td align="center">239.7</td>
<td align="center">9</td>
<td align="center">1.523e-46</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
<div class="alert alert-danger">
<p><strong>Error:</strong> Error in intervals.lme(fit): cannot get confidence intervals on var-cov components: Non-positive definite approximate variance-covariance Consider ‘which = “fixed”’</p>
</div>
</div>
<div id="m_e-exclusion-criteria-14" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-14" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-14" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 92592

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8588 -0.7351  0.0016  0.7129  2.9693 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            1.002    1.001   
 Xr.2     s(days_filled_out):includedhorm_contra 0.292    0.541   
 Xr.1     s(days_filled_out):includedcycling     0.120    0.346   
 Xr.0     s(day_number):includedhorm_contra      0.338    0.581   
 Xr       s(day_number):includedcycling          0.259    0.509   
 Residual                                        2.422    1.556   
Number of obs: 24250, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                3.48498    0.09475    36.8
Xincludedhorm_contra                        0.16847    0.07823     2.2
Xmenstruationpre                           -0.04995    0.04966    -1.0
Xmenstruationyes                           -0.18780    0.04763    -3.9
Xfertile                                    0.02840    0.10277     0.3
Xfertile_mean                               0.12495    0.43700     0.3
Xincludedhorm_contra:menstruationpre       -0.03142    0.06365    -0.5
Xincludedhorm_contra:menstruationyes        0.00884    0.06232     0.1
Xincludedhorm_contra:fertile               -0.31508    0.12969    -2.4
Xs(day_number):includedcyclingFx1           0.24951    0.16435     1.5
Xs(day_number):includedhorm_contraFx1       0.65155    0.17748     3.7
Xs(days_filled_out):includedcyclingFx1     -0.11903    0.14420    -0.8
Xs(days_filled_out):includedhorm_contraFx1 -0.56062    0.17269    -3.2
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
male_attention_1 ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          3.48498    0.09475   36.78  &lt; 2e-16 ***
includedhorm_contra                  0.16847    0.07823    2.15    0.031 *  
menstruationpre                     -0.04995    0.04966   -1.01    0.314    
menstruationyes                     -0.18780    0.04763   -3.94 0.000081 ***
fertile                              0.02840    0.10277    0.28    0.782    
fertile_mean                         0.12495    0.43700    0.29    0.775    
includedhorm_contra:menstruationpre -0.03142    0.06365   -0.49    0.622    
includedhorm_contra:menstruationyes  0.00884    0.06232    0.14    0.887    
includedhorm_contra:fertile         -0.31508    0.12969   -2.43    0.015 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F   p-value    
s(day_number):includedcycling          3.69   3.69 1.65      0.18    
s(day_number):includedhorm_contra      4.22   4.22 7.00 0.0000091 ***
s(days_filled_out):includedcycling     2.70   2.70 1.60      0.16    
s(days_filled_out):includedhorm_contra 3.97   3.97 7.69 0.0000039 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00262   
lmer.REML =  92592  Scale est. = 2.422     n = 24250
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
     AIC    BIC logLik
  100120 100218 -50048

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.9591    1.584

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2695 
Fixed effects: male_attention_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.508    0.0953 25495   36.82  0.0000
includedhorm_contra                  0.189    0.0784  1040    2.41  0.0163
menstruationpre                     -0.050    0.0548 25495   -0.91  0.3625
menstruationyes                     -0.163    0.0511 25495   -3.18  0.0015
fertile                              0.106    0.1162 25495    0.91  0.3618
fertile_mean                         0.115    0.4429  1040    0.26  0.7953
includedhorm_contra:menstruationpre -0.035    0.0703 25495   -0.50  0.6176
includedhorm_contra:menstruationyes  0.019    0.0666 25495    0.28  0.7797
includedhorm_contra:fertile         -0.366    0.1465 25495   -2.50  0.0124
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.475                                                               
menstruationpre                     -0.225  0.280                                                        
menstruationyes                     -0.219  0.271  0.401                                                 
fertile                             -0.216  0.350  0.434    0.365                                        
fertile_mean                        -0.766 -0.036 -0.007   -0.005   -0.091                               
includedhorm_contra:menstruationpre  0.184 -0.348 -0.779   -0.313   -0.337 -0.006                        
includedhorm_contra:menstruationyes  0.174 -0.330 -0.308   -0.767   -0.279 -0.005  0.386                 
includedhorm_contra:fertile          0.217 -0.441 -0.344   -0.289   -0.788  0.012  0.432                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.358                 

Standardized Within-Group Residuals:
      Min        Q1       Med        Q3       Max 
-2.765481 -0.749312  0.001412  0.718313  2.796476 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
     AIC    BIC logLik
  100115 100222 -50045

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.9565    1.585

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
    Phi1   Theta1 
 0.33098 -0.06607 
Fixed effects: male_attention_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          3.506    0.0953 25495   36.78  0.0000
includedhorm_contra                  0.190    0.0785  1040    2.42  0.0158
menstruationpre                     -0.048    0.0550 25495   -0.88  0.3787
menstruationyes                     -0.162    0.0513 25495   -3.16  0.0016
fertile                              0.108    0.1172 25495    0.92  0.3552
fertile_mean                         0.118    0.4433  1040    0.27  0.7893
includedhorm_contra:menstruationpre -0.036    0.0706 25495   -0.51  0.6074
includedhorm_contra:menstruationyes  0.018    0.0669 25495    0.26  0.7924
includedhorm_contra:fertile         -0.369    0.1477 25495   -2.50  0.0125
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.475                                                               
menstruationpre                     -0.226  0.280                                                        
menstruationyes                     -0.220  0.272  0.403                                                 
fertile                             -0.216  0.352  0.430    0.363                                        
fertile_mean                        -0.766 -0.037 -0.006   -0.005   -0.092                               
includedhorm_contra:menstruationpre  0.184 -0.348 -0.779   -0.314   -0.334 -0.006                        
includedhorm_contra:menstruationyes  0.175 -0.331 -0.309   -0.767   -0.278 -0.005  0.387                 
includedhorm_contra:fertile          0.218 -0.443 -0.340   -0.288   -0.788  0.012  0.428                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.357                 

Standardized Within-Group Residuals:
      Min        Q1       Med        Q3       Max 
-2.754758 -0.750546  0.001602  0.719551  2.787984 

Number of Observations: 26544
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-14" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-14" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/male_attention_1-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 65006

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-2.881 -0.734  0.005  0.724  2.853 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.905    0.951   
 Residual             2.464    1.570   
Number of obs: 17026, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                                3.6375     0.1893   19.22
fertile_mean                                               0.2528     0.9124    0.28
contraceptive_methodsfertility_awareness                   0.1701     0.2527    0.67
contraceptive_methodsnone                                 -0.0796     0.2680   -0.30
contraceptive_methodshormonal                              0.0131     0.1271    0.10
fertile                                                    0.0324     0.1749    0.19
menstruationpre                                           -0.0491     0.0845   -0.58
menstruationyes                                           -0.1371     0.0807   -1.70
contraceptive_methodsfertility_awareness:fertile          -0.1101     0.3973   -0.28
contraceptive_methodsnone:fertile                          0.1370     0.4303    0.32
contraceptive_methodshormonal:fertile                     -0.3382     0.1954   -1.73
contraceptive_methodsfertility_awareness:menstruationpre   0.0256     0.1873    0.14
contraceptive_methodsnone:menstruationpre                 -0.2189     0.1957   -1.12
contraceptive_methodshormonal:menstruationpre             -0.0266     0.0952   -0.28
contraceptive_methodsfertility_awareness:menstruationyes   0.0582     0.1882    0.31
contraceptive_methodsnone:menstruationyes                 -0.1345     0.2047   -0.66
contraceptive_methodshormonal:menstruationyes             -0.0495     0.0920   -0.54
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">64998</td>
<td align="center">65099</td>
<td align="center">-32486</td>
<td align="center">64972</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">65007</td>
<td align="center">65154</td>
<td align="center">-32485</td>
<td align="center">64969</td>
<td align="center">3.253</td>
<td align="center">6</td>
<td align="center">0.7765</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-14" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">101500</td>
<td align="center">101655</td>
<td align="center">-50731</td>
<td align="center">101462</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">101505</td>
<td align="center">101726</td>
<td align="center">-50725</td>
<td align="center">101451</td>
<td align="center">10.78</td>
<td align="center">8</td>
<td align="center">0.2142</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 101507

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8984 -0.7351 -0.0016  0.7200  2.8612 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.99     0.995   
 Residual             2.45     1.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   3.727460   0.190617   19.55
menstruationpre                              -0.052603   0.047871   -1.10
menstruationyes                              -0.174086   0.045020   -3.87
fertile_mean                                  0.028952   0.436277    0.07
age_group(20,25]                             -0.178275   0.202289   -0.88
age_group(25,30]                             -0.136586   0.208299   -0.66
age_group(30,35]                             -0.328638   0.238974   -1.38
age_group(35,70]                             -0.416804   0.219196   -1.90
includedhorm_contra                           0.092997   0.203128    0.46
fertile                                      -0.043176   0.275517   -0.16
menstruationpre:includedhorm_contra          -0.043650   0.061391   -0.71
menstruationyes:includedhorm_contra          -0.000766   0.058994   -0.01
age_group(20,25]:includedhorm_contra          0.084829   0.230390    0.37
age_group(25,30]:includedhorm_contra         -0.118149   0.254089   -0.46
age_group(30,35]:includedhorm_contra          0.246248   0.330291    0.75
age_group(35,70]:includedhorm_contra         -0.381224   0.373152   -1.02
age_group(20,25]:fertile                      0.186465   0.305069    0.61
age_group(25,30]:fertile                     -0.110141   0.314474   -0.35
age_group(30,35]:fertile                      0.710506   0.364131    1.95
age_group(35,70]:fertile                      0.035523   0.332022    0.11
includedhorm_contra:fertile                  -0.258727   0.305557   -0.85
age_group(20,25]:includedhorm_contra:fertile -0.179495   0.341749   -0.53
age_group(25,30]:includedhorm_contra:fertile  0.187048   0.378649    0.49
age_group(30,35]:includedhorm_contra:fertile -0.977660   0.488556   -2.00
age_group(35,70]:includedhorm_contra:fertile  0.460129   0.557918    0.82
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-14" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">101167</td>
<td align="center">101274</td>
<td align="center">-50571</td>
<td align="center">101141</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">101168</td>
<td align="center">101291</td>
<td align="center">-50569</td>
<td align="center">101138</td>
<td align="center">3.018</td>
<td align="center">2</td>
<td align="center">0.2211</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 101186

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0343 -0.7397  0.0038  0.7109  2.9340 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.994    0.997   
 Residual             2.422    1.556   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              3.38154    0.09491    35.6
menstruationpre                         -0.05125    0.04755    -1.1
menstruationyes                         -0.17405    0.04471    -3.9
fertile_mean                             0.06875    0.43390     0.2
weekendTRUE                              0.31276    0.04156     7.5
includedhorm_contra                      0.18129    0.07927     2.3
fertile                                 -0.03219    0.11731    -0.3
menstruationpre:includedhorm_contra     -0.04556    0.06098    -0.7
menstruationyes:includedhorm_contra      0.00546    0.05859     0.1
weekendTRUE:includedhorm_contra          0.03286    0.05341     0.6
weekendTRUE:fertile                      0.26543    0.16194     1.6
includedhorm_contra:fertile             -0.28907    0.14858    -1.9
weekendTRUE:includedhorm_contra:fertile -0.19283    0.20528    -0.9
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-14" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">100957</td>
<td align="center">101146</td>
<td align="center">-50456</td>
<td align="center">100911</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">100967</td>
<td align="center">101254</td>
<td align="center">-50449</td>
<td align="center">100897</td>
<td align="center">14.46</td>
<td align="center">12</td>
<td align="center">0.2724</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 100999

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.0538 -0.7289  0.0099  0.7137  3.0080 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.996    0.998   
 Residual             2.401    1.550   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    3.6227     0.1050    34.5
menstruationpre                               -0.0522     0.0474    -1.1
menstruationyes                               -0.1757     0.0445    -3.9
fertile_mean                                   0.0463     0.4336     0.1
weekdayTuesday                                -0.3070     0.0740    -4.1
weekdayWednesday                              -0.2835     0.0739    -3.8
weekdayThursday                               -0.3621     0.0747    -4.8
weekdayFriday                                 -0.1651     0.0760    -2.2
weekdaySaturday                                0.2185     0.0768     2.8
weekdaySunday                                  0.1777     0.0742     2.4
includedhorm_contra                            0.1607     0.0979     1.6
fertile                                       -0.1082     0.2092    -0.5
menstruationpre:includedhorm_contra           -0.0419     0.0607    -0.7
menstruationyes:includedhorm_contra            0.0102     0.0584     0.2
weekdayTuesday:includedhorm_contra            -0.0464     0.0949    -0.5
weekdayWednesday:includedhorm_contra          -0.0591     0.0953    -0.6
weekdayThursday:includedhorm_contra            0.1859     0.0962     1.9
weekdayFriday:includedhorm_contra              0.0796     0.0975     0.8
weekdaySaturday:includedhorm_contra           -0.0304     0.0987    -0.3
weekdaySunday:includedhorm_contra              0.1002     0.0956     1.0
weekdayTuesday:fertile                        -0.0426     0.2879    -0.1
weekdayWednesday:fertile                      -0.0889     0.2898    -0.3
weekdayThursday:fertile                        0.4733     0.2940     1.6
weekdayFriday:fertile                          0.3391     0.2944     1.2
weekdaySaturday:fertile                        0.0287     0.2983     0.1
weekdaySunday:fertile                          0.6665     0.2900     2.3
includedhorm_contra:fertile                   -0.3307     0.2668    -1.2
weekdayTuesday:includedhorm_contra:fertile     0.3215     0.3664     0.9
weekdayWednesday:includedhorm_contra:fertile   0.1499     0.3697     0.4
weekdayThursday:includedhorm_contra:fertile   -0.3123     0.3729    -0.8
weekdayFriday:includedhorm_contra:fertile     -0.0974     0.3739    -0.3
weekdaySaturday:includedhorm_contra:fertile    0.0797     0.3793     0.2
weekdaySunday:includedhorm_contra:fertile     -0.4360     0.3691    -1.2
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-14" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">101496</td>
<td align="center">101635</td>
<td align="center">-50731</td>
<td align="center">101462</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">101505</td>
<td align="center">101693</td>
<td align="center">-50729</td>
<td align="center">101459</td>
<td align="center">3.337</td>
<td align="center">6</td>
<td align="center">0.7655</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 101513

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8702 -0.7347  0.0011  0.7181  2.9062 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.984    0.992   
 Residual             2.454    1.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              3.42837    0.10350    33.1
menstruationpre                                         -0.05368    0.04790    -1.1
menstruationyes                                         -0.17189    0.04502    -3.8
fertile_mean                                             0.00879    0.43812     0.0
included_levelslax                                      -0.05073    0.20341    -0.2
included_levelsconservative                              0.44208    0.15912     2.8
included_levelsstrict                                    0.18949    0.15645     1.2
includedhorm_contra                                      0.29988    0.10682     2.8
fertile                                                  0.11491    0.12310     0.9
menstruationpre:includedhorm_contra                     -0.04100    0.06145    -0.7
menstruationyes:includedhorm_contra                     -0.00268    0.05904     0.0
included_levelslax:includedhorm_contra                  -0.11034    0.24823    -0.4
included_levelsconservative:includedhorm_contra         -0.38635    0.19935    -1.9
included_levelsstrict:includedhorm_contra               -0.22700    0.19294    -1.2
included_levelslax:fertile                              -0.10789    0.29801    -0.4
included_levelsconservative:fertile                     -0.02589    0.22269    -0.1
included_levelsstrict:fertile                           -0.10665    0.22286    -0.5
includedhorm_contra:fertile                             -0.30878    0.18634    -1.7
included_levelslax:includedhorm_contra:fertile          -0.17475    0.36323    -0.5
included_levelsconservative:includedhorm_contra:fertile -0.13971    0.28903    -0.5
included_levelsstrict:includedhorm_contra:fertile        0.11058    0.28457     0.4
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-14" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">101502</td>
<td align="center">101641</td>
<td align="center">-50734</td>
<td align="center">101468</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">101509</td>
<td align="center">101697</td>
<td align="center">-50731</td>
<td align="center">101463</td>
<td align="center">4.741</td>
<td align="center">6</td>
<td align="center">0.5775</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 101509

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8825 -0.7344 -0.0014  0.7179  2.8519 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.991    0.996   
 Residual             2.454    1.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              3.1944     0.1788   17.87
menstruationpre                                         -0.0528     0.0479   -1.10
menstruationyes                                         -0.1781     0.0453   -3.93
fertile_mean                                            -0.0216     0.4393   -0.05
cycle_length_groups(25,30]                               0.4033     0.1755    2.30
cycle_length_groups(30,35]                               0.3142     0.2092    1.50
cycle_length_groups(35,41]                               0.1746     0.2944    0.59
includedhorm_contra                                      0.4619     0.1986    2.33
fertile                                                  0.4021     0.2610    1.54
menstruationpre:includedhorm_contra                     -0.0397     0.0614   -0.65
menstruationyes:includedhorm_contra                      0.0100     0.0593    0.17
cycle_length_groups(25,30]:includedhorm_contra          -0.3276     0.2143   -1.53
cycle_length_groups(30,35]:includedhorm_contra          -0.4063     0.3243   -1.25
cycle_length_groups(35,41]:includedhorm_contra          -0.0870     0.4166   -0.21
cycle_length_groups(25,30]:fertile                      -0.3468     0.2791   -1.24
cycle_length_groups(30,35]:fertile                      -0.4143     0.3283   -1.26
cycle_length_groups(35,41]:fertile                      -0.3868     0.4599   -0.84
includedhorm_contra:fertile                             -0.8444     0.3059   -2.76
cycle_length_groups(25,30]:includedhorm_contra:fertile   0.5596     0.3286    1.70
cycle_length_groups(30,35]:includedhorm_contra:fertile   0.1542     0.5120    0.30
cycle_length_groups(35,41]:includedhorm_contra:fertile   0.5664     0.6038    0.94
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-14" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">101494</td>
<td align="center">101600</td>
<td align="center">-50734</td>
<td align="center">101468</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">101488</td>
<td align="center">101611</td>
<td align="center">-50729</td>
<td align="center">101458</td>
<td align="center">9.179</td>
<td align="center">2</td>
<td align="center">0.01016</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 101506

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8756 -0.7353  0.0003  0.7194  2.8654 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.985    0.993   
 Residual             2.453    1.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         3.10257    0.26160   11.86
menstruationpre                                    -0.04660    0.04787   -0.97
menstruationyes                                    -0.16451    0.04505   -3.65
fertile_mean                                        0.00707    0.43444    0.02
certainty_menstruation                              0.09984    0.05958    1.68
includedhorm_contra                                 0.40600    0.32808    1.24
fertile                                            -1.01237    0.39136   -2.59
menstruationpre:includedhorm_contra                -0.04755    0.06138   -0.77
menstruationyes:includedhorm_contra                -0.00947    0.05902   -0.16
certainty_menstruation:includedhorm_contra         -0.05251    0.07630   -0.69
certainty_menstruation:fertile                      0.26440    0.09150    2.89
includedhorm_contra:fertile                         1.00444    0.50203    2.00
certainty_menstruation:includedhorm_contra:fertile -0.32921    0.11595   -2.84
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-14" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">101501</td>
<td align="center">101624</td>
<td align="center">-50736</td>
<td align="center">101471</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">101505</td>
<td align="center">101661</td>
<td align="center">-50734</td>
<td align="center">101467</td>
<td align="center">3.602</td>
<td align="center">4</td>
<td align="center">0.4625</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 101514

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8735 -0.7354  0.0001  0.7181  2.8540 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.995    0.997   
 Residual             2.454    1.566   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        3.60344    0.10979    32.8
menstruationpre                                                                   -0.05321    0.04788    -1.1
menstruationyes                                                                   -0.17276    0.04501    -3.8
fertile_mean                                                                       0.03854    0.43696     0.1
cycle_regularityslightly irregular,\nup to 5 days off                             -0.12858    0.12419    -1.0
cycle_regularityirregular,\nmore than 5 days off                                  -0.23906    0.14939    -1.6
includedhorm_contra                                                                0.10440    0.09924     1.1
fertile                                                                           -0.04273    0.13387    -0.3
menstruationpre:includedhorm_contra                                               -0.04186    0.06140    -0.7
menstruationyes:includedhorm_contra                                               -0.00209    0.05900     0.0
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.22410    0.18732     1.2
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.06994    0.22380     0.3
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.19765    0.18414     1.1
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.28110    0.22982     1.2
includedhorm_contra:fertile                                                       -0.27883    0.15663    -1.8
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.09589    0.27333    -0.4
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.02575    0.33999     0.1
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-14" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">101484</td>
<td align="center">101607</td>
<td align="center">-50727</td>
<td align="center">101454</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">101490</td>
<td align="center">101645</td>
<td align="center">-50726</td>
<td align="center">101452</td>
<td align="center">2.128</td>
<td align="center">4</td>
<td align="center">0.7123</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 101502

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8621 -0.7358 -0.0005  0.7198  2.8807 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.972    0.986   
 Residual             2.454    1.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                           Estimate Std. Error t value
(Intercept)                                                3.598077   0.105806    34.0
menstruationpre                                           -0.050172   0.047861    -1.0
menstruationyes                                           -0.170437   0.045007    -3.8
fertile_mean                                              -0.033109   0.432436    -0.1
cohabitationLive in same city                             -0.094777   0.140156    -0.7
cohabitationLong-distance                                 -0.216262   0.132200    -1.6
includedhorm_contra                                        0.128440   0.112602     1.1
fertile                                                    0.129740   0.121816     1.1
menstruationpre:includedhorm_contra                       -0.044545   0.061384    -0.7
menstruationyes:includedhorm_contra                       -0.002191   0.058976     0.0
cohabitationLive in same city:includedhorm_contra          0.297631   0.178819     1.7
cohabitationLong-distance:includedhorm_contra              0.000615   0.171138     0.0
cohabitationLive in same city:fertile                     -0.014911   0.220307    -0.1
cohabitationLong-distance:fertile                         -0.163200   0.198617    -0.8
includedhorm_contra:fertile                               -0.292883   0.176795    -1.7
cohabitationLive in same city:includedhorm_contra:fertile -0.151636   0.275281    -0.6
cohabitationLong-distance:includedhorm_contra:fertile     -0.012910   0.255605    -0.1
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-14" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table style="width:100%;">
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">101496</td>
<td align="center">101619</td>
<td align="center">-50733</td>
<td align="center">101466</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">101501</td>
<td align="center">101657</td>
<td align="center">-50732</td>
<td align="center">101463</td>
<td align="center">2.738</td>
<td align="center">4</td>
<td align="center">0.6027</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/male_attention_1-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: male_attention_1 ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 101504

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8611 -0.7353  0.0018  0.7221  2.8664 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.988    0.994   
 Residual             2.454    1.567   
Number of obs: 26544, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       3.51614    0.09907    35.5
menstruationpre                                                  -0.05094    0.04786    -1.1
menstruationyes                                                  -0.17158    0.04500    -3.8
fertile_mean                                                      0.06479    0.43436     0.1
relationship_status_cleanVerheiratet                             -0.04494    0.13072    -0.3
relationship_status_cleanVerlobt                                  0.05054    0.24595     0.2
includedhorm_contra                                               0.19831    0.08479     2.3
fertile                                                           0.12813    0.11062     1.2
menstruationpre:includedhorm_contra                              -0.04427    0.06138    -0.7
menstruationyes:includedhorm_contra                              -0.00221    0.05897     0.0
relationship_status_cleanVerheiratet:includedhorm_contra         -0.48966    0.25042    -2.0
relationship_status_cleanVerlobt:includedhorm_contra              0.32047    0.36474     0.9
relationship_status_cleanVerheiratet:fertile                     -0.20560    0.19660    -1.0
relationship_status_cleanVerlobt:fertile                          0.05487    0.36388     0.2
includedhorm_contra:fertile                                      -0.43652    0.13464    -3.2
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  0.56002    0.36701     1.5
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.17826    0.56536     0.3
</code></pre>
</div>
</div>
</div>
<div id="in-pair-public-intimacy" class="section level2 tab-content">
<h2>In-pair public intimacy</h2>
<pre class="r"><code>model_summaries$in_pair_public_intimacy</code></pre>
<div id="model-summary-30" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-31" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32853    32935   -16417    32833    26558 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.847 -0.780 -0.354  0.859  3.982 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.486    0.697   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                         -0.08657    0.07100   -1.22    0.223  
includedhorm_contra                 -0.00124    0.05765   -0.02    0.983  
menstruationpre                     -0.03553    0.04136   -0.86    0.390  
menstruationyes                      0.02716    0.03911    0.69    0.487  
fertile                             -0.14056    0.08419   -1.67    0.095 .
fertile_mean                         0.15361    0.33286    0.46    0.644  
includedhorm_contra:menstruationpre -0.02276    0.05289   -0.43    0.667  
includedhorm_contra:menstruationyes -0.10085    0.05113   -1.97    0.049 *
includedhorm_contra:fertile         -0.12677    0.10601   -1.20    0.232  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.467                                                               
menstrutnpr             -0.233  0.293                                                        
menstrutnys             -0.223  0.279  0.393                                                 
fertile                 -0.222  0.357  0.469    0.382                                        
fertile_men             -0.772 -0.040 -0.006   -0.004   -0.085                               
inclddhrm_cntr:mnstrtnp  0.191 -0.365 -0.782   -0.307   -0.366 -0.006                        
inclddhrm_cntr:mnstrtny  0.178 -0.340 -0.301   -0.765   -0.291 -0.007  0.379                 
inclddhrm_cntr:f         0.221 -0.449 -0.372   -0.303   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.379                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.14 [-0.31;0.02].</p>
</div>
<div id="marginal-effect-plots-15" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-15" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-15" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-15" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-15" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-30" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-60" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-60" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-60" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-30" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-61" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-61" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-61" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-15" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-31" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-62" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-62" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-62" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-31" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-63" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-63" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-63" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-in_pair_public_intimacy-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-15" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-15" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-random_slopes-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32610    32765   -16286    32572    26549 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.767 -0.738 -0.312  0.812  3.557 

Random effects:
 Groups Name            Variance Std.Dev. Corr             
 person (Intercept)     0.554    0.744                     
        fertile         1.030    1.015    -0.28            
        menstruationpre 0.231    0.480    -0.32  0.21      
        menstruationyes 0.287    0.536     0.17  0.18  0.42
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                          -0.0978     0.0744   -1.31    0.189  
includedhorm_contra                   0.0064     0.0611    0.10    0.917  
menstruationpre                      -0.0261     0.0510   -0.51    0.609  
menstruationyes                       0.0241     0.0519    0.46    0.643  
fertile                              -0.1359     0.1058   -1.28    0.199  
fertile_mean                          0.1982     0.3484    0.57    0.569  
includedhorm_contra:menstruationpre  -0.0451     0.0653   -0.69    0.490  
includedhorm_contra:menstruationyes  -0.1309     0.0677   -1.93    0.053 .
includedhorm_contra:fertile          -0.1623     0.1333   -1.22    0.224  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.473                                                               
menstrutnpr             -0.292  0.347                                                        
menstrutnys             -0.126  0.163  0.391                                                 
fertile                 -0.246  0.392  0.386    0.307                                        
fertile_men             -0.766 -0.040  0.010   -0.010   -0.095                               
inclddhrm_cntr:mnstrtnp  0.232 -0.434 -0.781   -0.305   -0.301 -0.012                        
inclddhrm_cntr:mnstrtny  0.104 -0.195 -0.300   -0.766   -0.234 -0.002  0.381                 
inclddhrm_cntr:f         0.245 -0.494 -0.307   -0.243   -0.787  0.011  0.386                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.303                 
convergence code: 0
Model failed to converge with max|grad| = 0.0149075 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="23%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="10%" />
<col width="12%" />
<col width="9%" />
<col width="10%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>model</strong></td>
<td align="center">10</td>
<td align="center">32853</td>
<td align="center">32935</td>
<td align="center">-16417</td>
<td align="center">32833</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_ind_diff</strong></td>
<td align="center">19</td>
<td align="center">32610</td>
<td align="center">32765</td>
<td align="center">-16286</td>
<td align="center">32572</td>
<td align="center">261.6</td>
<td align="center">9</td>
<td align="center">3.528e-51</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-15" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-15" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-15" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-3.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )

     AIC      BIC   logLik deviance df.resid 
   29871    30017   -14917    29835    24253 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.707 -0.766 -0.326  0.854  3.857 

Random effects:
 Groups Name                                   Variance Std.Dev.
 person (Intercept)                            0.511    0.715   
 Xr.2   s(days_filled_out):includedhorm_contra 0.294    0.542   
 Xr.1   s(days_filled_out):includedcycling     0.153    0.391   
 Xr.0   s(day_number):includedhorm_contra      0.218    0.467   
 Xr     s(day_number):includedcycling          0.236    0.486   
Number of obs: 24271, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error z value Pr(&gt;|z|)   
X(Intercept)                               -0.12648    0.07337   -1.72   0.0847 . 
Xincludedhorm_contra                       -0.00301    0.06048   -0.05   0.9604   
Xmenstruationpre                            0.00201    0.04340    0.05   0.9631   
Xmenstruationyes                            0.02546    0.04187    0.61   0.5432   
Xfertile                                   -0.10550    0.09008   -1.17   0.2416   
Xfertile_mean                               0.15227    0.34016    0.45   0.6544   
Xincludedhorm_contra:menstruationpre       -0.03202    0.05551   -0.58   0.5641   
Xincludedhorm_contra:menstruationyes       -0.09890    0.05470   -1.81   0.0706 . 
Xincludedhorm_contra:fertile               -0.12706    0.11342   -1.12   0.2626   
Xs(day_number):includedcyclingFx1           0.48189    0.22527    2.14   0.0324 * 
Xs(day_number):includedhorm_contraFx1       0.53800    0.16964    3.17   0.0015 **
Xs(days_filled_out):includedcyclingFx1     -0.21903    0.15622   -1.40   0.1609   
Xs(days_filled_out):includedhorm_contraFx1 -0.48898    0.16904   -2.89   0.0038 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
<pre><code>
Family: binomial 
Link function: probit 

Formula:
in_pair_public_intimacy ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                         -0.12648    0.07182   -1.76    0.078 .
includedhorm_contra                 -0.00301    0.05980   -0.05    0.960  
menstruationpre                      0.00201    0.04286    0.05    0.963  
menstruationyes                      0.02546    0.04109    0.62    0.536  
fertile                             -0.10550    0.08874   -1.19    0.235  
fertile_mean                         0.15227    0.33096    0.46    0.645  
includedhorm_contra:menstruationpre -0.03202    0.05482   -0.58    0.559  
includedhorm_contra:menstruationyes -0.09890    0.05369   -1.84    0.065 .
includedhorm_contra:fertile         -0.12706    0.11179   -1.14    0.256  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df Chi.sq        p-value    
s(day_number):includedcycling          3.82   3.82   18.6         0.0011 ** 
s(day_number):includedhorm_contra      3.99   3.99   55.9 0.000000000023 ***
s(days_filled_out):includedcycling     3.20   3.20   15.0         0.0027 ** 
s(days_filled_out):includedhorm_contra 4.39   4.39   59.0 0.000000000025 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00373   
glmer.ML =  27081  Scale est. = 1         n = 24271
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-4.png" width="1056" /></p>
<div class="alert alert-info">
<strong>Information:</strong> No AR1/ARMA autocorrelation models were fitted for binomial outcomes.
</div>
</div>
<div id="m_d-other-designs-15" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-15" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rob_check-9.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

     AIC      BIC   logLik deviance df.resid 
   21215    21355   -10590    21179    17026 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.141 -0.777 -0.436  0.902  3.555 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.414    0.643   
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                                              -0.03169    0.13410   -0.24    0.813  
fertile_mean                                             -0.36458    0.64202   -0.57    0.570  
contraceptive_methodsfertility_awareness                  0.06370    0.18494    0.34    0.731  
contraceptive_methodsnone                                 0.22199    0.19567    1.14    0.257  
contraceptive_methodshormonal                            -0.04639    0.09254   -0.50    0.616  
fertile                                                  -0.25589    0.15065   -1.70    0.089 .
menstruationpre                                          -0.07185    0.07233   -0.99    0.321  
menstruationyes                                          -0.03671    0.06947   -0.53    0.597  
contraceptive_methodsfertility_awareness:fertile         -0.01366    0.34183   -0.04    0.968  
contraceptive_methodsnone:fertile                        -0.30793    0.36741   -0.84    0.402  
contraceptive_methodshormonal:fertile                     0.00651    0.16805    0.04    0.969  
contraceptive_methodsfertility_awareness:menstruationpre -0.02112    0.16057   -0.13    0.895  
contraceptive_methodsnone:menstruationpre                -0.05814    0.16715   -0.35    0.728  
contraceptive_methodshormonal:menstruationpre             0.05371    0.08137    0.66    0.509  
contraceptive_methodsfertility_awareness:menstruationyes  0.21429    0.16433    1.30    0.192  
contraceptive_methodsnone:menstruationyes                -0.12800    0.17595   -0.73    0.467  
contraceptive_methodshormonal:menstruationyes            -0.02602    0.07917   -0.33    0.742  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00141508 (tol = 0.001, component 1)
</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">12</td>
<td align="center">21207</td>
<td align="center">21300</td>
<td align="center">-10592</td>
<td align="center">21183</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">18</td>
<td align="center">21215</td>
<td align="center">21355</td>
<td align="center">-10590</td>
<td align="center">21179</td>
<td align="center">3.669</td>
<td align="center">6</td>
<td align="center">0.7213</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-15" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">18</td>
<td align="center">32853</td>
<td align="center">33000</td>
<td align="center">-16408</td>
<td align="center">32817</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">26</td>
<td align="center">32863</td>
<td align="center">33076</td>
<td align="center">-16405</td>
<td align="center">32811</td>
<td align="center">6.212</td>
<td align="center">8</td>
<td align="center">0.6235</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-age-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32863    33076   -16405    32811    26542 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.002 -0.780 -0.350  0.857  4.140 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.476    0.69    
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                                   -0.3794     0.1410   -2.69   0.0071 **
menstruationpre                               -0.0339     0.0414   -0.82   0.4129   
menstruationyes                                0.0267     0.0391    0.68   0.4947   
fertile_mean                                   0.1164     0.3314    0.35   0.7254   
age_group(20,25]                               0.3231     0.1483    2.18   0.0294 * 
age_group(25,30]                               0.4388     0.1526    2.88   0.0040 **
age_group(30,35]                               0.2071     0.1755    1.18   0.2381   
age_group(35,70]                               0.2642     0.1606    1.64   0.0999 . 
includedhorm_contra                            0.2959     0.1491    1.98   0.0473 * 
fertile                                       -0.1579     0.2381   -0.66   0.5071   
menstruationpre:includedhorm_contra           -0.0256     0.0529   -0.48   0.6288   
menstruationyes:includedhorm_contra           -0.1021     0.0512   -2.00   0.0460 * 
age_group(20,25]:includedhorm_contra          -0.2901     0.1684   -1.72   0.0850 . 
age_group(25,30]:includedhorm_contra          -0.5083     0.1860   -2.73   0.0063 **
age_group(30,35]:includedhorm_contra          -0.4954     0.2426   -2.04   0.0411 * 
age_group(35,70]:includedhorm_contra           0.0412     0.2757    0.15   0.8811   
age_group(20,25]:fertile                      -0.0406     0.2644   -0.15   0.8779   
age_group(25,30]:fertile                      -0.0821     0.2711   -0.30   0.7621   
age_group(30,35]:fertile                       0.2403     0.3161    0.76   0.4472   
age_group(35,70]:fertile                       0.1354     0.2869    0.47   0.6369   
includedhorm_contra:fertile                   -0.2625     0.2633   -1.00   0.3188   
age_group(20,25]:includedhorm_contra:fertile   0.2243     0.2952    0.76   0.4475   
age_group(25,30]:includedhorm_contra:fertile   0.2976     0.3260    0.91   0.3613   
age_group(30,35]:includedhorm_contra:fertile   0.1459     0.4294    0.34   0.7340   
age_group(35,70]:includedhorm_contra:fertile   0.3772     0.5149    0.73   0.4639   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0109067 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-15" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">32143</td>
<td align="center">32241</td>
<td align="center">-16060</td>
<td align="center">32119</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">32146</td>
<td align="center">32261</td>
<td align="center">-16059</td>
<td align="center">32118</td>
<td align="center">0.8778</td>
<td align="center">2</td>
<td align="center">0.6447</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-weekend-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32146    32261   -16059    32118    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.717 -0.748 -0.325  0.815  4.349 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.513    0.716   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                              -0.2579     0.0740   -3.49  0.00049 ***
menstruationpre                          -0.0366     0.0417   -0.88  0.38112    
menstruationyes                           0.0244     0.0395    0.62  0.53680    
fertile_mean                              0.1818     0.3389    0.54  0.59175    
weekendTRUE                               0.4085     0.0367   11.13  &lt; 2e-16 ***
includedhorm_contra                      -0.0222     0.0620   -0.36  0.72060    
fertile                                  -0.2018     0.1042   -1.94  0.05271 .  
menstruationpre:includedhorm_contra      -0.0296     0.0534   -0.55  0.57997    
menstruationyes:includedhorm_contra      -0.0952     0.0517   -1.84  0.06528 .  
weekendTRUE:includedhorm_contra           0.0593     0.0470    1.26  0.20722    
weekendTRUE:fertile                       0.1137     0.1428    0.80  0.42613    
includedhorm_contra:fertile              -0.1087     0.1320   -0.82  0.41019    
weekendTRUE:includedhorm_contra:fertile  -0.0589     0.1806   -0.33  0.74435    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-15" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">22</td>
<td align="center">31861</td>
<td align="center">32041</td>
<td align="center">-15908</td>
<td align="center">31817</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">34</td>
<td align="center">31880</td>
<td align="center">32158</td>
<td align="center">-15906</td>
<td align="center">31812</td>
<td align="center">4.949</td>
<td align="center">12</td>
<td align="center">0.9597</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-weekday-1.png" width="1056" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   31880    32158   -15906    31812    26534 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.538 -0.734 -0.315  0.805  4.098 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.525    0.725   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error z value     Pr(&gt;|z|)    
(Intercept)                                  -0.052639   0.084573   -0.62      0.53367    
menstruationpre                              -0.035857   0.041953   -0.85      0.39272    
menstruationyes                               0.024808   0.039649    0.63      0.53152    
fertile_mean                                  0.161669   0.343048    0.47      0.63745    
weekdayTuesday                               -0.241268   0.065623   -3.68      0.00024 ***
weekdayWednesday                             -0.316053   0.066075   -4.78 0.0000017247 ***
weekdayThursday                              -0.261580   0.066488   -3.93 0.0000834542 ***
weekdayFriday                                -0.039151   0.067043   -0.58      0.55924    
weekdaySaturday                               0.272431   0.067929    4.01 0.0000605799 ***
weekdaySunday                                 0.384494   0.065884    5.84 0.0000000053 ***
includedhorm_contra                          -0.006032   0.080217   -0.08      0.94006    
fertile                                      -0.178111   0.185141   -0.96      0.33604    
menstruationpre:includedhorm_contra          -0.028858   0.053693   -0.54      0.59095    
menstruationyes:includedhorm_contra          -0.094130   0.051886   -1.81      0.06965 .  
weekdayTuesday:includedhorm_contra           -0.135081   0.084441   -1.60      0.10966    
weekdayWednesday:includedhorm_contra         -0.001421   0.085052   -0.02      0.98667    
weekdayThursday:includedhorm_contra           0.065703   0.085335    0.77      0.44134    
weekdayFriday:includedhorm_contra             0.073050   0.085648    0.85      0.39371    
weekdaySaturday:includedhorm_contra           0.060431   0.086878    0.70      0.48669    
weekdaySunday:includedhorm_contra            -0.000204   0.084470    0.00      0.99807    
weekdayTuesday:fertile                       -0.264741   0.257123   -1.03      0.30319    
weekdayWednesday:fertile                      0.075531   0.260023    0.29      0.77145    
weekdayThursday:fertile                       0.121743   0.261571    0.47      0.64162    
weekdayFriday:fertile                         0.087782   0.259851    0.34      0.73550    
weekdaySaturday:fertile                       0.199903   0.263629    0.76      0.44829    
weekdaySunday:fertile                         0.027060   0.257495    0.11      0.91631    
includedhorm_contra:fertile                  -0.131024   0.235462   -0.56      0.57790    
weekdayTuesday:includedhorm_contra:fertile    0.330189   0.327874    1.01      0.31391    
weekdayWednesday:includedhorm_contra:fertile -0.161823   0.332212   -0.49      0.62618    
weekdayThursday:includedhorm_contra:fertile  -0.089289   0.331608   -0.27      0.78773    
weekdayFriday:includedhorm_contra:fertile     0.039349   0.328581    0.12      0.90468    
weekdaySaturday:includedhorm_contra:fertile  -0.207689   0.333555   -0.62      0.53351    
weekdaySunday:includedhorm_contra:fertile     0.020129   0.326011    0.06      0.95077    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.0606116 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-15" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">32843</td>
<td align="center">32974</td>
<td align="center">-16405</td>
<td align="center">32811</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">32851</td>
<td align="center">33032</td>
<td align="center">-16404</td>
<td align="center">32807</td>
<td align="center">3.509</td>
<td align="center">6</td>
<td align="center">0.7427</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-exclusion-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32852    33032   -16404    32808    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.828 -0.778 -0.353  0.857  3.888 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.473    0.688   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                                              -0.0629     0.0779   -0.81    0.420  
menstruationpre                                          -0.0368     0.0414   -0.89    0.373  
menstruationyes                                           0.0259     0.0391    0.66    0.507  
fertile_mean                                              0.1624     0.3329    0.49    0.626  
included_levelslax                                       -0.1549     0.1470   -1.05    0.292  
included_levelsconservative                               0.0225     0.1150    0.20    0.845  
included_levelsstrict                                    -0.1090     0.1132   -0.96    0.336  
includedhorm_contra                                       0.1020     0.0804    1.27    0.204  
fertile                                                  -0.0576     0.1069   -0.54    0.590  
menstruationpre:includedhorm_contra                      -0.0209     0.0529   -0.40    0.693  
menstruationyes:includedhorm_contra                      -0.1013     0.0512   -1.98    0.048 *
included_levelslax:includedhorm_contra                   -0.2555     0.1802   -1.42    0.156  
included_levelsconservative:includedhorm_contra          -0.1435     0.1447   -0.99    0.321  
included_levelsstrict:includedhorm_contra                -0.0441     0.1401   -0.32    0.753  
included_levelslax:fertile                               -0.0670     0.2640   -0.25    0.800  
included_levelsconservative:fertile                      -0.1654     0.1908   -0.87    0.386  
included_levelsstrict:fertile                            -0.2590     0.1938   -1.34    0.182  
includedhorm_contra:fertile                              -0.1244     0.1617   -0.77    0.442  
included_levelslax:includedhorm_contra:fertile           -0.0442     0.3204   -0.14    0.890  
included_levelsconservative:includedhorm_contra:fertile  -0.0117     0.2485   -0.05    0.962  
included_levelsstrict:includedhorm_contra:fertile         0.2111     0.2467    0.86    0.392  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00254503 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-15" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">16</td>
<td align="center">32850</td>
<td align="center">32981</td>
<td align="center">-16409</td>
<td align="center">32818</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">22</td>
<td align="center">32855</td>
<td align="center">33035</td>
<td align="center">-16406</td>
<td align="center">32811</td>
<td align="center">7.089</td>
<td align="center">6</td>
<td align="center">0.3127</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-cycle_length-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32855    33036   -16406    32811    26546 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.909 -0.780 -0.354  0.858  4.240 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.479    0.692   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                             -0.4523     0.1338   -3.38  0.00072 ***
menstruationpre                                         -0.0332     0.0414   -0.80  0.42358    
menstruationyes                                          0.0284     0.0394    0.72  0.47166    
fertile_mean                                             0.2123     0.3340    0.64  0.52498    
cycle_length_groups(25,30]                               0.3463     0.1306    2.65  0.00803 ** 
cycle_length_groups(30,35]                               0.5813     0.1550    3.75  0.00018 ***
cycle_length_groups(35,41]                               0.4903     0.2159    2.27  0.02316 *  
includedhorm_contra                                      0.2759     0.1476    1.87  0.06153 .  
fertile                                                 -0.1027     0.2350   -0.44  0.66207    
menstruationpre:includedhorm_contra                     -0.0247     0.0530   -0.47  0.64051    
menstruationyes:includedhorm_contra                     -0.1010     0.0514   -1.96  0.04960 *  
cycle_length_groups(25,30]:includedhorm_contra          -0.2521     0.1583   -1.59  0.11130    
cycle_length_groups(30,35]:includedhorm_contra          -0.4571     0.2388   -1.91  0.05557 .  
cycle_length_groups(35,41]:includedhorm_contra          -0.4623     0.3025   -1.53  0.12645    
cycle_length_groups(25,30]:fertile                       0.0459     0.2501    0.18  0.85451    
cycle_length_groups(30,35]:fertile                      -0.4254     0.2932   -1.45  0.14683    
cycle_length_groups(35,41]:fertile                       0.0933     0.3949    0.24  0.81323    
includedhorm_contra:fertile                             -0.2038     0.2723   -0.75  0.45425    
cycle_length_groups(25,30]:includedhorm_contra:fertile   0.0044     0.2913    0.02  0.98796    
cycle_length_groups(30,35]:includedhorm_contra:fertile   0.2017     0.4589    0.44  0.66026    
cycle_length_groups(35,41]:includedhorm_contra:fertile   0.1241     0.5144    0.24  0.80926    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.042406 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-15" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">12</td>
<td align="center">32854</td>
<td align="center">32952</td>
<td align="center">-16415</td>
<td align="center">32830</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">14</td>
<td align="center">32857</td>
<td align="center">32971</td>
<td align="center">-16414</td>
<td align="center">32829</td>
<td align="center">1.438</td>
<td align="center">2</td>
<td align="center">0.4871</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-certainty-1.png" width="768" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32857    32971   -16414    32829    26554 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.795 -0.779 -0.355  0.861  3.987 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.485    0.696   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)                                         -0.3418     0.1934   -1.77    0.077 .
menstruationpre                                     -0.0354     0.0414   -0.86    0.392  
menstruationyes                                      0.0277     0.0392    0.71    0.479  
fertile_mean                                         0.1459     0.3330    0.44    0.661  
certainty_menstruation                               0.0620     0.0440    1.41    0.159  
includedhorm_contra                                  0.3266     0.2419    1.35    0.177  
fertile                                             -0.2113     0.3388   -0.62    0.533  
menstruationpre:includedhorm_contra                 -0.0231     0.0529   -0.44    0.662  
menstruationyes:includedhorm_contra                 -0.1026     0.0512   -2.00    0.045 *
certainty_menstruation:includedhorm_contra          -0.0786     0.0562   -1.40    0.162  
certainty_menstruation:fertile                       0.0171     0.0792    0.22    0.830  
includedhorm_contra:fertile                          0.2509     0.4315    0.58    0.561  
certainty_menstruation:includedhorm_contra:fertile  -0.0887     0.0997   -0.89    0.374  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.187088 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-15" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">32860</td>
<td align="center">32975</td>
<td align="center">-16416</td>
<td align="center">32832</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">32864</td>
<td align="center">33011</td>
<td align="center">-16414</td>
<td align="center">32828</td>
<td align="center">4.317</td>
<td align="center">4</td>
<td align="center">0.3647</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-regularity-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32864    33011   -16414    32828    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.867 -0.782 -0.353  0.860  3.987 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.485    0.697   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error z value
(Intercept)                                                                       -0.06068    0.08285   -0.73
menstruationpre                                                                   -0.03535    0.04138   -0.85
menstruationyes                                                                    0.02737    0.03912    0.70
fertile_mean                                                                       0.17023    0.33364    0.51
cycle_regularityslightly irregular,\nup to 5 days off                             -0.08576    0.09112   -0.94
cycle_regularityirregular,\nmore than 5 days off                                   0.00586    0.11051    0.05
includedhorm_contra                                                               -0.04008    0.07431   -0.54
fertile                                                                           -0.16736    0.11747   -1.43
menstruationpre:includedhorm_contra                                               -0.02386    0.05291   -0.45
menstruationyes:includedhorm_contra                                               -0.10242    0.05116   -2.00
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.19151    0.13723    1.40
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.02882    0.16424   -0.18
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.09278    0.15936    0.58
cycle_regularityirregular,\nmore than 5 days off:fertile                          -0.04024    0.19987   -0.20
includedhorm_contra:fertile                                                       -0.07921    0.13677   -0.58
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.39273    0.23727   -1.66
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.20223    0.29145    0.69
                                                                                  Pr(&gt;|z|)  
(Intercept)                                                                          0.464  
menstruationpre                                                                      0.393  
menstruationyes                                                                      0.484  
fertile_mean                                                                         0.610  
cycle_regularityslightly irregular,\nup to 5 days off                                0.347  
cycle_regularityirregular,\nmore than 5 days off                                     0.958  
includedhorm_contra                                                                  0.590  
fertile                                                                              0.154  
menstruationpre:includedhorm_contra                                                  0.652  
menstruationyes:includedhorm_contra                                                  0.045 *
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra            0.163  
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                 0.861  
cycle_regularityslightly irregular,\nup to 5 days off:fertile                        0.560  
cycle_regularityirregular,\nmore than 5 days off:fertile                             0.840  
includedhorm_contra:fertile                                                          0.562  
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile    0.098 .
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile         0.488  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00108353 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-15" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">32658</td>
<td align="center">32773</td>
<td align="center">-16315</td>
<td align="center">32630</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">32661</td>
<td align="center">32808</td>
<td align="center">-16312</td>
<td align="center">32625</td>
<td align="center">5.267</td>
<td align="center">4</td>
<td align="center">0.2609</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-mod_cohabit-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32661    32808   -16312    32625    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.745 -0.780 -0.358  0.850  4.102 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.37     0.608   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                 0.1895     0.0735    2.58  0.00994 ** 
menstruationpre                                            -0.0347     0.0413   -0.84  0.40116    
menstruationyes                                             0.0295     0.0390    0.76  0.44951    
fertile_mean                                                0.1030     0.3048    0.34  0.73540    
cohabitationLive in same city                              -0.3332     0.0940   -3.55  0.00039 ***
cohabitationLong-distance                                  -0.8028     0.0894   -8.98  &lt; 2e-16 ***
includedhorm_contra                                         0.0391     0.0771    0.51  0.61249    
fertile                                                    -0.1897     0.1048   -1.81  0.07014 .  
menstruationpre:includedhorm_contra                        -0.0182     0.0528   -0.35  0.73002    
menstruationyes:includedhorm_contra                        -0.0994     0.0511   -1.95  0.05155 .  
cohabitationLive in same city:includedhorm_contra           0.2306     0.1198    1.93  0.05420 .  
cohabitationLong-distance:includedhorm_contra               0.0432     0.1153    0.37  0.70778    
cohabitationLive in same city:fertile                       0.2461     0.1874    1.31  0.18916    
cohabitationLong-distance:fertile                           0.0320     0.1758    0.18  0.85544    
includedhorm_contra:fertile                                -0.1762     0.1523   -1.16  0.24727    
cohabitationLive in same city:includedhorm_contra:fertile  -0.2063     0.2346   -0.88  0.37915    
cohabitationLong-distance:includedhorm_contra:fertile       0.2014     0.2244    0.90  0.36938    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.024288 (tol = 0.001, component 1)
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-15" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">14</td>
<td align="center">32838</td>
<td align="center">32953</td>
<td align="center">-16405</td>
<td align="center">32810</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">18</td>
<td align="center">32842</td>
<td align="center">32989</td>
<td align="center">-16403</td>
<td align="center">32806</td>
<td align="center">3.96</td>
<td align="center">4</td>
<td align="center">0.4114</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/in_pair_public_intimacy-rel_status-1.png" width="960" /></p>
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
 Family: binomial  ( probit )
Formula: in_pair_public_intimacy ~ menstruation + fertile_mean + (1 |  
    person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

     AIC      BIC   logLik deviance df.resid 
   32842    32989   -16403    32806    26550 

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.764 -0.780 -0.353  0.862  3.979 

Random effects:
 Groups Name        Variance Std.Dev.
 person (Intercept) 0.473    0.687   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                                                       -0.1835     0.0742   -2.47  0.01347 *  
menstruationpre                                                   -0.0363     0.0414   -0.88  0.38007    
menstruationyes                                                    0.0264     0.0391    0.67  0.50022    
fertile_mean                                                       0.1523     0.3298    0.46  0.64422    
relationship_status_cleanVerheiratet                               0.3656     0.0959    3.81  0.00014 ***
relationship_status_cleanVerlobt                                   0.2308     0.1782    1.30  0.19523    
includedhorm_contra                                                0.0850     0.0632    1.34  0.17897    
fertile                                                           -0.0737     0.0957   -0.77  0.44156    
menstruationpre:includedhorm_contra                               -0.0225     0.0529   -0.43  0.67026    
menstruationyes:includedhorm_contra                               -0.1007     0.0511   -1.97  0.04897 *  
relationship_status_cleanVerheiratet:includedhorm_contra          -0.4844     0.1843   -2.63  0.00860 ** 
relationship_status_cleanVerlobt:includedhorm_contra               0.3537     0.2668    1.33  0.18498    
relationship_status_cleanVerheiratet:fertile                      -0.2844     0.1710   -1.66  0.09635 .  
relationship_status_cleanVerlobt:fertile                          -0.0485     0.3183   -0.15  0.87894    
includedhorm_contra:fertile                                       -0.2080     0.1162   -1.79  0.07349 .  
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.5809     0.3345    1.74  0.08248 .  
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.2025     0.4940    0.41  0.68183    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
convergence code: 0
Model failed to converge with max|grad| = 0.00366416 (tol = 0.001, component 1)
</code></pre>
</div>
</div>
</div>
<div id="narcisstic-admiration" class="section level2 tab-content">
<h2>Narcisstic admiration</h2>
<pre class="r"><code>model_summaries$NARQ_admiration</code></pre>
<div id="model-summary-32" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-33" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 62699

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.223 -0.516 -0.074  0.533  5.953 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.132    1.064   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value  Pr(&gt;|t|)    
(Intercept)                             2.6037     0.0855  1207.0000   30.46   &lt; 2e-16 ***
includedhorm_contra                    -0.1323     0.0706  1162.0000   -1.87    0.0611 .  
menstruationpre                        -0.0469     0.0225 25659.0000   -2.09    0.0368 *  
menstruationyes                        -0.0987     0.0212 25721.0000   -4.66 0.0000031 ***
fertile                                -0.0206     0.0455 25667.0000   -0.45    0.6507    
fertile_mean                            0.3166     0.3875  1282.0000    0.82    0.4141    
includedhorm_contra:menstruationpre     0.0381     0.0288 25657.0000    1.32    0.1858    
includedhorm_contra:menstruationyes     0.0817     0.0277 25710.0000    2.95    0.0032 ** 
includedhorm_contra:fertile            -0.0253     0.0576 25727.0000   -0.44    0.6599    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.473                                                               
menstrutnpr             -0.100  0.128                                                        
menstrutnys             -0.098  0.124  0.401                                                 
fertile                 -0.097  0.159  0.470    0.388                                        
fertile_men             -0.769 -0.029 -0.007   -0.005   -0.043                               
inclddhrm_cntr:mnstrtnp  0.083 -0.159 -0.780   -0.313   -0.366 -0.001                        
inclddhrm_cntr:mnstrtny  0.079 -0.152 -0.306   -0.763   -0.296 -0.001  0.386                 
inclddhrm_cntr:f         0.097 -0.200 -0.371   -0.307   -0.789  0.007  0.469                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.384                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.03 [-0.15;0.09].</p>
</div>
<div id="marginal-effect-plots-16" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-16" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-16" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-16" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-16" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-32" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-64" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-64" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-64" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-32" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-65" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-65" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-65" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-16" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-33" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-66" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-66" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-66" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-33" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-67" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-67" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-67" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-NARQ_admiration-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-16" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-16" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 62239

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.889 -0.504 -0.067  0.513  6.056 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     1.2156   1.103                     
          fertile         0.4988   0.706    -0.18            
          menstruationpre 0.0686   0.262    -0.23  0.17      
          menstruationyes 0.0965   0.311    -0.28  0.26  0.59
 Residual                 0.5013   0.708                     
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           2.6027     0.0871   29.89
includedhorm_contra                  -0.1363     0.0731   -1.87
menstruationpre                      -0.0470     0.0267   -1.76
menstruationyes                      -0.1011     0.0272   -3.72
fertile                              -0.0185     0.0602   -0.31
fertile_mean                          0.3322     0.3912    0.85
includedhorm_contra:menstruationpre   0.0427     0.0343    1.25
includedhorm_contra:menstruationyes   0.0964     0.0354    2.73
includedhorm_contra:fertile          -0.0133     0.0764   -0.17

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.482                                                               
menstrutnpr             -0.159  0.189                                                        
menstrutnys             -0.186  0.219  0.458                                                 
fertile                 -0.134  0.208  0.350    0.332                                        
fertile_men             -0.760 -0.029  0.001    0.003   -0.052                               
inclddhrm_cntr:mnstrtnp  0.127 -0.240 -0.780   -0.357   -0.273 -0.004                        
inclddhrm_cntr:mnstrtny  0.145 -0.275 -0.352   -0.769   -0.255 -0.004  0.448                 
inclddhrm_cntr:f         0.130 -0.263 -0.276   -0.261   -0.786  0.009  0.349                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.327                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">62678</td>
<td align="center">62768</td>
<td align="center">-31328</td>
<td align="center">62656</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">62239</td>
<td align="center">62403</td>
<td align="center">-31099</td>
<td align="center">62199</td>
<td align="center">457.4</td>
<td align="center">9</td>
<td align="center">7.446e-93</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-16" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-16" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-16" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 57120

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.184 -0.515 -0.080  0.531  5.954 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            1.1139   1.055   
 Xr.2     s(days_filled_out):includedhorm_contra 0.0000   0.000   
 Xr.1     s(days_filled_out):includedcycling     0.0412   0.203   
 Xr.0     s(day_number):includedhorm_contra      0.0000   0.000   
 Xr       s(day_number):includedcycling          0.0667   0.258   
 Residual                                        0.5262   0.725   
Number of obs: 24252, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                2.58569    0.08507   30.39
Xincludedhorm_contra                       -0.10998    0.07048   -1.56
Xmenstruationpre                           -0.03841    0.02328   -1.65
Xmenstruationyes                           -0.09103    0.02237   -4.07
Xfertile                                    0.01267    0.04820    0.26
Xfertile_mean                               0.35852    0.38468    0.93
Xincludedhorm_contra:menstruationpre        0.02712    0.02981    0.91
Xincludedhorm_contra:menstruationyes        0.06646    0.02924    2.27
Xincludedhorm_contra:fertile               -0.07156    0.06091   -1.17
Xs(day_number):includedcyclingFx1           0.07701    0.08392    0.92
Xs(day_number):includedhorm_contraFx1      -0.00186    0.03261   -0.06
Xs(days_filled_out):includedcyclingFx1     -0.07309    0.07831   -0.93
Xs(days_filled_out):includedhorm_contraFx1  0.03480    0.03348    1.04
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
NARQ_admiration ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           2.5857     0.0851   30.39  &lt; 2e-16 ***
includedhorm_contra                  -0.1100     0.0705   -1.56    0.119    
menstruationpre                      -0.0384     0.0233   -1.65    0.099 .  
menstruationyes                      -0.0910     0.0224   -4.07 0.000047 ***
fertile                               0.0127     0.0482    0.26    0.793    
fertile_mean                          0.3585     0.3847    0.93    0.351    
includedhorm_contra:menstruationpre   0.0271     0.0298    0.91    0.363    
includedhorm_contra:menstruationyes   0.0665     0.0292    2.27    0.023 *  
includedhorm_contra:fertile          -0.0716     0.0609   -1.17    0.240    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value
s(day_number):includedcycling          3.78   3.78 1.09    0.28
s(day_number):includedhorm_contra      1.00   1.00 0.00    0.95
s(days_filled_out):includedcycling     3.10   3.10 1.69    0.16
s(days_filled_out):includedhorm_contra 1.00   1.00 1.08    0.30

R-sq.(adj) =  0.00271   
lmer.REML =  57120  Scale est. = 0.52621   n = 24252
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  60679 60777 -30328

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:       1.057   0.7455

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.3336 
Fixed effects: NARQ_admiration ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.6141    0.0864 25497  30.270  0.0000
includedhorm_contra                 -0.1328    0.0714  1040  -1.859  0.0633
menstruationpre                     -0.0366    0.0264 25497  -1.385  0.1662
menstruationyes                     -0.0924    0.0246 25497  -3.754  0.0002
fertile                             -0.0157    0.0571 25497  -0.275  0.7834
fertile_mean                         0.2720    0.3918  1040   0.694  0.4877
includedhorm_contra:menstruationpre  0.0353    0.0339 25497   1.040  0.2982
includedhorm_contra:menstruationyes  0.0842    0.0320 25497   2.628  0.0086
includedhorm_contra:fertile         -0.0139    0.0721 25497  -0.193  0.8472
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.475                                                               
menstruationpre                     -0.115  0.145                                                        
menstruationyes                     -0.114  0.143  0.408                                                 
fertile                             -0.112  0.187  0.421    0.359                                        
fertile_mean                        -0.767 -0.029 -0.007   -0.005   -0.054                               
includedhorm_contra:menstruationpre  0.095 -0.181 -0.779   -0.318   -0.328 -0.001                        
includedhorm_contra:menstruationyes  0.091 -0.174 -0.313   -0.769   -0.275 -0.001  0.392                 
includedhorm_contra:fertile          0.114 -0.235 -0.333   -0.284   -0.790  0.010  0.419                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.351                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-5.08280 -0.51832 -0.08962  0.51924  5.78638 

Number of Observations: 26546
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  60002 60108 -29988

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:       1.024   0.7813

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.8584 -0.6071 
Fixed effects: NARQ_admiration ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.6088    0.0861 25497  30.317  0.0000
includedhorm_contra                 -0.1281    0.0709  1040  -1.806  0.0712
menstruationpre                     -0.0285    0.0256 25497  -1.115  0.2647
menstruationyes                     -0.0792    0.0246 25497  -3.213  0.0013
fertile                             -0.0027    0.0592 25497  -0.045  0.9639
fertile_mean                         0.2726    0.3919  1040   0.696  0.4868
includedhorm_contra:menstruationpre  0.0310    0.0329 25497   0.942  0.3460
includedhorm_contra:menstruationyes  0.0755    0.0319 25497   2.364  0.0181
includedhorm_contra:fertile         -0.0310    0.0746 25497  -0.415  0.6779
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.108  0.133                                                        
menstruationyes                     -0.114  0.143  0.455                                                 
fertile                             -0.105  0.183  0.316    0.327                                        
fertile_mean                        -0.769 -0.030 -0.002   -0.004   -0.058                               
includedhorm_contra:menstruationpre  0.086 -0.165 -0.778   -0.354   -0.246 -0.002                        
includedhorm_contra:menstruationyes  0.091 -0.174 -0.351   -0.772   -0.252  0.000  0.444                 
includedhorm_contra:fertile          0.111 -0.231 -0.251   -0.259   -0.791  0.011  0.314                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.321                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.7028 -0.5140 -0.1353  0.5300  5.4399 

Number of Observations: 26546
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-16" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-16" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 39370

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.311 -0.509 -0.074  0.534  4.835 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.204    1.097   
 Residual             0.518    0.719   
Number of obs: 17028, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                                2.8212     0.2039   13.83
fertile_mean                                              -0.3883     0.9992   -0.39
contraceptive_methodsfertility_awareness                  -0.1124     0.2579   -0.44
contraceptive_methodsnone                                 -0.1415     0.2728   -0.52
contraceptive_methodshormonal                             -0.1763     0.1303   -1.35
fertile                                                    0.0394     0.0804    0.49
menstruationpre                                           -0.0482     0.0388   -1.24
menstruationyes                                           -0.1052     0.0371   -2.84
contraceptive_methodsfertility_awareness:fertile          -0.5471     0.1824   -3.00
contraceptive_methodsnone:fertile                          0.0339     0.1975    0.17
contraceptive_methodshormonal:fertile                     -0.1433     0.0898   -1.60
contraceptive_methodsfertility_awareness:menstruationpre   0.1129     0.0859    1.31
contraceptive_methodsnone:menstruationpre                 -0.0185     0.0899   -0.21
contraceptive_methodshormonal:menstruationpre              0.0132     0.0437    0.30
contraceptive_methodsfertility_awareness:menstruationyes   0.1536     0.0864    1.78
contraceptive_methodsnone:menstruationyes                  0.0602     0.0939    0.64
contraceptive_methodshormonal:menstruationyes              0.0727     0.0423    1.72
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">39371</td>
<td align="center">39471</td>
<td align="center">-19672</td>
<td align="center">39345</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">39354</td>
<td align="center">39501</td>
<td align="center">-19658</td>
<td align="center">39316</td>
<td align="center">29</td>
<td align="center">6</td>
<td align="center">0.0000609</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-16" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">62683</td>
<td align="center">62839</td>
<td align="center">-31323</td>
<td align="center">62645</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">62688</td>
<td align="center">62909</td>
<td align="center">-31317</td>
<td align="center">62634</td>
<td align="center">11.83</td>
<td align="center">8</td>
<td align="center">0.1589</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 62711

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.221 -0.515 -0.075  0.532  5.934 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.129    1.063   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    2.8989     0.1829   15.85
menstruationpre                               -0.0465     0.0225   -2.07
menstruationyes                               -0.0980     0.0212   -4.63
fertile_mean                                   0.3465     0.3893    0.89
age_group(20,25]                              -0.2620     0.1973   -1.33
age_group(25,30]                              -0.3860     0.2030   -1.90
age_group(30,35]                              -0.3734     0.2332   -1.60
age_group(35,70]                              -0.3549     0.2144   -1.66
includedhorm_contra                           -0.2663     0.1973   -1.35
fertile                                        0.1352     0.1292    1.05
menstruationpre:includedhorm_contra            0.0371     0.0288    1.29
menstruationyes:includedhorm_contra            0.0802     0.0277    2.89
age_group(20,25]:includedhorm_contra           0.0314     0.2256    0.14
age_group(25,30]:includedhorm_contra           0.1227     0.2480    0.49
age_group(30,35]:includedhorm_contra           0.3397     0.3241    1.05
age_group(35,70]:includedhorm_contra           0.4410     0.3654    1.21
age_group(20,25]:fertile                      -0.1939     0.1432   -1.35
age_group(25,30]:fertile                      -0.1318     0.1476   -0.89
age_group(30,35]:fertile                      -0.1503     0.1710   -0.88
age_group(35,70]:fertile                      -0.1981     0.1557   -1.27
includedhorm_contra:fertile                   -0.2935     0.1433   -2.05
age_group(20,25]:includedhorm_contra:fertile   0.3721     0.1604    2.32
age_group(25,30]:includedhorm_contra:fertile   0.1327     0.1778    0.75
age_group(30,35]:includedhorm_contra:fertile   0.4147     0.2295    1.81
age_group(35,70]:includedhorm_contra:fertile   0.4425     0.2616    1.69
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-16" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">62657</td>
<td align="center">62764</td>
<td align="center">-31316</td>
<td align="center">62631</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">62660</td>
<td align="center">62783</td>
<td align="center">-31315</td>
<td align="center">62630</td>
<td align="center">1.101</td>
<td align="center">2</td>
<td align="center">0.5765</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 62693

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.250 -0.516 -0.075  0.533  5.978 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.132    1.064   
 Residual             0.535    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              2.58992    0.08585   30.17
menstruationpre                         -0.04694    0.02245   -2.09
menstruationyes                         -0.09890    0.02115   -4.68
fertile_mean                             0.32276    0.38746    0.83
weekendTRUE                              0.03175    0.01957    1.62
includedhorm_contra                     -0.13545    0.07129   -1.90
fertile                                 -0.04326    0.05535   -0.78
menstruationpre:includedhorm_contra      0.03780    0.02880    1.31
menstruationyes:includedhorm_contra      0.08247    0.02770    2.98
weekendTRUE:includedhorm_contra          0.00938    0.02515    0.37
weekendTRUE:fertile                      0.05332    0.07627    0.70
includedhorm_contra:fertile             -0.02279    0.07019   -0.32
weekendTRUE:includedhorm_contra:fertile -0.00686    0.09666   -0.07
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-16" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">62664</td>
<td align="center">62853</td>
<td align="center">-31309</td>
<td align="center">62618</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">62682</td>
<td align="center">62968</td>
<td align="center">-31306</td>
<td align="center">62612</td>
<td align="center">6.547</td>
<td align="center">12</td>
<td align="center">0.886</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 62758

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.249 -0.518 -0.074  0.535  5.980 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.133    1.064   
 Residual             0.535    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.57025    0.08848   29.05
menstruationpre                              -0.04644    0.02246   -2.07
menstruationyes                              -0.09852    0.02115   -4.66
fertile_mean                                  0.32121    0.38756    0.83
weekdayTuesday                               -0.00274    0.03497   -0.08
weekdayWednesday                              0.02469    0.03493    0.71
weekdayThursday                               0.05786    0.03533    1.64
weekdayFriday                                 0.06381    0.03592    1.78
weekdaySaturday                               0.03835    0.03632    1.06
weekdaySunday                                 0.05130    0.03507    1.46
includedhorm_contra                          -0.11285    0.07632   -1.48
fertile                                      -0.03167    0.09895   -0.32
menstruationpre:includedhorm_contra           0.03712    0.02880    1.29
menstruationyes:includedhorm_contra           0.08184    0.02771    2.95
weekdayTuesday:includedhorm_contra           -0.01273    0.04487   -0.28
weekdayWednesday:includedhorm_contra         -0.02824    0.04502   -0.63
weekdayThursday:includedhorm_contra          -0.04940    0.04546   -1.09
weekdayFriday:includedhorm_contra            -0.00939    0.04607   -0.20
weekdaySaturday:includedhorm_contra           0.03284    0.04664    0.70
weekdaySunday:includedhorm_contra            -0.05792    0.04519   -1.28
weekdayTuesday:fertile                        0.05258    0.13615    0.39
weekdayWednesday:fertile                     -0.03176    0.13701   -0.23
weekdayThursday:fertile                      -0.06883    0.13906   -0.49
weekdayFriday:fertile                        -0.01297    0.13917   -0.09
weekdaySaturday:fertile                       0.12931    0.14102    0.92
weekdaySunday:fertile                         0.01542    0.13713    0.11
includedhorm_contra:fertile                  -0.09238    0.12624   -0.73
weekdayTuesday:includedhorm_contra:fertile   -0.00464    0.17328   -0.03
weekdayWednesday:includedhorm_contra:fertile  0.16849    0.17482    0.96
weekdayThursday:includedhorm_contra:fertile   0.11692    0.17631    0.66
weekdayFriday:includedhorm_contra:fertile     0.05925    0.17675    0.34
weekdaySaturday:includedhorm_contra:fertile  -0.05476    0.17929   -0.31
weekdaySunday:includedhorm_contra:fertile     0.17269    0.17452    0.99
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-16" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">62684</td>
<td align="center">62823</td>
<td align="center">-31325</td>
<td align="center">62650</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">62673</td>
<td align="center">62861</td>
<td align="center">-31313</td>
<td align="center">62627</td>
<td align="center">23.55</td>
<td align="center">6</td>
<td align="center">0.0006315</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 62699

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.251 -0.517 -0.075  0.532  5.970 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.132    1.064   
 Residual             0.535    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                               2.5614     0.0950   26.95
menstruationpre                                          -0.0485     0.0225   -2.16
menstruationyes                                          -0.1006     0.0212   -4.75
fertile_mean                                              0.2956     0.3893    0.76
included_levelslax                                        0.1081     0.2052    0.53
included_levelsconservative                               0.1734     0.1600    1.08
included_levelsstrict                                     0.0916     0.1576    0.58
includedhorm_contra                                      -0.1542     0.0984   -1.57
fertile                                                   0.0247     0.0579    0.43
menstruationpre:includedhorm_contra                       0.0375     0.0288    1.30
menstruationyes:includedhorm_contra                       0.0808     0.0277    2.91
included_levelslax:includedhorm_contra                   -0.1350     0.2487   -0.54
included_levelsconservative:includedhorm_contra          -0.1349     0.1987   -0.68
included_levelsstrict:includedhorm_contra                 0.1343     0.1925    0.70
included_levelslax:fertile                                0.2992     0.1395    2.14
included_levelsconservative:fertile                      -0.1910     0.1044   -1.83
included_levelsstrict:fertile                            -0.2060     0.1045   -1.97
includedhorm_contra:fertile                               0.0369     0.0881    0.42
included_levelslax:includedhorm_contra:fertile           -0.3365     0.1704   -1.97
included_levelsconservative:includedhorm_contra:fertile  -0.0600     0.1358   -0.44
included_levelsstrict:includedhorm_contra:fertile         0.1031     0.1337    0.77
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-16" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">62685</td>
<td align="center">62824</td>
<td align="center">-31325</td>
<td align="center">62651</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">62689</td>
<td align="center">62878</td>
<td align="center">-31322</td>
<td align="center">62643</td>
<td align="center">7.172</td>
<td align="center">6</td>
<td align="center">0.3052</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 62708

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.224 -0.518 -0.075  0.533  5.951 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.133    1.064   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              2.6165     0.1713   15.28
menstruationpre                                         -0.0477     0.0225   -2.12
menstruationyes                                         -0.1032     0.0213   -4.85
fertile_mean                                             0.2253     0.3922    0.57
cycle_length_groups(25,30]                               0.0368     0.1704    0.22
cycle_length_groups(30,35]                              -0.0885     0.2041   -0.43
cycle_length_groups(35,41]                              -0.1260     0.2877   -0.44
includedhorm_contra                                     -0.2339     0.1922   -1.22
fertile                                                  0.1864     0.1227    1.52
menstruationpre:includedhorm_contra                      0.0389     0.0288    1.35
menstruationyes:includedhorm_contra                      0.0854     0.0279    3.06
cycle_length_groups(25,30]:includedhorm_contra           0.1114     0.2089    0.53
cycle_length_groups(30,35]:includedhorm_contra          -0.1372     0.3188   -0.43
cycle_length_groups(35,41]:includedhorm_contra           0.0894     0.4147    0.22
cycle_length_groups(25,30]:fertile                      -0.1987     0.1312   -1.51
cycle_length_groups(30,35]:fertile                      -0.3671     0.1542   -2.38
cycle_length_groups(35,41]:fertile                      -0.2544     0.2160   -1.18
includedhorm_contra:fertile                             -0.1782     0.1437   -1.24
cycle_length_groups(25,30]:includedhorm_contra:fertile   0.1374     0.1543    0.89
cycle_length_groups(30,35]:includedhorm_contra:fertile   0.1705     0.2403    0.71
cycle_length_groups(35,41]:includedhorm_contra:fertile   0.2161     0.2834    0.76
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-16" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">62681</td>
<td align="center">62787</td>
<td align="center">-31327</td>
<td align="center">62655</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">62683</td>
<td align="center">62806</td>
<td align="center">-31327</td>
<td align="center">62653</td>
<td align="center">1.367</td>
<td align="center">2</td>
<td align="center">0.5048</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 62714

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.228 -0.515 -0.073  0.533  5.955 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.133    1.064   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          2.8690     0.2561   11.20
menstruationpre                                     -0.0477     0.0225   -2.12
menstruationyes                                     -0.0999     0.0212   -4.71
fertile_mean                                         0.3138     0.3883    0.81
certainty_menstruation                              -0.0641     0.0585   -1.10
includedhorm_contra                                 -0.3746     0.3218   -1.16
fertile                                              0.1705     0.1839    0.93
menstruationpre:includedhorm_contra                  0.0389     0.0288    1.35
menstruationyes:includedhorm_contra                  0.0832     0.0277    3.00
certainty_menstruation:includedhorm_contra           0.0588     0.0751    0.78
certainty_menstruation:fertile                      -0.0461     0.0430   -1.07
includedhorm_contra:fertile                         -0.2832     0.2360   -1.20
certainty_menstruation:includedhorm_contra:fertile   0.0617     0.0545    1.13
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-16" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">62680</td>
<td align="center">62803</td>
<td align="center">-31325</td>
<td align="center">62650</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">62687</td>
<td align="center">62843</td>
<td align="center">-31325</td>
<td align="center">62649</td>
<td align="center">1.051</td>
<td align="center">4</td>
<td align="center">0.902</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 62712

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.217 -0.517 -0.075  0.532  5.953 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.129    1.063   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         2.6767     0.1013   26.42
menstruationpre                                                                    -0.0465     0.0225   -2.07
menstruationyes                                                                    -0.0984     0.0212   -4.65
fertile_mean                                                                        0.4266     0.3897    1.09
cycle_regularityslightly irregular,\nup to 5 days off                              -0.2400     0.1214   -1.98
cycle_regularityirregular,\nmore than 5 days off                                   -0.0532     0.1441   -0.37
includedhorm_contra                                                                -0.2503     0.0937   -2.67
fertile                                                                             0.0209     0.0628    0.33
menstruationpre:includedhorm_contra                                                 0.0378     0.0288    1.31
menstruationyes:includedhorm_contra                                                 0.0815     0.0277    2.94
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.3669     0.1842    1.99
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                0.1963     0.2187    0.90
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      -0.0837     0.0866   -0.97
cycle_regularityirregular,\nmore than 5 days off:fertile                           -0.0568     0.1081   -0.53
includedhorm_contra:fertile                                                        -0.0688     0.0736   -0.93
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile   0.1070     0.1283    0.83
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.0437     0.1598    0.27
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-16" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">62685</td>
<td align="center">62807</td>
<td align="center">-31327</td>
<td align="center">62655</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">62668</td>
<td align="center">62824</td>
<td align="center">-31315</td>
<td align="center">62630</td>
<td align="center">24.47</td>
<td align="center">4</td>
<td align="center">0.00006426</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 62696

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.228 -0.518 -0.074  0.531  5.960 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.135    1.065   
 Residual             0.535    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                 2.5855     0.0989   26.15
menstruationpre                                            -0.0477     0.0225   -2.13
menstruationyes                                            -0.1007     0.0212   -4.76
fertile_mean                                                0.3060     0.3887    0.79
cohabitationLive in same city                               0.0155     0.1378    0.11
cohabitationLong-distance                                   0.0714     0.1297    0.55
includedhorm_contra                                        -0.1471     0.1083   -1.36
fertile                                                    -0.0418     0.0572   -0.73
menstruationpre:includedhorm_contra                         0.0392     0.0288    1.36
menstruationyes:includedhorm_contra                         0.0836     0.0277    3.02
cohabitationLive in same city:includedhorm_contra           0.0465     0.1762    0.26
cohabitationLong-distance:includedhorm_contra              -0.0303     0.1686   -0.18
cohabitationLive in same city:fertile                      -0.2779     0.1037   -2.68
cohabitationLong-distance:fertile                           0.2851     0.0934    3.05
includedhorm_contra:fertile                                -0.0642     0.0831   -0.77
cohabitationLive in same city:includedhorm_contra:fertile   0.3743     0.1294    2.89
cohabitationLong-distance:includedhorm_contra:fertile      -0.2142     0.1201   -1.78
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-16" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">62685</td>
<td align="center">62808</td>
<td align="center">-31328</td>
<td align="center">62655</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">62689</td>
<td align="center">62845</td>
<td align="center">-31326</td>
<td align="center">62651</td>
<td align="center">4.039</td>
<td align="center">4</td>
<td align="center">0.4008</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_admiration-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_admiration ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 62707

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.227 -0.517 -0.073  0.532  5.953 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 1.136    1.066   
 Residual             0.536    0.732   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       2.62783    0.09194   28.58
menstruationpre                                                  -0.04699    0.02246   -2.09
menstruationyes                                                  -0.09854    0.02116   -4.66
fertile_mean                                                      0.31702    0.38855    0.82
relationship_status_cleanVerheiratet                             -0.06862    0.12768   -0.54
relationship_status_cleanVerlobt                                 -0.15878    0.24555   -0.65
includedhorm_contra                                              -0.14858    0.07943   -1.87
fertile                                                          -0.04320    0.05195   -0.83
menstruationpre:includedhorm_contra                               0.03820    0.02881    1.33
menstruationyes:includedhorm_contra                               0.08178    0.02772    2.95
relationship_status_cleanVerheiratet:includedhorm_contra         -0.03482    0.24732   -0.14
relationship_status_cleanVerlobt:includedhorm_contra              0.04241    0.35972    0.12
relationship_status_cleanVerheiratet:fertile                      0.12884    0.09236    1.40
relationship_status_cleanVerlobt:fertile                         -0.14225    0.17106   -0.83
includedhorm_contra:fertile                                      -0.00637    0.06332   -0.10
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.15015    0.17237   -0.87
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.34540    0.26551    1.30
</code></pre>
</div>
</div>
</div>
<div id="narcisstic-rivalry" class="section level2 tab-content">
<h2>Narcisstic rivalry</h2>
<pre class="r"><code>model_summaries$NARQ_rivalry</code></pre>
<div id="model-summary-34" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-35" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 41741

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.956 -0.328 -0.091 -0.010  9.667 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value Pr(&gt;|t|)    
(Intercept)                             1.29729     0.04166  1289.00000   31.14   &lt;2e-16 ***
includedhorm_contra                     0.03393     0.03415  1237.00000    0.99     0.32    
menstruationpre                        -0.01877     0.01533 25758.00000   -1.22     0.22    
menstruationyes                         0.00340     0.01443 25851.00000    0.24     0.81    
fertile                                -0.02473     0.03108 25756.00000   -0.80     0.43    
fertile_mean                            0.08242     0.19114  1397.00000    0.43     0.67    
includedhorm_contra:menstruationpre     0.00121     0.01966 25757.00000    0.06     0.95    
includedhorm_contra:menstruationyes    -0.01901     0.01891 25836.00000   -1.01     0.31    
includedhorm_contra:fertile            -0.02460     0.03929 25859.00000   -0.63     0.53    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.470                                                               
menstrutnpr             -0.142  0.181                                                        
menstrutnys             -0.139  0.175  0.400                                                 
fertile                 -0.137  0.223  0.470    0.387                                        
fertile_men             -0.771 -0.032 -0.008   -0.006   -0.057                               
inclddhrm_cntr:mnstrtnp  0.117 -0.225 -0.780   -0.312   -0.366 -0.003                        
inclddhrm_cntr:mnstrtny  0.111 -0.214 -0.305   -0.763   -0.295 -0.002  0.385                 
inclddhrm_cntr:f         0.137 -0.281 -0.371   -0.306   -0.789  0.008  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.05 [-0.17;0.07].</p>
</div>
<div id="marginal-effect-plots-17" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-17" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-17" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-17" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-17" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-34" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-68" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-68" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-68" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-34" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-69" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-69" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-69" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-17" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-35" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-70" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-70" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-70" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-35" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-71" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-71" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-71" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-NARQ_rivalry-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-17" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-17" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 41586

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.100 -0.322 -0.085 -0.016  9.691 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.26875  0.518                     
          fertile         0.13382  0.366    -0.32            
          menstruationpre 0.00672  0.082    -0.34 -0.22      
          menstruationyes 0.01872  0.137    -0.26  0.38  0.31
 Residual                 0.24251  0.492                     
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          1.30003    0.04258   30.53
includedhorm_contra                  0.03342    0.03587    0.93
menstruationpre                     -0.01875    0.01598   -1.17
menstruationyes                     -0.00148    0.01634   -0.09
fertile                             -0.02920    0.03726   -0.78
fertile_mean                         0.08057    0.19205    0.42
includedhorm_contra:menstruationpre  0.00178    0.02049    0.09
includedhorm_contra:menstruationyes -0.01545    0.02130   -0.73
includedhorm_contra:fertile         -0.02558    0.04718   -0.54

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.485                                                               
menstrutnpr             -0.193  0.227                                                        
menstrutnys             -0.190  0.231  0.377                                                 
fertile                 -0.199  0.301  0.336    0.380                                        
fertile_men             -0.756 -0.031  0.003   -0.005   -0.069                               
inclddhrm_cntr:mnstrtnp  0.154 -0.286 -0.780   -0.294   -0.262 -0.006                        
inclddhrm_cntr:mnstrtny  0.151 -0.286 -0.289   -0.767   -0.291 -0.003  0.365                 
inclddhrm_cntr:f         0.192 -0.382 -0.266   -0.300   -0.787  0.009  0.335                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.375                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">41712</td>
<td align="center">41802</td>
<td align="center">-20845</td>
<td align="center">41690</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">41576</td>
<td align="center">41740</td>
<td align="center">-20768</td>
<td align="center">41536</td>
<td align="center">153.2</td>
<td align="center">9</td>
<td align="center">1.879e-28</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-17" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-17" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-17" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 38280

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.973 -0.331 -0.100  0.005  9.672 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.23980  0.4897  
 Xr.2     s(days_filled_out):includedhorm_contra 0.07338  0.2709  
 Xr.1     s(days_filled_out):includedcycling     0.03263  0.1806  
 Xr.0     s(day_number):includedhorm_contra      0.00822  0.0907  
 Xr       s(day_number):includedcycling          0.00000  0.0000  
 Residual                                        0.24954  0.4995  
Number of obs: 24252, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                            Estimate Std. Error t value
X(Intercept)                                1.286275   0.041840   30.74
Xincludedhorm_contra                        0.041882   0.034530    1.21
Xmenstruationpre                           -0.021469   0.015994   -1.34
Xmenstruationyes                           -0.006464   0.015356   -0.42
Xfertile                                   -0.040554   0.033102   -1.23
Xfertile_mean                               0.110326   0.191130    0.58
Xincludedhorm_contra:menstruationpre        0.000312   0.020504    0.02
Xincludedhorm_contra:menstruationyes       -0.011705   0.020089   -0.58
Xincludedhorm_contra:fertile               -0.039536   0.041832   -0.95
Xs(day_number):includedcyclingFx1           0.067915   0.026796    2.53
Xs(day_number):includedhorm_contraFx1       0.024916   0.041838    0.60
Xs(days_filled_out):includedcyclingFx1     -0.145450   0.050106   -2.90
Xs(days_filled_out):includedhorm_contraFx1 -0.133010   0.060913   -2.18
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
NARQ_rivalry ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          1.286275   0.041840   30.74   &lt;2e-16 ***
includedhorm_contra                  0.041882   0.034530    1.21     0.23    
menstruationpre                     -0.021469   0.015994   -1.34     0.18    
menstruationyes                     -0.006464   0.015356   -0.42     0.67    
fertile                             -0.040554   0.033102   -1.23     0.22    
fertile_mean                         0.110326   0.191130    0.58     0.56    
includedhorm_contra:menstruationpre  0.000312   0.020504    0.02     0.99    
includedhorm_contra:menstruationyes -0.011705   0.020089   -0.58     0.56    
includedhorm_contra:fertile         -0.039536   0.041832   -0.95     0.34    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value   
s(day_number):includedcycling          1.00   1.00 6.42  0.0113 * 
s(day_number):includedhorm_contra      2.49   2.49 1.47  0.2063   
s(days_filled_out):includedcycling     4.17   4.17 3.52  0.0117 * 
s(days_filled_out):includedhorm_contra 5.38   5.38 3.36  0.0065 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00247   
lmer.REML =  38279  Scale est. = 0.24954   n = 24252
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  40363 40461 -20170

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.4853   0.5077

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
 Phi1 
0.282 
Fixed effects: NARQ_rivalry ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.2977   0.04236 25496  30.634  0.0000
includedhorm_contra                  0.0323   0.03485  1040   0.927  0.3540
menstruationpre                     -0.0149   0.01769 25496  -0.841  0.4001
menstruationyes                     -0.0010   0.01651 25496  -0.058  0.9538
fertile                             -0.0185   0.03764 25496  -0.492  0.6225
fertile_mean                         0.0868   0.19449  1040   0.446  0.6556
includedhorm_contra:menstruationpre  0.0027   0.02270 25496   0.118  0.9064
includedhorm_contra:menstruationyes -0.0056   0.02152 25496  -0.258  0.7961
includedhorm_contra:fertile         -0.0250   0.04753 25496  -0.527  0.5985
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.160  0.202                                                        
menstruationyes                     -0.157  0.197  0.404                                                 
fertile                             -0.155  0.255  0.432    0.365                                        
fertile_mean                        -0.769 -0.032 -0.008   -0.006   -0.070                               
includedhorm_contra:menstruationpre  0.131 -0.251 -0.779   -0.315   -0.336 -0.003                        
includedhorm_contra:menstruationyes  0.126 -0.240 -0.310   -0.767   -0.279 -0.002  0.389                 
includedhorm_contra:fertile          0.156 -0.321 -0.342   -0.289   -0.789  0.011  0.430                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.358                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.7842 -0.3397 -0.1026 -0.0256  9.4834 

Number of Observations: 26545
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  39879 39985 -19926

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.4672   0.5209

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.8118 -0.5897 
Fixed effects: NARQ_rivalry ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.3051   0.04231 25496  30.846  0.0000
includedhorm_contra                  0.0261   0.03471  1040   0.753  0.4518
menstruationpre                     -0.0197   0.01752 25496  -1.124  0.2612
menstruationyes                     -0.0049   0.01679 25496  -0.293  0.7699
fertile                             -0.0266   0.03959 25496  -0.672  0.5016
fertile_mean                         0.0665   0.19509  1040   0.341  0.7335
includedhorm_contra:menstruationpre  0.0057   0.02252 25496   0.252  0.8012
includedhorm_contra:menstruationyes  0.0018   0.02179 25496   0.081  0.9353
includedhorm_contra:fertile         -0.0060   0.04989 25496  -0.119  0.9050
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.470                                                               
menstruationpre                     -0.155  0.191                                                        
menstruationyes                     -0.160  0.200  0.443                                                 
fertile                             -0.149  0.255  0.344    0.339                                        
fertile_mean                        -0.770 -0.035 -0.002   -0.005   -0.076                               
includedhorm_contra:menstruationpre  0.124 -0.237 -0.778   -0.345   -0.268 -0.003                        
includedhorm_contra:menstruationyes  0.127 -0.243 -0.342   -0.771   -0.261 -0.002  0.432                 
includedhorm_contra:fertile          0.155 -0.321 -0.273   -0.268   -0.790  0.013  0.342                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.333                 

Standardized Within-Group Residuals:
     Min       Q1      Med       Q3      Max 
-4.35267 -0.34756 -0.12883 -0.05503  9.28312 

Number of Observations: 26545
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-17" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-17" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 27783

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.774 -0.336 -0.094 -0.003  9.307 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.236    0.486   
 Residual             0.270    0.519   
Number of obs: 17027, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               1.21001    0.09234   13.10
fertile_mean                                              0.55005    0.45010    1.22
contraceptive_methodsfertility_awareness                  0.08830    0.11900    0.74
contraceptive_methodsnone                                 0.08904    0.12608    0.71
contraceptive_methodshormonal                             0.03830    0.06004    0.64
fertile                                                  -0.02645    0.05794   -0.46
menstruationpre                                          -0.02450    0.02798   -0.88
menstruationyes                                           0.00544    0.02674    0.20
contraceptive_methodsfertility_awareness:fertile         -0.07178    0.13157   -0.55
contraceptive_methodsnone:fertile                         0.06845    0.14243    0.48
contraceptive_methodshormonal:fertile                    -0.04386    0.06473   -0.68
contraceptive_methodsfertility_awareness:menstruationpre  0.01400    0.06197    0.23
contraceptive_methodsnone:menstruationpre                 0.10055    0.06480    1.55
contraceptive_methodshormonal:menstruationpre            -0.00346    0.03152   -0.11
contraceptive_methodsfertility_awareness:menstruationyes -0.00862    0.06229   -0.14
contraceptive_methodsnone:menstruationyes                -0.00526    0.06776   -0.08
contraceptive_methodshormonal:menstruationyes            -0.01836    0.03050   -0.60
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">27742</td>
<td align="center">27843</td>
<td align="center">-13858</td>
<td align="center">27716</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">27751</td>
<td align="center">27898</td>
<td align="center">-13856</td>
<td align="center">27713</td>
<td align="center">3.534</td>
<td align="center">6</td>
<td align="center">0.7395</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-17" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">41716</td>
<td align="center">41872</td>
<td align="center">-20839</td>
<td align="center">41678</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">41725</td>
<td align="center">41946</td>
<td align="center">-20836</td>
<td align="center">41671</td>
<td align="center">6.654</td>
<td align="center">8</td>
<td align="center">0.5743</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + age_group +  
    included + fertile + menstruation:included + age_group:included +  
    age_group:fertile + included:fertile + age_group:included:fertile
   Data: diary

REML criterion at convergence: 41776

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.974 -0.328 -0.091 -0.010  9.664 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.24     0.49    
 Residual             0.25     0.50    
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   1.38687    0.08750   15.85
menstruationpre                              -0.01894    0.01534   -1.23
menstruationyes                               0.00321    0.01444    0.22
fertile_mean                                  0.05374    0.19190    0.28
age_group(20,25]                             -0.04712    0.09385   -0.50
age_group(25,30]                             -0.08819    0.09658   -0.91
age_group(30,35]                             -0.06388    0.11084   -0.58
age_group(35,70]                             -0.20548    0.10184   -2.02
includedhorm_contra                          -0.05216    0.09394   -0.56
fertile                                      -0.01543    0.08825   -0.17
menstruationpre:includedhorm_contra           0.00122    0.01967    0.06
menstruationyes:includedhorm_contra          -0.01912    0.01892   -1.01
age_group(20,25]:includedhorm_contra          0.02049    0.10711    0.19
age_group(25,30]:includedhorm_contra          0.18146    0.11790    1.54
age_group(30,35]:includedhorm_contra          0.14385    0.15368    0.94
age_group(35,70]:includedhorm_contra          0.11398    0.17326    0.66
age_group(20,25]:fertile                      0.03285    0.09776    0.34
age_group(25,30]:fertile                     -0.05871    0.10076   -0.58
age_group(30,35]:fertile                     -0.05693    0.11672   -0.49
age_group(35,70]:fertile                      0.00692    0.10634    0.07
includedhorm_contra:fertile                  -0.00846    0.09787   -0.09
age_group(20,25]:includedhorm_contra:fertile -0.07267    0.10950   -0.66
age_group(25,30]:includedhorm_contra:fertile -0.02258    0.12135   -0.19
age_group(30,35]:includedhorm_contra:fertile  0.14062    0.15664    0.90
age_group(35,70]:includedhorm_contra:fertile  0.13196    0.17865    0.74
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-17" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">41715</td>
<td align="center">41821</td>
<td align="center">-20844</td>
<td align="center">41689</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">41718</td>
<td align="center">41841</td>
<td align="center">-20844</td>
<td align="center">41688</td>
<td align="center">0.2872</td>
<td align="center">2</td>
<td align="center">0.8662</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + weekend +  
    included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 41764

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.952 -0.328 -0.091 -0.011  9.665 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              1.29221    0.04202   30.75
menstruationpre                         -0.01876    0.01533   -1.22
menstruationyes                          0.00331    0.01444    0.23
fertile_mean                             0.08231    0.19115    0.43
weekendTRUE                              0.01246    0.01338    0.93
includedhorm_contra                      0.03975    0.03486    1.14
fertile                                 -0.01385    0.03781   -0.37
menstruationpre:includedhorm_contra      0.00122    0.01966    0.06
menstruationyes:includedhorm_contra     -0.01894    0.01891   -1.00
weekendTRUE:includedhorm_contra         -0.01438    0.01719   -0.84
weekendTRUE:fertile                     -0.02662    0.05213   -0.51
includedhorm_contra:fertile             -0.03268    0.04792   -0.68
weekendTRUE:includedhorm_contra:fertile  0.02006    0.06607    0.30
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-17" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">41718</td>
<td align="center">41907</td>
<td align="center">-20836</td>
<td align="center">41672</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">41732</td>
<td align="center">42018</td>
<td align="center">-20831</td>
<td align="center">41662</td>
<td align="center">10.68</td>
<td align="center">12</td>
<td align="center">0.5563</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + weekday +  
    included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 41836

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.993 -0.327 -0.096  0.000  9.675 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   1.300008   0.044477   29.23
menstruationpre                              -0.018863   0.015335   -1.23
menstruationyes                               0.003310   0.014435    0.23
fertile_mean                                  0.084000   0.191149    0.44
weekdayTuesday                               -0.016248   0.023902   -0.68
weekdayWednesday                             -0.000832   0.023873   -0.03
weekdayThursday                              -0.016635   0.024150   -0.69
weekdayFriday                                 0.009924   0.024549    0.40
weekdaySaturday                               0.018163   0.024828    0.73
weekdaySunday                                -0.012830   0.023973   -0.54
includedhorm_contra                           0.030339   0.039503    0.77
fertile                                      -0.064155   0.067624   -0.95
menstruationpre:includedhorm_contra           0.000925   0.019665    0.05
menstruationyes:includedhorm_contra          -0.019391   0.018911   -1.03
weekdayTuesday:includedhorm_contra           -0.003691   0.030668   -0.12
weekdayWednesday:includedhorm_contra          0.007542   0.030775    0.25
weekdayThursday:includedhorm_contra           0.038162   0.031074    1.23
weekdayFriday:includedhorm_contra            -0.017223   0.031494   -0.55
weekdaySaturday:includedhorm_contra          -0.025077   0.031886   -0.79
weekdaySunday:includedhorm_contra             0.024975   0.030892    0.81
weekdayTuesday:fertile                        0.109123   0.093036    1.17
weekdayWednesday:fertile                     -0.008840   0.093637   -0.09
weekdayThursday:fertile                       0.104941   0.095030    1.10
weekdayFriday:fertile                        -0.065011   0.095125   -0.68
weekdaySaturday:fertile                       0.028057   0.096400    0.29
weekdaySunday:fertile                         0.103689   0.093711    1.11
includedhorm_contra:fertile                  -0.010896   0.086255   -0.13
weekdayTuesday:includedhorm_contra:fertile   -0.087821   0.118420   -0.74
weekdayWednesday:includedhorm_contra:fertile  0.007392   0.119481    0.06
weekdayThursday:includedhorm_contra:fertile  -0.014504   0.120491   -0.12
weekdayFriday:includedhorm_contra:fertile     0.141739   0.120810    1.17
weekdaySaturday:includedhorm_contra:fertile   0.003086   0.122557    0.03
weekdaySunday:includedhorm_contra:fertile    -0.144621   0.119278   -1.21
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-17" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">41722</td>
<td align="center">41861</td>
<td align="center">-20844</td>
<td align="center">41688</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">41722</td>
<td align="center">41910</td>
<td align="center">-20838</td>
<td align="center">41676</td>
<td align="center">12.14</td>
<td align="center">6</td>
<td align="center">0.05885</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + included_levels +  
    included + fertile + menstruation:included + included_levels:included +  
    included_levels:fertile + included:fertile + included_levels:included:fertile
   Data: diary

REML criterion at convergence: 41771

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.961 -0.328 -0.093 -0.008  9.642 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.242    0.492   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              1.29039    0.04641   27.81
menstruationpre                                         -0.01927    0.01534   -1.26
menstruationyes                                          0.00247    0.01444    0.17
fertile_mean                                             0.06876    0.19293    0.36
included_levelslax                                       0.06554    0.09669    0.68
included_levelsconservative                              0.02616    0.07547    0.35
included_levelsstrict                                    0.00236    0.07429    0.03
includedhorm_contra                                      0.04329    0.04792    0.90
fertile                                                 -0.01281    0.03948   -0.32
menstruationpre:includedhorm_contra                      0.00133    0.01968    0.07
menstruationyes:includedhorm_contra                     -0.01886    0.01893   -1.00
included_levelslax:includedhorm_contra                  -0.07676    0.11747   -0.65
included_levelsconservative:includedhorm_contra         -0.00980    0.09403   -0.10
included_levelsstrict:includedhorm_contra               -0.01482    0.09107   -0.16
included_levelslax:fertile                               0.17438    0.09535    1.83
included_levelsconservative:fertile                     -0.10537    0.07130   -1.48
included_levelsstrict:fertile                           -0.04579    0.07134   -0.64
includedhorm_contra:fertile                              0.01192    0.06000    0.20
included_levelslax:includedhorm_contra:fertile          -0.30984    0.11634   -2.66
included_levelsconservative:includedhorm_contra:fertile  0.03969    0.09267    0.43
included_levelsstrict:includedhorm_contra:fertile        0.02292    0.09125    0.25
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-17" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">41711</td>
<td align="center">41850</td>
<td align="center">-20839</td>
<td align="center">41677</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">41720</td>
<td align="center">41908</td>
<td align="center">-20837</td>
<td align="center">41674</td>
<td align="center">3.254</td>
<td align="center">6</td>
<td align="center">0.7763</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + cycle_length_groups +  
    included + fertile + menstruation:included + cycle_length_groups:included +  
    cycle_length_groups:fertile + included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 41762

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.956 -0.329 -0.092 -0.010  9.676 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.239    0.489   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             1.44083    0.08167   17.64
menstruationpre                                        -0.01908    0.01535   -1.24
menstruationyes                                         0.00195    0.01454    0.13
fertile_mean                                            0.08355    0.19285    0.43
cycle_length_groups(25,30]                             -0.16625    0.08088   -2.06
cycle_length_groups(30,35]                             -0.14662    0.09670   -1.52
cycle_length_groups(35,41]                             -0.16794    0.13636   -1.23
includedhorm_contra                                    -0.20510    0.09130   -2.25
fertile                                                 0.03257    0.08368    0.39
menstruationpre:includedhorm_contra                     0.00140    0.01968    0.07
menstruationyes:includedhorm_contra                    -0.01812    0.01902   -0.95
cycle_length_groups(25,30]:includedhorm_contra          0.29218    0.09898    2.95
cycle_length_groups(30,35]:includedhorm_contra          0.15902    0.15066    1.06
cycle_length_groups(35,41]:includedhorm_contra          0.07721    0.19507    0.40
cycle_length_groups(25,30]:fertile                     -0.05685    0.08950   -0.64
cycle_length_groups(30,35]:fertile                     -0.08602    0.10523   -0.82
cycle_length_groups(35,41]:fertile                     -0.10304    0.14742   -0.70
includedhorm_contra:fertile                            -0.06589    0.09805   -0.67
cycle_length_groups(25,30]:includedhorm_contra:fertile  0.03247    0.10531    0.31
cycle_length_groups(30,35]:includedhorm_contra:fertile  0.01190    0.16402    0.07
cycle_length_groups(35,41]:includedhorm_contra:fertile  0.24779    0.19344    1.28
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-17" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">41706</td>
<td align="center">41813</td>
<td align="center">-20840</td>
<td align="center">41680</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">41705</td>
<td align="center">41828</td>
<td align="center">-20837</td>
<td align="center">41675</td>
<td align="center">5.524</td>
<td align="center">2</td>
<td align="center">0.06316</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + certainty_menstruation +  
    included + fertile + menstruation:included + certainty_menstruation:included +  
    certainty_menstruation:fertile + included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 41749

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.956 -0.329 -0.092 -0.009  9.669 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.239    0.489   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         1.56745    0.12134   12.92
menstruationpre                                    -0.01991    0.01534   -1.30
menstruationyes                                     0.00161    0.01445    0.11
fertile_mean                                        0.06966    0.19100    0.36
certainty_menstruation                             -0.06479    0.02769   -2.34
includedhorm_contra                                -0.35050    0.15234   -2.30
fertile                                             0.25610    0.12547    2.04
menstruationpre:includedhorm_contra                 0.00238    0.01967    0.12
menstruationyes:includedhorm_contra                -0.01737    0.01893   -0.92
certainty_menstruation:includedhorm_contra          0.09211    0.03551    2.59
certainty_menstruation:fertile                     -0.06777    0.02934   -2.31
includedhorm_contra:fertile                        -0.26290    0.16099   -1.63
certainty_menstruation:includedhorm_contra:fertile  0.05785    0.03718    1.56
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-17" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">41716</td>
<td align="center">41838</td>
<td align="center">-20843</td>
<td align="center">41686</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">41723</td>
<td align="center">41878</td>
<td align="center">-20842</td>
<td align="center">41685</td>
<td align="center">0.6846</td>
<td align="center">4</td>
<td align="center">0.9532</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + cycle_regularity +  
    included + fertile + menstruation:included + cycle_regularity:included +  
    cycle_regularity:fertile + included:fertile + cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 41765

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.955 -0.328 -0.090 -0.010  9.665 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        1.29600    0.04920   26.34
menstruationpre                                                                   -0.01887    0.01534   -1.23
menstruationyes                                                                    0.00324    0.01444    0.22
fertile_mean                                                                       0.11441    0.19224    0.60
cycle_regularityslightly irregular,\nup to 5 days off                             -0.04782    0.05770   -0.83
cycle_regularityirregular,\nmore than 5 days off                                   0.06265    0.06886    0.91
includedhorm_contra                                                                0.02177    0.04502    0.48
fertile                                                                           -0.03538    0.04289   -0.82
menstruationpre:includedhorm_contra                                                0.00132    0.01967    0.07
menstruationyes:includedhorm_contra                                               -0.01891    0.01892   -1.00
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.11721    0.08732    1.34
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.06351    0.10390   -0.61
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.01583    0.05905    0.27
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.02675    0.07373    0.36
includedhorm_contra:fertile                                                       -0.01967    0.05021   -0.39
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.03121    0.08759    0.36
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.02449    0.10898   -0.22
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-17" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">41715</td>
<td align="center">41838</td>
<td align="center">-20842</td>
<td align="center">41685</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">41714</td>
<td align="center">41869</td>
<td align="center">-20838</td>
<td align="center">41676</td>
<td align="center">9.085</td>
<td align="center">4</td>
<td align="center">0.05902</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + cohabitation +  
    included + fertile + menstruation:included + cohabitation:included +  
    cohabitation:fertile + included:fertile + cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 41759

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.974 -0.326 -0.094 -0.009  9.670 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                1.25446    0.04786   26.21
menstruationpre                                           -0.01863    0.01533   -1.22
menstruationyes                                            0.00386    0.01444    0.27
fertile_mean                                               0.07696    0.19148    0.40
cohabitationLive in same city                              0.03505    0.06547    0.54
cohabitationLong-distance                                  0.14358    0.06170    2.33
includedhorm_contra                                        0.09983    0.05180    1.93
fertile                                                   -0.01938    0.03902   -0.50
menstruationpre:includedhorm_contra                        0.00148    0.01966    0.08
menstruationyes:includedhorm_contra                       -0.01938    0.01891   -1.03
cohabitationLive in same city:includedhorm_contra         -0.07290    0.08362   -0.87
cohabitationLong-distance:includedhorm_contra             -0.16959    0.08006   -2.12
cohabitationLive in same city:fertile                      0.07668    0.07070    1.08
cohabitationLong-distance:fertile                         -0.07790    0.06371   -1.22
includedhorm_contra:fertile                               -0.10022    0.05669   -1.77
cohabitationLive in same city:includedhorm_contra:fertile  0.04564    0.08831    0.52
cohabitationLong-distance:includedhorm_contra:fertile      0.15339    0.08195    1.87
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-17" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">41717</td>
<td align="center">41840</td>
<td align="center">-20844</td>
<td align="center">41687</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">41718</td>
<td align="center">41874</td>
<td align="center">-20840</td>
<td align="center">41680</td>
<td align="center">7.039</td>
<td align="center">4</td>
<td align="center">0.1339</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/NARQ_rivalry-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: NARQ_rivalry ~ menstruation + fertile_mean + (1 | person) + relationship_status_clean +  
    included + fertile + menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 41754

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.001 -0.329 -0.091 -0.009  9.669 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.241    0.491   
 Residual             0.250    0.500   
Number of obs: 26545, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       1.31998    0.04458   29.61
menstruationpre                                                  -0.01857    0.01533   -1.21
menstruationyes                                                   0.00341    0.01443    0.24
fertile_mean                                                      0.08876    0.19155    0.46
relationship_status_cleanVerheiratet                             -0.09465    0.06073   -1.56
relationship_status_cleanVerlobt                                 -0.02774    0.11574   -0.24
includedhorm_contra                                               0.01028    0.03830    0.27
fertile                                                          -0.05086    0.03545   -1.43
menstruationpre:includedhorm_contra                               0.00113    0.01966    0.06
menstruationyes:includedhorm_contra                              -0.01892    0.01891   -1.00
relationship_status_cleanVerheiratet:includedhorm_contra          0.08938    0.11715    0.76
relationship_status_cleanVerlobt:includedhorm_contra              0.02818    0.17026    0.17
relationship_status_cleanVerheiratet:fertile                      0.05642    0.06302    0.90
relationship_status_cleanVerlobt:fertile                          0.23127    0.11671    1.98
includedhorm_contra:fertile                                       0.00715    0.04318    0.17
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.21126    0.11761   -1.80
relationship_status_cleanVerlobt:includedhorm_contra:fertile     -0.16520    0.18120   -0.91
</code></pre>
</div>
</div>
</div>
<div id="self-esteem" class="section level2 tab-content">
<h2>Self esteem</h2>
<pre class="r"><code>model_summaries$self_esteem_1</code></pre>
<div id="model-summary-36" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-37" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 72114

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.254 -0.497  0.094  0.632  4.410 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.575    0.758   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value  Pr(&gt;|t|)    
(Intercept)                             4.3260     0.0662  1381.0000   65.36   &lt; 2e-16 ***
includedhorm_contra                    -0.0597     0.0541  1336.0000   -1.10   0.27045    
menstruationpre                        -0.0509     0.0273 25842.0000   -1.87   0.06192 .  
menstruationyes                        -0.1188     0.0257 25943.0000   -4.63 0.0000037 ***
fertile                                -0.0721     0.0553 25833.0000   -1.30   0.19217    
fertile_mean                           -0.1478     0.3050  1499.0000   -0.48   0.62799    
includedhorm_contra:menstruationpre     0.0532     0.0350 25842.0000    1.52   0.12866    
includedhorm_contra:menstruationyes     0.1208     0.0336 25926.0000    3.59   0.00033 ***
includedhorm_contra:fertile             0.1396     0.0699 25949.0000    2.00   0.04583 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.160  0.203                                                        
menstrutnys             -0.156  0.196  0.399                                                 
fertile                 -0.154  0.251  0.469    0.387                                        
fertile_men             -0.772 -0.033 -0.008   -0.006   -0.063                               
inclddhrm_cntr:mnstrtnp  0.132 -0.254 -0.780   -0.311   -0.365 -0.003                        
inclddhrm_cntr:mnstrtny  0.125 -0.240 -0.305   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.154 -0.316 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.08 [-0.20;0.04].</p>
</div>
<div id="marginal-effect-plots-18" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-18" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-18" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-18" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-18" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-36" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-72" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-72" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-72" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-36" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-73" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-73" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-73" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-18" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-37" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-74" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-74" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-74" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-37" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-75" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-75" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-75" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-self_esteem_1-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-18" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-18" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 71790

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.239 -0.491  0.098  0.614  3.815 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.665    0.816                     
          fertile         0.721    0.849    -0.34            
          menstruationpre 0.108    0.329    -0.34  0.46      
          menstruationyes 0.111    0.333    -0.21  0.30  0.63
 Residual                 0.752    0.867                     
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                           4.3265     0.0683    63.4
includedhorm_contra                  -0.0611     0.0578    -1.1
menstruationpre                      -0.0466     0.0327    -1.4
menstruationyes                      -0.1156     0.0316    -3.7
fertile                              -0.0722     0.0727    -1.0
fertile_mean                         -0.1571     0.3090    -0.5
includedhorm_contra:menstruationpre   0.0547     0.0420     1.3
includedhorm_contra:menstruationyes   0.1164     0.0412     2.8
includedhorm_contra:fertile           0.1461     0.0921     1.6

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.488                                                               
menstrutnpr             -0.240  0.288                                                        
menstrutnys             -0.199  0.239  0.473                                                 
fertile                 -0.227  0.339  0.454    0.351                                        
fertile_men             -0.753 -0.033 -0.004   -0.004   -0.076                               
inclddhrm_cntr:mnstrtnp  0.195 -0.364 -0.780   -0.368   -0.354 -0.007                        
inclddhrm_cntr:mnstrtny  0.158 -0.296 -0.363   -0.768   -0.269 -0.004  0.461                 
inclddhrm_cntr:f         0.217 -0.430 -0.358   -0.277   -0.785  0.010  0.454                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.346                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">72094</td>
<td align="center">72184</td>
<td align="center">-36036</td>
<td align="center">72072</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">71791</td>
<td align="center">71954</td>
<td align="center">-35875</td>
<td align="center">71751</td>
<td align="center">321.6</td>
<td align="center">9</td>
<td align="center">6.925e-64</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-18" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-18" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-18" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 65753

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.303 -0.497  0.097  0.631  4.246 

Random effects:
 Groups   Name                                   Variance Std.Dev.   
 person   (Intercept)                            5.78e-01 0.760149286
 Xr.2     s(days_filled_out):includedhorm_contra 9.30e-04 0.030493447
 Xr.1     s(days_filled_out):includedcycling     6.35e-03 0.079703103
 Xr.0     s(day_number):includedhorm_contra      0.00e+00 0.000000000
 Xr       s(day_number):includedcycling          3.44e-13 0.000000586
 Residual                                        7.84e-01 0.885160713
Number of obs: 24255, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 4.3151     0.0667    64.7
Xincludedhorm_contra                        -0.0575     0.0550    -1.0
Xmenstruationpre                            -0.0530     0.0283    -1.9
Xmenstruationyes                            -0.1070     0.0272    -3.9
Xfertile                                    -0.0381     0.0585    -0.7
Xfertile_mean                               -0.1112     0.3059    -0.4
Xincludedhorm_contra:menstruationpre         0.0519     0.0363     1.4
Xincludedhorm_contra:menstruationyes         0.1071     0.0355     3.0
Xincludedhorm_contra:fertile                 0.0935     0.0739     1.3
Xs(day_number):includedcyclingFx1           -0.0741     0.0466    -1.6
Xs(day_number):includedhorm_contraFx1        0.0155     0.0391     0.4
Xs(days_filled_out):includedcyclingFx1       0.0640     0.0549     1.2
Xs(days_filled_out):includedhorm_contraFx1  -0.0566     0.0414    -1.4
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
self_esteem_1 ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           4.3151     0.0667   64.69  &lt; 2e-16 ***
includedhorm_contra                  -0.0575     0.0550   -1.05   0.2955    
menstruationpre                      -0.0530     0.0283   -1.87   0.0614 .  
menstruationyes                      -0.1070     0.0272   -3.94 0.000082 ***
fertile                              -0.0381     0.0585   -0.65   0.5148    
fertile_mean                         -0.1112     0.3059   -0.36   0.7161    
includedhorm_contra:menstruationpre   0.0519     0.0363    1.43   0.1527    
includedhorm_contra:menstruationyes   0.1071     0.0355    3.01   0.0026 ** 
includedhorm_contra:fertile           0.0935     0.0739    1.26   0.2059    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value  
s(day_number):includedcycling          1.00   1.00 2.53   0.112  
s(day_number):includedhorm_contra      1.00   1.00 0.16   0.692  
s(days_filled_out):includedcycling     2.09   2.09 3.08   0.047 *
s(days_filled_out):includedhorm_contra 1.46   1.46 1.22   0.205  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00134   
lmer.REML =  65753  Scale est. = 0.78351   n = 24255
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  70733 70831 -35354

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7452   0.9019

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2724 
Fixed effects: self_esteem_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          4.327   0.06730 25500   64.30  0.0000
includedhorm_contra                 -0.056   0.05530  1040   -1.02  0.3102
menstruationpre                     -0.038   0.03130 25500   -1.22  0.2215
menstruationyes                     -0.116   0.02920 25500   -3.98  0.0001
fertile                             -0.068   0.06642 25500   -1.03  0.3047
fertile_mean                        -0.182   0.31037  1040   -0.59  0.5569
includedhorm_contra:menstruationpre  0.050   0.04016 25500    1.24  0.2159
includedhorm_contra:menstruationyes  0.123   0.03807 25500    3.22  0.0013
includedhorm_contra:fertile          0.140   0.08383 25500    1.66  0.0959
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.179  0.225                                                        
menstruationyes                     -0.176  0.220  0.403                                                 
fertile                             -0.173  0.284  0.434    0.366                                        
fertile_mean                        -0.768 -0.034 -0.008   -0.006   -0.076                               
includedhorm_contra:menstruationpre  0.147 -0.280 -0.779   -0.314   -0.337 -0.004                        
includedhorm_contra:menstruationyes  0.140 -0.267 -0.309   -0.767   -0.280 -0.003  0.388                 
includedhorm_contra:fertile          0.175 -0.358 -0.343   -0.289   -0.789  0.011  0.432                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.359                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-5.1616 -0.4887  0.1029  0.6269  4.2819 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  70473 70579 -35223

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7275   0.9145

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.7107 -0.4786 
Fixed effects: self_esteem_1 ~ included * (menstruation + fertile) + fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          4.324   0.06753 25500   64.03  0.0000
includedhorm_contra                 -0.053   0.05546  1040   -0.95  0.3432
menstruationpre                     -0.031   0.03167 25500   -0.98  0.3280
menstruationyes                     -0.115   0.03003 25500   -3.84  0.0001
fertile                             -0.075   0.07041 25500   -1.07  0.2851
fertile_mean                        -0.158   0.31233  1040   -0.50  0.6140
includedhorm_contra:menstruationpre  0.043   0.04068 25500    1.05  0.2921
includedhorm_contra:menstruationyes  0.115   0.03900 25500    2.95  0.0031
includedhorm_contra:fertile          0.128   0.08876 25500    1.45  0.1480
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.471                                                               
menstruationpre                     -0.178  0.221                                                        
menstruationyes                     -0.180  0.225  0.429                                                 
fertile                             -0.172  0.289  0.373    0.346                                        
fertile_mean                        -0.769 -0.036 -0.004   -0.005   -0.082                               
includedhorm_contra:menstruationpre  0.144 -0.274 -0.778   -0.334   -0.290 -0.004                        
includedhorm_contra:menstruationyes  0.144 -0.273 -0.331   -0.770   -0.266 -0.002  0.417                 
includedhorm_contra:fertile          0.176 -0.363 -0.296   -0.275   -0.789  0.013  0.371                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.339                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-5.0523 -0.4849  0.1105  0.6209  4.1072 

Number of Observations: 26549
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-18" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-18" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 45836

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.276 -0.501  0.097  0.634  3.745 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.557    0.746   
 Residual             0.783    0.885   
Number of obs: 17029, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               4.44870    0.14296   31.12
fertile_mean                                             -0.80827    0.69549   -1.16
contraceptive_methodsfertility_awareness                  0.26107    0.18544    1.41
contraceptive_methodsnone                                -0.24335    0.19654   -1.24
contraceptive_methodshormonal                            -0.07282    0.09351   -0.78
fertile                                                  -0.01294    0.09875   -0.13
menstruationpre                                          -0.08810    0.04769   -1.85
menstruationyes                                          -0.08502    0.04556   -1.87
contraceptive_methodsfertility_awareness:fertile         -0.26618    0.22427   -1.19
contraceptive_methodsnone:fertile                         0.23302    0.24278    0.96
contraceptive_methodshormonal:fertile                     0.01934    0.11032    0.18
contraceptive_methodsfertility_awareness:menstruationpre  0.05496    0.10564    0.52
contraceptive_methodsnone:menstruationpre                 0.09870    0.11046    0.89
contraceptive_methodshormonal:menstruationpre             0.06074    0.05372    1.13
contraceptive_methodsfertility_awareness:menstruationyes  0.00171    0.10617    0.02
contraceptive_methodsnone:menstruationyes                -0.02049    0.11550   -0.18
contraceptive_methodshormonal:menstruationyes             0.06749    0.05196    1.30
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">45815</td>
<td align="center">45915</td>
<td align="center">-22894</td>
<td align="center">45789</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">45821</td>
<td align="center">45968</td>
<td align="center">-22892</td>
<td align="center">45783</td>
<td align="center">5.404</td>
<td align="center">6</td>
<td align="center">0.4931</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-18" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">72098</td>
<td align="center">72253</td>
<td align="center">-36030</td>
<td align="center">72060</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">72098</td>
<td align="center">72319</td>
<td align="center">-36022</td>
<td align="center">72044</td>
<td align="center">15.33</td>
<td align="center">8</td>
<td align="center">0.0531</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 72123

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.221 -0.496  0.098  0.629  4.398 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.573    0.757   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                    4.2545     0.1378   30.88
menstruationpre                               -0.0498     0.0273   -1.82
menstruationyes                               -0.1186     0.0257   -4.62
fertile_mean                                  -0.0875     0.3062   -0.29
age_group(20,25]                               0.0392     0.1474    0.27
age_group(25,30]                              -0.0237     0.1517   -0.16
age_group(30,35]                               0.0900     0.1740    0.52
age_group(35,70]                               0.2425     0.1598    1.52
includedhorm_contra                            0.0151     0.1476    0.10
fertile                                        0.3382     0.1570    2.15
menstruationpre:includedhorm_contra            0.0517     0.0350    1.48
menstruationyes:includedhorm_contra            0.1203     0.0336    3.58
age_group(20,25]:includedhorm_contra          -0.0221     0.1681   -0.13
age_group(25,30]:includedhorm_contra          -0.1655     0.1851   -0.89
age_group(30,35]:includedhorm_contra          -0.0867     0.2410   -0.36
age_group(35,70]:includedhorm_contra           0.0045     0.2718    0.02
age_group(20,25]:fertile                      -0.5079     0.1739   -2.92
age_group(25,30]:fertile                      -0.4807     0.1792   -2.68
age_group(30,35]:fertile                      -0.3257     0.2076   -1.57
age_group(35,70]:fertile                      -0.3820     0.1892   -2.02
includedhorm_contra:fertile                   -0.4044     0.1741   -2.32
age_group(20,25]:includedhorm_contra:fertile   0.6738     0.1948    3.46
age_group(25,30]:includedhorm_contra:fertile   0.7017     0.2159    3.25
age_group(30,35]:includedhorm_contra:fertile   0.6176     0.2786    2.22
age_group(35,70]:includedhorm_contra:fertile   0.4072     0.3179    1.28
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-18" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">72036</td>
<td align="center">72142</td>
<td align="center">-36005</td>
<td align="center">72010</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">72038</td>
<td align="center">72161</td>
<td align="center">-36004</td>
<td align="center">72008</td>
<td align="center">2.106</td>
<td align="center">2</td>
<td align="center">0.3489</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 72069

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.319 -0.494  0.091  0.634  4.362 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.575    0.758   
 Residual             0.792    0.890   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                               4.3075     0.0669    64.4
menstruationpre                          -0.0510     0.0273    -1.9
menstruationyes                          -0.1191     0.0256    -4.6
fertile_mean                             -0.1428     0.3050    -0.5
weekendTRUE                               0.0442     0.0238     1.9
includedhorm_contra                      -0.0841     0.0555    -1.5
fertile                                  -0.1256     0.0672    -1.9
menstruationpre:includedhorm_contra       0.0526     0.0349     1.5
menstruationyes:includedhorm_contra       0.1226     0.0336     3.6
weekendTRUE:includedhorm_contra           0.0619     0.0306     2.0
weekendTRUE:fertile                       0.1271     0.0927     1.4
includedhorm_contra:fertile               0.2061     0.0852     2.4
weekendTRUE:includedhorm_contra:fertile  -0.1613     0.1175    -1.4
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-18" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">72049</td>
<td align="center">72237</td>
<td align="center">-36002</td>
<td align="center">72003</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">72060</td>
<td align="center">72347</td>
<td align="center">-35995</td>
<td align="center">71990</td>
<td align="center">13.17</td>
<td align="center">12</td>
<td align="center">0.3565</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 72127

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.253 -0.493  0.092  0.631  4.333 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.575    0.758   
 Residual             0.792    0.890   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   4.34501    0.07174    60.6
menstruationpre                              -0.05091    0.02726    -1.9
menstruationyes                              -0.11921    0.02565    -4.6
fertile_mean                                 -0.14885    0.30501    -0.5
weekdayTuesday                               -0.06719    0.04252    -1.6
weekdayWednesday                             -0.04506    0.04246    -1.1
weekdayThursday                              -0.03525    0.04296    -0.8
weekdayFriday                                 0.00114    0.04366     0.0
weekdaySaturday                               0.01236    0.04414     0.3
weekdaySunday                                 0.00986    0.04264     0.2
includedhorm_contra                          -0.08553    0.06463    -1.3
fertile                                      -0.25497    0.12027    -2.1
menstruationpre:includedhorm_contra           0.05252    0.03495     1.5
menstruationyes:includedhorm_contra           0.12277    0.03360     3.7
weekdayTuesday:includedhorm_contra            0.00149    0.05455     0.0
weekdayWednesday:includedhorm_contra          0.00675    0.05474     0.1
weekdayThursday:includedhorm_contra          -0.00243    0.05527     0.0
weekdayFriday:includedhorm_contra             0.07481    0.05601     1.3
weekdaySaturday:includedhorm_contra           0.07585    0.05670     1.3
weekdaySunday:includedhorm_contra             0.04025    0.05495     0.7
weekdayTuesday:fertile                        0.25941    0.16546     1.6
weekdayWednesday:fertile                      0.08021    0.16654     0.5
weekdayThursday:fertile                       0.18677    0.16901     1.1
weekdayFriday:fertile                         0.27278    0.16920     1.6
weekdaySaturday:fertile                       0.18474    0.17144     1.1
weekdaySunday:fertile                         0.30712    0.16667     1.8
includedhorm_contra:fertile                   0.20293    0.15339     1.3
weekdayTuesday:includedhorm_contra:fertile   -0.13234    0.21062    -0.6
weekdayWednesday:includedhorm_contra:fertile  0.16517    0.21251     0.8
weekdayThursday:includedhorm_contra:fertile  -0.02079    0.21430    -0.1
weekdayFriday:includedhorm_contra:fertile    -0.13666    0.21487    -0.6
weekdaySaturday:includedhorm_contra:fertile  -0.24313    0.21797    -1.1
weekdaySunday:includedhorm_contra:fertile    -0.10210    0.21215    -0.5
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-18" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">72099</td>
<td align="center">72239</td>
<td align="center">-36033</td>
<td align="center">72065</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">72096</td>
<td align="center">72284</td>
<td align="center">-36025</td>
<td align="center">72050</td>
<td align="center">15.82</td>
<td align="center">6</td>
<td align="center">0.01478</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 72123

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.229 -0.493  0.096  0.632  4.373 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.574    0.758   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              4.30437    0.07350    58.6
menstruationpre                                         -0.05096    0.02730    -1.9
menstruationyes                                         -0.12026    0.02568    -4.7
fertile_mean                                            -0.14383    0.30744    -0.5
included_levelslax                                      -0.07323    0.15053    -0.5
included_levelsconservative                             -0.03328    0.11757    -0.3
included_levelsstrict                                    0.22403    0.11570     1.9
includedhorm_contra                                     -0.00914    0.07584    -0.1
fertile                                                 -0.10046    0.07022    -1.4
menstruationpre:includedhorm_contra                      0.05167    0.03502     1.5
menstruationyes:includedhorm_contra                      0.11982    0.03367     3.6
included_levelslax:includedhorm_contra                  -0.05449    0.18311    -0.3
included_levelsconservative:includedhorm_contra         -0.03059    0.14671    -0.2
included_levelsstrict:includedhorm_contra               -0.22492    0.14207    -1.6
included_levelslax:fertile                               0.53407    0.16970     3.1
included_levelsconservative:fertile                     -0.00840    0.12689    -0.1
included_levelsstrict:fertile                           -0.10231    0.12697    -0.8
includedhorm_contra:fertile                              0.27196    0.10658     2.6
included_levelslax:includedhorm_contra:fertile          -0.62103    0.20698    -3.0
included_levelsconservative:includedhorm_contra:fertile -0.19211    0.16484    -1.2
included_levelsstrict:includedhorm_contra:fertile       -0.00497    0.16231     0.0
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-18" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">72096</td>
<td align="center">72235</td>
<td align="center">-36031</td>
<td align="center">72062</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">72093</td>
<td align="center">72281</td>
<td align="center">-36023</td>
<td align="center">72047</td>
<td align="center">14.57</td>
<td align="center">6</td>
<td align="center">0.02387</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 72112

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.244 -0.499  0.091  0.632  4.234 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.573    0.757   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                              4.1881     0.1289    32.5
menstruationpre                                         -0.0493     0.0273    -1.8
menstruationyes                                         -0.1157     0.0259    -4.5
fertile_mean                                            -0.1852     0.3082    -0.6
cycle_length_groups(25,30]                               0.1686     0.1273     1.3
cycle_length_groups(30,35]                               0.0690     0.1521     0.5
cycle_length_groups(35,41]                               0.3873     0.2144     1.8
includedhorm_contra                                      0.0164     0.1438     0.1
fertile                                                 -0.1973     0.1488    -1.3
menstruationpre:includedhorm_contra                      0.0500     0.0350     1.4
menstruationyes:includedhorm_contra                      0.1135     0.0338     3.4
cycle_length_groups(25,30]:includedhorm_contra          -0.0634     0.1557    -0.4
cycle_length_groups(30,35]:includedhorm_contra          -0.2903     0.2367    -1.2
cycle_length_groups(35,41]:includedhorm_contra          -0.4628     0.3057    -1.5
cycle_length_groups(25,30]:fertile                       0.1776     0.1592     1.1
cycle_length_groups(30,35]:fertile                      -0.0287     0.1872    -0.2
cycle_length_groups(35,41]:fertile                       0.2720     0.2622     1.0
includedhorm_contra:fertile                              0.3979     0.1744     2.3
cycle_length_groups(25,30]:includedhorm_contra:fertile  -0.3614     0.1873    -1.9
cycle_length_groups(30,35]:includedhorm_contra:fertile  -0.2431     0.2918    -0.8
cycle_length_groups(35,41]:includedhorm_contra:fertile   0.1212     0.3441     0.4
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-18" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">72087</td>
<td align="center">72194</td>
<td align="center">-36031</td>
<td align="center">72061</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">72087</td>
<td align="center">72210</td>
<td align="center">-36029</td>
<td align="center">72057</td>
<td align="center">4.228</td>
<td align="center">2</td>
<td align="center">0.1207</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 72117

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.257 -0.498  0.094  0.632  4.413 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.570    0.755   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          4.0757     0.1903   21.42
menstruationpre                                     -0.0491     0.0273   -1.80
menstruationyes                                     -0.1160     0.0257   -4.51
fertile_mean                                        -0.1990     0.3045   -0.65
certainty_menstruation                               0.0625     0.0434    1.44
includedhorm_contra                                 -0.1960     0.2388   -0.82
fertile                                             -0.5160     0.2232   -2.31
menstruationpre:includedhorm_contra                  0.0516     0.0350    1.47
menstruationyes:includedhorm_contra                  0.1181     0.0337    3.51
certainty_menstruation:includedhorm_contra           0.0303     0.0556    0.54
certainty_menstruation:fertile                       0.1073     0.0522    2.06
includedhorm_contra:fertile                          0.5931     0.2864    2.07
certainty_menstruation:includedhorm_contra:fertile  -0.1095     0.0661   -1.66
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-18" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">72081</td>
<td align="center">72204</td>
<td align="center">-36026</td>
<td align="center">72051</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">72076</td>
<td align="center">72232</td>
<td align="center">-36019</td>
<td align="center">72038</td>
<td align="center">13.21</td>
<td align="center">4</td>
<td align="center">0.01027</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 72101

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.261 -0.499  0.095  0.631  4.401 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.565    0.752   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                         4.4330     0.0775    57.2
menstruationpre                                                                    -0.0496     0.0273    -1.8
menstruationyes                                                                    -0.1179     0.0257    -4.6
fertile_mean                                                                       -0.1285     0.3046    -0.4
cycle_regularityslightly irregular,\nup to 5 days off                              -0.2860     0.0898    -3.2
cycle_regularityirregular,\nmore than 5 days off                                   -0.0687     0.1075    -0.6
includedhorm_contra                                                                -0.1314     0.0705    -1.9
fertile                                                                             0.0335     0.0763     0.4
menstruationpre:includedhorm_contra                                                 0.0509     0.0350     1.5
menstruationyes:includedhorm_contra                                                 0.1188     0.0336     3.5
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra           0.0795     0.1358     0.6
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               -0.1172     0.1618    -0.7
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      -0.1881     0.1050    -1.8
cycle_regularityirregular,\nmore than 5 days off:fertile                           -0.1855     0.1311    -1.4
includedhorm_contra:fertile                                                         0.0521     0.0893     0.6
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  -0.1087     0.1558    -0.7
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile        0.3798     0.1938     2.0
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-18" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">72100</td>
<td align="center">72222</td>
<td align="center">-36035</td>
<td align="center">72070</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">72087</td>
<td align="center">72243</td>
<td align="center">-36025</td>
<td align="center">72049</td>
<td align="center">20.2</td>
<td align="center">4</td>
<td align="center">0.000455</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 72115

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.266 -0.498  0.092  0.633  4.417 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.576    0.759   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                           Estimate Std. Error t value
(Intercept)                                                4.362836   0.075929    57.5
menstruationpre                                           -0.051729   0.027278    -1.9
menstruationyes                                           -0.120862   0.025672    -4.7
fertile_mean                                              -0.146601   0.305898    -0.5
cohabitationLive in same city                             -0.057580   0.102952    -0.6
cohabitationLong-distance                                 -0.092895   0.097066    -1.0
includedhorm_contra                                       -0.049206   0.081761    -0.6
fertile                                                   -0.071800   0.069425    -1.0
menstruationpre:includedhorm_contra                        0.054553   0.034982     1.6
menstruationyes:includedhorm_contra                        0.123048   0.033632     3.7
cohabitationLive in same city:includedhorm_contra          0.016297   0.131436     0.1
cohabitationLong-distance:includedhorm_contra             -0.000375   0.125849     0.0
cohabitationLive in same city:fertile                     -0.365180   0.125727    -2.9
cohabitationLong-distance:fertile                          0.265394   0.113302     2.3
includedhorm_contra:fertile                                0.099604   0.100834     1.0
cohabitationLive in same city:includedhorm_contra:fertile  0.387099   0.157051     2.5
cohabitationLong-distance:includedhorm_contra:fertile     -0.180788   0.145758    -1.2
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-18" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">72099</td>
<td align="center">72221</td>
<td align="center">-36034</td>
<td align="center">72069</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">72103</td>
<td align="center">72258</td>
<td align="center">-36032</td>
<td align="center">72065</td>
<td align="center">3.835</td>
<td align="center">4</td>
<td align="center">0.4289</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/self_esteem_1-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: self_esteem_1 ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 72121

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-5.255 -0.498  0.092  0.632  4.409 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.576    0.759   
 Residual             0.794    0.891   
Number of obs: 26549, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                        4.2990     0.0706    60.9
menstruationpre                                                   -0.0513     0.0273    -1.9
menstruationyes                                                   -0.1187     0.0257    -4.6
fertile_mean                                                      -0.1375     0.3055    -0.5
relationship_status_cleanVerheiratet                               0.0858     0.0953     0.9
relationship_status_cleanVerlobt                                   0.0963     0.1810     0.5
includedhorm_contra                                               -0.0358     0.0606    -0.6
fertile                                                           -0.0565     0.0631    -0.9
menstruationpre:includedhorm_contra                                0.0534     0.0350     1.5
menstruationyes:includedhorm_contra                                0.1205     0.0336     3.6
relationship_status_cleanVerheiratet:includedhorm_contra          -0.2161     0.1835    -1.2
relationship_status_cleanVerlobt:includedhorm_contra               0.1605     0.2668     0.6
relationship_status_cleanVerheiratet:fertile                       0.0239     0.1121     0.2
relationship_status_cleanVerlobt:fertile                          -0.3898     0.2076    -1.9
includedhorm_contra:fertile                                        0.1266     0.0768     1.6
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  -0.0543     0.2093    -0.3
relationship_status_cleanVerlobt:includedhorm_contra:fertile       0.3280     0.3224     1.0
</code></pre>
</div>
</div>
</div>
<div id="female-jealousy" class="section level2 tab-content">
<h2>Female jealousy</h2>
<pre class="r"><code>model_summaries$female_jealousy</code></pre>
<div id="model-summary-38" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-39" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: female_jealousy ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
   Data: diary

REML criterion at convergence: 54334

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.608 -0.544 -0.134  0.444  7.281 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.289    0.537   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value Pr(&gt;|t|)    
(Intercept)                             1.66175     0.04700  1384.00000   35.35   &lt;2e-16 ***
includedhorm_contra                     0.03281     0.03843  1339.00000    0.85     0.39    
menstruationpre                         0.00788     0.01953 25842.00000    0.40     0.69    
menstruationyes                         0.00924     0.01837 25944.00000    0.50     0.62    
fertile                                 0.02446     0.03958 25833.00000    0.62     0.54    
fertile_mean                           -0.11290     0.21670  1502.00000   -0.52     0.60    
includedhorm_contra:menstruationpre     0.01402     0.02504 25842.00000    0.56     0.58    
includedhorm_contra:menstruationyes     0.01152     0.02407 25928.00000    0.48     0.63    
includedhorm_contra:fertile            -0.00465     0.05002 25951.00000   -0.09     0.93    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.161  0.205                                                        
menstrutnys             -0.157  0.198  0.399                                                 
fertile                 -0.156  0.253  0.469    0.387                                        
fertile_men             -0.772 -0.033 -0.008   -0.006   -0.064                               
inclddhrm_cntr:mnstrtnp  0.133 -0.256 -0.780   -0.311   -0.365 -0.003                        
inclddhrm_cntr:mnstrtny  0.126 -0.242 -0.305   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.156 -0.318 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.04 [-0.08;0.16].</p>
</div>
<div id="marginal-effect-plots-19" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-marg_eff-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-19" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-outcome_dist-1.png" width="576" /></p>
</div>
<div id="diagnostics-19" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-diagnostics-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-diagnostics-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-diagnostics-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-diagnostics-4.png" width="576" /></p>
</div>
</div>
<div id="curves-19" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-19" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-38" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-76" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-residuals-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-76" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-raw-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-76" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-means-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-38" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-77" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-residuals-8-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-77" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-raw-9-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-77" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-means-10-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-19" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-39" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-78" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-residuals-12-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-78" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-raw-13-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-78" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-means-14-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-39" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-79" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-residuals-16-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-79" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-raw-17-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-79" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-female_jealousy-curve-means-18-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-19" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-19" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-random_slopes-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ included + menstruation + fertile + fertile_mean +  
    (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 54173

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.609 -0.533 -0.128  0.444  7.298 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.2883   0.537                     
          fertile         0.2199   0.469    -0.12            
          menstruationpre 0.0306   0.175     0.08  0.21      
          menstruationyes 0.0321   0.179    -0.08  0.21  0.25
 Residual                 0.3921   0.626                     
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          1.66191    0.04710    35.3
includedhorm_contra                  0.03420    0.03848     0.9
menstruationpre                      0.00945    0.02192     0.4
menstruationyes                      0.00563    0.02094     0.3
fertile                              0.03187    0.04755     0.7
fertile_mean                        -0.11728    0.21842    -0.5
includedhorm_contra:menstruationpre  0.01517    0.02811     0.5
includedhorm_contra:menstruationyes  0.01283    0.02732     0.5
includedhorm_contra:fertile         -0.00716    0.06020    -0.1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.468                                                               
menstrutnpr             -0.123  0.162                                                        
menstrutnys             -0.161  0.201  0.362                                                 
fertile                 -0.157  0.264  0.395    0.338                                        
fertile_men             -0.772 -0.035 -0.012   -0.004   -0.073                               
inclddhrm_cntr:mnstrtnp  0.104 -0.200 -0.780   -0.282   -0.307 -0.002                        
inclddhrm_cntr:mnstrtny  0.128 -0.247 -0.278   -0.766   -0.259 -0.003  0.351                 
inclddhrm_cntr:f         0.160 -0.332 -0.311   -0.267   -0.787  0.011  0.394                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.333                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">54308</td>
<td align="center">54398</td>
<td align="center">-27143</td>
<td align="center">54286</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">54167</td>
<td align="center">54331</td>
<td align="center">-27064</td>
<td align="center">54127</td>
<td align="center">159.2</td>
<td align="center">9</td>
<td align="center">1.082e-29</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-19" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-19" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-19" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 49693

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.588 -0.538 -0.136  0.446  7.359 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.2891   0.538   
 Xr.2     s(days_filled_out):includedhorm_contra 0.0256   0.160   
 Xr.1     s(days_filled_out):includedcycling     0.0000   0.000   
 Xr.0     s(day_number):includedhorm_contra      0.0000   0.000   
 Xr       s(day_number):includedcycling          0.0136   0.117   
 Residual                                        0.4044   0.636   
Number of obs: 24252, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                            Estimate Std. Error t value
X(Intercept)                                1.657819   0.047351    35.0
Xincludedhorm_contra                        0.028690   0.039024     0.7
Xmenstruationpre                            0.012672   0.020335     0.6
Xmenstruationyes                            0.020804   0.019520     1.1
Xfertile                                    0.005609   0.042071     0.1
Xfertile_mean                              -0.080917   0.217211    -0.4
Xincludedhorm_contra:menstruationpre        0.013072   0.026063     0.5
Xincludedhorm_contra:menstruationyes       -0.000247   0.025535     0.0
Xincludedhorm_contra:fertile                0.015268   0.053145     0.3
Xs(day_number):includedcyclingFx1           0.061777   0.046844     1.3
Xs(day_number):includedhorm_contraFx1       0.060629   0.028510     2.1
Xs(days_filled_out):includedcyclingFx1     -0.042987   0.034042    -1.3
Xs(days_filled_out):includedhorm_contraFx1  0.005132   0.048211     0.1
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
female_jealousy ~ included + menstruation + fertile + fertile_mean + 
    s(day_number, by = included) + s(days_filled_out, by = included) + 
    included:menstruation + included:fertile

Parametric coefficients:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          1.657819   0.047351   35.01   &lt;2e-16 ***
includedhorm_contra                  0.028690   0.039024    0.74     0.46    
menstruationpre                      0.012672   0.020335    0.62     0.53    
menstruationyes                      0.020804   0.019520    1.07     0.29    
fertile                              0.005609   0.042071    0.13     0.89    
fertile_mean                        -0.080917   0.217211   -0.37     0.71    
includedhorm_contra:menstruationpre  0.013072   0.026063    0.50     0.62    
includedhorm_contra:menstruationyes -0.000247   0.025535   -0.01     0.99    
includedhorm_contra:fertile          0.015268   0.053145    0.29     0.77    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F  p-value    
s(day_number):includedcycling          3.03   3.03 7.61 0.000042 ***
s(day_number):includedhorm_contra      1.00   1.00 4.52    0.033 *  
s(days_filled_out):includedcycling     1.00   1.00 1.59    0.207    
s(days_filled_out):includedhorm_contra 3.94   3.94 6.85 0.000035 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00134   
lmer.REML =  49693  Scale est. = 0.40441   n = 24252
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  53331 53430 -26654

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.5317   0.6441

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2354 
Fixed effects: female_jealousy ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.6639   0.04783 25497   34.79  0.0000
includedhorm_contra                  0.0335   0.03928  1040    0.85  0.3942
menstruationpre                      0.0072   0.02207 25497    0.32  0.7455
menstruationyes                      0.0078   0.02061 25497    0.38  0.7062
fertile                              0.0214   0.04641 25497    0.46  0.6449
fertile_mean                        -0.0968   0.22059  1040   -0.44  0.6608
includedhorm_contra:menstruationpre  0.0147   0.02831 25497    0.52  0.6042
includedhorm_contra:menstruationyes  0.0138   0.02689 25497    0.51  0.6080
includedhorm_contra:fertile         -0.0101   0.05858 25497   -0.17  0.8635
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.178  0.224                                                        
menstruationyes                     -0.174  0.218  0.403                                                 
fertile                             -0.172  0.281  0.440    0.370                                        
fertile_mean                        -0.769 -0.033 -0.008   -0.006   -0.075                               
includedhorm_contra:menstruationpre  0.146 -0.279 -0.779   -0.314   -0.343 -0.004                        
includedhorm_contra:menstruationyes  0.139 -0.266 -0.308   -0.766   -0.283 -0.003  0.387                 
includedhorm_contra:fertile          0.173 -0.354 -0.349   -0.293   -0.789  0.011  0.439                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.363                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.4526 -0.5410 -0.1488  0.4446  7.1958 

Number of Observations: 26546
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  53255 53362 -26615

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.5262   0.6471

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.5251 -0.3068 
Fixed effects: female_jealousy ~ included * (menstruation + fertile) + fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          1.6654   0.04788 25497   34.78  0.0000
includedhorm_contra                  0.0330   0.03936  1040    0.84  0.4020
menstruationpre                      0.0033   0.02246 25497    0.15  0.8820
menstruationyes                      0.0052   0.02108 25497    0.25  0.8033
fertile                              0.0209   0.04823 25497    0.43  0.6652
fertile_mean                        -0.1027   0.22098  1040   -0.46  0.6421
includedhorm_contra:menstruationpre  0.0200   0.02883 25497    0.69  0.4876
includedhorm_contra:menstruationyes  0.0151   0.02745 25497    0.55  0.5823
includedhorm_contra:fertile         -0.0112   0.06085 25497   -0.18  0.8544
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.180  0.225                                                        
menstruationyes                     -0.178  0.223  0.412                                                 
fertile                             -0.174  0.287  0.416    0.361                                        
fertile_mean                        -0.768 -0.034 -0.007   -0.006   -0.078                               
includedhorm_contra:menstruationpre  0.147 -0.280 -0.779   -0.321   -0.324 -0.004                        
includedhorm_contra:menstruationyes  0.142 -0.271 -0.316   -0.768   -0.277 -0.003  0.398                 
includedhorm_contra:fertile          0.176 -0.361 -0.330   -0.286   -0.789  0.012  0.414                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.354                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.3646 -0.5426 -0.1554  0.4520  7.1202 

Number of Observations: 26546
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-19" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-19" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/female_jealousy-rob_check-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 35174

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.600 -0.546 -0.129  0.460  7.178 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.303    0.550   
 Residual             0.418    0.647   
Number of obs: 17028, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               1.62726    0.10533   15.45
fertile_mean                                              0.24785    0.51252    0.48
contraceptive_methodsfertility_awareness                  0.01177    0.13655    0.09
contraceptive_methodsnone                                 0.30398    0.14472    2.10
contraceptive_methodshormonal                             0.01479    0.06886    0.21
fertile                                                   0.05442    0.07218    0.75
menstruationpre                                           0.04745    0.03486    1.36
menstruationyes                                           0.02974    0.03330    0.89
contraceptive_methodsfertility_awareness:fertile          0.07655    0.16391    0.47
contraceptive_methodsnone:fertile                        -0.07141    0.17744   -0.40
contraceptive_methodshormonal:fertile                    -0.04614    0.08063   -0.57
contraceptive_methodsfertility_awareness:menstruationpre -0.04400    0.07721   -0.57
contraceptive_methodsnone:menstruationpre                -0.06108    0.08073   -0.76
contraceptive_methodshormonal:menstruationpre            -0.03980    0.03926   -1.01
contraceptive_methodsfertility_awareness:menstruationyes  0.03712    0.07760    0.48
contraceptive_methodsnone:menstruationyes                -0.10542    0.08441   -1.25
contraceptive_methodshormonal:menstruationyes            -0.00285    0.03797   -0.08
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">35140</td>
<td align="center">35241</td>
<td align="center">-17557</td>
<td align="center">35114</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">35149</td>
<td align="center">35296</td>
<td align="center">-17555</td>
<td align="center">35111</td>
<td align="center">3.228</td>
<td align="center">6</td>
<td align="center">0.7798</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-19" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">54285</td>
<td align="center">54441</td>
<td align="center">-27124</td>
<td align="center">54247</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">54287</td>
<td align="center">54508</td>
<td align="center">-27116</td>
<td align="center">54233</td>
<td align="center">14.35</td>
<td align="center">8</td>
<td align="center">0.073</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-age-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 54328

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.605 -0.541 -0.137  0.445  7.259 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.280    0.529   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   1.75738    0.09664   18.19
menstruationpre                               0.00794    0.01953    0.41
menstruationyes                               0.00946    0.01838    0.51
fertile_mean                                 -0.14389    0.21526   -0.67
age_group(20,25]                              0.01195    0.10329    0.12
age_group(25,30]                             -0.05727    0.10631   -0.54
age_group(30,35]                             -0.22205    0.12198   -1.82
age_group(35,70]                             -0.28755    0.11202   -2.57
includedhorm_contra                           0.10070    0.10347    0.97
fertile                                       0.03299    0.11235    0.29
menstruationpre:includedhorm_contra           0.01272    0.02504    0.51
menstruationyes:includedhorm_contra           0.01020    0.02408    0.42
age_group(20,25]:includedhorm_contra         -0.17506    0.11779   -1.49
age_group(25,30]:includedhorm_contra         -0.23352    0.12973   -1.80
age_group(30,35]:includedhorm_contra         -0.11992    0.16892   -0.71
age_group(35,70]:includedhorm_contra         -0.05999    0.19052   -0.31
age_group(20,25]:fertile                      0.03878    0.12444    0.31
age_group(25,30]:fertile                     -0.06041    0.12827   -0.47
age_group(30,35]:fertile                     -0.01447    0.14857   -0.10
age_group(35,70]:fertile                     -0.02544    0.13540   -0.19
includedhorm_contra:fertile                  -0.05981    0.12461   -0.48
age_group(20,25]:includedhorm_contra:fertile  0.00196    0.13940    0.01
age_group(25,30]:includedhorm_contra:fertile  0.26697    0.15448    1.73
age_group(30,35]:includedhorm_contra:fertile -0.22787    0.19938   -1.14
age_group(35,70]:includedhorm_contra:fertile  0.26848    0.22750    1.18
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-19" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">54307</td>
<td align="center">54414</td>
<td align="center">-27141</td>
<td align="center">54281</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">54311</td>
<td align="center">54434</td>
<td align="center">-27141</td>
<td align="center">54281</td>
<td align="center">0.05726</td>
<td align="center">2</td>
<td align="center">0.9718</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-weekend-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    weekend + included + fertile + menstruation:included + weekend:included +  
    weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 54351

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.622 -0.541 -0.135  0.446  7.291 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.289    0.537   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              1.67136    0.04752    35.2
menstruationpre                          0.00789    0.01953     0.4
menstruationyes                          0.00941    0.01837     0.5
fertile_mean                            -0.11405    0.21672    -0.5
weekendTRUE                             -0.02334    0.01704    -1.4
includedhorm_contra                      0.02824    0.03946     0.7
fertile                                  0.02887    0.04815     0.6
menstruationpre:includedhorm_contra      0.01408    0.02504     0.6
menstruationyes:includedhorm_contra      0.01118    0.02407     0.5
weekendTRUE:includedhorm_contra          0.01118    0.02190     0.5
weekendTRUE:fertile                     -0.00980    0.06641    -0.1
includedhorm_contra:fertile             -0.01302    0.06101    -0.2
weekendTRUE:includedhorm_contra:fertile  0.01955    0.08418     0.2
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-19" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">54283</td>
<td align="center">54471</td>
<td align="center">-27118</td>
<td align="center">54237</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">54303</td>
<td align="center">54590</td>
<td align="center">-27117</td>
<td align="center">54233</td>
<td align="center">3.705</td>
<td align="center">12</td>
<td align="center">0.9882</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-weekday-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    weekday + included + fertile + menstruation:included + weekday:included +  
    weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 54392

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.607 -0.541 -0.136  0.445  7.264 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.289    0.538   
 Residual             0.406    0.637   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                               Estimate Std. Error t value
(Intercept)                                   1.6553761  0.0510294    32.4
menstruationpre                               0.0077059  0.0195189     0.4
menstruationyes                               0.0093457  0.0183644     0.5
fertile_mean                                 -0.1070591  0.2167921    -0.5
weekdayTuesday                               -0.0000231  0.0304442     0.0
weekdayWednesday                              0.0439849  0.0304069     1.4
weekdayThursday                               0.0153285  0.0307591     0.5
weekdayFriday                                 0.0348465  0.0312668     1.1
weekdaySaturday                              -0.0268710  0.0316090    -0.9
weekdaySunday                                -0.0322326  0.0305337    -1.1
includedhorm_contra                           0.0040826  0.0460233     0.1
fertile                                       0.0644359  0.0861223     0.7
menstruationpre:includedhorm_contra           0.0134793  0.0250307     0.5
menstruationyes:includedhorm_contra           0.0104943  0.0240628     0.4
weekdayTuesday:includedhorm_contra            0.0255920  0.0390624     0.7
weekdayWednesday:includedhorm_contra          0.0157423  0.0391983     0.4
weekdayThursday:includedhorm_contra           0.0593613  0.0395784     1.5
weekdayFriday:includedhorm_contra             0.0065827  0.0401133     0.2
weekdaySaturday:includedhorm_contra           0.0520154  0.0406023     1.3
weekdaySunday:includedhorm_contra             0.0467446  0.0393487     1.2
weekdayTuesday:fertile                       -0.0783748  0.1184846    -0.7
weekdayWednesday:fertile                     -0.1037371  0.1192577    -0.9
weekdayThursday:fertile                       0.0428408  0.1210252     0.4
weekdayFriday:fertile                        -0.0551096  0.1211568    -0.5
weekdaySaturday:fertile                      -0.0153964  0.1227621    -0.1
weekdaySunday:fertile                        -0.0713762  0.1193480    -0.6
includedhorm_contra:fertile                  -0.1100912  0.1098398    -1.0
weekdayTuesday:includedhorm_contra:fertile    0.1478959  0.1508173     1.0
weekdayWednesday:includedhorm_contra:fertile  0.2022624  0.1521709     1.3
weekdayThursday:includedhorm_contra:fertile   0.0263191  0.1534557     0.2
weekdayFriday:includedhorm_contra:fertile     0.1483768  0.1538723     1.0
weekdaySaturday:includedhorm_contra:fertile   0.0946555  0.1560813     0.6
weekdaySunday:includedhorm_contra:fertile     0.1110798  0.1519187     0.7
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-19" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">54310</td>
<td align="center">54449</td>
<td align="center">-27138</td>
<td align="center">54276</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">54319</td>
<td align="center">54508</td>
<td align="center">-27137</td>
<td align="center">54273</td>
<td align="center">2.484</td>
<td align="center">6</td>
<td align="center">0.8702</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-exclusion-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 54361

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.610 -0.542 -0.132  0.444  7.283 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.287    0.536   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              1.61908    0.05213   31.06
menstruationpre                                          0.00755    0.01954    0.39
menstruationyes                                          0.00950    0.01838    0.52
fertile_mean                                            -0.12531    0.21815   -0.57
included_levelslax                                       0.12604    0.10659    1.18
included_levelsconservative                              0.08310    0.08326    1.00
included_levelsstrict                                    0.15881    0.08192    1.94
includedhorm_contra                                      0.06182    0.05379    1.15
fertile                                                  0.01644    0.05026    0.33
menstruationpre:includedhorm_contra                      0.01431    0.02507    0.57
menstruationyes:includedhorm_contra                      0.01107    0.02410    0.46
included_levelslax:includedhorm_contra                  -0.07372    0.12967   -0.57
included_levelsconservative:includedhorm_contra          0.01858    0.10390    0.18
included_levelsstrict:includedhorm_contra               -0.21026    0.10061   -2.09
included_levelslax:fertile                              -0.02555    0.12148   -0.21
included_levelsconservative:fertile                      0.01416    0.09083    0.16
included_levelsstrict:fertile                            0.04303    0.09089    0.47
includedhorm_contra:fertile                              0.01407    0.07630    0.18
included_levelslax:includedhorm_contra:fertile          -0.02301    0.14817   -0.16
included_levelsconservative:includedhorm_contra:fertile -0.06741    0.11801   -0.57
included_levelsstrict:includedhorm_contra:fertile       -0.00731    0.11619   -0.06
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-19" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">54313</td>
<td align="center">54452</td>
<td align="center">-27139</td>
<td align="center">54279</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">54314</td>
<td align="center">54502</td>
<td align="center">-27134</td>
<td align="center">54268</td>
<td align="center">10.53</td>
<td align="center">6</td>
<td align="center">0.104</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-cycle_length-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 54348

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.608 -0.542 -0.136  0.444  7.286 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.288    0.537   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             1.71962    0.09152   18.79
menstruationpre                                         0.00898    0.01955    0.46
menstruationyes                                         0.01249    0.01851    0.68
fertile_mean                                           -0.18228    0.21907   -0.83
cycle_length_groups(25,30]                             -0.00962    0.09041   -0.11
cycle_length_groups(30,35]                             -0.19227    0.10798   -1.78
cycle_length_groups(35,41]                             -0.15879    0.15222   -1.04
includedhorm_contra                                    -0.01779    0.10211   -0.17
fertile                                                -0.12939    0.10653   -1.21
menstruationpre:includedhorm_contra                     0.01248    0.02506    0.50
menstruationyes:includedhorm_contra                     0.00516    0.02421    0.21
cycle_length_groups(25,30]:includedhorm_contra          0.02112    0.11055    0.19
cycle_length_groups(30,35]:includedhorm_contra          0.13477    0.16800    0.80
cycle_length_groups(35,41]:includedhorm_contra          0.11182    0.21701    0.52
cycle_length_groups(25,30]:fertile                      0.17621    0.11393    1.55
cycle_length_groups(30,35]:fertile                      0.18243    0.13397    1.36
cycle_length_groups(35,41]:fertile                      0.10965    0.18769    0.58
includedhorm_contra:fertile                             0.30076    0.12483    2.41
cycle_length_groups(25,30]:includedhorm_contra:fertile -0.35418    0.13407   -2.64
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.51064    0.20885   -2.44
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.30728    0.24632   -1.25
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-19" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">54311</td>
<td align="center">54418</td>
<td align="center">-27143</td>
<td align="center">54285</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">54312</td>
<td align="center">54435</td>
<td align="center">-27141</td>
<td align="center">54282</td>
<td align="center">3.475</td>
<td align="center">2</td>
<td align="center">0.176</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-certainty-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 54351

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.609 -0.543 -0.133  0.444  7.288 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.289    0.538   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         1.76963    0.13564   13.05
menstruationpre                                     0.00767    0.01953    0.39
menstruationyes                                     0.00892    0.01840    0.48
fertile_mean                                       -0.11455    0.21723   -0.53
certainty_menstruation                             -0.02602    0.03094   -0.84
includedhorm_contra                                -0.12163    0.17023   -0.71
fertile                                             0.06828    0.15976    0.43
menstruationpre:includedhorm_contra                 0.01412    0.02505    0.56
menstruationyes:includedhorm_contra                 0.01094    0.02409    0.45
certainty_menstruation:includedhorm_contra          0.03706    0.03965    0.93
certainty_menstruation:fertile                     -0.01057    0.03735   -0.28
includedhorm_contra:fertile                         0.18139    0.20498    0.88
certainty_menstruation:includedhorm_contra:fertile -0.04300    0.04734   -0.91
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-19" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">54313</td>
<td align="center">54435</td>
<td align="center">-27141</td>
<td align="center">54283</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">54314</td>
<td align="center">54470</td>
<td align="center">-27138</td>
<td align="center">54276</td>
<td align="center">6.518</td>
<td align="center">4</td>
<td align="center">0.1636</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-regularity-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 54350

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.599 -0.542 -0.134  0.446  7.283 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.289    0.537   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        1.69767    0.05539   30.65
menstruationpre                                                                    0.00755    0.01954    0.39
menstruationyes                                                                    0.00926    0.01838    0.50
fertile_mean                                                                      -0.13436    0.21788   -0.62
cycle_regularityslightly irregular,\nup to 5 days off                             -0.02485    0.06423   -0.39
cycle_regularityirregular,\nmore than 5 days off                                  -0.12330    0.07685   -1.60
includedhorm_contra                                                                0.00496    0.05045    0.10
fertile                                                                           -0.03918    0.05461   -0.72
menstruationpre:includedhorm_contra                                                0.01400    0.02505    0.56
menstruationyes:includedhorm_contra                                                0.01075    0.02408    0.45
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra          0.04461    0.09711    0.46
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra               0.04349    0.11568    0.38
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.16097    0.07517    2.14
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.02461    0.09384    0.26
includedhorm_contra:fertile                                                        0.04565    0.06393    0.71
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.12984    0.11153   -1.16
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.10345    0.13872    0.75
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-19" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">54289</td>
<td align="center">54411</td>
<td align="center">-27129</td>
<td align="center">54259</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">54288</td>
<td align="center">54444</td>
<td align="center">-27125</td>
<td align="center">54250</td>
<td align="center">8.109</td>
<td align="center">4</td>
<td align="center">0.08766</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-mod_cohabit-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 54328

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.601 -0.542 -0.132  0.444  7.294 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.282    0.531   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                           Estimate Std. Error t value
(Intercept)                                                1.573712   0.053351   29.50
menstruationpre                                            0.007696   0.019524    0.39
menstruationyes                                            0.009067   0.018374    0.49
fertile_mean                                              -0.099604   0.215192   -0.46
cohabitationLive in same city                              0.170527   0.072221    2.36
cohabitationLong-distance                                  0.198146   0.068096    2.91
includedhorm_contra                                       -0.006329   0.057397   -0.11
fertile                                                    0.017523   0.049691    0.35
menstruationpre:includedhorm_contra                        0.013776   0.025040    0.55
menstruationyes:includedhorm_contra                        0.010642   0.024072    0.44
cohabitationLive in same city:includedhorm_contra         -0.005338   0.092198   -0.06
cohabitationLong-distance:includedhorm_contra              0.000349   0.088280    0.00
cohabitationLive in same city:fertile                      0.027749   0.089981    0.31
cohabitationLong-distance:fertile                          0.004572   0.081091    0.06
includedhorm_contra:fertile                               -0.018693   0.072169   -0.26
cohabitationLive in same city:includedhorm_contra:fertile -0.091506   0.112402   -0.81
cohabitationLong-distance:includedhorm_contra:fertile      0.104265   0.104325    1.00
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-19" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">54281</td>
<td align="center">54404</td>
<td align="center">-27125</td>
<td align="center">54251</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">54286</td>
<td align="center">54441</td>
<td align="center">-27124</td>
<td align="center">54248</td>
<td align="center">3.133</td>
<td align="center">4</td>
<td align="center">0.5358</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/female_jealousy-rel_status-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: female_jealousy ~ menstruation + fertile_mean + (1 | person) +  
    relationship_status_clean + included + fertile + menstruation:included +  
    relationship_status_clean:included + relationship_status_clean:fertile +  
    included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 54316

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.609 -0.543 -0.132  0.446  7.281 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.280    0.529   
 Residual             0.407    0.638   
Number of obs: 26546, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       1.74512    0.04949    35.3
menstruationpre                                                   0.00815    0.01952     0.4
menstruationyes                                                   0.00954    0.01837     0.5
fertile_mean                                                     -0.09950    0.21437    -0.5
relationship_status_cleanVerheiratet                             -0.29833    0.06668    -4.5
relationship_status_cleanVerlobt                                 -0.29720    0.12648    -2.3
includedhorm_contra                                              -0.03337    0.04243    -0.8
fertile                                                           0.01685    0.04514     0.4
menstruationpre:includedhorm_contra                               0.01339    0.02504     0.5
menstruationyes:includedhorm_contra                               0.01115    0.02407     0.5
relationship_status_cleanVerheiratet:includedhorm_contra         -0.08347    0.12832    -0.7
relationship_status_cleanVerlobt:includedhorm_contra              0.22446    0.18655     1.2
relationship_status_cleanVerheiratet:fertile                      0.01447    0.08023     0.2
relationship_status_cleanVerlobt:fertile                          0.08658    0.14857     0.6
includedhorm_contra:fertile                                      -0.00544    0.05497    -0.1
relationship_status_cleanVerheiratet:includedhorm_contra:fertile  0.01170    0.14976     0.1
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.20671    0.23072     0.9
</code></pre>
</div>
</div>
</div>
<div id="relationship-satisfaction" class="section level2 tab-content">
<h2>Relationship satisfaction</h2>
<pre class="r"><code>model_summaries$relationship_satisfaction_1</code></pre>
<div id="model-summary-40" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-41" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

REML criterion at convergence: 74734

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.866 -0.497  0.152  0.648  3.829 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.633    0.796   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                       Estimate  Std. Error          df t value Pr(&gt;|t|)    
(Intercept)                             4.75494     0.06945  1319.00000   68.46   &lt;2e-16 ***
includedhorm_contra                     0.18245     0.05680  1276.00000    3.21   0.0013 ** 
menstruationpre                         0.02607     0.02863 25826.00000    0.91   0.3625    
menstruationyes                         0.02656     0.02694 25933.00000    0.99   0.3242    
fertile                                 0.04207     0.05805 25817.00000    0.72   0.4686    
fertile_mean                           -0.41188     0.32011  1432.00000   -1.29   0.1984    
includedhorm_contra:menstruationpre    -0.04130     0.03671 25827.00000   -1.13   0.2606    
includedhorm_contra:menstruationyes    -0.00716     0.03528 25915.00000   -0.20   0.8391    
includedhorm_contra:fertile            -0.13287     0.07334 25939.00000   -1.81   0.0701 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.469                                                               
menstrutnpr             -0.160  0.204                                                        
menstrutnys             -0.156  0.197  0.399                                                 
fertile                 -0.154  0.251  0.469    0.387                                        
fertile_men             -0.772 -0.033 -0.008   -0.006   -0.063                               
inclddhrm_cntr:mnstrtnp  0.132 -0.254 -0.780   -0.311   -0.365 -0.003                        
inclddhrm_cntr:mnstrtny  0.125 -0.240 -0.305   -0.763   -0.295 -0.003  0.384                 
inclddhrm_cntr:f         0.154 -0.316 -0.371   -0.306   -0.789  0.009  0.468                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.383                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): 0.04 [-0.08;0.17].</p>
</div>
<div id="marginal-effect-plots-20" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-marg_eff-20-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-20" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-outcome_dist-21-1.png" width="576" /></p>
</div>
<div id="diagnostics-20" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-diagnostics-22-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-diagnostics-22-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-diagnostics-22-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-diagnostics-22-4.png" width="576" /></p>
</div>
</div>
<div id="curves-20" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-20" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-40" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-80" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-residuals-39-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-80" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-raw-40-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-80" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-means-41-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-40" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-81" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-residuals-43-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-81" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-raw-44-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-81" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-means-45-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-20" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-41" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-82" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-residuals-47-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-82" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-raw-48-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-82" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-means-49-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-41" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-83" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-residuals-51-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-83" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-raw-52-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-83" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-relationship_satisfaction_1-curve-means-53-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-20" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-20" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-random_slopes-27-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 74188

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.877 -0.502  0.132  0.619  3.697 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.676    0.822                     
          fertile         0.896    0.946    -0.24            
          menstruationpre 0.218    0.467    -0.15  0.47      
          menstruationyes 0.214    0.463    -0.20  0.38  0.49
 Residual                 0.807    0.898                     
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          4.75642    0.07073    67.2
includedhorm_contra                  0.17309    0.05861     3.0
menstruationpre                      0.02199    0.03865     0.6
menstruationyes                      0.02166    0.03699     0.6
fertile                              0.02502    0.07797     0.3
fertile_mean                        -0.40438    0.32530    -1.2
includedhorm_contra:menstruationpre -0.03174    0.04957    -0.6
includedhorm_contra:menstruationyes  0.00737    0.04806     0.2
includedhorm_contra:fertile         -0.09516    0.09887    -1.0

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.476                                                               
menstrutnpr             -0.171  0.220                                                        
menstrutnys             -0.195  0.240  0.435                                                 
fertile                 -0.191  0.301  0.458    0.379                                        
fertile_men             -0.764 -0.034 -0.013   -0.005   -0.074                               
inclddhrm_cntr:mnstrtnp  0.144 -0.275 -0.780   -0.339   -0.356 -0.003                        
inclddhrm_cntr:mnstrtny  0.156 -0.297 -0.335   -0.770   -0.291 -0.003  0.426                 
inclddhrm_cntr:f         0.187 -0.379 -0.361   -0.298   -0.785  0.011  0.458                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.374                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">74715</td>
<td align="center">74805</td>
<td align="center">-37346</td>
<td align="center">74693</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">74190</td>
<td align="center">74354</td>
<td align="center">-37075</td>
<td align="center">74150</td>
<td align="center">542.8</td>
<td align="center">9</td>
<td align="center">3.964e-111</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-20" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-20" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-20" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 67836

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.862 -0.516  0.153  0.642  3.926 

Random effects:
 Groups   Name                                   Variance Std.Dev.
 person   (Intercept)                            0.65310  0.8081  
 Xr.2     s(days_filled_out):includedhorm_contra 0.00000  0.0000  
 Xr.1     s(days_filled_out):includedcycling     0.00613  0.0783  
 Xr.0     s(day_number):includedhorm_contra      0.00000  0.0000  
 Xr       s(day_number):includedcycling          0.00000  0.0000  
 Residual                                        0.85102  0.9225  
Number of obs: 24271, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                           Estimate Std. Error t value
X(Intercept)                                 4.7310     0.0706    67.0
Xincludedhorm_contra                         0.1806     0.0582     3.1
Xmenstruationpre                             0.0238     0.0295     0.8
Xmenstruationyes                             0.0427     0.0283     1.5
Xfertile                                     0.0604     0.0610     1.0
Xfertile_mean                               -0.3526     0.3236    -1.1
Xincludedhorm_contra:menstruationpre        -0.0260     0.0378    -0.7
Xincludedhorm_contra:menstruationyes        -0.0120     0.0370    -0.3
Xincludedhorm_contra:fertile                -0.1286     0.0771    -1.7
Xs(day_number):includedcyclingFx1           -0.0252     0.0486    -0.5
Xs(day_number):includedhorm_contraFx1        0.0430     0.0404     1.1
Xs(days_filled_out):includedcyclingFx1       0.0277     0.0566     0.5
Xs(days_filled_out):includedhorm_contraFx1  -0.0552     0.0414    -1.3
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
relationship_satisfaction_1 ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           4.7310     0.0706   67.00   &lt;2e-16 ***
includedhorm_contra                   0.1806     0.0582    3.10   0.0019 ** 
menstruationpre                       0.0238     0.0295    0.81   0.4187    
menstruationyes                       0.0427     0.0283    1.51   0.1311    
fertile                               0.0604     0.0610    0.99   0.3224    
fertile_mean                         -0.3526     0.3236   -1.09   0.2758    
includedhorm_contra:menstruationpre  -0.0260     0.0378   -0.69   0.4906    
includedhorm_contra:menstruationyes  -0.0120     0.0370   -0.32   0.7467    
includedhorm_contra:fertile          -0.1286     0.0771   -1.67   0.0952 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df    F p-value
s(day_number):includedcycling          1.00   1.00 0.27    0.60
s(day_number):includedhorm_contra      1.00   1.00 1.13    0.29
s(days_filled_out):includedcycling     2.03   2.03 1.13    0.30
s(days_filled_out):includedhorm_contra 1.00   1.00 1.78    0.18

R-sq.(adj) =  0.00206   
lmer.REML =  67836  Scale est. = 0.85102   n = 24271
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  71671 71770 -35824

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7625   0.9575

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.3979 
Fixed effects: relationship_satisfaction_1 ~ included * (menstruation + fertile) +      fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          4.768    0.0706 25519   67.54  0.0000
includedhorm_contra                  0.163    0.0581  1040    2.81  0.0050
menstruationpre                     -0.001    0.0342 25519   -0.01  0.9883
menstruationyes                     -0.003    0.0318 25519   -0.09  0.9281
fertile                             -0.016    0.0757 25519   -0.21  0.8340
fertile_mean                        -0.341    0.3263  1040   -1.04  0.2964
includedhorm_contra:menstruationpre -0.016    0.0439 25519   -0.36  0.7167
includedhorm_contra:menstruationyes  0.023    0.0413 25519    0.55  0.5816
includedhorm_contra:fertile         -0.076    0.0955 25519   -0.80  0.4262
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.473                                                               
menstruationpre                     -0.185  0.232                                                        
menstruationyes                     -0.183  0.228  0.407                                                 
fertile                             -0.180  0.300  0.404    0.348                                        
fertile_mean                        -0.768 -0.034 -0.007   -0.006   -0.084                               
includedhorm_contra:menstruationpre  0.152 -0.288 -0.779   -0.317   -0.314 -0.004                        
includedhorm_contra:menstruationyes  0.146 -0.277 -0.314   -0.770   -0.267 -0.003  0.392                 
includedhorm_contra:fertile          0.183 -0.377 -0.320   -0.275   -0.788  0.013  0.402                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.340                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.7488 -0.4941  0.1622  0.6413  3.6873 

Number of Observations: 26568
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  71491 71597 -35733

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.7478   0.9664

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.6177 -0.2592 
Fixed effects: relationship_satisfaction_1 ~ included * (menstruation + fertile) +      fertile_mean 
                                     Value Std.Error    DF t-value p-value
(Intercept)                          4.768    0.0707 25519   67.46  0.0000
includedhorm_contra                  0.162    0.0581  1040    2.79  0.0054
menstruationpre                      0.002    0.0345 25519    0.05  0.9570
menstruationyes                     -0.008    0.0323 25519   -0.25  0.8057
fertile                             -0.022    0.0788 25519   -0.28  0.7782
fertile_mean                        -0.323    0.3274  1040   -0.99  0.3247
includedhorm_contra:menstruationpre -0.020    0.0443 25519   -0.46  0.6470
includedhorm_contra:menstruationyes  0.026    0.0419 25519    0.63  0.5308
includedhorm_contra:fertile         -0.072    0.0993 25519   -0.72  0.4685
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.472                                                               
menstruationpre                     -0.185  0.229                                                        
menstruationyes                     -0.186  0.231  0.422                                                 
fertile                             -0.180  0.304  0.367    0.334                                        
fertile_mean                        -0.768 -0.036 -0.004   -0.005   -0.088                               
includedhorm_contra:menstruationpre  0.150 -0.284 -0.779   -0.329   -0.285 -0.004                        
includedhorm_contra:menstruationyes  0.148 -0.280 -0.326   -0.772   -0.258 -0.002  0.408                 
includedhorm_contra:fertile          0.185 -0.382 -0.291   -0.265   -0.788  0.014  0.364                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.326                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-4.6954 -0.4846  0.1661  0.6386  3.5806 

Number of Observations: 26568
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-20" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-20" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rob_check-28-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 46954

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.946 -0.507  0.136  0.662  3.917 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.536    0.732   
 Residual             0.837    0.915   
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                         Estimate Std. Error t value
(Intercept)                                               4.90611    0.14095    34.8
fertile_mean                                             -0.39045    0.68498    -0.6
contraceptive_methodsfertility_awareness                  0.04214    0.18352     0.2
contraceptive_methodsnone                                -0.08171    0.19453    -0.4
contraceptive_methodshormonal                             0.06537    0.09251     0.7
fertile                                                  -0.00823    0.10207    -0.1
menstruationpre                                          -0.01576    0.04926    -0.3
menstruationyes                                           0.02907    0.04706     0.6
contraceptive_methodsfertility_awareness:fertile          0.25109    0.23180     1.1
contraceptive_methodsnone:fertile                         0.04515    0.25094     0.2
contraceptive_methodshormonal:fertile                    -0.10485    0.11401    -0.9
contraceptive_methodsfertility_awareness:menstruationpre -0.14348    0.10918    -1.3
contraceptive_methodsnone:menstruationpre                -0.03247    0.11415    -0.3
contraceptive_methodshormonal:menstruationpre             0.00961    0.05549     0.2
contraceptive_methodsfertility_awareness:menstruationyes  0.05853    0.10973     0.5
contraceptive_methodsnone:menstruationyes                 0.03853    0.11937     0.3
contraceptive_methodshormonal:menstruationyes            -0.03916    0.05366    -0.7
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">46934</td>
<td align="center">47035</td>
<td align="center">-23454</td>
<td align="center">46908</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">46940</td>
<td align="center">47087</td>
<td align="center">-23451</td>
<td align="center">46902</td>
<td align="center">6.321</td>
<td align="center">6</td>
<td align="center">0.3882</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-20" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">74725</td>
<td align="center">74880</td>
<td align="center">-37343</td>
<td align="center">74687</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">74723</td>
<td align="center">74944</td>
<td align="center">-37335</td>
<td align="center">74669</td>
<td align="center">17.31</td>
<td align="center">8</td>
<td align="center">0.02703</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-age-29-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 74745

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.865 -0.498  0.150  0.647  3.824 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.635    0.797   
 Residual             0.874    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                              Estimate Std. Error t value
(Intercept)                                   4.727775   0.144966    32.6
menstruationpre                               0.027031   0.028634     0.9
menstruationyes                               0.025543   0.026946     0.9
fertile_mean                                 -0.417068   0.322066    -1.3
age_group(20,25]                              0.119888   0.155033     0.8
age_group(25,30]                             -0.000359   0.159573     0.0
age_group(30,35]                              0.076178   0.183100     0.4
age_group(35,70]                             -0.110089   0.168141    -0.7
includedhorm_contra                           0.215122   0.155290     1.4
fertile                                       0.286655   0.164778     1.7
menstruationpre:includedhorm_contra          -0.043208   0.036720    -1.2
menstruationyes:includedhorm_contra          -0.007386   0.035293    -0.2
age_group(20,25]:includedhorm_contra         -0.090329   0.176828    -0.5
age_group(25,30]:includedhorm_contra         -0.108402   0.194735    -0.6
age_group(30,35]:includedhorm_contra         -0.133361   0.253601    -0.5
age_group(35,70]:includedhorm_contra          0.075338   0.286005     0.3
age_group(20,25]:fertile                     -0.350808   0.182508    -1.9
age_group(25,30]:fertile                     -0.397657   0.188130    -2.1
age_group(30,35]:fertile                      0.067657   0.217914     0.3
age_group(35,70]:fertile                     -0.149233   0.198580    -0.8
includedhorm_contra:fertile                  -0.467547   0.182735    -2.6
age_group(20,25]:includedhorm_contra:fertile  0.450371   0.204423     2.2
age_group(25,30]:includedhorm_contra:fertile  0.467535   0.226547     2.1
age_group(30,35]:includedhorm_contra:fertile  0.313164   0.292428     1.1
age_group(35,70]:includedhorm_contra:fertile  0.560248   0.333645     1.7
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-20" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">74698</td>
<td align="center">74804</td>
<td align="center">-37336</td>
<td align="center">74672</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">74700</td>
<td align="center">74822</td>
<td align="center">-37335</td>
<td align="center">74670</td>
<td align="center">2.132</td>
<td align="center">2</td>
<td align="center">0.3444</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-weekend-30-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 74730

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.843 -0.496  0.151  0.646  3.854 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.633    0.796   
 Residual             0.874    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              4.74413    0.07019    67.6
menstruationpre                          0.02602    0.02862     0.9
menstruationyes                          0.02637    0.02693     1.0
fertile_mean                            -0.40608    0.32006    -1.3
weekendTRUE                              0.02500    0.02498     1.0
includedhorm_contra                      0.17230    0.05828     3.0
fertile                                 -0.01376    0.07059    -0.2
menstruationpre:includedhorm_contra     -0.04168    0.03670    -1.1
menstruationyes:includedhorm_contra     -0.00633    0.03527    -0.2
weekendTRUE:includedhorm_contra          0.02602    0.03209     0.8
weekendTRUE:fertile                      0.13349    0.09736     1.4
includedhorm_contra:fertile             -0.09364    0.08944    -1.0
weekendTRUE:includedhorm_contra:fertile -0.09557    0.12337    -0.8
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-20" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">74653</td>
<td align="center">74841</td>
<td align="center">-37304</td>
<td align="center">74607</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">74667</td>
<td align="center">74954</td>
<td align="center">-37299</td>
<td align="center">74597</td>
<td align="center">9.56</td>
<td align="center">12</td>
<td align="center">0.6545</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-weekday-31-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 74731

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.820 -0.498  0.152  0.644  3.765 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.633    0.796   
 Residual             0.872    0.934   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   4.84655    0.07525    64.4
menstruationpre                               0.02530    0.02860     0.9
menstruationyes                               0.02569    0.02690     1.0
fertile_mean                                 -0.41729    0.31996    -1.3
weekdayTuesday                               -0.16230    0.04458    -3.6
weekdayWednesday                             -0.11629    0.04456    -2.6
weekdayThursday                              -0.12383    0.04507    -2.7
weekdayFriday                                -0.08348    0.04581    -1.8
weekdaySaturday                              -0.08319    0.04632    -1.8
weekdaySunday                                -0.05806    0.04474    -1.3
includedhorm_contra                           0.18534    0.06780     2.7
fertile                                      -0.14063    0.12620    -1.1
menstruationpre:includedhorm_contra          -0.03955    0.03667    -1.1
menstruationyes:includedhorm_contra          -0.00416    0.03524    -0.1
weekdayTuesday:includedhorm_contra            0.01305    0.05721     0.2
weekdayWednesday:includedhorm_contra         -0.05322    0.05743    -0.9
weekdayThursday:includedhorm_contra          -0.01723    0.05799    -0.3
weekdayFriday:includedhorm_contra            -0.02921    0.05876    -0.5
weekdaySaturday:includedhorm_contra           0.04553    0.05947     0.8
weekdaySunday:includedhorm_contra             0.02039    0.05765     0.4
weekdayTuesday:fertile                        0.23274    0.17358     1.3
weekdayWednesday:fertile                      0.06338    0.17476     0.4
weekdayThursday:fertile                       0.22223    0.17735     1.3
weekdayFriday:fertile                         0.13014    0.17752     0.7
weekdaySaturday:fertile                       0.27683    0.17989     1.5
weekdaySunday:fertile                         0.37372    0.17489     2.1
includedhorm_contra:fertile                  -0.08446    0.16095    -0.5
weekdayTuesday:includedhorm_contra:fertile   -0.06772    0.22097    -0.3
weekdayWednesday:includedhorm_contra:fertile  0.06766    0.22297     0.3
weekdayThursday:includedhorm_contra:fertile  -0.02799    0.22487    -0.1
weekdayFriday:includedhorm_contra:fertile     0.01726    0.22540     0.1
weekdaySaturday:includedhorm_contra:fertile  -0.16892    0.22868    -0.7
weekdaySunday:includedhorm_contra:fertile    -0.15963    0.22260    -0.7
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-20" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">74708</td>
<td align="center">74848</td>
<td align="center">-37337</td>
<td align="center">74674</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">74714</td>
<td align="center">74902</td>
<td align="center">-37334</td>
<td align="center">74668</td>
<td align="center">6.686</td>
<td align="center">6</td>
<td align="center">0.3508</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-exclusion-32-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 74739

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.853 -0.496  0.152  0.651  3.839 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.625    0.790   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              4.68901    0.07676    61.1
menstruationpre                                          0.02569    0.02865     0.9
menstruationyes                                          0.02695    0.02695     1.0
fertile_mean                                            -0.41179    0.32118    -1.3
included_levelslax                                      -0.09279    0.15708    -0.6
included_levelsconservative                              0.16982    0.12270     1.4
included_levelsstrict                                    0.34355    0.12073     2.8
includedhorm_contra                                      0.18737    0.07920     2.4
fertile                                                  0.01422    0.07371     0.2
menstruationpre:includedhorm_contra                     -0.04261    0.03675    -1.2
menstruationyes:includedhorm_contra                     -0.00898    0.03532    -0.3
included_levelslax:includedhorm_contra                  -0.02799    0.19109    -0.1
included_levelsconservative:includedhorm_contra         -0.02098    0.15311    -0.1
included_levelsstrict:includedhorm_contra               -0.18637    0.14826    -1.3
included_levelslax:fertile                               0.08657    0.17814     0.5
included_levelsconservative:fertile                      0.23035    0.13318     1.7
included_levelsstrict:fertile                           -0.12475    0.13325    -0.9
includedhorm_contra:fertile                             -0.05908    0.11187    -0.5
included_levelslax:includedhorm_contra:fertile          -0.10913    0.21723    -0.5
included_levelsconservative:includedhorm_contra:fertile -0.25204    0.17302    -1.5
included_levelsstrict:includedhorm_contra:fertile        0.01177    0.17034     0.1
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-20" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">74702</td>
<td align="center">74841</td>
<td align="center">-37334</td>
<td align="center">74668</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">74710</td>
<td align="center">74899</td>
<td align="center">-37332</td>
<td align="center">74664</td>
<td align="center">3.715</td>
<td align="center">6</td>
<td align="center">0.7151</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-cycle_length-33-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 74728

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.866 -0.497  0.151  0.646  3.812 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.622    0.789   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             4.28288    0.13441    31.9
menstruationpre                                         0.02588    0.02867     0.9
menstruationyes                                         0.02600    0.02713     1.0
fertile_mean                                           -0.39727    0.32167    -1.2
cycle_length_groups(25,30]                              0.52168    0.13279     3.9
cycle_length_groups(30,35]                              0.56892    0.15859     3.6
cycle_length_groups(35,41]                              0.54269    0.22357     2.4
includedhorm_contra                                     0.46594    0.14997     3.1
fertile                                                 0.10283    0.15624     0.7
menstruationpre:includedhorm_contra                    -0.04025    0.03675    -1.1
menstruationyes:includedhorm_contra                    -0.00669    0.03549    -0.2
cycle_length_groups(25,30]:includedhorm_contra         -0.28992    0.16237    -1.8
cycle_length_groups(30,35]:includedhorm_contra         -0.57690    0.24675    -2.3
cycle_length_groups(35,41]:includedhorm_contra         -0.28842    0.31873    -0.9
cycle_length_groups(25,30]:fertile                     -0.06894    0.16709    -0.4
cycle_length_groups(30,35]:fertile                     -0.11878    0.19647    -0.6
cycle_length_groups(35,41]:fertile                      0.12179    0.27527     0.4
includedhorm_contra:fertile                            -0.13021    0.18308    -0.7
cycle_length_groups(25,30]:includedhorm_contra:fertile  0.01017    0.19663     0.1
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.22739    0.30630    -0.7
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.33222    0.36119    -0.9
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-20" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">74716</td>
<td align="center">74823</td>
<td align="center">-37345</td>
<td align="center">74690</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">74717</td>
<td align="center">74840</td>
<td align="center">-37343</td>
<td align="center">74687</td>
<td align="center">3.543</td>
<td align="center">2</td>
<td align="center">0.1701</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-certainty-34-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 74746

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.869 -0.499  0.153  0.646  3.827 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.633    0.796   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                          4.6231     0.2004   23.06
menstruationpre                                      0.0277     0.0286    0.97
menstruationyes                                      0.0292     0.0270    1.08
fertile_mean                                        -0.4328     0.3207   -1.35
certainty_menstruation                               0.0326     0.0457    0.71
includedhorm_contra                                  0.1361     0.2515    0.54
fertile                                             -0.3772     0.2343   -1.61
menstruationpre:includedhorm_contra                 -0.0429     0.0367   -1.17
menstruationyes:includedhorm_contra                 -0.0100     0.0353   -0.28
certainty_menstruation:includedhorm_contra           0.0101     0.0586    0.17
certainty_menstruation:fertile                       0.1012     0.0548    1.85
includedhorm_contra:fertile                          0.3518     0.3006    1.17
certainty_menstruation:includedhorm_contra:fertile  -0.1165     0.0694   -1.68
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-20" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">74720</td>
<td align="center">74843</td>
<td align="center">-37345</td>
<td align="center">74690</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">74719</td>
<td align="center">74875</td>
<td align="center">-37340</td>
<td align="center">74681</td>
<td align="center">9.373</td>
<td align="center">4</td>
<td align="center">0.05243</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-regularity-35-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 74742

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.870 -0.498  0.149  0.647  3.828 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.635    0.797   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                                   Estimate Std. Error
(Intercept)                                                                        4.795193   0.081975
menstruationpre                                                                    0.023924   0.028641
menstruationyes                                                                    0.024858   0.026943
fertile_mean                                                                      -0.411436   0.322287
cycle_regularityslightly irregular,\nup to 5 days off                             -0.091838   0.095150
cycle_regularityirregular,\nmore than 5 days off                                  -0.041067   0.113815
includedhorm_contra                                                                0.161649   0.074691
fertile                                                                           -0.018789   0.080087
menstruationpre:includedhorm_contra                                               -0.038820   0.036724
menstruationyes:includedhorm_contra                                               -0.005059   0.035293
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra         -0.000897   0.143857
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.070211   0.171355
cycle_regularityslightly irregular,\nup to 5 days off:fertile                     -0.008876   0.110230
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.342287   0.137600
includedhorm_contra:fertile                                                       -0.086828   0.093738
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile  0.172485   0.163510
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile      -0.399648   0.203386
                                                                                  t value
(Intercept)                                                                          58.5
menstruationpre                                                                       0.8
menstruationyes                                                                       0.9
fertile_mean                                                                         -1.3
cycle_regularityslightly irregular,\nup to 5 days off                                -1.0
cycle_regularityirregular,\nmore than 5 days off                                     -0.4
includedhorm_contra                                                                   2.2
fertile                                                                              -0.2
menstruationpre:includedhorm_contra                                                  -1.1
menstruationyes:includedhorm_contra                                                  -0.1
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra             0.0
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra                 -0.4
cycle_regularityslightly irregular,\nup to 5 days off:fertile                        -0.1
cycle_regularityirregular,\nmore than 5 days off:fertile                              2.5
includedhorm_contra:fertile                                                          -0.9
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile     1.1
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile         -2.0
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-20" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">74713</td>
<td align="center">74836</td>
<td align="center">-37341</td>
<td align="center">74683</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">74711</td>
<td align="center">74867</td>
<td align="center">-37337</td>
<td align="center">74673</td>
<td align="center">9.566</td>
<td align="center">4</td>
<td align="center">0.0484</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-mod_cohabit-36-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 74738

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.844 -0.498  0.155  0.647  3.817 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.629    0.793   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                4.80511    0.07942    60.5
menstruationpre                                            0.02625    0.02863     0.9
menstruationyes                                            0.02662    0.02694     1.0
fertile_mean                                              -0.40970    0.32004    -1.3
cohabitationLive in same city                             -0.08125    0.10765    -0.8
cohabitationLong-distance                                 -0.12939    0.10150    -1.3
includedhorm_contra                                        0.23580    0.08550     2.8
fertile                                                    0.12315    0.07287     1.7
menstruationpre:includedhorm_contra                       -0.04057    0.03671    -1.1
menstruationyes:includedhorm_contra                       -0.00682    0.03528    -0.2
cohabitationLive in same city:includedhorm_contra          0.01495    0.13743     0.1
cohabitationLong-distance:includedhorm_contra             -0.09772    0.13159    -0.7
cohabitationLive in same city:fertile                     -0.25746    0.13195    -2.0
cohabitationLong-distance:fertile                         -0.12793    0.11894    -1.1
includedhorm_contra:fertile                               -0.19393    0.10584    -1.8
cohabitationLive in same city:includedhorm_contra:fertile  0.11920    0.16482     0.7
cohabitationLong-distance:includedhorm_contra:fertile      0.19944    0.15300     1.3
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-20" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">74719</td>
<td align="center">74842</td>
<td align="center">-37345</td>
<td align="center">74689</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">74726</td>
<td align="center">74881</td>
<td align="center">-37344</td>
<td align="center">74688</td>
<td align="center">1.567</td>
<td align="center">4</td>
<td align="center">0.8147</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/relationship_satisfaction_1-rel_status-37-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: relationship_satisfaction_1 ~ menstruation + fertile_mean + (1 |  
    person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 74742

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-4.866 -0.497  0.151  0.648  3.829 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.633    0.796   
 Residual             0.875    0.935   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                       4.75182    0.07407    64.2
menstruationpre                                                   0.02609    0.02863     0.9
menstruationyes                                                   0.02656    0.02694     1.0
fertile_mean                                                     -0.38807    0.32047    -1.2
relationship_status_cleanVerheiratet                             -0.00662    0.09997    -0.1
relationship_status_cleanVerlobt                                  0.01284    0.18980     0.1
includedhorm_contra                                               0.17877    0.06353     2.8
fertile                                                           0.01748    0.06621     0.3
menstruationpre:includedhorm_contra                              -0.04142    0.03672    -1.1
menstruationyes:includedhorm_contra                              -0.00713    0.03528    -0.2
relationship_status_cleanVerheiratet:includedhorm_contra         -0.12422    0.19247    -0.6
relationship_status_cleanVerlobt:includedhorm_contra              0.28555    0.27982     1.0
relationship_status_cleanVerheiratet:fertile                      0.08907    0.11769     0.8
relationship_status_cleanVerlobt:fertile                          0.05846    0.21795     0.3
includedhorm_contra:fertile                                      -0.11013    0.08063    -1.4
relationship_status_cleanVerheiratet:includedhorm_contra:fertile -0.16154    0.21967    -0.7
relationship_status_cleanVerlobt:includedhorm_contra:fertile      0.17135    0.33843     0.5
</code></pre>
</div>
</div>
</div>
<div id="communicaton-with-partner" class="section level2 tab-content">
<h2>Communicaton with partner</h2>
<pre class="r"><code>model_summaries$communication_partner_1</code></pre>
<div id="model-summary-42" class="section level3 tab-content">
<h3>Model summary</h3>
<div id="model-summary-43" class="section level4">
<h4>Model summary</h4>
<pre class="r"><code>model %&gt;% 
  print_summary()</code></pre>
<pre><code>Linear mixed model fit by REML 
t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
   Data: diary

REML criterion at convergence: 40655

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.735 -0.848  0.247  0.786  2.916 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0669   0.259   
 Residual             0.2507   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                      Estimate Std. Error         df t value Pr(&gt;|t|)    
(Intercept)                             2.5482     0.0259  1630.0000   98.22   &lt;2e-16 ***
includedhorm_contra                     0.0403     0.0212  1741.0000    1.90    0.058 .  
menstruationpre                         0.0176     0.0153 26114.0000    1.15    0.249    
menstruationyes                         0.0068     0.0143 26253.0000    0.47    0.635    
fertile                                -0.0206     0.0309 26072.0000   -0.66    0.506    
fertile_mean                           -0.1178     0.1211  1700.0000   -0.97    0.330    
includedhorm_contra:menstruationpre    -0.0490     0.0196 26123.0000   -2.50    0.012 *  
includedhorm_contra:menstruationyes    -0.0275     0.0188 26230.0000   -1.46    0.144    
includedhorm_contra:fertile            -0.0410     0.0390 26240.0000   -1.05    0.294    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.472                                                               
menstrutnpr             -0.234  0.293                                                        
menstrutnys             -0.226  0.280  0.396                                                 
fertile                 -0.224  0.357  0.468    0.385                                        
fertile_men             -0.768 -0.037 -0.006   -0.005   -0.086                               
inclddhrm_cntr:mnstrtnp  0.192 -0.364 -0.780   -0.309   -0.364 -0.007                        
inclddhrm_cntr:mnstrtny  0.180 -0.342 -0.302   -0.763   -0.293 -0.006  0.381                 
inclddhrm_cntr:f         0.223 -0.450 -0.371   -0.305   -0.788  0.009  0.467                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.381                 
</code></pre>
<p>Effect size standardised by residual variance (<span class="math inline">\(\frac{b}{ SD_{residual} }\)</span>): -0.04 [-0.16;0.08].</p>
</div>
<div id="marginal-effect-plots-21" class="section level4">
<h4>Marginal effect plots</h4>
<pre class="r"><code>model %&gt;% 
  plot_all_effects()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-marg_eff-20-1.png" width="960" /></p>
</div>
<div id="outcome-distribution-21" class="section level4">
<h4>Outcome distribution</h4>
<pre class="r"><code>model %&gt;% 
  plot_outcome(diary) + xlab(outcome_label)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-outcome_dist-21-1.png" width="576" /></p>
</div>
<div id="diagnostics-21" class="section level4">
<h4>Diagnostics</h4>
<pre class="r"><code>model %&gt;% 
  print_diagnostics()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-diagnostics-22-1.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-diagnostics-22-2.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-diagnostics-22-3.png" width="576" /></p>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-diagnostics-22-4.png" width="576" /></p>
</div>
</div>
<div id="curves-21" class="section level3 tab-content active">
<h3>Curves</h3>
<p>Here, we continuously plot the outcome over the course of the cycle. Because cycle lengths vary, we subset the data to cycles in a certain range. If the red curve traces the pink curve, our predictor accurately maps the relationship between fertile window probability and the outcome.</p>
<div id="cycle-lengths-from-21-to-36-21" class="section level4 tab-content">
<h4>Cycle lengths from 21 to 36</h4>
<div id="backward-counted-42" class="section level5 tab-content active">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-84" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-residuals-39-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-84" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-raw-40-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-84" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-means-41-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve21_36_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 36, minimum_cycle_length_diary > 20) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-42" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 36, minimum_cycle_length_diary &gt; 20) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-85" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-residuals-43-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-85" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-raw-44-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-85" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-means-45-1.png" width="768" /></p>
</div>
</div>
</div>
<div id="cycle-lengths-from-27-to-30-21" class="section level4 tab-content">
<h4>Cycle lengths from 27 to 30</h4>
<div id="backward-counted-43" class="section level5 tab-content">
<h5>Backward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(fertile=prc_stirn_b))</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-86" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-residuals-47-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-86" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-raw-48-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-86" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-means-49-1.png" width="768" /></p>
<!-- ##### Backward-counted, inferred {.tab-content} -->
<!-- ```{r curve27_30_bci,results='asis'} -->
<!-- model %>%  -->
<!--   plot_curve(diary %>% filter(minimum_cycle_length_diary <= 30, minimum_cycle_length_diary >= 27) %>% mutate(RCD = (RCD_inferred - 1)*-1, fertile=prc_stirn_b_backward_inferred), caption_x = "Days until next menstruation, inferred where unknown") -->
<!-- ``` -->
</div>
</div>
<div id="forward-counted-43" class="section level5 tab-content">
<h5>Forward-counted</h5>
<pre class="r"><code>model %&gt;% 
  plot_curve(diary %&gt;% filter(minimum_cycle_length_diary &lt;= 30, minimum_cycle_length_diary &gt;= 27) %&gt;% mutate(RCD = FCD, fertile = prc_stirn_b_forward_counted), caption_x = &quot;Days since last menstruation&quot;)</code></pre>
<pre class="r"><code>outcome = names(model@frame)[1]
outcome_label = recode(str_replace_all(str_replace_all(str_replace_all(outcome, &quot;_&quot;, &quot; &quot;), &quot; pair&quot;, &quot;-pair&quot;), &quot; 1&quot;, &quot;&quot;), 
                       &quot;desirability 1&quot; = &quot;self-perceived desirability&quot;,
                       &quot;NARQ admiration&quot; = &quot;narcissistic admiration&quot;,
                       &quot;NARQ rivalry&quot; = &quot;narcissistic rivalry&quot;,
                       &quot;extra-pair&quot; = &quot;extra-pair desire &amp; behaviour&quot;,
                       &quot;had sexual intercourse&quot; = &quot;sexual intercourse&quot;)

library(ggplot2)

# form a subset and run the model without the hormonal contraception and the fertility predictors
tmp = diary %&gt;%
  filter(!is.na(fertile), !is.na(included),
         RCD &gt; -1 * minimum_cycle_length_diary, RCD &gt; -40)

new_form = update.formula(formula(model), new = . ~ . - fertile * included)
tmp$residuals = residuals(update(model, new_form, data = tmp , na.action = na.exclude))

tmp = tmp %&gt;% 
  filter(!is.na(RCD), !is.na(residuals))
rcd_min = min(tmp$RCD)

tmp$real = FALSE
tmp_before = tmp
tmp_before$RCD = tmp_before$RCD + min(tmp$RCD) - 1
tmp_after = tmp
tmp_after$RCD = tmp_after$RCD - min(tmp$RCD) + 1
tmp$real = TRUE
tmp = bind_rows(tmp_before %&gt;% filter(RCD &gt; rcd_min - 11), tmp, tmp_after %&gt;% filter(RCD &lt; 11))</code></pre>
<div id="gam-smooth-on-residuals-87" class="section level6">
<h6>GAM smooth on residuals</h6>
<p>Here, we partialled out menstruation and individual random effects, then superimposed estimated probability of being in the fertile window scaled to the range of the estimated means. To address the periodicity of the cycle, we prepended and appended ten days of the timeseries to the end and the beginning of the timeseries. We then estimated the GAM and cut off the appended subsets before plotting.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes(x = RCD, y = residuals, colour = included)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data



ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, residuals&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-residuals-51-1.png" width="768" /></p>
</div>
<div id="gam-smooth-on-raw-data-87" class="section level6">
<h6>GAM smooth on raw data</h6>
<p>As before, but without partialling anything out.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    stat_smooth(geom = &#39;smooth&#39;,size = 0.8, fill = &quot;#9ECAE1&quot;, method = &#39;gam&#39;, formula = y ~ s(x))
}, error = function(e){cat_message(e, &quot;danger&quot;)})

tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot1b = ggplot(trend_data) +
  geom_ribbon(aes(x = x, ymin = ymin, ymax = ymax,  fill = factor(group)), alpha = 0.2) +
  geom_line(aes(x = x, y = y, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;) +
  scale_x_continuous(caption_x) +
  geom_line(aes(x = x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;GAM smooth, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)

suppressWarnings(print(plot1b))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-raw-52-1.png" width="768" /></p>
</div>
<div id="means-and-standard-errors-over-raw-data-87" class="section level6">
<h6>Means and standard errors over raw data</h6>
<p>Nothing partialled out, just straight means with bootstrapped confidence intervals.</p>
<pre class="r"><code>tryCatch({
  trend_plot = ggplot(tmp,aes_string(x = &quot;RCD&quot;, y = outcome, colour = &quot;included&quot;)) +
    geom_pointrange(size = 0.8, stat = &#39;summary&#39;, fun.data = &quot;mean_cl_boot&quot;)
}, error = function(e){cat_message(e, &quot;danger&quot;)})
tryCatch({
  trend_data = ggplot_build(trend_plot)$data[[1]]
}, error = function(e){cat_message(e, &quot;danger&quot;)})

trend_data$RCD = round(trend_data$x)
trend_data = left_join(trend_data, tmp %&gt;% select(real, RCD,fertile) %&gt;% unique(), by = &quot;RCD&quot;)
trend_data %&gt;%
  filter(real == TRUE) %&gt;%
  mutate(superimposed = ( ( (fertile - 0.01)/0.58) * (max(y)-min(y) ) ) + min(y) ) -&gt;
  trend_data

plot3 = ggplot(trend_data) +
  geom_pointrange(aes(x = x, y = y, ymin = ymin,ymax = ymax, colour = factor(group)), size = 0.8, stat = &quot;identity&quot;, alpha = 0.6, position = position_dodge(width = .5)) +
  scale_x_continuous(&quot;Days until next menstruation&quot;) +
  geom_line(aes(x= x, y = superimposed), color = &quot;#a83fbf&quot;, size = 1, linetype = &#39;dashed&#39;) +
  annotate(&quot;text&quot;,x = mean(trend_data$x),  y = max(trend_data$superimposed,na.rm=T) + 0.1, label = &#39;superimposed fertility peak&#39;, color = &quot;#a83fbf&quot;) +
  scale_y_continuous(outcome_label) +
  ggtitle(&quot;Means with standard errors, raw data&quot;) +
  scale_color_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;,values = c(&quot;2&quot;=&quot;black&quot;,&quot;1&quot;= &quot;red&quot;), labels = c(&quot;2&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F)
suppressWarnings(print(plot3))</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-communication_partner_1-curve-means-53-1.png" width="768" /></p>
</div>
</div>
</div>
</div>
<div id="robustness-checks-21" class="section level3 tab-content">
<h3>Robustness checks</h3>
<div id="m_r1-random-slopes-for-conception-risk-and-menstruation-21" class="section level4">
<h4>M_r1: Random slopes for conception risk and menstruation</h4>
<pre class="r"><code>tryCatch({
# refit model with random effects for fertile and menstruation dummies
with_ind_diff = update(model, formula = . ~ . - (1| person) + (1 + fertile + menstruation | person))

# pull the random effects, format as tibble
rand = coef(with_ind_diff)$person %&gt;% 
  tibble::rownames_to_column(&quot;person&quot;) %&gt;% 
  mutate(person = as.numeric(person))

# pull the fixed effects
fixd = data.frame(fixef(with_ind_diff)) %&gt;% 
  tibble::rownames_to_column(&quot;effect&quot;)
names(fixd) = c(&quot;effect&quot;, &quot;pop_effect_size&quot;)

# pull apart the coefficients so that we can account for the fact that the random effect variation implicitly includes HC explaining the mean population-level effect of fertile/menstruation dummies among HC users
fixd = fixd %&gt;% 
  separate(effect, c(&quot;included&quot;, &quot;effect&quot;), sep = &quot;:&quot;, fill = &quot;left&quot;) %&gt;% 
  mutate(included = if_else(is.na(included), &quot;cycling&quot;, str_replace(included, &quot;included&quot;, &quot;&quot;)))
fixd[2,c(&quot;included&quot;, &quot;effect&quot;)] = c(&quot;horm_contra&quot;, &quot;(Intercept)&quot;)
  

rand = rand %&gt;% 
  # merge diary data on the random effects, so that we know who is a HC users and who isn&#39;t
  inner_join(diary %&gt;% select(person, included) %&gt;% unique(), by = &#39;person&#39;) %&gt;%
  # gather into long format, to have the dataset by predictor
  gather(effect, value, -person, -included) %&gt;% 
  inner_join(fixd, by = c(&#39;effect&#39;, &#39;included&#39;)) %&gt;% 
  # pull the fixed effects
  mutate(
    # only for those who are HC users, add the moderated population effect size for this effect (the random effects have the reference category mean)
    value = if_else(included == &quot;horm_contra&quot;, value + pop_effect_size, value),
    effect = recode(effect, &quot;includedhorm_contra&quot; = &quot;HC user&quot;,
                   &quot;includedhorm_contra:fertile&quot; = &quot;HC user x fertile&quot;,
                   &quot;includedhorm_contra:menstruationpre&quot; = &quot;HC user x premens.&quot;,
                   &quot;includedhorm_contra:menstruationyes&quot; = &quot;HC user x mens.&quot;,
                   &quot;menstruationyes&quot; = &quot;mens.&quot;, 
                   &quot;menstruationpre&quot; = &quot;premens.&quot;)) %&gt;% 
  group_by(included, effect) %&gt;% 
  # filter out predictors that aren&#39;t modelled as varying/random
  filter(sd(value) &gt; 0)

# plot dot plot of random effects
print(
ggplot(rand, aes(x = included, y = value, color = included, fill = included)) +
  facet_wrap( ~ effect, scales = &quot;free&quot;) + 
  # geom_violin(alpha = 0.4, size = 0) + 
  geom_dotplot(binaxis=&#39;y&#39;, dotsize = 0.1, method = &quot;histodot&quot;) +
# geom_jitter(alpha = 0.05) + 
  coord_flip() + 
  geom_pointrange(stat = &#39;summary&#39;, fun.data = &#39;mean_sdl&#39;, color = &#39;darkred&#39;, size = 1.2) +
  scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;cycling&quot;=&quot;cycling&quot;), guide = F) +
  scale_fill_manual(&quot;Contraception status&quot;, values = c(&quot;horm_contra&quot;=&quot;black&quot;,&quot;cycling&quot;= &quot;red&quot;), labels = c(&quot;horm_contra&quot;=&quot;hormonally\ncontracepting&quot;,&quot;1&quot;=&quot;cycling&quot;), guide = F) + 
  ggtitle(&quot;M_r1: allowing participant-varying slopes&quot;, subtitle = &quot;for the conception risk measure and the menstruation dummies&quot;) +
  scale_x_discrete(&quot;Hormonal contraception&quot;, breaks = c(&quot;horm_contra&quot;, &quot;cycling&quot;), labels = c(&quot;yes&quot;, &quot;no&quot;)) +
  scale_y_continuous(&quot;Random effect size distribution&quot;))

print_summary(with_ind_diff)
cat(pander(anova(model, with_ind_diff)))
}, error = function(e){
  with_ind_diff = model
  cat_message(e, &quot;danger&quot;)
})</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-random_slopes-27-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ included + menstruation + fertile +  
    fertile_mean + (1 + fertile + menstruation | person) + included:menstruation +      included:fertile
   Data: diary

REML criterion at convergence: 40456

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.722 -0.831  0.236  0.768  2.874 

Random effects:
 Groups   Name            Variance Std.Dev. Corr             
 person   (Intercept)     0.0814   0.285                     
          fertile         0.1739   0.417    -0.40            
          menstruationpre 0.0330   0.182    -0.38  0.48      
          menstruationyes 0.0274   0.165    -0.26  0.60  0.55
 Residual                 0.2403   0.490                     
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                    Estimate Std. Error t value
(Intercept)                          2.54553    0.02687    94.7
includedhorm_contra                  0.04087    0.02279     1.8
menstruationpre                      0.01750    0.01831     1.0
menstruationyes                      0.00492    0.01703     0.3
fertile                             -0.01908    0.03865    -0.5
fertile_mean                        -0.10707    0.12312    -0.9
includedhorm_contra:menstruationpre -0.04714    0.02347    -2.0
includedhorm_contra:menstruationyes -0.02597    0.02217    -1.2
includedhorm_contra:fertile         -0.04310    0.04887    -0.9

Correlation of Fixed Effects:
                        (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
inclddhrm_c             -0.492                                                               
menstrutnpr             -0.304  0.361                                                        
menstrutnys             -0.258  0.315  0.438                                                 
fertile                 -0.288  0.424  0.464    0.452                                        
fertile_men             -0.748 -0.036 -0.003   -0.012   -0.093                               
inclddhrm_cntr:mnstrtnp  0.246 -0.454 -0.780   -0.341   -0.361 -0.010                        
inclddhrm_cntr:mnstrtny  0.209 -0.388 -0.336   -0.768   -0.346 -0.005  0.426                 
inclddhrm_cntr:f         0.275 -0.537 -0.367   -0.357   -0.785  0.010  0.463                 
                        inclddhrm_cntr:mnstrtny
inclddhrm_c                                    
menstrutnpr                                    
menstrutnys                                    
fertile                                        
fertile_men                                    
inclddhrm_cntr:mnstrtnp                        
inclddhrm_cntr:mnstrtny                        
inclddhrm_cntr:f         0.447                 
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="16%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="11%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>object</strong></td>
<td align="center">11</td>
<td align="center">40622</td>
<td align="center">40712</td>
<td align="center">-20300</td>
<td align="center">40600</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>..1</strong></td>
<td align="center">20</td>
<td align="center">40443</td>
<td align="center">40607</td>
<td align="center">-20202</td>
<td align="center">40403</td>
<td align="center">196.7</td>
<td align="center">9</td>
<td align="center">1.616e-37</td>
</tr>
</tbody>
</table>
<pre class="r"><code>robustness_check_ovu_shift(model, diary)</code></pre>
</div>
<div id="m_e-exclusion-criteria-21" class="section level4">
<h4>M_e: Exclusion criteria</h4>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-1.png" width="1056" /></p>
</div>
<div id="m_p-predictors-21" class="section level4">
<h4>M_p: Predictors</h4>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-2.png" width="1056" /></p>
</div>
<div id="m_c-covariates-controls-autocorrelation-21" class="section level4">
<h4>M_c: Covariates, controls, autocorrelation</h4>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-3.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]

REML criterion at convergence: 37059

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.703 -0.841  0.251  0.786  2.822 

Random effects:
 Groups   Name                                   Variance Std.Dev.    
 person   (Intercept)                            6.80e-02 0.2608262300
 Xr.2     s(days_filled_out):includedhorm_contra 1.45e-03 0.0381340105
 Xr.1     s(days_filled_out):includedcycling     5.65e-03 0.0751478563
 Xr.0     s(day_number):includedhorm_contra      1.50e-15 0.0000000388
 Xr       s(day_number):includedcycling          2.89e-13 0.0000005377
 Residual                                        2.48e-01 0.4983897808
Number of obs: 24271, groups:  person, 1043; Xr.2, 8; Xr.1, 8; Xr.0, 8; Xr, 8

Fixed effects:
                                            Estimate Std. Error t value
X(Intercept)                                2.543379   0.026422    96.3
Xincludedhorm_contra                        0.037493   0.021900     1.7
Xmenstruationpre                            0.024874   0.015851     1.6
Xmenstruationyes                            0.009655   0.015189     0.6
Xfertile                                   -0.019607   0.032794    -0.6
Xfertile_mean                              -0.131282   0.122208    -1.1
Xincludedhorm_contra:menstruationpre       -0.053224   0.020309    -2.6
Xincludedhorm_contra:menstruationyes       -0.028790   0.019866    -1.4
Xincludedhorm_contra:fertile               -0.040239   0.041345    -1.0
Xs(day_number):includedcyclingFx1           0.020540   0.024784     0.8
Xs(day_number):includedhorm_contraFx1       0.077559   0.021013     3.7
Xs(days_filled_out):includedcyclingFx1      0.000605   0.034189     0.0
Xs(days_filled_out):includedhorm_contraFx1 -0.098364   0.024785    -4.0
</code></pre>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
communication_partner_1 ~ included + menstruation + fertile + 
    fertile_mean + s(day_number, by = included) + s(days_filled_out, 
    by = included) + included:menstruation + included:fertile

Parametric coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                          2.54338    0.02642   96.26   &lt;2e-16 ***
includedhorm_contra                  0.03749    0.02190    1.71   0.0869 .  
menstruationpre                      0.02487    0.01585    1.57   0.1166    
menstruationyes                      0.00965    0.01519    0.64   0.5250    
fertile                             -0.01961    0.03279   -0.60   0.5499    
fertile_mean                        -0.13128    0.12221   -1.07   0.2827    
includedhorm_contra:menstruationpre -0.05322    0.02031   -2.62   0.0088 ** 
includedhorm_contra:menstruationyes -0.02879    0.01987   -1.45   0.1473    
includedhorm_contra:fertile         -0.04024    0.04135   -0.97   0.3304    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
                                        edf Ref.df     F  p-value    
s(day_number):includedcycling          1.00   1.00  0.69  0.40725    
s(day_number):includedhorm_contra      1.00   1.00 13.62  0.00022 ***
s(days_filled_out):includedcycling     2.72   2.72  1.77  0.09922 .  
s(days_filled_out):includedhorm_contra 2.18   2.18 10.61 0.000017 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.00144   
lmer.REML =  37059  Scale est. = 0.24839   n = 24271
</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-4.png" width="1056" /></p>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  39328 39426 -19652

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.2469    0.506

Correlation Structure: ARMA(1,0)
 Formula: ~day_number | person 
 Parameter estimate(s):
  Phi1 
0.2626 
Fixed effects: communication_partner_1 ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.5482   0.02664 25519   95.66  0.0000
includedhorm_contra                  0.0415   0.02204  1040    1.88  0.0599
menstruationpre                      0.0153   0.01741 25519    0.88  0.3789
menstruationyes                      0.0054   0.01622 25519    0.33  0.7410
fertile                             -0.0098   0.03687 25519   -0.27  0.7906
fertile_mean                        -0.1084   0.12423  1040   -0.87  0.3832
includedhorm_contra:menstruationpre -0.0485   0.02234 25519   -2.17  0.0298
includedhorm_contra:menstruationyes -0.0192   0.02115 25519   -0.91  0.3641
includedhorm_contra:fertile         -0.0527   0.04643 25519   -1.13  0.2565
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.478                                                               
menstruationpre                     -0.259  0.318                                                        
menstruationyes                     -0.250  0.306  0.399                                                 
fertile                             -0.247  0.395  0.435    0.365                                        
fertile_mean                        -0.761 -0.039 -0.005   -0.005   -0.101                               
includedhorm_contra:menstruationpre  0.210 -0.395 -0.779   -0.311   -0.338 -0.007                        
includedhorm_contra:menstruationyes  0.199 -0.373 -0.306   -0.767   -0.279 -0.006  0.384                 
includedhorm_contra:fertile          0.248 -0.498 -0.345   -0.290   -0.787  0.012  0.433                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.359                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.6657 -0.8640  0.2884  0.7830  2.7734 

Number of Observations: 26568
Number of Groups: 1043 
</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: diary 
    AIC   BIC logLik
  39312 39418 -19643

Random effects:
 Formula: ~1 | person
        (Intercept) Residual
StdDev:      0.2453   0.5066

Correlation Structure: ARMA(1,1)
 Formula: ~day_number | person 
 Parameter estimate(s):
   Phi1  Theta1 
 0.3691 -0.1141 
Fixed effects: communication_partner_1 ~ included * (menstruation + fertile) +      fertile_mean 
                                      Value Std.Error    DF t-value p-value
(Intercept)                          2.5480   0.02670 25519   95.43  0.0000
includedhorm_contra                  0.0416   0.02211  1040    1.88  0.0601
menstruationpre                      0.0149   0.01754 25519    0.85  0.3958
menstruationyes                      0.0048   0.01636 25519    0.29  0.7702
fertile                             -0.0094   0.03740 25519   -0.25  0.8009
fertile_mean                        -0.1074   0.12455  1040   -0.86  0.3885
includedhorm_contra:menstruationpre -0.0482   0.02251 25519   -2.14  0.0321
includedhorm_contra:menstruationyes -0.0187   0.02132 25519   -0.88  0.3808
includedhorm_contra:fertile         -0.0538   0.04710 25519   -1.14  0.2530
 Correlation: 
                                    (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
includedhorm_contra                 -0.479                                                               
menstruationpre                     -0.260  0.318                                                        
menstruationyes                     -0.251  0.308  0.402                                                 
fertile                             -0.248  0.398  0.427    0.362                                        
fertile_mean                        -0.761 -0.039 -0.005   -0.005   -0.103                               
includedhorm_contra:menstruationpre  0.211 -0.395 -0.779   -0.313   -0.332 -0.007                        
includedhorm_contra:menstruationyes  0.200 -0.374 -0.308   -0.767   -0.277 -0.006  0.387                 
includedhorm_contra:fertile          0.249 -0.501 -0.339   -0.287   -0.787  0.013  0.426                 
                                    inclddhrm_cntr:mnstrtny
includedhorm_contra                                        
menstruationpre                                            
menstruationyes                                            
fertile                                                    
fertile_mean                                               
includedhorm_contra:menstruationpre                        
includedhorm_contra:menstruationyes                        
includedhorm_contra:fertile          0.356                 

Standardized Within-Group Residuals:
    Min      Q1     Med      Q3     Max 
-3.6554 -0.8657  0.2953  0.7837  2.7490 

Number of Observations: 26568
Number of Groups: 1043 
</code></pre>
</div>
<div id="m_d-other-designs-21" class="section level4">
<h4>M_d: Other designs</h4>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-5.png" width="1056" /></p>
</div>
<div id="m_m1-moderation-by-contraceptive-method-21" class="section level4">
<h4><em>M_m1</em>: Moderation by contraceptive method</h4>
<p>Based on the sample with lax exclusion criteria. Users who used any hormonal contraception are classified as hormonal, users who use any awareness-based methods (counting, temperature-based) are classified as ‘fertility-awareness’, women who don’t fall into the before groups and use condoms, pessars, coitus interruptus etc. are classified as ‘barrie or abstinence’. Women who don’t use contraception or use other methods such as sterilisation are excluded from this analysis.</p>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-6.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-7.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-8.png" width="1056" /><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rob_check-28-9.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ fertile_mean + (1 | person) + contraceptive_methods +  
    fertile + menstruation + fertile:contraceptive_methods +      menstruation:contraceptive_methods
   Data: diary
 Subset: !is.na(included_lax) &amp; contraceptive_method != &quot;other&quot;

REML criterion at convergence: 26215

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.701 -0.843  0.243  0.783  2.886 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0663   0.257   
 Residual             0.2538   0.504   
Number of obs: 17044, groups:  person, 513

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                               2.552029   0.052748    48.4
fertile_mean                                             -0.237851   0.252436    -0.9
contraceptive_methodsfertility_awareness                  0.154581   0.071903     2.1
contraceptive_methodsnone                                 0.002050   0.076230     0.0
contraceptive_methodshormonal                             0.039372   0.036111     1.1
fertile                                                   0.000541   0.056093     0.0
menstruationpre                                          -0.001261   0.027092     0.0
menstruationyes                                          -0.015761   0.025855    -0.6
contraceptive_methodsfertility_awareness:fertile         -0.140399   0.127420    -1.1
contraceptive_methodsnone:fertile                        -0.120908   0.138004    -0.9
contraceptive_methodshormonal:fertile                    -0.052020   0.062634    -0.8
contraceptive_methodsfertility_awareness:menstruationpre -0.039217   0.060068    -0.7
contraceptive_methodsnone:menstruationpre                -0.044501   0.062747    -0.7
contraceptive_methodshormonal:menstruationpre            -0.023694   0.030515    -0.8
contraceptive_methodsfertility_awareness:menstruationyes  0.016308   0.060343     0.3
contraceptive_methodsnone:menstruationyes                -0.010447   0.065642    -0.2
contraceptive_methodshormonal:menstruationyes             0.001625   0.029482     0.1
</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>add_main</strong></td>
<td align="center">13</td>
<td align="center">26167</td>
<td align="center">26268</td>
<td align="center">-13071</td>
<td align="center">26141</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>by_method</strong></td>
<td align="center">19</td>
<td align="center">26177</td>
<td align="center">26324</td>
<td align="center">-13069</td>
<td align="center">26139</td>
<td align="center">2.618</td>
<td align="center">6</td>
<td align="center">0.8551</td>
</tr>
</tbody>
</table>
</div>
<div id="m_m2-moderation-by-participant-age-21" class="section level4">
<h4><em>M_m2</em>: Moderation by participant age</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;age_group&quot;, diary, xlevels = 5)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">19</td>
<td align="center">40633</td>
<td align="center">40788</td>
<td align="center">-20297</td>
<td align="center">40595</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">27</td>
<td align="center">40639</td>
<td align="center">40860</td>
<td align="center">-20293</td>
<td align="center">40585</td>
<td align="center">9.505</td>
<td align="center">8</td>
<td align="center">0.3015</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-age-29-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + age_group + included + fertile + menstruation:included +  
    age_group:included + age_group:fertile + included:fertile +      age_group:included:fertile
   Data: diary

REML criterion at convergence: 40702

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.740 -0.847  0.244  0.785  2.921 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0671   0.259   
 Residual             0.2507   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.52555    0.05210    48.5
menstruationpre                               0.01714    0.01527     1.1
menstruationyes                               0.00624    0.01435     0.4
fertile_mean                                 -0.12059    0.12172    -1.0
age_group(20,25]                              0.01028    0.05492     0.2
age_group(25,30]                              0.05121    0.05658     0.9
age_group(30,35]                              0.02032    0.06493     0.3
age_group(35,70]                              0.01929    0.05947     0.3
includedhorm_contra                           0.05070    0.05531     0.9
fertile                                      -0.15998    0.08793    -1.8
menstruationpre:includedhorm_contra          -0.04904    0.01958    -2.5
menstruationyes:includedhorm_contra          -0.02756    0.01880    -1.5
age_group(20,25]:includedhorm_contra          0.01993    0.06248     0.3
age_group(25,30]:includedhorm_contra         -0.05909    0.06901    -0.9
age_group(30,35]:includedhorm_contra         -0.04454    0.08961    -0.5
age_group(35,70]:includedhorm_contra         -0.05951    0.10147    -0.6
age_group(20,25]:fertile                      0.13160    0.09732     1.4
age_group(25,30]:fertile                      0.15181    0.10033     1.5
age_group(30,35]:fertile                      0.28244    0.11614     2.4
age_group(35,70]:fertile                      0.11213    0.10595     1.1
includedhorm_contra:fertile                   0.09778    0.09750     1.0
age_group(20,25]:includedhorm_contra:fertile -0.13690    0.10901    -1.3
age_group(25,30]:includedhorm_contra:fertile -0.16444    0.12077    -1.4
age_group(30,35]:includedhorm_contra:fertile -0.29374    0.15579    -1.9
age_group(35,70]:includedhorm_contra:fertile  0.13019    0.17804     0.7
</code></pre>
</div>
<div id="m_m3-moderation-by-weekend-21" class="section level4">
<h4><em>M_m3</em>: Moderation by weekend</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekend&quot;, diary, xlevels = 2) </code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">40269</td>
<td align="center">40376</td>
<td align="center">-20122</td>
<td align="center">40243</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">40272</td>
<td align="center">40395</td>
<td align="center">-20121</td>
<td align="center">40242</td>
<td align="center">1.538</td>
<td align="center">2</td>
<td align="center">0.4635</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-weekend-30-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + weekend + included + fertile + menstruation:included +  
    weekend:included + weekend:fertile + included:fertile + weekend:included:fertile
   Data: diary

REML criterion at convergence: 40321

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.902 -0.826  0.248  0.781  3.031 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.067    0.259   
 Residual             0.247    0.497   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                        Estimate Std. Error t value
(Intercept)                              2.49758    0.02646    94.4
menstruationpre                          0.01759    0.01516     1.2
menstruationyes                          0.00579    0.01424     0.4
fertile_mean                            -0.11138    0.12082    -0.9
weekendTRUE                              0.12267    0.01327     9.2
includedhorm_contra                      0.04870    0.02230     2.2
fertile                                 -0.03954    0.03743    -1.1
menstruationpre:includedhorm_contra     -0.04981    0.01944    -2.6
menstruationyes:includedhorm_contra     -0.02514    0.01866    -1.3
weekendTRUE:includedhorm_contra         -0.01898    0.01705    -1.1
weekendTRUE:fertile                      0.04108    0.05170     0.8
includedhorm_contra:fertile             -0.03935    0.04737    -0.8
weekendTRUE:includedhorm_contra:fertile -0.00276    0.06553     0.0
</code></pre>
</div>
<div id="m_m4-moderation-by-weekday-21" class="section level4">
<h4><em>M_m4</em>: Moderation by weekday</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;weekday&quot;, diary, xlevels = 7)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">23</td>
<td align="center">40070</td>
<td align="center">40259</td>
<td align="center">-20012</td>
<td align="center">40024</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">35</td>
<td align="center">40085</td>
<td align="center">40372</td>
<td align="center">-20008</td>
<td align="center">40015</td>
<td align="center">9.026</td>
<td align="center">12</td>
<td align="center">0.7007</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-weekday-31-1.png" width="1056" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + weekday + included + fertile + menstruation:included +  
    weekday:included + weekday:fertile + included:fertile + weekday:included:fertile
   Data: diary

REML criterion at convergence: 40193

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.902 -0.818  0.242  0.777  3.115 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0673   0.259   
 Residual             0.2452   0.495   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                             Estimate Std. Error t value
(Intercept)                                   2.56073    0.03010    85.1
menstruationpre                               0.01774    0.01510     1.2
menstruationyes                               0.00568    0.01419     0.4
fertile_mean                                 -0.12194    0.12079    -1.0
weekdayTuesday                               -0.09437    0.02362    -4.0
weekdayWednesday                             -0.07922    0.02360    -3.4
weekdayThursday                              -0.07330    0.02388    -3.1
weekdayFriday                                -0.02117    0.02426    -0.9
weekdaySaturday                               0.08139    0.02453     3.3
weekdaySunday                                 0.12097    0.02370     5.1
includedhorm_contra                           0.05427    0.02887     1.9
fertile                                      -0.10767    0.06682    -1.6
menstruationpre:includedhorm_contra          -0.04903    0.01936    -2.5
menstruationyes:includedhorm_contra          -0.02397    0.01859    -1.3
weekdayTuesday:includedhorm_contra           -0.00767    0.03031    -0.3
weekdayWednesday:includedhorm_contra         -0.02784    0.03043    -0.9
weekdayThursday:includedhorm_contra           0.01205    0.03072     0.4
weekdayFriday:includedhorm_contra            -0.00563    0.03112    -0.2
weekdaySaturday:includedhorm_contra          -0.03457    0.03150    -1.1
weekdaySunday:includedhorm_contra            -0.03347    0.03054    -1.1
weekdayTuesday:fertile                        0.08486    0.09192     0.9
weekdayWednesday:fertile                      0.04829    0.09256     0.5
weekdayThursday:fertile                       0.15300    0.09392     1.6
weekdayFriday:fertile                         0.04138    0.09403     0.4
weekdaySaturday:fertile                       0.11416    0.09528     1.2
weekdaySunday:fertile                         0.18831    0.09263     2.0
includedhorm_contra:fertile                   0.00109    0.08518     0.0
weekdayTuesday:includedhorm_contra:fertile   -0.06256    0.11703    -0.5
weekdayWednesday:includedhorm_contra:fertile  0.02262    0.11809     0.2
weekdayThursday:includedhorm_contra:fertile  -0.12244    0.11909    -1.0
weekdayFriday:includedhorm_contra:fertile     0.07130    0.11939     0.6
weekdaySaturday:includedhorm_contra:fertile  -0.07847    0.12113    -0.6
weekdaySunday:includedhorm_contra:fertile    -0.13475    0.11791    -1.1
</code></pre>
</div>
<div id="m_m5-moderation-by-exclusion-threshold-21" class="section level4">
<h4><em>M_m5</em>: Moderation by exclusion threshold</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;included_levels&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">40617</td>
<td align="center">40756</td>
<td align="center">-20291</td>
<td align="center">40583</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">40623</td>
<td align="center">40812</td>
<td align="center">-20289</td>
<td align="center">40577</td>
<td align="center">5.499</td>
<td align="center">6</td>
<td align="center">0.4816</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-exclusion-32-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + included_levels + included + fertile + menstruation:included +  
    included_levels:included + included_levels:fertile + included:fertile +  
    included_levels:included:fertile
   Data: diary

REML criterion at convergence: 40683

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.736 -0.846  0.247  0.785  2.934 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0663   0.257   
 Residual             0.2507   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                        Estimate Std. Error t value
(Intercept)                                              2.55513    0.02869    89.1
menstruationpre                                          0.01798    0.01527     1.2
menstruationyes                                          0.00744    0.01434     0.5
fertile_mean                                            -0.10702    0.12226    -0.9
included_levelslax                                      -0.11457    0.05458    -2.1
included_levelsconservative                              0.01374    0.04276     0.3
included_levelsstrict                                   -0.00782    0.04200    -0.2
includedhorm_contra                                      0.06025    0.02967     2.0
fertile                                                 -0.03008    0.03924    -0.8
menstruationpre:includedhorm_contra                     -0.04900    0.01959    -2.5
menstruationyes:includedhorm_contra                     -0.02801    0.01881    -1.5
included_levelslax:includedhorm_contra                   0.00996    0.06680     0.1
included_levelsconservative:includedhorm_contra         -0.04945    0.05375    -0.9
included_levelsstrict:includedhorm_contra               -0.01243    0.05200    -0.2
included_levelslax:fertile                              -0.13147    0.09512    -1.4
included_levelsconservative:fertile                      0.10717    0.07104     1.5
included_levelsstrict:fertile                            0.00555    0.07108     0.1
includedhorm_contra:fertile                             -0.03405    0.05924    -0.6
included_levelslax:includedhorm_contra:fertile           0.12124    0.11581     1.0
included_levelsconservative:includedhorm_contra:fertile -0.11120    0.09211    -1.2
included_levelsstrict:includedhorm_contra:fertile        0.01342    0.09067     0.1
</code></pre>
</div>
<div id="m_m6-moderation-by-cycle-length-21" class="section level4">
<h4><em>M_m6</em>: Moderation by cycle length</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_length_groups&quot;, diary, xlevels = 4)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">17</td>
<td align="center">40625</td>
<td align="center">40764</td>
<td align="center">-20296</td>
<td align="center">40591</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">23</td>
<td align="center">40633</td>
<td align="center">40821</td>
<td align="center">-20293</td>
<td align="center">40587</td>
<td align="center">4.718</td>
<td align="center">6</td>
<td align="center">0.5805</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-cycle_length-33-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + cycle_length_groups + included + fertile + menstruation:included +  
    cycle_length_groups:included + cycle_length_groups:fertile +  
    included:fertile + cycle_length_groups:included:fertile
   Data: diary

REML criterion at convergence: 40684

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.741 -0.848  0.246  0.784  2.935 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0668   0.258   
 Residual             0.2507   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                       Estimate Std. Error t value
(Intercept)                                             2.47006    0.04889    50.5
menstruationpre                                         0.01810    0.01528     1.2
menstruationyes                                         0.00874    0.01445     0.6
fertile_mean                                           -0.13531    0.12234    -1.1
cycle_length_groups(25,30]                              0.09068    0.04776     1.9
cycle_length_groups(30,35]                              0.10616    0.05678     1.9
cycle_length_groups(35,41]                              0.04344    0.07975     0.5
includedhorm_contra                                     0.12039    0.05416     2.2
fertile                                                -0.09098    0.08323    -1.1
menstruationpre:includedhorm_contra                    -0.04907    0.01959    -2.5
menstruationyes:includedhorm_contra                    -0.02813    0.01890    -1.5
cycle_length_groups(25,30]:includedhorm_contra         -0.08589    0.05819    -1.5
cycle_length_groups(30,35]:includedhorm_contra         -0.17753    0.08779    -2.0
cycle_length_groups(35,41]:includedhorm_contra         -0.05880    0.11220    -0.5
cycle_length_groups(25,30]:fertile                      0.07255    0.08900     0.8
cycle_length_groups(30,35]:fertile                      0.09755    0.10469     0.9
cycle_length_groups(35,41]:fertile                      0.12694    0.14663     0.9
includedhorm_contra:fertile                            -0.01068    0.09754    -0.1
cycle_length_groups(25,30]:includedhorm_contra:fertile -0.01418    0.10477    -0.1
cycle_length_groups(30,35]:includedhorm_contra:fertile -0.07995    0.16327    -0.5
cycle_length_groups(35,41]:includedhorm_contra:fertile -0.26100    0.19250    -1.4
</code></pre>
</div>
<div id="m_m7-moderation-by-certainty-about-menstruation-parameters-21" class="section level4">
<h4><em>M_m7</em>: Moderation by certainty about menstruation parameters</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;certainty_menstruation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">13</td>
<td align="center">40606</td>
<td align="center">40713</td>
<td align="center">-20290</td>
<td align="center">40580</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">15</td>
<td align="center">40609</td>
<td align="center">40732</td>
<td align="center">-20289</td>
<td align="center">40579</td>
<td align="center">1.414</td>
<td align="center">2</td>
<td align="center">0.493</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-certainty-34-1.png" width="768" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + certainty_menstruation + included + fertile + menstruation:included +  
    certainty_menstruation:included + certainty_menstruation:fertile +  
    included:fertile + certainty_menstruation:included:fertile
   Data: diary

REML criterion at convergence: 40658

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.733 -0.848  0.248  0.784  2.908 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0657   0.256   
 Residual             0.2507   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                   Estimate Std. Error t value
(Intercept)                                         2.29064    0.07066    32.4
menstruationpre                                     0.01730    0.01527     1.1
menstruationyes                                     0.00627    0.01436     0.4
fertile_mean                                       -0.14943    0.12061    -1.2
certainty_menstruation                              0.06358    0.01606     4.0
includedhorm_contra                                 0.17598    0.08857     2.0
fertile                                             0.12065    0.12479     1.0
menstruationpre:includedhorm_contra                -0.04859    0.01957    -2.5
menstruationyes:includedhorm_contra                -0.02696    0.01880    -1.4
certainty_menstruation:includedhorm_contra         -0.03374    0.02056    -1.6
certainty_menstruation:fertile                     -0.03399    0.02918    -1.2
includedhorm_contra:fertile                        -0.15897    0.16000    -1.0
certainty_menstruation:includedhorm_contra:fertile  0.02862    0.03696     0.8
</code></pre>
</div>
<div id="m_m8-moderation-by-cycle-regularity-21" class="section level4">
<h4><em>M_m8</em>: Moderation by cycle regularity</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cycle_regularity&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">40625</td>
<td align="center">40748</td>
<td align="center">-20298</td>
<td align="center">40595</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">40626</td>
<td align="center">40782</td>
<td align="center">-20294</td>
<td align="center">40588</td>
<td align="center">6.886</td>
<td align="center">4</td>
<td align="center">0.142</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-regularity-35-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + cycle_regularity + included + fertile + menstruation:included +  
    cycle_regularity:included + cycle_regularity:fertile + included:fertile +  
    cycle_regularity:included:fertile
   Data: diary

REML criterion at convergence: 40677

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.721 -0.848  0.247  0.788  2.917 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.067    0.259   
 Residual             0.251    0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                                  Estimate Std. Error t value
(Intercept)                                                                        2.57136    0.03034    84.8
menstruationpre                                                                    0.01662    0.01527     1.1
menstruationyes                                                                    0.00623    0.01434     0.4
fertile_mean                                                                      -0.14064    0.12159    -1.2
cycle_regularityslightly irregular,\nup to 5 days off                             -0.01609    0.03360    -0.5
cycle_regularityirregular,\nmore than 5 days off                                  -0.07030    0.04059    -1.7
includedhorm_contra                                                                0.03191    0.02732     1.2
fertile                                                                           -0.06538    0.04270    -1.5
menstruationpre:includedhorm_contra                                               -0.04853    0.01958    -2.5
menstruationyes:includedhorm_contra                                               -0.02773    0.01879    -1.5
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra         -0.01239    0.05058    -0.2
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra              -0.02074    0.06060    -0.3
cycle_regularityslightly irregular,\nup to 5 days off:fertile                      0.05567    0.05869     0.9
cycle_regularityirregular,\nmore than 5 days off:fertile                           0.13008    0.07324     1.8
includedhorm_contra:fertile                                                       -0.00468    0.04993    -0.1
cycle_regularityslightly irregular,\nup to 5 days off:includedhorm_contra:fertile -0.07921    0.08715    -0.9
cycle_regularityirregular,\nmore than 5 days off:includedhorm_contra:fertile       0.01503    0.10824     0.1
</code></pre>
</div>
<div id="m_m9-moderation-by-cohabitation-status-21" class="section level4">
<h4><em>M_m9</em>: Moderation by cohabitation status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;cohabitation&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">40566</td>
<td align="center">40689</td>
<td align="center">-20268</td>
<td align="center">40536</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">40565</td>
<td align="center">40721</td>
<td align="center">-20264</td>
<td align="center">40527</td>
<td align="center">8.627</td>
<td align="center">4</td>
<td align="center">0.07112</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-mod_cohabit-36-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + cohabitation + included + fertile + menstruation:included +  
    cohabitation:included + cohabitation:fertile + included:fertile +      cohabitation:included:fertile
   Data: diary

REML criterion at convergence: 40619

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.714 -0.845  0.251  0.787  2.904 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.0623   0.250   
 Residual             0.2506   0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                          Estimate Std. Error t value
(Intercept)                                                2.61985    0.02877    91.1
menstruationpre                                            0.01823    0.01526     1.2
menstruationyes                                            0.00769    0.01433     0.5
fertile_mean                                              -0.12449    0.11861    -1.0
cohabitationLive in same city                             -0.14842    0.03733    -4.0
cohabitationLong-distance                                 -0.16029    0.03520    -4.6
includedhorm_contra                                        0.05633    0.03037     1.9
fertile                                                   -0.02888    0.03884    -0.7
menstruationpre:includedhorm_contra                       -0.04822    0.01956    -2.5
menstruationyes:includedhorm_contra                       -0.02747    0.01878    -1.5
cohabitationLive in same city:includedhorm_contra          0.08275    0.04761     1.7
cohabitationLong-distance:includedhorm_contra             -0.01862    0.04552    -0.4
cohabitationLive in same city:fertile                      0.08962    0.07014     1.3
cohabitationLong-distance:fertile                         -0.02856    0.06327    -0.5
includedhorm_contra:fertile                               -0.06734    0.05632    -1.2
cohabitationLive in same city:includedhorm_contra:fertile -0.09820    0.08765    -1.1
cohabitationLong-distance:includedhorm_contra:fertile      0.12940    0.08144     1.6
</code></pre>
</div>
<div id="m_m10-moderation-by-relationship-status-21" class="section level4">
<h4><em>M_m10</em>: Moderation by relationship status</h4>
<pre class="r"><code>model %&gt;% 
  test_moderator(&quot;relationship_status_clean&quot;, diary)</code></pre>
<p>refitting model(s) with ML (instead of REML)</p>
<table>
<caption>Data: diary</caption>
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="13%" />
<col width="9%" />
<col width="10%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">AIC</th>
<th align="center">BIC</th>
<th align="center">logLik</th>
<th align="center">deviance</th>
<th align="center">Chisq</th>
<th align="center">Chi Df</th>
<th align="center">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>with_main</strong></td>
<td align="center">15</td>
<td align="center">40614</td>
<td align="center">40737</td>
<td align="center">-20292</td>
<td align="center">40584</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center"><strong>with_mod</strong></td>
<td align="center">19</td>
<td align="center">40620</td>
<td align="center">40776</td>
<td align="center">-20291</td>
<td align="center">40582</td>
<td align="center">2.052</td>
<td align="center">4</td>
<td align="center">0.7262</td>
</tr>
</tbody>
</table>
<p><img src="3_fertility_robustness_files/figure-html/communication_partner_1-rel_status-37-1.png" width="960" /></p>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: communication_partner_1 ~ menstruation + fertile_mean + (1 |  
    person) + relationship_status_clean + included + fertile +  
    menstruation:included + relationship_status_clean:included +  
    relationship_status_clean:fertile + included:fertile + relationship_status_clean:included:fertile
   Data: diary

REML criterion at convergence: 40664

Scaled residuals: 
   Min     1Q Median     3Q    Max 
-3.733 -0.846  0.247  0.787  2.915 

Random effects:
 Groups   Name        Variance Std.Dev.
 person   (Intercept) 0.066    0.257   
 Residual             0.251    0.501   
Number of obs: 26568, groups:  person, 1043

Fixed effects:
                                                                 Estimate Std. Error t value
(Intercept)                                                        2.5344     0.0273    92.8
menstruationpre                                                    0.0176     0.0153     1.2
menstruationyes                                                    0.0067     0.0143     0.5
fertile_mean                                                      -0.1095     0.1207    -0.9
relationship_status_cleanVerheiratet                               0.0382     0.0354     1.1
relationship_status_cleanVerlobt                                   0.0631     0.0661     1.0
includedhorm_contra                                                0.0502     0.0234     2.1
fertile                                                           -0.0335     0.0353    -0.9
menstruationpre:includedhorm_contra                               -0.0493     0.0196    -2.5
menstruationyes:includedhorm_contra                               -0.0278     0.0188    -1.5
relationship_status_cleanVerheiratet:includedhorm_contra          -0.1244     0.0675    -1.8
relationship_status_cleanVerlobt:includedhorm_contra               0.1721     0.0986     1.7
relationship_status_cleanVerheiratet:fertile                       0.0194     0.0627     0.3
relationship_status_cleanVerlobt:fertile                           0.1422     0.1159     1.2
includedhorm_contra:fertile                                       -0.0291     0.0429    -0.7
relationship_status_cleanVerheiratet:includedhorm_contra:fertile   0.0329     0.1170     0.3
relationship_status_cleanVerlobt:includedhorm_contra:fertile      -0.2081     0.1802    -1.2
</code></pre>
</div>
</div>
</div>
<div id="response-time" class="section level2 tab-content">
<h2>Response time</h2>
<div id="time-of-response" class="section level3">
<h3>Time of response</h3>
<p>This model simply tests whether there was a main effect on time of response. Potentially, if participants delayed their responses more on (in)fertile days, they would have more behaviour to report on or could be more tired/hungry etc.</p>
<pre class="r"><code>m_time_of_response = lmer(time_of_response ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
summary(m_time_of_response)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: time_of_response ~ included * (menstruation + fertile) + fertile_mean +      (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 115301
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -2.860 -0.777 -0.151  0.738  3.440 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.813    0.901   
##  Residual             3.782    1.945   
## Number of obs: 27220, groups:  person, 1043
## 
## Fixed effects:
##                                         Estimate   Std. Error           df t value Pr(&gt;|t|)    
## (Intercept)                            19.885320     0.092221  1751.000000  215.63   &lt;2e-16 ***
## includedhorm_contra                    -0.102284     0.076289  1939.000000   -1.34     0.18    
## menstruationpre                         0.008841     0.058332 26832.000000    0.15     0.88    
## menstruationyes                        -0.015210     0.055114 26954.000000   -0.28     0.78    
## fertile                                 0.059463     0.117997 26789.000000    0.50     0.61    
## fertile_mean                            0.561794     0.427781  1811.000000    1.31     0.19    
## includedhorm_contra:menstruationpre    -0.039106     0.074829 26843.000000   -0.52     0.60    
## includedhorm_contra:menstruationyes     0.000834     0.072286 26933.000000    0.01     0.99    
## includedhorm_contra:fertile            -0.345186     0.148913 26967.000000   -2.32     0.02 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.479                                                               
## menstrutnpr             -0.248  0.306                                                        
## menstrutnys             -0.235  0.290  0.388                                                 
## fertile                 -0.238  0.376  0.463    0.378                                        
## fertile_men             -0.762 -0.035 -0.007   -0.005   -0.093                               
## inclddhrm_cntr:mnstrtnp  0.203 -0.382 -0.779   -0.302   -0.360 -0.007                        
## inclddhrm_cntr:mnstrtny  0.188 -0.355 -0.295   -0.762   -0.287 -0.007  0.373                 
## inclddhrm_cntr:f         0.237 -0.474 -0.367   -0.299   -0.786  0.010  0.463                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.375</code></pre>
</div>
<div id="time-taken-for-response" class="section level3">
<h3>Time taken for response</h3>
<p>Here, we test if participants took longer to respond on fertile days. This is not necessarily a confound, as participants may take longer to fill out the survey because they are reporting more behaviours.</p>
<pre class="r"><code>m_time_for_response = lmer(log10(time_for_response+1) ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
summary(m_time_for_response)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: log10(time_for_response + 1) ~ included * (menstruation + fertile) +  
##     fertile_mean + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: -1940
## 
## Scaled residuals: 
##    Min     1Q Median     3Q    Max 
## -3.466 -0.560 -0.217  0.262  6.714 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  person   (Intercept) 0.0113   0.106   
##  Residual             0.0505   0.225   
## Number of obs: 25884, groups:  person, 1042
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                             0.72971     0.01109  1689.00000   65.82   &lt;2e-16 ***
## includedhorm_contra                    -0.01305     0.00909  1874.00000   -1.44   0.1511    
## menstruationpre                         0.00315     0.00693 25473.00000    0.45   0.6493    
## menstruationyes                         0.01827     0.00652 25623.00000    2.80   0.0051 ** 
## fertile                                 0.01703     0.01404 25430.00000    1.21   0.2254    
## fertile_mean                            0.03753     0.05175  1735.00000    0.73   0.4684    
## includedhorm_contra:menstruationpre    -0.00781     0.00889 25485.00000   -0.88   0.3800    
## includedhorm_contra:menstruationyes    -0.00538     0.00854 25600.00000   -0.63   0.5285    
## includedhorm_contra:fertile            -0.02774     0.01772 25602.00000   -1.57   0.1176    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.475                                                               
## menstrutnpr             -0.251  0.311                                                        
## menstrutnys             -0.240  0.297  0.395                                                 
## fertile                 -0.239  0.379  0.469    0.385                                        
## fertile_men             -0.767 -0.037 -0.006   -0.004   -0.090                               
## inclddhrm_cntr:mnstrtnp  0.205 -0.387 -0.779   -0.307   -0.364 -0.008                        
## inclddhrm_cntr:mnstrtny  0.191 -0.363 -0.301   -0.763   -0.293 -0.007  0.379                 
## inclddhrm_cntr:f         0.239 -0.478 -0.371   -0.305   -0.787  0.007  0.467                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.381</code></pre>
</div>
<div id="time-since-last-response" class="section level3">
<h3>Time since last response</h3>
<p>We asked participants to report on the last 24h or the time since their last diary entry. If women waited longer between entries on (in)fertile days, these could pose a problem. This does not appear to be the case.</p>
<pre class="r"><code>m_time_since_last_response = lmer(time_since_last_response ~ included * (menstruation + fertile) + fertile_mean + ( 1 | person), data = diary)
summary(m_time_since_last_response)</code></pre>
<pre><code>## Linear mixed model fit by REML 
## t-tests use  Satterthwaite approximations to degrees of freedom [&#39;lmerMod&#39;]
## Formula: time_since_last_response ~ included * (menstruation + fertile) +      fertile_mean + (1 | person)
##    Data: diary
## 
## REML criterion at convergence: 99027
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.6895 -0.5961  0.0079  0.5924  2.7216 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.    
##  person   (Intercept) 5.07e-15 0.0000000712
##  Residual             6.69e+00 2.5859662469
## Number of obs: 20896, groups:  person, 992
## 
## Fixed effects:
##                                        Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)                            23.84868     0.07739 20887.00000  308.17   &lt;2e-16 ***
## includedhorm_contra                    -0.00937     0.07117 20887.00000   -0.13     0.90    
## menstruationpre                         0.03273     0.08624 20887.00000    0.38     0.70    
## menstruationyes                         0.01008     0.08153 20887.00000    0.12     0.90    
## fertile                                 0.10495     0.17660 20887.00000    0.59     0.55    
## fertile_mean                            0.31522     0.34554 20887.00000    0.91     0.36    
## includedhorm_contra:menstruationpre    -0.01319     0.11029 20887.00000   -0.12     0.90    
## includedhorm_contra:menstruationyes    -0.01815     0.10711 20887.00000   -0.17     0.87    
## includedhorm_contra:fertile            -0.09508     0.22015 20887.00000   -0.43     0.67    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##                         (Intr) incld_ mnstrtnp mnstrtny fertil frtl_m inclddhrm_cntr:mnstrtnp
## inclddhrm_c             -0.546                                                               
## menstrutnpr             -0.467  0.502                                                        
## menstrutnys             -0.427  0.458  0.369                                                 
## fertile                 -0.430  0.600  0.465    0.371                                        
## fertile_men             -0.686 -0.043  0.007    0.008   -0.168                               
## inclddhrm_cntr:mnstrtnp  0.368 -0.626 -0.782   -0.289   -0.363 -0.010                        
## inclddhrm_cntr:mnstrtny  0.332 -0.561 -0.281   -0.761   -0.280 -0.016  0.354                 
## inclddhrm_cntr:f         0.434 -0.762 -0.374   -0.298   -0.780  0.004  0.468                 
##                         inclddhrm_cntr:mnstrtny
## inclddhrm_c                                    
## menstrutnpr                                    
## menstrutnys                                    
## fertile                                        
## fertile_men                                    
## inclddhrm_cntr:mnstrtnp                        
## inclddhrm_cntr:mnstrtny                        
## inclddhrm_cntr:f         0.373</code></pre>
</div>
</div>
<div id="coefficient-plot" class="section level2">
<h2>Coefficient plot</h2>
<pre class="r"><code>library(broom)
coefs = models %&gt;% lapply(FUN = tidy, conf.int = TRUE) %&gt;% 
  bind_rows(.id = &quot;outcome&quot;) %&gt;% 
  select(-p.value) %&gt;% 
  left_join(
    models %&gt;% lapply(FUN = get_p_val) %&gt;% 
  bind_rows(.id = &quot;outcome&quot;),
  by = c(&quot;outcome&quot;, &quot;term&quot;)) %&gt;% 
  mutate(outcome = factor(outcome),
         term = factor(term),
         group = factor(group),
         p.value = pvalues(p.value))

coefs %&gt;% filter(term %in% c(&quot;includedhorm_contra:fertile&quot;, &quot;fertile&quot;)) %&gt;% 
  ggplot(., aes(x = outcome, y = estimate, ymax = conf.high, ymin = conf.low, colour = term)) +
    geom_hline(yintercept = 0, linetype = &quot;dotted&quot;, color = &quot;gray70&quot;) +
    geom_text(aes(label = format(estimate, digits = 1, nsmall=2), y = estimate), vjust = -0.7,position = position_dodge(width = 0.6)) +
    geom_pointrange( position = position_dodge(width = 0.6), size = 1) +
    scale_color_manual(&quot;Contraception status&quot;, values = c(&quot;includedhorm_contra:fertile&quot;=&quot;black&quot;,&quot;fertile&quot; = &quot;red&quot;), labels = c(&quot;includedhorm_contra:fertile&quot;=&quot;hormonally\ncontracepting&quot;,&quot;fertile&quot; = &quot;fertile&quot;), guide = F) +
     coord_flip()</code></pre>
<p><img src="3_fertility_robustness_files/figure-html/coefplot-1.png" width="1152" /></p>
</div>
<div id="table" class="section level2">
<h2>Table</h2>
<pre class="r"><code>library(DT)
coefs %&gt;% 
  datatable(rownames = FALSE, filter = &quot;top&quot;, extensions = &#39;Buttons&#39;, options = list(
    dom = &#39;Bfrtip&#39;,
    buttons = c(&#39;copy&#39;, &#39;csv&#39;, &#39;excel&#39;, &#39;pdf&#39;, &#39;print&#39;),
    pagelength = 20
  )) %&gt;% 
  formatRound(c(&quot;estimate&quot;, &quot;std.error&quot;, &quot;statistic&quot;, &quot;conf.low&quot;, &quot;conf.high&quot;), 2)</code></pre>
<div id="htmlwidget-939d8a65e79adfc8f471" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-939d8a65e79adfc8f471">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;communication_partner_1&quot;,&quot;desirability_1&quot;,&quot;extra_pair&quot;,&quot;extra_pair_intimacy&quot;,&quot;extra_pair_sex&quot;,&quot;female_jealousy&quot;,&quot;female_mate_retention&quot;,&quot;had_petting&quot;,&quot;had_sexual_intercourse&quot;,&quot;in_pair_desire&quot;,&quot;in_pair_public_intimacy&quot;,&quot;male_attention_1&quot;,&quot;NARQ_admiration&quot;,&quot;NARQ_rivalry&quot;,&quot;partner_initiated_sexual_intercourse&quot;,&quot;partner_mate_retention&quot;,&quot;relationship_satisfaction_1&quot;,&quot;self_esteem_1&quot;,&quot;sexual_intercourse_satisfaction&quot;,&quot;sexy_clothes&quot;,&quot;showy_clothes&quot;,&quot;spent_night_with_partner&quot;]\">\u003c/select>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;(Intercept)&quot;,&quot;fertile&quot;,&quot;fertile_mean&quot;,&quot;includedhorm_contra&quot;,&quot;includedhorm_contra:fertile&quot;,&quot;includedhorm_contra:menstruationpre&quot;,&quot;includedhorm_contra:menstruationyes&quot;,&quot;menstruationpre&quot;,&quot;menstruationyes&quot;,&quot;sd_(Intercept).person&quot;,&quot;sd_Observation.Residual&quot;]\">\u003c/select>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-4.27634855348346\" data-max=\"5.05870331760666\" data-scale=\"15\">\u003c/div>\n      <span style=\"float: left;\">\u003c/span>\n      <span style=\"float: right;\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0.01433955524971\" data-max=\"2.11670946462595\" data-scale=\"15\">\u003c/div>\n      <span style=\"float: left;\">\u003c/span>\n      <span style=\"float: right;\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-17.2845560277835\" data-max=\"98.2248208327746\" data-scale=\"15\">\u003c/div>\n      <span style=\"float: left;\">\u003c/span>\n      <span style=\"float: right;\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-6.07636035141803\" data-max=\"4.90965186429899\" data-scale=\"15\">\u003c/div>\n      <span style=\"float: left;\">\u003c/span>\n      <span style=\"float: right;\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-3.5442573654045\" data-max=\"5.20775477091432\" data-scale=\"15\">\u003c/div>\n      <span style=\"float: left;\">\u003c/span>\n      <span style=\"float: right;\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;fixed&quot;,&quot;person&quot;,&quot;Residual&quot;]\">\u003c/select>\n    \u003c/div>\n  \u003c/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\">\u003c/span>\n    \u003c/div>\n  \u003c/td>\n\u003c/tr>","extensions":["Buttons"],"data":[["extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","extra_pair","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","desirability_1","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_intimacy","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","extra_pair_sex","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","in_pair_desire","had_petting","had_petting","had_petting","had_petting","had_petting","had_petting","had_petting","had_petting","had_petting","had_petting","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","had_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","partner_initiated_sexual_intercourse","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","sexual_intercourse_satisfaction","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","spent_night_with_partner","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","partner_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","female_mate_retention","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","sexy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","showy_clothes","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","male_attention_1","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","in_pair_public_intimacy","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_admiration","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","NARQ_rivalry","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","self_esteem_1","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","female_jealousy","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","relationship_satisfaction_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1","communication_partner_1"],["(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual","(Intercept)","includedhorm_contra","menstruationpre","menstruationyes","fertile","fertile_mean","includedhorm_contra:menstruationpre","includedhorm_contra:menstruationyes","includedhorm_contra:fertile","sd_(Intercept).person","sd_Observation.Residual"],[1.83329633169766,-0.124142484701707,-0.0906677645345392,-0.0715720970810287,0.173564051363724,-0.0115980587946577,0.0691553995500865,0.0860199968999134,-0.175118525287305,0.558112256064232,0.56658496171842,3.72862803150981,-0.00860619299686407,-0.111338501783404,-0.253376840399826,0.148779094929839,-0.000747436603503619,0.0283134303410538,0.0723057881052194,-0.287174632324143,0.846001420115222,1.12521961149581,-3.99755600908333,-0.813619927279477,-0.250824317080836,-0.239325602389077,-0.367299902114271,1.8585434208167,0.118142551653487,0.26369970214126,0.3705863577404,2.09133035312794,-4.27634855348346,-0.209562083732971,0.0129412403870464,-0.122011733892269,0.158661291964736,-1.9276860350161,-0.239320301815751,-0.0501400509694171,0.180671486317306,2.92983246384524,3.47715688761324,0.286288869212807,-0.0654810188569106,-0.186567664389215,0.271063492075319,0.0368753720881748,-0.00498452896135082,0.0366673172643722,-0.483282752869956,0.856223051635232,1.09134165379535,-1.08106034541025,0.186626014135654,-0.0623795940047209,-0.121670473445489,0.136665786970716,-0.0673963991404161,0.00580844369042389,-0.033293107844543,-0.271521126579953,0.605433826168963,-1.02456147772413,0.267807088059106,-0.0193122733291674,-0.409986472514767,0.114372877677451,0.420388301850424,-0.0712941191915407,-0.213878484556302,-0.342649649330255,0.55709377101143,0.147725497610265,0.0966392902252891,0.0322198242497149,0.060731455282955,-0.288333497522312,0.630759975138056,-0.106616646875762,-0.34421569244957,0.324156439053034,0.30348102442789,5.05870331760666,0.0841932753283732,-0.0179375757245241,-0.0578499063552162,0.0695355529084762,-0.0495750423647817,0.0439424151645005,-0.00526553269442296,-0.231826348184358,0.566276547881151,0.807799249364081,0.351659024396798,-0.211716185704494,-0.0218453668870866,-0.0225372276787966,-0.226559004939647,0.350331257685105,-0.0653672645879408,-0.0936201093793045,-0.000476416140096135,1.18332632531368,2.8096193287199,0.0805660461958188,-0.0312606784714034,-0.059878090483101,0.0417249229992126,-0.0566742336952803,0.0202542532140777,0.0128941987869228,-0.102281142546304,0.734434314147261,0.80203997131305,3.03175430754368,0.16900741634961,-0.00651420834519593,0.0190439349598163,0.05127363277668,-0.0952286365062096,-0.0353059702837381,-0.0242519260471497,-0.214074261912542,0.73786893285427,0.844617898708912,2.98340340838292,0.11289841602466,-0.0956141311429717,-0.144477370950685,-0.0410436401415926,0.562865843762074,0.0366306360061741,0.0901549066314496,-0.0902532208153657,0.760899950490513,0.952158106500031,2.6242738932824,0.049717363605636,-0.0698882732715368,-0.114631076377416,-0.0634944902299501,0.557957401165025,0.0379394211705139,0.0683172340061364,-0.0802278959075943,0.898285621481453,1.12339201014098,3.51139044375815,0.192099071035429,-0.0509983189308278,-0.171582385374392,0.0827460830264548,0.045494360493255,-0.0431715644080071,-0.00139373330692317,-0.368908066655806,0.995970491850747,1.56649098424212,-0.0865712431348586,-0.00123678110188242,-0.0355264691260952,0.027155286061541,-0.140564164178973,0.153605943976771,-0.0227580259375808,-0.10085051922856,-0.126769355769255,0.697340107519802,2.60366064171339,-0.132267805648779,-0.0468960503025534,-0.0986516840589517,-0.0206196734647232,0.316552287072824,0.0381195674545662,0.0816913640232031,-0.0253452855982881,1.06401926035864,0.731952207671084,1.29728546735701,0.033929127314712,-0.0187688502938714,0.00340091345342802,-0.0247281958364234,0.0824190815592361,0.0012088734543606,-0.0190115072045066,-0.0245957619927482,0.490805530795722,0.500363810403835,4.32598352035404,-0.0596744003253307,-0.0509405681822162,-0.118813287362896,-0.0721349516524896,-0.147845247989526,0.0531635546909313,0.120845544571498,0.139562895467738,0.758382865219268,0.891127146648609,1.66175061048355,0.03280781553123,0.00787714870671665,0.00923664415366496,0.0244604449742376,-0.112904019543038,0.0140216098936707,0.0115201097713861,-0.00465127896114719,0.53740512588797,0.637776736384073,4.75493761686769,0.182448484893391,0.0260735900837872,0.0265594071552867,0.0420723288188417,-0.411879377371386,-0.0413049204387088,-0.00716288232910722,-0.132871750592074,0.795778997275953,0.935302694686351,2.54817135959541,0.0403228806357797,0.0175921840666153,0.00679893892880431,-0.020572639592971,-0.117844332683353,-0.0490175262097304,-0.02746192849802,-0.0409451457869281,0.258698929108138,0.500681840547204],[0.0473413562321311,0.0388021985832955,0.0173625412156637,0.0163423403341263,0.0351944363906046,0.217161613565299,0.0222659557355838,0.0214110367643278,0.0444896857169877,null,null,0.0759457542355069,0.0620236617129462,0.0344241842591938,0.0323820999983789,0.0697822315568669,0.351362147229444,0.0441427899878264,0.0424269375593911,0.088143375232278,null,null,0.231279068010633,0.19711259000338,0.115288225478125,0.109959030634051,0.236742430978705,1.01223953447366,0.212903016593685,0.194873769460084,0.40358126160974,null,0.375226686902533,0.291424585750655,0.175084065416105,0.180232016419818,0.377298714622087,2.11670946462595,0.346276552921065,0.336856649631009,0.609523623104519,null,0.0760920446561847,0.0621661894280609,0.0333977982002647,0.0314198821861496,0.0677007284994779,0.35159678345122,0.0428298441975338,0.0411684389395481,0.0855329832332786,null,null,0.0702321824581199,0.0571640298015172,0.0492457799986971,0.0466498982938632,0.0978669202811377,0.32725332337024,0.0617181898902985,0.0598784234445809,0.121593087877736,null,0.0655906534032283,0.0535747084279588,0.0470661421253437,0.0478653691656578,0.0951401540322002,0.304121190424595,0.0588202019263253,0.0622343584641865,0.117519163717435,null,0.0828839935913455,0.0734254200982347,0.0881412386430194,0.0960474874603248,0.177234769246464,0.369434188258459,0.109018088123814,0.126470142023902,0.217112566877189,null,0.0760480572517481,0.0617835514080092,0.0574460127670457,0.0630029339604293,0.115929692052645,0.353527022056983,0.0709116377738015,0.0829622804426932,0.142041615859923,null,null,0.10826780561287,0.0873444396307044,0.0477716974407153,0.0454016282596487,0.0971790816235364,0.502705595119216,0.0596468350548218,0.0577759697094033,0.119796581043862,null,0.0631518382084832,0.0516988512110224,0.024568205825508,0.023121212619683,0.0498007922334991,0.290375762420935,0.0315066434500441,0.0302931835652037,0.0629433936141495,null,null,0.0640481705517575,0.0523957359882217,0.0258653545484394,0.0243395232453186,0.0524304786042463,0.294945616767205,0.0331701284945316,0.0318885498875233,0.06625939530412,null,null,0.0673307392816901,0.055020103824101,0.0291420841431974,0.027417293241604,0.059073266951268,0.310935950833558,0.0373692343247431,0.035918805771965,0.0746291491442903,null,null,0.079478961023625,0.0649469617774847,0.0343830705528546,0.0323482703037279,0.069697595517019,0.367022480026243,0.0440901245084849,0.042381535079816,0.0880518949588842,null,null,0.0934872907744857,0.0763120733883578,0.0478599049560774,0.0450003805606212,0.0970259089918757,0.434504341845034,0.0613756038618539,0.0589681602675022,0.122500924431469,null,null,0.0710019060585348,0.057649631137703,0.0413631923917277,0.0391061542572815,0.0841888669991278,0.332863522029746,0.0528942937718845,0.0511340195614821,0.106005587200998,null,0.0854765668215645,0.0705529426168079,0.0224643086969421,0.0211574982951008,0.045537367746345,0.38749135443701,0.0288079269667355,0.0277154110980147,0.057598923710344,null,null,0.0416635482025867,0.0341460298752922,0.0153329603244685,0.0144343188155139,0.0310803997124872,0.191142895878224,0.019663061133397,0.0189090575936756,0.0392867801232356,null,null,0.0661878819310039,0.0541270773766872,0.0272852693487776,0.0256741938242568,0.0553089526910154,0.305048106133089,0.034988477282915,0.0336365842908797,0.0698856729067992,null,null,0.0470031137142746,0.0384327230956029,0.0195267613457626,0.0183733824135972,0.0395820526839407,0.216702225611546,0.0250412920750918,0.024072276742058,0.0500151574913333,null,null,0.0694520239257926,0.0567965781159575,0.0286304042607236,0.026937770612226,0.0580496130426335,0.320105052808586,0.0367144290119612,0.0352807815840604,0.0733429568759844,null,null,0.0259422347426178,0.0212286771991697,0.0152623042592886,0.0143395552497103,0.030953591948977,0.121055668027232,0.0195708556804116,0.0187854047826002,0.0390428541982434,null,null],[38.7250488285205,-3.19936728418143,-5.22203307732068,-4.37955002880283,4.93157638433039,-0.0534074996231793,3.1058805816077,4.01755402350383,-3.93616008890885,null,null,49.0959378709622,-0.138756609319435,-3.23431053427703,-7.82459569986227,2.13204839699912,-0.00212725420025263,0.641405546610488,1.70424245219214,-3.258039887483,null,null,-17.2845560277835,-4.1276913223327,-2.17562822257533,-2.17649792844723,-1.55147474238494,1.8360707693393,0.554912530332794,1.3531821284715,0.918244708047803,null,-11.3967068514886,-0.719095416034231,0.073914438508669,-0.676970364732892,0.420519036550801,-0.910699397924574,-0.691124766597482,-0.148846849318071,0.296414247895894,null,45.6967203775963,4.60521823593679,-1.96063879613452,-5.9378855491526,4.00384897006551,0.104879719678354,-0.116379806061443,0.890665718907017,-5.65025016784312,null,null,-15.3926634140253,3.26474558885456,-1.26669927872746,-2.60816160153332,1.39644515816092,-0.205945652274299,0.0941123467935167,-0.55601176399303,-2.2330309339045,null,-15.6205408021397,4.99875959976942,-0.410321994901051,-8.56540918123582,1.20215148735981,1.38230519637091,-1.21206858964611,-3.43666247767912,-2.91569169224286,null,1.78231635819355,1.31615576861524,0.365547668103557,0.632306548446068,-1.62684499631871,1.70736763186836,-0.977972084363426,-2.72171507789178,1.49303397640909,null,66.5198231278995,1.36271343115862,-0.312251013786881,-0.91820972006717,0.599807967029701,-0.140229853085434,0.619678469487207,-0.0634689965888794,-1.63210159769639,null,null,3.24804795300106,-2.42392288049059,-0.457286804895236,-0.496396903430594,-2.33135569049024,0.696891502872619,-1.09590499693506,-1.62039875488351,-0.00397687593372719,null,44.4899057323479,1.55837207807515,-1.27240380080775,-2.58974697685739,0.837836530864379,-0.195175496820992,0.642856585030778,0.425646870662141,-1.62497025777319,null,null,47.3355332623234,3.22559485351254,-0.251850726924946,0.782428430001363,0.977935623355676,-0.322868458090603,-1.06439051900443,-0.760521445242592,-3.23085142763491,null,null,44.3096784650073,2.05194843662228,-3.28096407494901,-5.26957091196185,-0.694792115957479,1.81023082809544,0.980235123038635,2.5099639226262,-1.20935615440111,null,null,33.018472555301,0.765507149910616,-2.0326361825103,-3.54365396669156,-0.910999723289533,1.52022677500607,0.860497029515366,1.61195751587281,-0.911143320027999,null,null,37.5600834580658,2.51728281654494,-1.06557501477762,-3.81290965180281,0.852824610314998,0.104704041161183,-0.703399424063981,-0.0236353533941141,-3.01147169597226,null,null,-1.21928055091209,-0.0214534087638518,-0.858890889988467,0.694399297943872,-1.66962888549658,0.461468240917803,-0.430254840639873,-1.97227834020168,-1.19587428470998,null,30.4605196316393,-1.87473124072459,-2.0875803896399,-4.66272915081815,-0.452807759543331,0.816927354502518,1.32323188331402,2.94750684860145,-0.440030541642507,null,null,31.1371816209467,0.99364779561863,-1.22408523185962,0.235613020392257,-0.79562026438445,0.431190922270764,0.0614794129031811,-1.00541801781096,-0.626056956451908,null,null,65.3591472357972,-1.10248702160728,-1.86696226198326,-4.62773196214799,-1.30421836145539,-0.484662074659865,1.51945894246993,3.5926818111631,1.99701726638393,null,null,35.3540537885448,0.853642752547595,0.403402723433501,0.502718767058884,0.617968076834018,-0.521009967592242,0.559939553103884,0.478563365436006,-0.0929973870811698,null,null,68.4636292521612,3.2123147370058,0.910695840909101,0.985954165903857,0.724765017605586,-1.28670064329687,-1.12503235240979,-0.203025046711078,-1.81164976504487,null,null,98.2248208327746,1.8994532846991,1.1526558354325,0.474138758867131,-0.664628506665149,-0.973472243008426,-2.50461844950356,-1.46187579218183,-1.04872316913681,null,null],[1.7405089785034,-0.200193396445937,-0.124697719997332,-0.103602495559013,0.104584223581953,-0.437227000207248,0.0255149282269791,0.044055135970168,-0.262316706976107,null,null,3.57977708842949,-0.130170336143534,-0.178808663128595,-0.316844590140423,0.0120084343175456,-0.689404590703873,-0.0582048482122013,-0.0108494814855169,-0.459932473255208,null,null,-4.45085465276216,-1.19995350458551,-0.476785086859493,-0.454841342206752,-0.831306540444991,-0.125409610479258,-0.29913969307007,-0.118245867532065,-0.420418379849928,null,-5.01177934585071,-0.780743776013759,-0.330217222095373,-0.475259994936143,-0.58083060010781,-6.07636035141803,-0.918009874231716,-0.710366952199023,-1.01397286269392,null,3.32801922057711,0.164445376877713,-0.130939500492366,-0.24814950187256,0.138372502489218,-0.652241660556344,-0.0889294810519788,-0.0440213403568784,-0.65092431949745,null,null,-1.21871289358381,0.074586574513506,-0.15889954919275,-0.213102593983917,-0.0551498520581668,-0.708801126767126,-0.115156985685565,-0.15065266124696,-0.509839199589328,null,-1.15311679611691,0.162802589058073,-0.111560216786084,-0.503800872186171,-0.0720983977092544,-0.17567827831723,-0.186579596530512,-0.335855585747062,-0.572982977709695,null,-0.014724144723621,-0.0472718887169744,-0.140533829043353,-0.127518160944844,-0.635707262053649,-0.0933177285063144,-0.320288173261852,-0.592092615936083,-0.101376372617301,null,4.90965186429899,-0.0369002602683037,-0.130529691803362,-0.181333387838013,-0.157682468253527,-0.742475273158166,-0.0950418409569004,-0.167868614437413,-0.510222799575682,null,null,0.13945802471039,-0.382908141630507,-0.115476173351233,-0.111522783907184,-0.417026504972456,-0.634953603575333,-0.182272913087193,-0.206858929181612,-0.2352734004571,null,2.68584400027377,-0.02076184021988,-0.0794134770541663,-0.105194834496573,-0.0558828361800076,-0.625800270023672,-0.0414976332217535,-0.0464793499779371,-0.225647927094765,null,null,2.90622219998655,0.0663136608692259,-0.0572093717074965,-0.0286606540018835,-0.0514882169798405,-0.673311422767885,-0.100318227495586,-0.0867523353459041,-0.34394029034602,null,null,2.85143758433835,0.00506099410376731,-0.152731566498074,-0.198214278257802,-0.156825115815198,-0.046557421370417,-0.0366117174001603,0.0197553409507089,-0.236523665335043,null,null,2.46849799214743,-0.0775763423835335,-0.137277853233031,-0.178032521134889,-0.200099267252348,-0.161393441202983,-0.0484756349400032,-0.0147490483598238,-0.252806438797511,null,null,3.32815872082793,0.0425301556086704,-0.144802008948249,-0.259781510563806,-0.107421204164882,-0.806118500649292,-0.163465537506638,-0.116969203665813,-0.609005466614348,null,null,-0.225732421843283,-0.114227981853799,-0.116596836499483,-0.0494913678565984,-0.305571311396496,-0.498794570968685,-0.126428936718156,-0.201071355953832,-0.334536488843231,null,2.43612964922099,-0.270549032181043,-0.0909252862861499,-0.140119618720317,-0.109871274198315,-0.44291681194436,-0.0183429318694955,0.0273701564543725,-0.138237101618832,null,null,1.21562641341179,-0.0329958614558895,-0.0488209003062113,-0.0248898315663481,-0.0856446598980073,-0.292214110262772,-0.0373300181929068,-0.0560725790697043,-0.101596436102834,null,null,4.19625765555629,-0.16576152257205,-0.104418713414295,-0.16913378259054,-0.180538506949509,-0.745728549562533,-0.0154126006574799,0.0549190507984279,0.00258949353506455,null,null,1.56962620044234,-0.0425189375639524,-0.030394600265687,-0.0267745236511671,-0.0531189527204531,-0.537632577111341,-0.0350584206998575,-0.0356606856689286,-0.102679186325259,null,null,4.61881415131973,0.0711292373409987,-0.0300409711300531,-0.0262376530684777,-0.0717028220612065,-1.03927375214551,-0.113263879015105,-0.0763119435802896,-0.276621304588677,null,null,2.4973255138214,-0.00128456211401946,-0.0123213826026826,-0.0213060729149502,-0.081240565005115,-0.355109082141165,-0.0873756984899683,-0.0642806453069229,-0.117467733869134,null,null],[1.92608368489192,-0.0480915729574765,-0.0566378090717462,-0.0395416986030448,0.242543879145495,0.414030882617933,0.112795870873194,0.127984857829659,-0.0879203435985032,null,null,3.87747897459013,0.112957950149806,-0.0438683404382136,-0.189909090659229,0.285549755542133,0.687909717496866,0.114831708894309,0.155461057695956,-0.114416791393078,null,null,-3.5442573654045,-0.427286349973442,-0.0248635473021784,-0.023809862571401,0.0967067362164499,3.84249645211265,0.535424796377043,0.645645271814586,1.16159109533073,null,-3.5409177611162,0.361619608547818,0.356099702869466,0.231236527151606,0.898153184037281,2.22098828138582,0.439369270600213,0.610086850260189,1.37531583532853,null,3.62629455464938,0.408132361547901,-2.25372214551212e-05,-0.12498582690587,0.40375448166142,0.725992404732694,0.0789604231292772,0.117355974885623,-0.315641186242461,null,null,-0.94340779723669,0.298665453757802,0.0341403611833084,-0.0302383529070604,0.328481425999598,0.574008328486294,0.126773873066413,0.0840664455578743,-0.0332030535705768,null,-0.896006159331355,0.37281158706014,0.0729356701277496,-0.316172072843364,0.300844153064157,1.01645488201808,0.0439913581474304,-0.0919013833655406,-0.112316320950816,null,0.310175139944151,0.240550469167553,0.204973477542783,0.248981071510754,0.0590402670090249,1.35483767878243,0.107054879510327,-0.096338768963056,0.749689250723369,null,5.20775477091432,0.20528681092505,0.0946545403543136,0.0656335751275807,0.29675357407048,0.643325188428603,0.182926671285901,0.157337549048567,0.0465701032069646,null,null,0.563860024083206,-0.0405242297784802,0.0717854395770596,0.0664483285495908,-0.0360915049068374,1.33561611894554,0.0515383839113111,0.019618710423003,0.234320568176908,null,2.93339465716603,0.181893932611518,0.0168921201113595,-0.0145613464696293,0.139332682178433,0.512451802633112,0.0820061396499088,0.0722677475517827,0.0210856420021573,null,null,3.1572864151008,0.271701171829993,0.0441809550171046,0.0667485239215161,0.1540354825332,0.482854149755466,0.0297062869281096,0.0382484832516047,-0.0842082334790645,null,null,3.11536923242749,0.220735837945552,-0.0384966957878691,-0.0907404636435674,0.074737835532013,1.17228910889457,0.109872989412509,0.16055447231219,0.0560172237043115,null,null,2.78004979441737,0.177011069594806,-0.0024986933100421,-0.0512296316199427,0.0731102867924475,1.27730824353303,0.124354477281031,0.151383516372097,0.0923506469823225,null,null,3.69462216668836,0.341667986462188,0.0428053710865939,-0.0833832601849782,0.272913370217792,0.897107221635802,0.077122408690624,0.114181737051967,-0.128810666697264,null,null,0.0525899355735658,0.111754419650034,0.0455438982472923,0.10380193997968,0.0244429830385498,0.806006458922227,0.0809128848429941,-0.00062968250328882,0.0809977773047216,null,2.77119163420579,0.00601342088348575,-0.00286681431895702,-0.0571837493975866,0.0686319272688689,1.07602138609001,0.094582066778628,0.136012571592034,0.0875465304222563,null,null,1.37894452130223,0.100854116085313,0.0112831997184685,0.0316916584732041,0.0361882682251605,0.457052273381244,0.039747765101628,0.0180495646606911,0.0524049121173376,null,null,4.4557093851518,0.0464127219213888,0.00253757704986253,-0.0684927921352517,0.0362686036445302,0.450038053583481,0.121739710039343,0.186772038344568,0.276536297400411,null,null,1.75387502052477,0.108134568626412,0.0461488976791203,0.045247811958497,0.102039842668928,0.311824538025265,0.063101640487199,0.0587009052117009,0.0933766284029647,null,null,4.89106108241566,0.293767732445784,0.0821881512976275,0.0793564673790511,0.15584747969889,0.215514997402734,0.0306540381376876,0.0619861789220752,0.0108778034045302,null,null,2.59901720536943,0.0819303233855788,0.0475057507359132,0.0349039507725589,0.040095285819173,0.119420416774459,-0.0106593539294925,0.00935678831088293,0.0355774422952775,null,null],["fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","fixed","person","Residual"],["&lt; .001","= .001","&lt; .001","&lt; .001","&lt; .001","= .957","= .002","&lt; .001","&lt; .001",null,null,"&lt; .001","= .890","= .001","&lt; .001","= .033","= .998","= .521","= .088","= .001",null,null,"&lt; .001","&lt; .001","= .030","= .030","= .121","= .066","= .579","= .176","= .358",null,"&lt; .001","= .472","= .941","= .498","= .674","= .362","= .489","= .882","= .767",null,"&lt; .001","&lt; .001","= .050","&lt; .001","&lt; .001","= .916","= .907","= .373","&lt; .001",null,null,"&lt; .001","= .001","= .205","= .009","= .163","= .837","= .925","= .578","= .026",null,"&lt; .001","&lt; .001","= .682","&lt; .001","= .229","= .167","= .225","&lt; .001","= .004",null,"= .075","= .188","= .715","= .527","= .104","= .088","= .328","= .006","= .135",null,"&lt; .001","= .173","= .755","= .359","= .549","= .889","= .535","= .949","= .103",null,null,"= .001","= .015","= .647","= .620","= .020","= .486","= .273","= .105","= .997",null,"&lt; .001","= .119","= .203","= .010","= .402","= .845","= .520","= .670","= .104",null,null,"&lt; .001","= .001","= .801","= .434","= .328","= .747","= .287","= .447","= .001",null,null,"&lt; .001","= .040","= .001","&lt; .001","= .487","= .070","= .327","= .012","= .227",null,null,"&lt; .001","= .444","= .042","&lt; .001","= .362","= .129","= .390","= .107","= .362",null,null,"&lt; .001","= .012","= .287","&lt; .001","= .394","= .917","= .482","= .981","= .003",null,null,"= .223","= .983","= .390","= .487","= .095","= .644","= .667","= .049","= .232",null,"&lt; .001","= .061","= .037","&lt; .001","= .651","= .414","= .186","= .003","= .660",null,null,"&lt; .001","= .321","= .221","= .814","= .426","= .666","= .951","= .315","= .531",null,null,"&lt; .001","= .270","= .062","&lt; .001","= .192","= .628","= .129","&lt; .001","= .046",null,null,"&lt; .001","= .393","= .687","= .615","= .537","= .602","= .576","= .632","= .926",null,null,"&lt; .001","= .001","= .362","= .324","= .469","= .198","= .261","= .839","= .070",null,null,"&lt; .001","= .058","= .249","= .635","= .506","= .330","= .012","= .144","= .294",null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>outcome\u003c/th>\n      <th>term\u003c/th>\n      <th>estimate\u003c/th>\n      <th>std.error\u003c/th>\n      <th>statistic\u003c/th>\n      <th>conf.low\u003c/th>\n      <th>conf.high\u003c/th>\n      <th>group\u003c/th>\n      <th>p.value\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pagelength":20,"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 2, 2);\nDTWidget.formatRound(this, row, data, 3, 2);\nDTWidget.formatRound(this, row, data, 4, 2);\nDTWidget.formatRound(this, row, data, 5, 2);\nDTWidget.formatRound(this, row, data, 6, 2);\n}"},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
<div id="wrap-up" class="section level2">
<h2>Wrap-up</h2>
<pre class="r"><code>saveRDS(models, file = &quot;robustness_models.rds&quot;)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
